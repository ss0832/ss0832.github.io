---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Ar原子のフラーレンへの内包過程, NNP(UMA)使用)
published: 2025-12-04
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-12-04

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Ar原子のフラーレンへの内包過程の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy


今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.20.0
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.20.0.zip
unzip v1.20.0.zip
cd MultiOptPy-1.20.0
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.20.0 にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。

#### UMAを使用可能にするための手順

1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-1.20.0`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-1.20.0`がNNP`uma-s-1p1`を使用できるようになる。

#### ※Linuxの場合

すでにAnacondaの導入が終わっている前提で、環境の構築手段について述べる。以下を実行すると可能である。

GitHubのレポジトリのブランチ`stable-v1.0`から`git clone`して得られる`multioptpy`ディレクトリ内は`v1.20.0`と同等であるので安心していただきたい。

```
## 1. Download and install MultiOptPy:
git clone -b stable-v1.0 https://github.com/ss0832/MultiOptPy.git
cd MultiOptPy

## 2. Create and activate a conda environment:
conda env create -f environment.yml
conda activate test_mop

## 3. Copy the test configuration file and run the AutoTS workflow（任意で行う）:
cp test/config_autots_run_xtb_test.json .
python run_autots.py aldol_rxn.xyz -cfg config_autots_run_xtb_test.json
```

あとは、「UMAを使用可能にするための手順」と同じように進めれば問題なく導入できるはずである。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`Ar_in_c60.xyz`とした。
初期構造は以下のものを使用した。

```
115
OptimizedStructure
C     -2.866975742190     -0.090579062271      1.398350126606
C     -2.591570654163      1.179822189089      1.155695386663
C     -1.575893755511      1.645812168251      0.156839665764
C     -0.282278980258      2.194789930964      0.775023559311
C      0.098432037522      2.106045149302      2.098557412246
C     -0.450000029992      1.482837728894      3.366544186710
C      0.818388620019      1.182406094114      4.259369077925
C      1.990961946887      1.439139569361      3.386542626441
C      3.261300715478      0.937401973497      3.191121845101
C      3.749077433458     -0.489138391314      3.092887742505
C      2.999861999520     -1.648871130185      3.004232885516
C      1.497024751260     -1.831199473920      3.177296299667
C      1.072928069907     -2.756212161258      2.042782922728
C     -0.042040573143     -2.620549041074      1.247168470880
C     -1.312246459450     -2.011835594141      1.758420049742
C     -2.176501761792     -1.236626186852      0.730485732261
N     -2.884458013764     -3.515092906795      0.282736941292
O     -1.667077472190     -2.135043671207      2.899051707945
N     -2.074905587664      3.988909700743     -0.221028273219
C     -1.301039451057     -0.793782579185     -0.408449882355
C     -0.157061974554      0.868115494958     -1.762709284641
O      0.811940548977      1.087949629877      5.450538638411
C     -0.519255054535     -1.828340261506     -1.038391244271
C      0.694696434145      2.622485919471     -0.228983239683
O      0.788290261575     -1.272540146423      3.966586343951
C      1.823652695750      2.143126150085     -2.369555178406
C     -2.623639815196      5.017015339498     -0.872489517010
C      3.050235873516      2.734064493994     -1.874422326397
C     -2.238815385491      2.756123807554     -0.668647261257
C      0.679007731899      2.043502755592     -1.578682175782
C      0.251381554386     -0.137694159996     -2.614316317779
C     -1.090136644099      0.512410954618     -0.723717968785
C      3.082412642081      3.234723339143     -0.607079674080
C      1.455881836342     -0.034210405628     -3.394075878025
C      2.297867542333      3.015364077227      1.549960510494
C      2.221000117569      1.091375838645     -3.284754802112
C      0.092377390579     -1.518036638516     -2.228517543122
C      0.093337935777     -2.835062569906     -0.177293131837
C      1.884123400849      3.191826881121      0.194485060414
C     -4.345907505281     -1.791470136703     -0.472392516678
C     -3.198852971757     -2.230780733313      0.167325221118
C      5.257200339684      2.196915469042     -0.205767249800
C      1.228234744308     -3.486246620528     -0.648711868213
C      1.231002115156     -2.248733513337     -2.734275460565
C     -5.184144244023     -2.750499932271     -1.019630811819
C      1.480837004523      2.374030171830      2.425991443117
C      3.669804570109      0.973284299569     -3.277458058686
C     -3.389729946213      4.813766169405     -2.013778131954
C      5.798786442503      1.150214745361      0.640930204665
C      4.259184179063     -0.270487403414     -3.318252431440
C      3.698180379501      2.762411754278      1.582081206892
C     -4.848761033958     -4.087670027939     -0.911114191416
C     -2.317291718541      6.385115892664     -0.280124667156
C     -2.998777437415      2.463004613045     -1.794556251969
C      4.149195577750      1.712902020801      2.353725557174
C     -3.676200685146     -4.442707486692     -0.244105291780
C      2.071422671574     -1.342051397661     -3.478466703217
C      6.182482226163      0.044992564787     -0.210274571558
C      5.412850987320     -1.488575084309      1.531671781657
C      4.219871135872      2.968091031461      0.251737774403
C      2.324208269698     -3.772021400359      0.225474452944
C      4.184816362861      1.991278757356     -2.392105407863
C      5.374754854523     -0.570414365959     -2.438426684813
C      5.229519161151      0.901339499440      1.869188554793
C     -3.581518724942      3.517184809969     -2.470628867598
C      2.265337491788     -3.311631375470      1.517116831493
C      4.990942095875     -0.444100301519      2.328844214622
C      5.852790176698      0.392974178351     -1.584273244244
C      5.257196736689      1.715924993118     -1.573222170753
C      3.429939190173     -2.706633851570      2.134612357858
C      3.439135977597     -1.462373962177     -3.420382151971
C      4.036781032409     -2.496704830165     -2.596515589414
C      1.787829554291     -3.228639916714     -1.959946919865
C      5.541490405616     -2.269495768204     -0.678897907015
C      3.230218229596     -3.359635746851     -1.888796673640
C     -0.792921357061      6.565524001873     -0.267516548526
C      3.563773237309     -3.698942497907     -0.525449560032
C      4.607278838936     -2.663305282173      1.431763067306
C      6.017531549654     -1.243193823571      0.232806202243
C      4.678191223745     -3.159483020695      0.067110843324
C      5.226669795563     -1.943109374066     -1.979003623447
C     -2.841822663151      6.419062023026      1.160649736248
C     -2.955664329193      7.518848978041     -1.078986489954
C     -3.239019429678     -5.896622552036     -0.119523042698
C     -2.944329571293     -6.434436255392     -1.527014747734
C     -4.361008110754     -6.720816574889      0.523520690003
C     -1.976744619554     -6.015472094011      0.733112495651
H     -3.614450643020     -0.355409553697      2.138404243057
H     -3.105901631800      1.961267037515      1.702179473920
H     -4.567637199349     -0.734542274093     -0.540439065180
H     -6.090969032316     -2.455232736895     -1.532621374725
H     -3.828346380604      5.646249792404     -2.543390679313
H     -5.486789375703     -4.847931866444     -1.340587735906
H     -3.109375733318      1.440905498404     -2.132220949024
H     -4.177318535064      3.335135925252     -3.356343030834
H     -0.533654839449      7.530841226867      0.172553478393
H     -0.386791041621      6.531360594956     -1.281142485957
H     -0.319260357718      5.774821419601      0.313968604074
H     -2.603126105298      7.379400624293      1.622487235680
H     -2.387124844131      5.624376680697      1.751077303455
H     -3.926011543705      6.288697927584      1.185196171107
H     -2.703214507536      8.474704471164     -0.617110795446
H     -4.044449127247      7.437942749348     -1.098180606306
H     -2.592252848980      7.542747348020     -2.108327547403
H     -2.152907025108     -5.852445873912     -2.003413884334
H     -3.827527963051     -6.395846245863     -2.167104604013
H     -2.614659460016     -7.473691087100     -1.468168121392
H     -4.047373919074     -7.762358549844      0.617415565913
H     -5.275382352677     -6.701324417344     -0.071387865925
H     -4.595895569096     -6.345526328344      1.521163158694
H     -1.701511751815     -7.068779741649      0.821517735710
H     -2.130331697872     -5.609797027879      1.733288347419
H     -1.143115618933     -5.475606063100      0.284446510143
O     -1.572626690673      1.312190224186      3.741984177319
Ar    -3.367040599337     -0.253195203473      5.455128447369
```

<MoleculeViewer 
  xyzData={`115
OptimizedStructure
C     -2.866975742190     -0.090579062271      1.398350126606
C     -2.591570654163      1.179822189089      1.155695386663
C     -1.575893755511      1.645812168251      0.156839665764
C     -0.282278980258      2.194789930964      0.775023559311
C      0.098432037522      2.106045149302      2.098557412246
C     -0.450000029992      1.482837728894      3.366544186710
C      0.818388620019      1.182406094114      4.259369077925
C      1.990961946887      1.439139569361      3.386542626441
C      3.261300715478      0.937401973497      3.191121845101
C      3.749077433458     -0.489138391314      3.092887742505
C      2.999861999520     -1.648871130185      3.004232885516
C      1.497024751260     -1.831199473920      3.177296299667
C      1.072928069907     -2.756212161258      2.042782922728
C     -0.042040573143     -2.620549041074      1.247168470880
C     -1.312246459450     -2.011835594141      1.758420049742
C     -2.176501761792     -1.236626186852      0.730485732261
N     -2.884458013764     -3.515092906795      0.282736941292
O     -1.667077472190     -2.135043671207      2.899051707945
N     -2.074905587664      3.988909700743     -0.221028273219
C     -1.301039451057     -0.793782579185     -0.408449882355
C     -0.157061974554      0.868115494958     -1.762709284641
O      0.811940548977      1.087949629877      5.450538638411
C     -0.519255054535     -1.828340261506     -1.038391244271
C      0.694696434145      2.622485919471     -0.228983239683
O      0.788290261575     -1.272540146423      3.966586343951
C      1.823652695750      2.143126150085     -2.369555178406
C     -2.623639815196      5.017015339498     -0.872489517010
C      3.050235873516      2.734064493994     -1.874422326397
C     -2.238815385491      2.756123807554     -0.668647261257
C      0.679007731899      2.043502755592     -1.578682175782
C      0.251381554386     -0.137694159996     -2.614316317779
C     -1.090136644099      0.512410954618     -0.723717968785
C      3.082412642081      3.234723339143     -0.607079674080
C      1.455881836342     -0.034210405628     -3.394075878025
C      2.297867542333      3.015364077227      1.549960510494
C      2.221000117569      1.091375838645     -3.284754802112
C      0.092377390579     -1.518036638516     -2.228517543122
C      0.093337935777     -2.835062569906     -0.177293131837
C      1.884123400849      3.191826881121      0.194485060414
C     -4.345907505281     -1.791470136703     -0.472392516678
C     -3.198852971757     -2.230780733313      0.167325221118
C      5.257200339684      2.196915469042     -0.205767249800
C      1.228234744308     -3.486246620528     -0.648711868213
C      1.231002115156     -2.248733513337     -2.734275460565
C     -5.184144244023     -2.750499932271     -1.019630811819
C      1.480837004523      2.374030171830      2.425991443117
C      3.669804570109      0.973284299569     -3.277458058686
C     -3.389729946213      4.813766169405     -2.013778131954
C      5.798786442503      1.150214745361      0.640930204665
C      4.259184179063     -0.270487403414     -3.318252431440
C      3.698180379501      2.762411754278      1.582081206892
C     -4.848761033958     -4.087670027939     -0.911114191416
C     -2.317291718541      6.385115892664     -0.280124667156
C     -2.998777437415      2.463004613045     -1.794556251969
C      4.149195577750      1.712902020801      2.353725557174
C     -3.676200685146     -4.442707486692     -0.244105291780
C      2.071422671574     -1.342051397661     -3.478466703217
C      6.182482226163      0.044992564787     -0.210274571558
C      5.412850987320     -1.488575084309      1.531671781657
C      4.219871135872      2.968091031461      0.251737774403
C      2.324208269698     -3.772021400359      0.225474452944
C      4.184816362861      1.991278757356     -2.392105407863
C      5.374754854523     -0.570414365959     -2.438426684813
C      5.229519161151      0.901339499440      1.869188554793
C     -3.581518724942      3.517184809969     -2.470628867598
C      2.265337491788     -3.311631375470      1.517116831493
C      4.990942095875     -0.444100301519      2.328844214622
C      5.852790176698      0.392974178351     -1.584273244244
C      5.257196736689      1.715924993118     -1.573222170753
C      3.429939190173     -2.706633851570      2.134612357858
C      3.439135977597     -1.462373962177     -3.420382151971
C      4.036781032409     -2.496704830165     -2.596515589414
C      1.787829554291     -3.228639916714     -1.959946919865
C      5.541490405616     -2.269495768204     -0.678897907015
C      3.230218229596     -3.359635746851     -1.888796673640
C     -0.792921357061      6.565524001873     -0.267516548526
C      3.563773237309     -3.698942497907     -0.525449560032
C      4.607278838936     -2.663305282173      1.431763067306
C      6.017531549654     -1.243193823571      0.232806202243
C      4.678191223745     -3.159483020695      0.067110843324
C      5.226669795563     -1.943109374066     -1.979003623447
C     -2.841822663151      6.419062023026      1.160649736248
C     -2.955664329193      7.518848978041     -1.078986489954
C     -3.239019429678     -5.896622552036     -0.119523042698
C     -2.944329571293     -6.434436255392     -1.527014747734
C     -4.361008110754     -6.720816574889      0.523520690003
C     -1.976744619554     -6.015472094011      0.733112495651
H     -3.614450643020     -0.355409553697      2.138404243057
H     -3.105901631800      1.961267037515      1.702179473920
H     -4.567637199349     -0.734542274093     -0.540439065180
H     -6.090969032316     -2.455232736895     -1.532621374725
H     -3.828346380604      5.646249792404     -2.543390679313
H     -5.486789375703     -4.847931866444     -1.340587735906
H     -3.109375733318      1.440905498404     -2.132220949024
H     -4.177318535064      3.335135925252     -3.356343030834
H     -0.533654839449      7.530841226867      0.172553478393
H     -0.386791041621      6.531360594956     -1.281142485957
H     -0.319260357718      5.774821419601      0.313968604074
H     -2.603126105298      7.379400624293      1.622487235680
H     -2.387124844131      5.624376680697      1.751077303455
H     -3.926011543705      6.288697927584      1.185196171107
H     -2.703214507536      8.474704471164     -0.617110795446
H     -4.044449127247      7.437942749348     -1.098180606306
H     -2.592252848980      7.542747348020     -2.108327547403
H     -2.152907025108     -5.852445873912     -2.003413884334
H     -3.827527963051     -6.395846245863     -2.167104604013
H     -2.614659460016     -7.473691087100     -1.468168121392
H     -4.047373919074     -7.762358549844      0.617415565913
H     -5.275382352677     -6.701324417344     -0.071387865925
H     -4.595895569096     -6.345526328344      1.521163158694
H     -1.701511751815     -7.068779741649      0.821517735710
H     -2.130331697872     -5.609797027879      1.733288347419
H     -1.143115618933     -5.475606063100      0.284446510143
O     -1.572626690673      1.312190224186      3.741984177319
Ar    -3.367040599337     -0.253195203473      5.455128447369`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`Ar_in_c60.xyz`として保存する。その後、同じディレクトリ内で、`config_Ar_in_c60.json`を作成し、以下のように記述する。

`config_Ar_in_c60.json`
```json
{
  "work_dir": "Ar_in_c60",
  "top_n_candidates": 3,
  "multioptpy_version": "1.20.0",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"manual_AFIR": ["200", "50,63", "115", "100", "115", "22,25,114"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 20,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
	"QSMv2": true,
    "node_distance": 0.40,
    "align_distances_energy_predicted": 1,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py Ar_in_c60.xyz -cfg config_Ar_in_c60.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.20.0/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
-  `"shape_conditions": ["yyy", "lt", "a,b"]`: 構造最適化中に、ラベル番号aの原子とラベル番号bの原子の間の距離yyy(Å)よりも大きくなった時に構造最適化を途中で打ち切る。"lt"を"gt"にすると、yyy(Å)よりも小さくなった時に途中で打ち切る。
- `"shape_conditions": ["yyy", "lt", "a,b,c"]`: 構造最適化中に、角度の中心がラベル番号bの原子で、ラベル番号aの原子とラベル番号cで作る角度yyy(degrees)よりも大きくなった時に構造最適化を途中で打ち切る。"lt"を"gt"にすると、yyy(degrees)よりも小さくなった時に途中で打ち切る。
- `"shape_conditions": ["yyy", "lt", "a,b,c,d"]`: 構造最適化中に、ラベル番号bとラベル番号cを軸とした、ラベル番号aの原子とラベル番号dの原子がなす二面角yyy(degrees)よりも大きくなった時に構造最適化を途中で打ち切る。"lt"を"gt"にすると、yyy(degrees)よりも小さくなった時に途中で打ち切る。

Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`Ar_in_c60_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`Ar_in_c60_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`Ar_in_c60_step1_traj.xyz`はStep2のNEB計算に使用している。

※`Ar_in_c60_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`Ar_in_c60_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。


- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"node_distance": yyy`: 入力された経路を経路座標上でyyy(Å)間隔で線形補間により構造を再配置して初期経路とする。
- `"align_distances_energy_predicted": a`:経路緩和a回に1回、経路座標上で等間隔に線形補間により構造を置きなおす。エネルギー極大値を示す構造に対しては前後のノードの情報を使って経路座標を変数とした多項式を作り、真のエネルギー極大値の場所を連続最適化により推定し、再配置する。


`MultiOptPy-v1.20.0/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-4078.3763017646775,-4078.3763017646775,-4078.3515769675287,-4078.343368884971,-4078.338878329265,-4078.344629240581,-4078.3511075497254,-4078.3536479222407,-4078.348557574367,-4078.3386412371756,-4078.333455666951,-4078.334102842489,-4078.3419762274193,-4078.364095640105,-4078.38407540621,-4078.394556418603,-4078.402573635896,-4078.409522239015,-4078.419215152398,-4078.431472760825,-4078.447385705429,-4078.4742937825145,-4078.4957035135662,-4078.5125004629454,-4078.5174183626855,-4078.517355208222,-4078.519204176047,-4078.520363246197,-4078.5203219084115,-4078.528496889199,-4078.529863209026,-4078.528178365703,-4078.527416709557,-4078.522095735743,-4078.511274207942,-4078.5047032173447,-4078.5025608195842,-4078.5027245059996,-4078.50304146991,-4078.5029637359476,-4078.502508967737,-4078.502436753657,-4078.5025071277764,-4078.5022837214906,-4078.502453488539,-4078.5024133248235,-4078.502378505756,-4078.5023029096533];

export const dataset1_itr5 = [-4078.376993660024,-4078.3614888187208,-4078.353391449232,-4078.3534612626004,-4078.353765364309,-4078.356048843252,-4078.3587025573515,-4078.3611946002306,-4078.3612044484016,-4078.355827767584,-4078.3527095422437,-4078.3573710215446,-4078.3707025712697,-4078.3847722081186,-4078.3961212088666,-4078.403653605256,-4078.4094636406453,-4078.41722117814,-4078.4275306010477,-4078.4431997245633,-4078.4564884294878,-4078.4698215037515,-4078.4867323379417,-4078.5096448613403,-4078.5232396305973,-4078.524672539482,-4078.526109391139,-4078.5307670503307,-4078.534083798678,-4078.53776797843,-4078.5367852466165,-4078.535383038792,-4078.528087506687,-4078.5192703795883,-4078.514012507667,-4078.5115746297283,-4078.511093348559,-4078.5112424029057,-4078.5113157384853,-4078.5111490380386,-4078.5108358767143,-4078.5107638203453,-4078.510791262046,-4078.5106962499763,-4078.510740444082,-4078.5107749652507,-4078.5104553553015,-4078.5074338943746];

export const dataset1_itr10 = [-4078.3774925522466,-4078.359728975091,-4078.35586747569,-4078.359945880182,-4078.3627648753295,-4078.3651672332626,-4078.366984028059,-4078.3676334115503,-4078.3667353705027,-4078.3629315232056,-4078.3603711389264,-4078.3660084633307,-4078.3815239238365,-4078.394039547335,-4078.402513022331,-4078.410223351689,-4078.4149440426804,-4078.422333973535,-4078.431163331992,-4078.4476930840196,-4078.463666817423,-4078.4745646773113,-4078.4897084306926,-4078.5119455132512,-4078.5261931882096,-4078.5290138305604,-4078.5313525258507,-4078.538392688923,-4078.5429794132465,-4078.544282929079,-4078.539716496895,-4078.5386389632927,-4078.530739328255,-4078.522779324981,-4078.5204545432985,-4078.5191396197088,-4078.5189862020266,-4078.519010524556,-4078.5189510675377,-4078.5187690691314,-4078.5185520413766,-4078.5184954056317,-4078.5184503178307,-4078.5183661878145,-4078.518451491901,-4078.518453997752,-4078.5178376459385,-4078.5123246152652];

export const dataset2 = [-4078.3779172151944,-4078.3715413831037,-4078.355184166827,-4078.360513849789,-4078.3651478523425,-4078.3682300845453,-4078.3716536732813,-4078.372797252714,-4078.372621737979,-4078.368334804599,-4078.36317348681,-4078.3694535007526,-4078.3851442657115,-4078.3977522201944,-4078.4054068775968,-4078.413413493211,-4078.4196885304978,-4078.4245476566334,-4078.430970434009,-4078.441982424036,-4078.4590217575815,-4078.4729110081807,-4078.4842265041184,-4078.495844472085,-4078.517330500177,-4078.5286352717726,-4078.532668676081,-4078.535680218743,-4078.543508726154,-4078.5496284882743,-4078.5492339043044,-4078.545725642326,-4078.5455559190864,-4078.5400447283746,-4078.531834770809,-4078.530640408459,-4078.52901209574,-4078.528492648527,-4078.528258850844,-4078.5281486985255,-4078.5278841121653,-4078.5276972422444,-4078.527579957887,-4078.527493725059,-4078.527581114434,-4078.527624134469,-4078.526616747181,-4078.518039480874];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.0009793216502787924,0.0009793212971541377,0.0013535433233023216,0.0026649518319994095,0.004067683915653043,0.00353865200030301,0.0025387252645982105,0.0025754995304295694,0.003487263956516225,0.005111632345403455,0.004918203445790739,0.0062211546693180285,0.00810293954037943,0.005746064047613666,0.0041508905224202424,0.003378330808497059,0.003888376711902325,0.004933155235228019,0.0064281087399478565,0.00737338064874613,0.006753909633034413,0.0038951752994892744,0.004377083943181428,0.005243140342452118,0.0033772536813916716,0.0030730135747404626,0.004144418190751187,0.005353034357937333,0.005050139729485998,0.005258766634824298,0.003452731476381177,0.003126864191470043,0.003529729512218935,0.002336723426149844,0.0024070181010182722,0.0023068903727855314,0.0022666375697746196,0.002277178574022915,0.002281138420621414,0.002275296562377811,0.002271188142637414,0.002270496716195572,0.002281300046501454,0.0022679365679354373,0.002273743138445099,0.0022717635839531953,0.002271951466409049,0.0022715039639185177];

export const dataset1_grad_itr5 = [0.0007625516786023928,0.004808368798565792,0.000734564019406636,0.0011443579442645085,0.0015213636812782378,0.001799321731672213,0.0016754981552343728,0.0015153899714085107,0.001534921344227605,0.0019968379384128635,0.0023068434684690537,0.0029144855884712683,0.0033349211180207414,0.0027228494093326093,0.0020532749466007313,0.0018270883302645073,0.0017592600375974212,0.0018608052647663246,0.002238028205733987,0.002592590513989356,0.0025654594035655095,0.002395760292850855,0.00221178189601116,0.0026384223549350064,0.0013034134359310107,0.0012694543454081337,0.0015807597828430763,0.001919884045528853,0.0020933558691713164,0.0016353431296982994,0.0016643887198668262,0.0014200240514522552,0.001571755616473289,0.001839335732791907,0.001662927282103131,0.001628226561727367,0.0016128631264896,0.0016047284419267492,0.0016020671307306147,0.0016028514679289636,0.001605870822574057,0.0016022280118590292,0.0015983831305054735,0.001600564375906498,0.0016004672888027395,0.0016004076032041998,0.0016005178554462254,0.0016633988949123124];

export const dataset1_grad_itr10 = [0.0004970894653595194,0.00415763399329202,0.0006658073468614338,0.0006961631734306305,0.0008160523628145942,0.000904963196190055,0.0009734576788336216,0.0009704030234004283,0.0010485913961815869,0.001145068923835152,0.0011531657123903664,0.0018184308998046577,0.0020852335004817786,0.0015401590203207578,0.0013340001725434417,0.0012316379006611909,0.0012584324734536843,0.0013492801500461203,0.0016296288130967168,0.0019015663387098084,0.0016929236494337546,0.0018024288592917023,0.0017965122865486473,0.002228675329233812,0.0009150654771789733,0.0008010936081394194,0.00123376239290285,0.0014389568925473582,0.0012804337078258226,0.0011102905286481486,0.0013259765850544205,0.0010512117739701022,0.00123349258957219,0.0015111734396660084,0.0012607915787568522,0.0012416327490148945,0.001217907810410298,0.001213380103166713,0.0012118342991750777,0.0012111558875606372,0.0012099877398568228,0.001206407072007676,0.0012058065535839398,0.0012094254319124172,0.0012080991803697268,0.0012081965885398567,0.001220983793855533,0.0013445187253090397];

export const dataset2_grad = [0.0003468068319402869,0.0023633479918026257,0.0005721877172524319,0.0005262862159843822,0.0004734667989544658,0.0004975702939778807,0.00046318306539503833,0.00047247876017259867,0.0005474515170506713,0.0008155408280801063,0.0007245314670533575,0.0013084610652418444,0.0016031018451736394,0.0010562509382103348,0.0009955281904435271,0.0008947082110065508,0.0008823866269546067,0.0010715862288679567,0.0012398143164905277,0.0016563255022866185,0.0016880774352677908,0.001336398207881151,0.0014942531350667836,0.0016747741096959528,0.0018393647412337656,0.0006817471822511475,0.0007081472649968282,0.0009078672433946767,0.0011237096220754765,0.0008370927729037967,0.0007887423390291919,0.0010587015457550288,0.0007744473741082092,0.000929690619122887,0.0010628114828263662,0.000960054088397087,0.0008986818262966856,0.0008820053276125287,0.000870178646619269,0.0008663866265579525,0.0008597513763828703,0.0008569554814026381,0.000854060772518541,0.0008555860324395258,0.0008561018484933038,0.0008574840677257612,0.0008687965895599848,0.00107962061413988];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`Ar_in_c60_step3_TS_Opt_Inputs`内に保存された`Ar_in_c60_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`Ar_in_c60_ts_guess_1.xyz`
```
115
0 1
C      -2.869914072386     -0.090863882316      1.406907952026
C      -2.591027614109      1.180045667432      1.167325686361
C      -1.578472685427      1.646152437083      0.160560855953
C      -0.283964384890      2.196603878280      0.770163614454
C       0.106520656943      2.101365508037      2.087992845021
C      -0.443199430722      1.502506980550      3.340877329160
C       0.798354243444      1.165763412163      4.250702940950
C       1.985809390797      1.435125123903      3.393989179461
C       3.257261727305      0.935170637512      3.199198522300
C       3.745799790664     -0.490494996273      3.099781387287
C       2.996253384405     -1.650583410825      3.009340986579
C       1.492248526117     -1.828660545980      3.175725455305
C       1.070400222074     -2.757902664235      2.046697056614
C      -0.043008727530     -2.619479511056      1.248185970719
C      -1.312568593778     -2.012836400753      1.757552544666
C      -2.179522865961     -1.237389351329      0.735706763202
N      -2.885949203731     -3.515339762289      0.284936571229
O      -1.666157440213     -2.143062242397      2.898539484683
N      -2.078645689344      3.988680564143     -0.219625995200
C      -1.304462746006     -0.793284480090     -0.404444452902
C      -0.161691166344      0.868833337279     -1.760060984080
O       0.746982082855      1.054991771618      5.439542368501
C      -0.522918980551     -1.828439334452     -1.034716606057
C       0.690761813830      2.624707277232     -0.229001392854
O       0.781354853216     -1.252694066372      3.953702735124
C       1.817906784247      2.146006654013     -2.367396749756
C      -2.624559934905      5.017322730415     -0.872602961883
C       3.044971438057      2.736500593018     -1.870025553550
C      -2.242846967297      2.755853885523     -0.667068477900
C       0.673579746722      2.045827468314     -1.577829614708
C       0.245710736436     -0.137933250027     -2.611116128328
C      -1.094427966265      0.512931013931     -0.720442207002
C       3.078292555862      3.235479177481     -0.601835550402
C       1.449659328046     -0.034010688388     -3.390945684622
C       2.296560524790      3.013953268747      1.553078721125
C       2.214309600780      1.092554008986     -3.280726724847
C       0.086751213603     -1.519085572471     -2.225594518522
C       0.090329259195     -2.835301352524     -0.174621278040
C       1.880706585172      3.192388330013      0.198151339223
C      -4.348018952270     -1.791144457513     -0.469146320364
C      -3.202103619644     -2.230707645899      0.172175097983
C       5.253539151072      2.197810053491     -0.198440764643
C       1.224131075236     -3.488000698771     -0.644992713496
C       1.224337585183     -2.251147220931     -2.730913029956
C      -5.185333230631     -2.750173538220     -1.018398621211
C       1.483261998573      2.368477343847      2.425597546873
C       3.662615616601      0.973662071616     -3.269227198572
C      -3.389538239695      4.814127807501     -2.014976627538
C       5.795235395672      1.150861237495      0.649129750196
C       4.249279376521     -0.270890679825     -3.305642359351
C       3.695859513955      2.761590887030      1.588007738529
C      -4.849461934052     -4.087287478008     -0.910324775656
C      -2.317204971924      6.385413148796     -0.280804165407
C      -3.000993435103      2.463065866635     -1.794125822439
C       4.145082509187      1.712558094127      2.360957934980
C      -3.676991096448     -4.442823105838     -0.242829430398
C       2.064275082473     -1.343118242664     -3.474214774008
C       6.177533246921      0.044793662839     -0.201627388040
C       5.408467553345     -1.490054658871      1.538537269291
C       4.216312394254      2.968684983957      0.257930658881
C       2.320265167433     -3.774865967990      0.230187140641
C       4.179029931038      1.992082061578     -2.385158997058
C       5.363728901245     -0.570548940328     -2.426012576957
C       5.225907126460      0.901307948387      1.877011753939
C      -3.582089371501      3.517674531433     -2.471442669684
C       2.261753624008     -3.313657003714      1.521807464944
C       4.987125991848     -0.445161608850      2.335832706186
C       5.845071984835      0.392990140694     -1.574692300092
C       5.251219667028      1.716315540525     -1.565580996054
C       3.426108709239     -2.708928636123      2.139920677212
C       3.431326364026     -1.463205856983     -3.411270678913
C       4.030024455343     -2.498345773328     -2.589075856976
C       1.782102762614     -3.231579892711     -1.956334002226
C       5.536737018044     -2.271433665669     -0.671048619826
C       3.224788967888     -3.363613009435     -1.883622401623
C      -0.792712423451      6.565253681616     -0.268610025586
C       3.559639356818     -3.702544512993     -0.519939698476
C       4.603586162955     -2.665902874212      1.438235202924
C       6.013158908738     -1.244160944806      0.240341335353
C       4.674251455607     -3.162919194520      0.073780656872
C       5.218325091275     -1.943759037621     -1.969493665026
C      -2.841353751561      6.419871735294      1.160045578769
C      -2.955205842275      7.519167828616     -1.079997570720
C      -3.239870547624     -5.896845896971     -0.118739882522
C      -2.945267412756     -6.434562764269     -1.526230891067
C      -4.361959123152     -6.720773344849      0.524512903006
C      -1.977599689934     -6.015674441184      0.733703616668
H      -3.623107056641     -0.351945525837      2.139326306114
H      -3.101848391623      1.960579008153      1.717060672064
H      -4.569548549710     -0.734210067394     -0.538333998275
H      -6.091873455274     -2.455171537651     -1.532045144863
H      -3.827122732966      5.646777324383     -2.545172347974
H      -5.487465001159     -4.847590704817     -1.340124959117
H      -3.110664687740      1.441151599464     -2.132554506030
H      -4.177207718586      3.335699211627     -3.357664988641
H      -0.533106534210      7.530562387587      0.171326550585
H      -0.386642980402      6.531027896725     -1.282279802135
H      -0.319104273232      5.774736730359      0.313190690244
H      -2.602425438735      7.380216764573      1.621679341911
H      -2.386799403599      5.625265062417      1.750764437400
H      -3.925525096187      6.289547655682      1.184936270546
H      -2.702409017580      8.474987091890     -0.618256012862
H      -4.043996292192      7.438628580259     -1.099109495657
H      -2.591729745972      7.542857600026     -2.109330080278
H      -2.153711708070     -5.852660286389     -2.002537260549
H      -3.828401740121     -6.395958387401     -2.166378590186
H      -2.615661417715     -7.473832501386     -1.467300618971
H      -4.048412631598     -7.762309719580      0.618546425475
H      -5.276395200159     -6.701304384642     -0.070249461435
H      -4.596715402615     -6.345318682915      1.522105577352
H      -1.702182185698     -7.068972066775      0.822072923518
H      -2.131256108364     -5.610396059082      1.733994293693
H      -1.143978633170     -5.475764496068      0.285213002944
O      -1.580522280670      1.416937074780      3.711669528793
Ar     -2.977750814528     -0.306819314264      5.204045607682
```

<MoleculeViewer 
  xyzData={`115
0 1
C      -2.869914072386     -0.090863882316      1.406907952026
C      -2.591027614109      1.180045667432      1.167325686361
C      -1.578472685427      1.646152437083      0.160560855953
C      -0.283964384890      2.196603878280      0.770163614454
C       0.106520656943      2.101365508037      2.087992845021
C      -0.443199430722      1.502506980550      3.340877329160
C       0.798354243444      1.165763412163      4.250702940950
C       1.985809390797      1.435125123903      3.393989179461
C       3.257261727305      0.935170637512      3.199198522300
C       3.745799790664     -0.490494996273      3.099781387287
C       2.996253384405     -1.650583410825      3.009340986579
C       1.492248526117     -1.828660545980      3.175725455305
C       1.070400222074     -2.757902664235      2.046697056614
C      -0.043008727530     -2.619479511056      1.248185970719
C      -1.312568593778     -2.012836400753      1.757552544666
C      -2.179522865961     -1.237389351329      0.735706763202
N      -2.885949203731     -3.515339762289      0.284936571229
O      -1.666157440213     -2.143062242397      2.898539484683
N      -2.078645689344      3.988680564143     -0.219625995200
C      -1.304462746006     -0.793284480090     -0.404444452902
C      -0.161691166344      0.868833337279     -1.760060984080
O       0.746982082855      1.054991771618      5.439542368501
C      -0.522918980551     -1.828439334452     -1.034716606057
C       0.690761813830      2.624707277232     -0.229001392854
O       0.781354853216     -1.252694066372      3.953702735124
C       1.817906784247      2.146006654013     -2.367396749756
C      -2.624559934905      5.017322730415     -0.872602961883
C       3.044971438057      2.736500593018     -1.870025553550
C      -2.242846967297      2.755853885523     -0.667068477900
C       0.673579746722      2.045827468314     -1.577829614708
C       0.245710736436     -0.137933250027     -2.611116128328
C      -1.094427966265      0.512931013931     -0.720442207002
C       3.078292555862      3.235479177481     -0.601835550402
C       1.449659328046     -0.034010688388     -3.390945684622
C       2.296560524790      3.013953268747      1.553078721125
C       2.214309600780      1.092554008986     -3.280726724847
C       0.086751213603     -1.519085572471     -2.225594518522
C       0.090329259195     -2.835301352524     -0.174621278040
C       1.880706585172      3.192388330013      0.198151339223
C      -4.348018952270     -1.791144457513     -0.469146320364
C      -3.202103619644     -2.230707645899      0.172175097983
C       5.253539151072      2.197810053491     -0.198440764643
C       1.224131075236     -3.488000698771     -0.644992713496
C       1.224337585183     -2.251147220931     -2.730913029956
C      -5.185333230631     -2.750173538220     -1.018398621211
C       1.483261998573      2.368477343847      2.425597546873
C       3.662615616601      0.973662071616     -3.269227198572
C      -3.389538239695      4.814127807501     -2.014976627538
C       5.795235395672      1.150861237495      0.649129750196
C       4.249279376521     -0.270890679825     -3.305642359351
C       3.695859513955      2.761590887030      1.588007738529
C      -4.849461934052     -4.087287478008     -0.910324775656
C      -2.317204971924      6.385413148796     -0.280804165407
C      -3.000993435103      2.463065866635     -1.794125822439
C       4.145082509187      1.712558094127      2.360957934980
C      -3.676991096448     -4.442823105838     -0.242829430398
C       2.064275082473     -1.343118242664     -3.474214774008
C       6.177533246921      0.044793662839     -0.201627388040
C       5.408467553345     -1.490054658871      1.538537269291
C       4.216312394254      2.968684983957      0.257930658881
C       2.320265167433     -3.774865967990      0.230187140641
C       4.179029931038      1.992082061578     -2.385158997058
C       5.363728901245     -0.570548940328     -2.426012576957
C       5.225907126460      0.901307948387      1.877011753939
C      -3.582089371501      3.517674531433     -2.471442669684
C       2.261753624008     -3.313657003714      1.521807464944
C       4.987125991848     -0.445161608850      2.335832706186
C       5.845071984835      0.392990140694     -1.574692300092
C       5.251219667028      1.716315540525     -1.565580996054
C       3.426108709239     -2.708928636123      2.139920677212
C       3.431326364026     -1.463205856983     -3.411270678913
C       4.030024455343     -2.498345773328     -2.589075856976
C       1.782102762614     -3.231579892711     -1.956334002226
C       5.536737018044     -2.271433665669     -0.671048619826
C       3.224788967888     -3.363613009435     -1.883622401623
C      -0.792712423451      6.565253681616     -0.268610025586
C       3.559639356818     -3.702544512993     -0.519939698476
C       4.603586162955     -2.665902874212      1.438235202924
C       6.013158908738     -1.244160944806      0.240341335353
C       4.674251455607     -3.162919194520      0.073780656872
C       5.218325091275     -1.943759037621     -1.969493665026
C      -2.841353751561      6.419871735294      1.160045578769
C      -2.955205842275      7.519167828616     -1.079997570720
C      -3.239870547624     -5.896845896971     -0.118739882522
C      -2.945267412756     -6.434562764269     -1.526230891067
C      -4.361959123152     -6.720773344849      0.524512903006
C      -1.977599689934     -6.015674441184      0.733703616668
H      -3.623107056641     -0.351945525837      2.139326306114
H      -3.101848391623      1.960579008153      1.717060672064
H      -4.569548549710     -0.734210067394     -0.538333998275
H      -6.091873455274     -2.455171537651     -1.532045144863
H      -3.827122732966      5.646777324383     -2.545172347974
H      -5.487465001159     -4.847590704817     -1.340124959117
H      -3.110664687740      1.441151599464     -2.132554506030
H      -4.177207718586      3.335699211627     -3.357664988641
H      -0.533106534210      7.530562387587      0.171326550585
H      -0.386642980402      6.531027896725     -1.282279802135
H      -0.319104273232      5.774736730359      0.313190690244
H      -2.602425438735      7.380216764573      1.621679341911
H      -2.386799403599      5.625265062417      1.750764437400
H      -3.925525096187      6.289547655682      1.184936270546
H      -2.702409017580      8.474987091890     -0.618256012862
H      -4.043996292192      7.438628580259     -1.099109495657
H      -2.591729745972      7.542857600026     -2.109330080278
H      -2.153711708070     -5.852660286389     -2.002537260549
H      -3.828401740121     -6.395958387401     -2.166378590186
H      -2.615661417715     -7.473832501386     -1.467300618971
H      -4.048412631598     -7.762309719580      0.618546425475
H      -5.276395200159     -6.701304384642     -0.070249461435
H      -4.596715402615     -6.345318682915      1.522105577352
H      -1.702182185698     -7.068972066775      0.822072923518
H      -2.131256108364     -5.610396059082      1.733994293693
H      -1.143978633170     -5.475764496068      0.285213002944
O      -1.580522280670      1.416937074780      3.711669528793
Ar     -2.977750814528     -0.306819314264      5.204045607682`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`Ar_in_c60_ts_guess_2.xyz`
```
115
0 1
C      -2.835192894625     -0.109143636693      1.476282334610
C      -2.569823377194      1.167128493407      1.220997584502
C      -1.587546974896      1.652399021060      0.193470389255
C      -0.293036915026      2.243196579703      0.766991846526
C       0.093789384424      2.220939626131      2.079017058725
C      -0.491141846822      1.862441881984      3.384829771911
C       0.720173687193      1.297752360673      4.244570006097
C       1.932382037053      1.473641852372      3.393172157527
C       3.208082336531      0.945551596451      3.206708331290
C       3.704966533796     -0.483762148461      3.113010733839
C       2.972875974967     -1.653591453522      3.015494008813
C       1.495832907992     -1.893689158589      3.225647025563
C       1.056128507459     -2.780353199498      2.071944048734
C      -0.052351484588     -2.652039430752      1.265055913525
C      -1.383178284607     -2.191883494189      1.722072078039
C      -2.182752699064     -1.260552516787      0.770688287039
N      -2.904062556356     -3.510274725943      0.255167556327
O      -1.872623982752     -2.592294044621      2.765235548553
N      -2.101695139599      3.985662409084     -0.204195446460
C      -1.303141552006     -0.795468022578     -0.357554161922
C      -0.176326420983      0.868524189767     -1.733303811927
O       0.614399905026      0.983499774985      5.399690830651
C      -0.535230224815     -1.832081775928     -1.004094866692
C       0.690489614959      2.644826787027     -0.236111121870
O       0.825460709102     -1.437760456096      4.120264007355
C       1.805089893969      2.149923853657     -2.360797910943
C      -2.635848061733      5.014952139429     -0.864934918646
C       3.036268966714      2.739255031700     -1.864519428000
C      -2.269927182376      2.749971765318     -0.642961209167
C       0.661471102391      2.052660417543     -1.570581531604
C       0.222881670778     -0.140758286646     -2.585933444729
C      -1.097225204095      0.511315828208     -0.677923969746
C       3.080293836089      3.249921211640     -0.600900997453
C       1.425755374360     -0.040499746152     -3.367594135959
C       2.302616740170      3.048792667570      1.547220008904
C       2.194355541465      1.085611689052     -3.260990208459
C       0.065059639863     -1.524210957993     -2.198872450876
C       0.083366170430     -2.844426486270     -0.157721700918
C       1.880675382479      3.218998997298      0.190916507138
C      -4.371568464134     -1.785499313648     -0.469424957616
C      -3.226312526404     -2.224558330405      0.169701599672
C       5.247802395418      2.196889955840     -0.178867018398
C       1.210543563141     -3.503232235801     -0.626673086195
C       1.198847404237     -2.261627050505     -2.705517477325
C      -5.201109272090     -2.749167791851     -1.029120681866
C       1.481730026520      2.422804478599      2.415993040580
C       3.639704222328      0.960608428812     -3.236967167655
C      -3.393360038567      4.809999140849     -2.012327690787
C       5.778579705622      1.150225616298      0.679820722868
C       4.216462766181     -0.286742281776     -3.255796346547
C       3.692387421931      2.774067664719      1.593922500325
C      -4.866210133885     -4.087477546260     -0.926772695101
C      -2.323871029589      6.384121651449     -0.276965089830
C      -3.015554059208      2.456633669438     -1.778421136675
C       4.117508728157      1.719027678945      2.380831790037
C      -3.689664342557     -4.443644228790     -0.265783152024
C       2.036716450321     -1.352464812226     -3.444572782676
C       6.154881961361      0.038570381274     -0.163846457858
C       5.386554785787     -1.493387960467      1.573507797617
C       4.216756109809      2.979989542795      0.266428958218
C       2.306250828672     -3.793175776696      0.250743509103
C       4.164290471872      1.981985484007     -2.364838009081
C       5.325546063876     -0.584255799836     -2.375624448651
C       5.200441099794      0.903263610333      1.906470010588
C      -3.585710094030      3.512559867987     -2.465161980666
C       2.250506765738     -3.324912245551      1.539632011484
C       4.957110477246     -0.442345276312      2.363260596847
C       5.817224825439      0.381149602135     -1.534589498696
C       5.235592586872      1.706473257975     -1.539797939034
C       3.410503740139     -2.717149203698      2.159950176160
C       3.402958970721     -1.475726912041     -3.369396251832
C       4.004863349198     -2.511062965674     -2.552258089582
C       1.762236859897     -3.246552484225     -1.934715222029
C       5.517126268690     -2.283317033307     -0.630917995984
C       3.204376925509     -3.384292912837     -1.855807919584
C      -0.799052755270      6.562649253703     -0.266374703306
C       3.544789196888     -3.722690468838     -0.492639684230
C       4.591468839636     -2.677265876659      1.468980543934
C       5.992274856172     -1.251669302849      0.278448938419
C       4.659458290778     -3.179226679972      0.108053680400
C       5.187124935052     -1.954834154681     -1.925905690296
C      -2.846487053886      6.421384569170      1.164359607505
C      -2.960309192230      7.517794684701     -1.077708051727
C      -3.244446041878     -5.896598301139     -0.131805040307
C      -2.945125346019     -6.439649135028     -1.535728573470
C      -4.363390335620     -6.722366107214      0.515381310774
C      -1.982897616747     -6.010785936630      0.725234489276
H      -3.559011544307     -0.362367789203      2.243617337241
H      -3.085290590572      1.935159289204      1.781406978488
H      -4.596946327709     -0.728971846347     -0.536062153998
H      -6.106227408502     -2.454934299169     -1.545401614570
H      -3.822675828176      5.642547768214     -2.549702021108
H      -5.504724279429     -4.847367700935     -1.356210504883
H      -3.121848918791      1.435833159601     -2.121830039625
H      -4.170818543566      3.330857644832     -3.358169768546
H      -0.539076662643      7.528155639474      0.173274475316
H      -0.393216134671      6.528794162519     -1.280180704533
H      -0.324541416456      5.772786043449      0.315701596201
H      -2.606751025509      7.382522652255      1.623895864861
H      -2.392466539911      5.627510071027      1.756361774957
H      -3.930792055408      6.291863504718      1.189788084613
H      -2.707147570022      8.473672515009     -0.616171631637
H      -4.049137562863      7.438160027646     -1.097798220731
H      -2.595648961776      7.541280835791     -2.106669374490
H      -2.152630357174     -5.858223493359     -2.011116230728
H      -3.826453771398     -6.403227504185     -2.178397893586
H      -2.614417729272     -7.478273163596     -1.472729614747
H      -4.046431272535     -7.762965583533      0.610679199596
H      -5.278954000278     -6.707148193304     -0.077616750954
H      -4.596751946114     -6.347074059014      1.513396776458
H      -1.707236726624     -7.064434587832      0.815613810475
H      -2.136118433778     -5.603649359046      1.725294365508
H      -1.146830485386     -5.474247486331      0.276750871774
O      -1.594493227426      2.097059905155      3.826133748106
Ar     -1.272224386261     -0.432017200495      3.580290476212
```

<MoleculeViewer 
  xyzData={`115
0 1
C      -2.835192894625     -0.109143636693      1.476282334610
C      -2.569823377194      1.167128493407      1.220997584502
C      -1.587546974896      1.652399021060      0.193470389255
C      -0.293036915026      2.243196579703      0.766991846526
C       0.093789384424      2.220939626131      2.079017058725
C      -0.491141846822      1.862441881984      3.384829771911
C       0.720173687193      1.297752360673      4.244570006097
C       1.932382037053      1.473641852372      3.393172157527
C       3.208082336531      0.945551596451      3.206708331290
C       3.704966533796     -0.483762148461      3.113010733839
C       2.972875974967     -1.653591453522      3.015494008813
C       1.495832907992     -1.893689158589      3.225647025563
C       1.056128507459     -2.780353199498      2.071944048734
C      -0.052351484588     -2.652039430752      1.265055913525
C      -1.383178284607     -2.191883494189      1.722072078039
C      -2.182752699064     -1.260552516787      0.770688287039
N      -2.904062556356     -3.510274725943      0.255167556327
O      -1.872623982752     -2.592294044621      2.765235548553
N      -2.101695139599      3.985662409084     -0.204195446460
C      -1.303141552006     -0.795468022578     -0.357554161922
C      -0.176326420983      0.868524189767     -1.733303811927
O       0.614399905026      0.983499774985      5.399690830651
C      -0.535230224815     -1.832081775928     -1.004094866692
C       0.690489614959      2.644826787027     -0.236111121870
O       0.825460709102     -1.437760456096      4.120264007355
C       1.805089893969      2.149923853657     -2.360797910943
C      -2.635848061733      5.014952139429     -0.864934918646
C       3.036268966714      2.739255031700     -1.864519428000
C      -2.269927182376      2.749971765318     -0.642961209167
C       0.661471102391      2.052660417543     -1.570581531604
C       0.222881670778     -0.140758286646     -2.585933444729
C      -1.097225204095      0.511315828208     -0.677923969746
C       3.080293836089      3.249921211640     -0.600900997453
C       1.425755374360     -0.040499746152     -3.367594135959
C       2.302616740170      3.048792667570      1.547220008904
C       2.194355541465      1.085611689052     -3.260990208459
C       0.065059639863     -1.524210957993     -2.198872450876
C       0.083366170430     -2.844426486270     -0.157721700918
C       1.880675382479      3.218998997298      0.190916507138
C      -4.371568464134     -1.785499313648     -0.469424957616
C      -3.226312526404     -2.224558330405      0.169701599672
C       5.247802395418      2.196889955840     -0.178867018398
C       1.210543563141     -3.503232235801     -0.626673086195
C       1.198847404237     -2.261627050505     -2.705517477325
C      -5.201109272090     -2.749167791851     -1.029120681866
C       1.481730026520      2.422804478599      2.415993040580
C       3.639704222328      0.960608428812     -3.236967167655
C      -3.393360038567      4.809999140849     -2.012327690787
C       5.778579705622      1.150225616298      0.679820722868
C       4.216462766181     -0.286742281776     -3.255796346547
C       3.692387421931      2.774067664719      1.593922500325
C      -4.866210133885     -4.087477546260     -0.926772695101
C      -2.323871029589      6.384121651449     -0.276965089830
C      -3.015554059208      2.456633669438     -1.778421136675
C       4.117508728157      1.719027678945      2.380831790037
C      -3.689664342557     -4.443644228790     -0.265783152024
C       2.036716450321     -1.352464812226     -3.444572782676
C       6.154881961361      0.038570381274     -0.163846457858
C       5.386554785787     -1.493387960467      1.573507797617
C       4.216756109809      2.979989542795      0.266428958218
C       2.306250828672     -3.793175776696      0.250743509103
C       4.164290471872      1.981985484007     -2.364838009081
C       5.325546063876     -0.584255799836     -2.375624448651
C       5.200441099794      0.903263610333      1.906470010588
C      -3.585710094030      3.512559867987     -2.465161980666
C       2.250506765738     -3.324912245551      1.539632011484
C       4.957110477246     -0.442345276312      2.363260596847
C       5.817224825439      0.381149602135     -1.534589498696
C       5.235592586872      1.706473257975     -1.539797939034
C       3.410503740139     -2.717149203698      2.159950176160
C       3.402958970721     -1.475726912041     -3.369396251832
C       4.004863349198     -2.511062965674     -2.552258089582
C       1.762236859897     -3.246552484225     -1.934715222029
C       5.517126268690     -2.283317033307     -0.630917995984
C       3.204376925509     -3.384292912837     -1.855807919584
C      -0.799052755270      6.562649253703     -0.266374703306
C       3.544789196888     -3.722690468838     -0.492639684230
C       4.591468839636     -2.677265876659      1.468980543934
C       5.992274856172     -1.251669302849      0.278448938419
C       4.659458290778     -3.179226679972      0.108053680400
C       5.187124935052     -1.954834154681     -1.925905690296
C      -2.846487053886      6.421384569170      1.164359607505
C      -2.960309192230      7.517794684701     -1.077708051727
C      -3.244446041878     -5.896598301139     -0.131805040307
C      -2.945125346019     -6.439649135028     -1.535728573470
C      -4.363390335620     -6.722366107214      0.515381310774
C      -1.982897616747     -6.010785936630      0.725234489276
H      -3.559011544307     -0.362367789203      2.243617337241
H      -3.085290590572      1.935159289204      1.781406978488
H      -4.596946327709     -0.728971846347     -0.536062153998
H      -6.106227408502     -2.454934299169     -1.545401614570
H      -3.822675828176      5.642547768214     -2.549702021108
H      -5.504724279429     -4.847367700935     -1.356210504883
H      -3.121848918791      1.435833159601     -2.121830039625
H      -4.170818543566      3.330857644832     -3.358169768546
H      -0.539076662643      7.528155639474      0.173274475316
H      -0.393216134671      6.528794162519     -1.280180704533
H      -0.324541416456      5.772786043449      0.315701596201
H      -2.606751025509      7.382522652255      1.623895864861
H      -2.392466539911      5.627510071027      1.756361774957
H      -3.930792055408      6.291863504718      1.189788084613
H      -2.707147570022      8.473672515009     -0.616171631637
H      -4.049137562863      7.438160027646     -1.097798220731
H      -2.595648961776      7.541280835791     -2.106669374490
H      -2.152630357174     -5.858223493359     -2.011116230728
H      -3.826453771398     -6.403227504185     -2.178397893586
H      -2.614417729272     -7.478273163596     -1.472729614747
H      -4.046431272535     -7.762965583533      0.610679199596
H      -5.278954000278     -6.707148193304     -0.077616750954
H      -4.596751946114     -6.347074059014      1.513396776458
H      -1.707236726624     -7.064434587832      0.815613810475
H      -2.136118433778     -5.603649359046      1.725294365508
H      -1.146830485386     -5.474247486331      0.276750871774
O      -1.594493227426      2.097059905155      3.826133748106
Ar     -1.272224386261     -0.432017200495      3.580290476212`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`Ar_in_c60_ts_guess_3.xyz`
```
115
0 1
C      -2.922291362064     -0.138306330541      1.309676247745
C      -2.638853181167      1.138631056340      1.121226474811
C      -1.605958299362      1.639877712009      0.154010469193
C      -0.344096025430      2.208399767204      0.824315209100
C      -0.012829273502      2.107921968655      2.152066484408
C      -0.604724092519      1.382106451090      3.331178578647
C       0.624761034563      0.701087679313      4.048017567693
C       1.832521851150      1.339105792993      3.454142389362
C       3.126689994978      0.880329966560      3.291296378857
C       3.615525113036     -0.526054599072      3.140341238163
C       2.833575100411     -1.639207316100      2.910782508160
C       1.397325167374     -1.563203140438      2.472500469010
C       0.952141268496     -2.854622546075      1.859568228998
C      -0.156708046138     -2.763660284945      1.041537201436
C      -1.318539419638     -2.010229898343      1.608316718244
C      -2.220212625665     -1.260952855417      0.607358443903
N      -2.994941274940     -3.545056768698      0.355429810687
O      -1.507097398288     -1.950838073077      2.793578532609
N      -2.123333640125      3.984162372503     -0.188789601469
C      -1.327788001570     -0.790707571827     -0.513084841571
C      -0.119258978169      0.935221451462     -1.734343250899
O       0.535952050211     -0.128114803025      4.905954734778
C      -0.536164351829     -1.810774468167     -1.170849551122
C       0.666078511121      2.662325930190     -0.125227767587
O       0.860693747403     -0.538658293659      2.099854966271
C       1.870942147503      2.243289433454     -2.226648447429
C      -2.667792358275      5.021308770231     -0.828712919541
C       3.072066549766      2.823212341623     -1.671627318082
C      -2.261320471612      2.760605560062     -0.668369633074
C       0.696979462383      2.113892738298     -1.482265817402
C       0.323633501804     -0.036066663975     -2.609421959111
C      -1.087875734323      0.532391702141     -0.748995199960
C       3.062945130976      3.287494170667     -0.391543334313
C       1.549023921419      0.106063082081     -3.340523119965
C       2.208927464269      3.002085068780      1.727336417743
C       2.300450988151      1.229641257203     -3.162035347347
C       0.146982008724     -1.432648010216     -2.301919677436
C       0.036151734792     -2.891365980882     -0.359433299643
C       1.839385776955      3.219964338408      0.365888107859
C      -4.293373172279     -1.865596082553     -0.726719262281
C      -3.225685192152     -2.272895533095      0.057943831514
C       5.219863318390      2.237642382602      0.050571318994
C       1.235702131256     -3.486000516621     -0.786710937377
C       1.307610883291     -2.137669677169     -2.791860117364
C      -5.141405035245     -2.845542381959     -1.216604132030
C       1.352734318561      2.344726544194      2.561641958308
C       3.745948152611      1.118761528578     -3.110337418952
C      -3.405425737756      4.837627848001     -1.991478239394
C       5.745513713877      1.170281116011      0.880149771844
C       4.335283093367     -0.117826732178     -3.160440231695
C       3.610150252634      2.756914832564      1.798821014661
C      -4.890911985532     -4.173174762864     -0.917426471587
C      -2.383162485997      6.376406676294     -0.197566222709
C      -2.987753530576      2.485975565580     -1.820690809256
C       4.055276185875      1.694628781785      2.556994247920
C      -3.792637467358     -4.495302776222     -0.122172734630
C       2.168334255691     -1.193981554002     -3.460895834612
C       6.157181001756      0.088766565676      0.008474552817
C       5.325127519147     -1.503290907429      1.662772112834
C       4.172755013734      3.003172159364      0.494154209996
C       2.295286340182     -3.801503059327      0.127374642227
C       4.226585727529      2.106030994602     -2.174339877395
C       5.422902591860     -0.445768107990     -2.256510634762
C       5.161918478053      0.893641255473      2.091188018919
C      -3.568362218716      3.550234301756     -2.484175030418
C       2.177529637984     -3.399672219555      1.443565127149
C       4.905013712484     -0.476136649953      2.485003106607
C       5.869609167480      0.485288967184     -1.363374754931
C       5.265621845185      1.804506782167     -1.328865642785
C       3.304776051527     -2.747055830554      2.122337208049
C       3.530172264525     -1.305297455853     -3.339469729680
C       4.105970625630     -2.370442706062     -2.543429126314
C       1.848134323693     -3.149499496742     -2.046066424208
C       5.537327265548     -2.209946153096     -0.566772039703
C       3.289026883312     -3.276513001556     -1.917827870660
C      -0.860538834165      6.572074765002     -0.168514974870
C       3.569323678239     -3.666085938583     -0.553549947481
C       4.520603756689     -2.676785243963      1.487617127115
C       5.974631552092     -1.210511367760      0.398161867311
C       4.646894657986     -3.131226562468      0.109909427918
C       5.266667648746     -1.835820089046     -1.856271631374
C      -2.917586059129      6.365465070507      1.240133206476
C      -3.028016307314      7.523154880938     -0.971520997316
C      -3.448681085540     -5.939479873468      0.218161950631
C      -3.192368558389     -6.705010098602     -1.087113986151
C      -4.624667990516     -6.577743436255      0.967296878748
C      -2.195655831237     -6.011765378177      1.089280771510
H      -3.656316186470     -0.425120122440      2.052775959695
H      -3.151049517248      1.896144376103      1.700754051365
H      -4.447519931431     -0.815592737617     -0.939464342236
H      -5.989998979870     -2.576672729512     -1.833253267391
H      -3.841565558694      5.677870393683     -2.511181239690
H      -5.537883937810     -4.951371890450     -1.299038229648
H      -3.074763847553      1.471825522361     -2.188480613152
H      -4.139421941134      3.383084736048     -3.388920175855
H      -0.615126600554      7.530724237115      0.293464781704
H      -0.446011042771      6.563501275404     -1.179184968179
H      -0.382953614580      5.773968823530      0.399853699782
H      -2.691899526291      7.315121638848      1.729813959609
H      -2.458397082748      5.559096876718      1.810799345499
H      -4.000466470168      6.223270318128      1.253979021668
H      -2.794852366959      8.469343638576     -0.480708377292
H      -4.115146197301      7.426748834376     -1.006070632689
H      -2.653340530135      7.580747350843     -1.995481586883
H      -2.369544123708     -6.253289437099     -1.643772286502
H      -4.072515822729     -6.716583021030     -1.731683658254
H      -2.924811304816     -7.739796791752     -0.864732778691
H      -4.390347925247     -7.615532196245      1.212559792968
H      -5.536498262397     -6.572727774151      0.367989620256
H      -4.826082935489     -6.044830311580      1.898184475020
H      -1.982809826995     -7.056712356142      1.325367013676
H      -2.321690528345     -5.461025670922      2.021236961241
H      -1.332027118236     -5.589538801042      0.574948987219
O      -1.709462832591      1.382709290185      3.786182366747
Ar      2.966291464366     -0.261771903920     -0.307371243323
```

<MoleculeViewer 
  xyzData={`115
0 1
C      -2.922291362064     -0.138306330541      1.309676247745
C      -2.638853181167      1.138631056340      1.121226474811
C      -1.605958299362      1.639877712009      0.154010469193
C      -0.344096025430      2.208399767204      0.824315209100
C      -0.012829273502      2.107921968655      2.152066484408
C      -0.604724092519      1.382106451090      3.331178578647
C       0.624761034563      0.701087679313      4.048017567693
C       1.832521851150      1.339105792993      3.454142389362
C       3.126689994978      0.880329966560      3.291296378857
C       3.615525113036     -0.526054599072      3.140341238163
C       2.833575100411     -1.639207316100      2.910782508160
C       1.397325167374     -1.563203140438      2.472500469010
C       0.952141268496     -2.854622546075      1.859568228998
C      -0.156708046138     -2.763660284945      1.041537201436
C      -1.318539419638     -2.010229898343      1.608316718244
C      -2.220212625665     -1.260952855417      0.607358443903
N      -2.994941274940     -3.545056768698      0.355429810687
O      -1.507097398288     -1.950838073077      2.793578532609
N      -2.123333640125      3.984162372503     -0.188789601469
C      -1.327788001570     -0.790707571827     -0.513084841571
C      -0.119258978169      0.935221451462     -1.734343250899
O       0.535952050211     -0.128114803025      4.905954734778
C      -0.536164351829     -1.810774468167     -1.170849551122
C       0.666078511121      2.662325930190     -0.125227767587
O       0.860693747403     -0.538658293659      2.099854966271
C       1.870942147503      2.243289433454     -2.226648447429
C      -2.667792358275      5.021308770231     -0.828712919541
C       3.072066549766      2.823212341623     -1.671627318082
C      -2.261320471612      2.760605560062     -0.668369633074
C       0.696979462383      2.113892738298     -1.482265817402
C       0.323633501804     -0.036066663975     -2.609421959111
C      -1.087875734323      0.532391702141     -0.748995199960
C       3.062945130976      3.287494170667     -0.391543334313
C       1.549023921419      0.106063082081     -3.340523119965
C       2.208927464269      3.002085068780      1.727336417743
C       2.300450988151      1.229641257203     -3.162035347347
C       0.146982008724     -1.432648010216     -2.301919677436
C       0.036151734792     -2.891365980882     -0.359433299643
C       1.839385776955      3.219964338408      0.365888107859
C      -4.293373172279     -1.865596082553     -0.726719262281
C      -3.225685192152     -2.272895533095      0.057943831514
C       5.219863318390      2.237642382602      0.050571318994
C       1.235702131256     -3.486000516621     -0.786710937377
C       1.307610883291     -2.137669677169     -2.791860117364
C      -5.141405035245     -2.845542381959     -1.216604132030
C       1.352734318561      2.344726544194      2.561641958308
C       3.745948152611      1.118761528578     -3.110337418952
C      -3.405425737756      4.837627848001     -1.991478239394
C       5.745513713877      1.170281116011      0.880149771844
C       4.335283093367     -0.117826732178     -3.160440231695
C       3.610150252634      2.756914832564      1.798821014661
C      -4.890911985532     -4.173174762864     -0.917426471587
C      -2.383162485997      6.376406676294     -0.197566222709
C      -2.987753530576      2.485975565580     -1.820690809256
C       4.055276185875      1.694628781785      2.556994247920
C      -3.792637467358     -4.495302776222     -0.122172734630
C       2.168334255691     -1.193981554002     -3.460895834612
C       6.157181001756      0.088766565676      0.008474552817
C       5.325127519147     -1.503290907429      1.662772112834
C       4.172755013734      3.003172159364      0.494154209996
C       2.295286340182     -3.801503059327      0.127374642227
C       4.226585727529      2.106030994602     -2.174339877395
C       5.422902591860     -0.445768107990     -2.256510634762
C       5.161918478053      0.893641255473      2.091188018919
C      -3.568362218716      3.550234301756     -2.484175030418
C       2.177529637984     -3.399672219555      1.443565127149
C       4.905013712484     -0.476136649953      2.485003106607
C       5.869609167480      0.485288967184     -1.363374754931
C       5.265621845185      1.804506782167     -1.328865642785
C       3.304776051527     -2.747055830554      2.122337208049
C       3.530172264525     -1.305297455853     -3.339469729680
C       4.105970625630     -2.370442706062     -2.543429126314
C       1.848134323693     -3.149499496742     -2.046066424208
C       5.537327265548     -2.209946153096     -0.566772039703
C       3.289026883312     -3.276513001556     -1.917827870660
C      -0.860538834165      6.572074765002     -0.168514974870
C       3.569323678239     -3.666085938583     -0.553549947481
C       4.520603756689     -2.676785243963      1.487617127115
C       5.974631552092     -1.210511367760      0.398161867311
C       4.646894657986     -3.131226562468      0.109909427918
C       5.266667648746     -1.835820089046     -1.856271631374
C      -2.917586059129      6.365465070507      1.240133206476
C      -3.028016307314      7.523154880938     -0.971520997316
C      -3.448681085540     -5.939479873468      0.218161950631
C      -3.192368558389     -6.705010098602     -1.087113986151
C      -4.624667990516     -6.577743436255      0.967296878748
C      -2.195655831237     -6.011765378177      1.089280771510
H      -3.656316186470     -0.425120122440      2.052775959695
H      -3.151049517248      1.896144376103      1.700754051365
H      -4.447519931431     -0.815592737617     -0.939464342236
H      -5.989998979870     -2.576672729512     -1.833253267391
H      -3.841565558694      5.677870393683     -2.511181239690
H      -5.537883937810     -4.951371890450     -1.299038229648
H      -3.074763847553      1.471825522361     -2.188480613152
H      -4.139421941134      3.383084736048     -3.388920175855
H      -0.615126600554      7.530724237115      0.293464781704
H      -0.446011042771      6.563501275404     -1.179184968179
H      -0.382953614580      5.773968823530      0.399853699782
H      -2.691899526291      7.315121638848      1.729813959609
H      -2.458397082748      5.559096876718      1.810799345499
H      -4.000466470168      6.223270318128      1.253979021668
H      -2.794852366959      8.469343638576     -0.480708377292
H      -4.115146197301      7.426748834376     -1.006070632689
H      -2.653340530135      7.580747350843     -1.995481586883
H      -2.369544123708     -6.253289437099     -1.643772286502
H      -4.072515822729     -6.716583021030     -1.731683658254
H      -2.924811304816     -7.739796791752     -0.864732778691
H      -4.390347925247     -7.615532196245      1.212559792968
H      -5.536498262397     -6.572727774151      0.367989620256
H      -4.826082935489     -6.044830311580      1.898184475020
H      -1.982809826995     -7.056712356142      1.325367013676
H      -2.321690528345     -5.461025670922      2.021236961241
H      -1.332027118236     -5.589538801042      0.574948987219
O      -1.709462832591      1.382709290185      3.786182366747
Ar      2.966291464366     -0.261771903920     -0.307371243323`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-1.20.0/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`Ar_in_c60_ts_final_X.xyz`として保存されている。)

`Ar_in_c60_ts_final_2.xyz`
```
115
OptimizedStructure
C     -2.598561997675     -0.148325000234      1.851751479504
C     -2.386045851549      1.117570995263      1.526105480556
C     -1.515245499757      1.577026190277      0.397286137189
C     -0.238935303114      2.259205396478      0.893697108020
C      0.159211059504      2.311270242415      2.206839285697
C     -0.372529791058      1.895371983140      3.535309720931
C      0.877663416986      1.342039501024      4.323502475732
C      2.052687275470      1.606559082979      3.464750120170
C      3.323725162262      1.083842299121      3.269840890119
C      3.832037612988     -0.345240962405      3.231419712453
C      3.132640678784     -1.542174047371      3.231272972277
C      1.690212367471     -1.928363282064      3.578184880181
C      1.217125002307     -2.758621206312      2.378847959440
C      0.088031349496     -2.692862130363      1.589284687684
C     -1.291300726177     -2.305383478150      2.003411415792
C     -2.056098802681     -1.314389130162      1.086253644017
N     -2.911701168947     -3.379681655909      0.148454890633
O     -1.833617786292     -2.796623634757      2.973090301672
N     -2.122077727583      3.840775241583     -0.265178859750
C     -1.187335260603     -0.885165101788     -0.064727567194
C     -0.129018077103      0.745618833547     -1.533287034995
O      0.817513952276      0.918989764063      5.450035420882
C     -0.422940568344     -1.931467843868     -0.698654242888
C      0.716939974451      2.621844144608     -0.153389585050
O      1.126723525673     -1.717076333555      4.623160451538
C      1.803715607898      2.033372957989     -2.279947312904
C     -2.791471746180      4.746580290497     -0.985472026332
C      3.031667017425      2.667280030989     -1.846356225012
C     -2.323501383074      2.552049976983     -0.471578767081
C      0.682295978935      1.953368247394     -1.452893286774
C      0.271223700001     -0.287160629084     -2.357063486618
C     -1.007974939440      0.411765991838     -0.435053878114
C      3.087184039872      3.236202872691     -0.607167485707
C      1.447816744071     -0.196622950771     -3.183229444256
C      2.353443050122      3.133378926784      1.572040264321
C      2.196315915349      0.944762314107     -3.150956480820
C      0.146425716177     -1.653887450503     -1.918179388987
C      0.223257207323     -2.910580131968      0.163187313335
C      1.905727887787      3.235606073151      0.215272494115
C     -4.465632377341     -1.578052110268      0.252033376671
C     -3.217517945011     -2.129819354211      0.484377786871
C      5.277756135423      2.232096375179     -0.199196734185
C      1.354161194079     -3.553571319866     -0.316842383898
C      1.280532762736     -2.386347212701     -2.435670889101
C     -5.424647856464     -2.381122086156     -0.351864154706
C      1.557404243097      2.540929505024      2.492062100006
C      3.646594720381      0.851076587417     -3.176683429033
C     -3.716245111227      4.355085149499     -1.945130833627
C      5.839106423615      1.229122099438      0.684549533570
C      4.257198872703     -0.384170645417     -3.176802751364
C      3.746016870264      2.859142194971      1.586652132181
C     -5.103906599047     -3.676910854971     -0.703132372544
C     -2.437988575814      6.195163207346     -0.680679048805
C     -3.235346992061      2.073911721221     -1.406934925151
C      4.202673480029      1.837664328127      2.397870062864
C     -3.816535121222     -4.152153649060     -0.440560831303
C      2.084158103112     -1.495320974767     -3.233788896470
C      6.232105868903      0.098012440552     -0.125673329614
C      5.515467039130     -1.372467694209      1.691074665550
C      4.242588992778      3.014898669873      0.242370316091
C      2.471990191233     -3.779011723014      0.544179191625
C      4.164488739406      1.915523576492     -2.351748835259
C      5.397072081862     -0.626675158660     -2.310953017822
C      5.281744104167      1.020240105896      1.928293962701
C     -3.940305908088      2.999907073860     -2.149672716378
C      2.422154192321     -3.265658462555      1.816217667087
C      5.065559907737     -0.306661641400      2.443915990243
C      5.874768986448      0.381018757915     -1.506954232401
C      5.259787034952      1.692868496470     -1.543204116050
C      3.580855743140     -2.611343299291      2.383217254995
C      3.456850019602     -1.591594551044     -3.208955291679
C      4.094888934816     -2.580663246989     -2.360944831869
C      1.876933650384     -3.330617782797     -1.645941086812
C      5.633593228506     -2.245732719415     -0.484555443433
C      3.321786829268     -3.431723893400     -1.602562515666
C     -0.935570888548      6.380760211716     -0.934038000082
C      3.690720388194     -3.708960761923     -0.235138703561
C      4.742111547392     -2.568292785163      1.653447648128
C      6.100476898462     -1.172682500419      0.374702483941
C      4.804014742011     -3.120568227735      0.313237133173
C      5.285746355893     -1.979731112148     -1.792013959041
C     -2.738785732529      6.468582687331      0.798191625655
C     -3.222592652370      7.177632406826     -1.547016895929
C     -3.409983880252     -5.573716218830     -0.812316106513
C     -3.679255157152     -5.806449569854     -2.304952444497
C     -4.242227141245     -6.558616493705      0.020001870545
C     -1.925770033202     -5.807401555260     -0.538319879045
H     -3.205943109059     -0.389776894969      2.716558494420
H     -2.828255992704      1.897856125139      2.128840293921
H     -4.683501909864     -0.555357966426      0.526393113555
H     -6.416255008030     -1.991633483120     -0.547376096120
H     -4.252415234787      5.087621465432     -2.529797364005
H     -5.839462184452     -4.314791585855     -1.173828987020
H     -3.368184493916      1.008792055167     -1.549511909851
H     -4.656975713349      2.673256936912     -2.892868601379
H     -0.641472304564      7.407314612925     -0.704988221806
H     -0.687914123164      6.179213136360     -1.978789784645
H     -0.355051421621      5.701206767994     -0.310307370485
H     -2.459379295704      7.493245734029      1.052350529657
H     -2.178388124793      5.785086099210      1.435170024865
H     -3.802717148694      6.342518188084      1.010842191189
H     -2.930244693575      8.197794171749     -1.293100747838
H     -4.298902429878      7.091643890509     -1.384265126001
H     -3.020367687353      7.030633965958     -2.609889124884
H     -3.114903893557     -5.098825842874     -2.915501249724
H     -4.736420282901     -5.702838655303     -2.553113193942
H     -3.370205395257     -6.816081615764     -2.582475515478
H     -3.967893351052     -7.584844212840     -0.233112606619
H     -5.311080440676     -6.439885345182     -0.166686969319
H     -4.064946179178     -6.410845514598      1.086688212204
H     -1.667377387663     -6.833260242815     -0.810662402584
H     -1.681709692282     -5.652114493795      0.512299341782
H     -1.305369228328     -5.127252796147     -1.123080189225
O     -1.461852913342      2.027307808147      4.039401453054
Ar    -0.937034283777     -0.594436685509      3.956801626448

```

<MoleculeViewer 
  xyzData={`115
OptimizedStructure
C     -2.598561997675     -0.148325000234      1.851751479504
C     -2.386045851549      1.117570995263      1.526105480556
C     -1.515245499757      1.577026190277      0.397286137189
C     -0.238935303114      2.259205396478      0.893697108020
C      0.159211059504      2.311270242415      2.206839285697
C     -0.372529791058      1.895371983140      3.535309720931
C      0.877663416986      1.342039501024      4.323502475732
C      2.052687275470      1.606559082979      3.464750120170
C      3.323725162262      1.083842299121      3.269840890119
C      3.832037612988     -0.345240962405      3.231419712453
C      3.132640678784     -1.542174047371      3.231272972277
C      1.690212367471     -1.928363282064      3.578184880181
C      1.217125002307     -2.758621206312      2.378847959440
C      0.088031349496     -2.692862130363      1.589284687684
C     -1.291300726177     -2.305383478150      2.003411415792
C     -2.056098802681     -1.314389130162      1.086253644017
N     -2.911701168947     -3.379681655909      0.148454890633
O     -1.833617786292     -2.796623634757      2.973090301672
N     -2.122077727583      3.840775241583     -0.265178859750
C     -1.187335260603     -0.885165101788     -0.064727567194
C     -0.129018077103      0.745618833547     -1.533287034995
O      0.817513952276      0.918989764063      5.450035420882
C     -0.422940568344     -1.931467843868     -0.698654242888
C      0.716939974451      2.621844144608     -0.153389585050
O      1.126723525673     -1.717076333555      4.623160451538
C      1.803715607898      2.033372957989     -2.279947312904
C     -2.791471746180      4.746580290497     -0.985472026332
C      3.031667017425      2.667280030989     -1.846356225012
C     -2.323501383074      2.552049976983     -0.471578767081
C      0.682295978935      1.953368247394     -1.452893286774
C      0.271223700001     -0.287160629084     -2.357063486618
C     -1.007974939440      0.411765991838     -0.435053878114
C      3.087184039872      3.236202872691     -0.607167485707
C      1.447816744071     -0.196622950771     -3.183229444256
C      2.353443050122      3.133378926784      1.572040264321
C      2.196315915349      0.944762314107     -3.150956480820
C      0.146425716177     -1.653887450503     -1.918179388987
C      0.223257207323     -2.910580131968      0.163187313335
C      1.905727887787      3.235606073151      0.215272494115
C     -4.465632377341     -1.578052110268      0.252033376671
C     -3.217517945011     -2.129819354211      0.484377786871
C      5.277756135423      2.232096375179     -0.199196734185
C      1.354161194079     -3.553571319866     -0.316842383898
C      1.280532762736     -2.386347212701     -2.435670889101
C     -5.424647856464     -2.381122086156     -0.351864154706
C      1.557404243097      2.540929505024      2.492062100006
C      3.646594720381      0.851076587417     -3.176683429033
C     -3.716245111227      4.355085149499     -1.945130833627
C      5.839106423615      1.229122099438      0.684549533570
C      4.257198872703     -0.384170645417     -3.176802751364
C      3.746016870264      2.859142194971      1.586652132181
C     -5.103906599047     -3.676910854971     -0.703132372544
C     -2.437988575814      6.195163207346     -0.680679048805
C     -3.235346992061      2.073911721221     -1.406934925151
C      4.202673480029      1.837664328127      2.397870062864
C     -3.816535121222     -4.152153649060     -0.440560831303
C      2.084158103112     -1.495320974767     -3.233788896470
C      6.232105868903      0.098012440552     -0.125673329614
C      5.515467039130     -1.372467694209      1.691074665550
C      4.242588992778      3.014898669873      0.242370316091
C      2.471990191233     -3.779011723014      0.544179191625
C      4.164488739406      1.915523576492     -2.351748835259
C      5.397072081862     -0.626675158660     -2.310953017822
C      5.281744104167      1.020240105896      1.928293962701
C     -3.940305908088      2.999907073860     -2.149672716378
C      2.422154192321     -3.265658462555      1.816217667087
C      5.065559907737     -0.306661641400      2.443915990243
C      5.874768986448      0.381018757915     -1.506954232401
C      5.259787034952      1.692868496470     -1.543204116050
C      3.580855743140     -2.611343299291      2.383217254995
C      3.456850019602     -1.591594551044     -3.208955291679
C      4.094888934816     -2.580663246989     -2.360944831869
C      1.876933650384     -3.330617782797     -1.645941086812
C      5.633593228506     -2.245732719415     -0.484555443433
C      3.321786829268     -3.431723893400     -1.602562515666
C     -0.935570888548      6.380760211716     -0.934038000082
C      3.690720388194     -3.708960761923     -0.235138703561
C      4.742111547392     -2.568292785163      1.653447648128
C      6.100476898462     -1.172682500419      0.374702483941
C      4.804014742011     -3.120568227735      0.313237133173
C      5.285746355893     -1.979731112148     -1.792013959041
C     -2.738785732529      6.468582687331      0.798191625655
C     -3.222592652370      7.177632406826     -1.547016895929
C     -3.409983880252     -5.573716218830     -0.812316106513
C     -3.679255157152     -5.806449569854     -2.304952444497
C     -4.242227141245     -6.558616493705      0.020001870545
C     -1.925770033202     -5.807401555260     -0.538319879045
H     -3.205943109059     -0.389776894969      2.716558494420
H     -2.828255992704      1.897856125139      2.128840293921
H     -4.683501909864     -0.555357966426      0.526393113555
H     -6.416255008030     -1.991633483120     -0.547376096120
H     -4.252415234787      5.087621465432     -2.529797364005
H     -5.839462184452     -4.314791585855     -1.173828987020
H     -3.368184493916      1.008792055167     -1.549511909851
H     -4.656975713349      2.673256936912     -2.892868601379
H     -0.641472304564      7.407314612925     -0.704988221806
H     -0.687914123164      6.179213136360     -1.978789784645
H     -0.355051421621      5.701206767994     -0.310307370485
H     -2.459379295704      7.493245734029      1.052350529657
H     -2.178388124793      5.785086099210      1.435170024865
H     -3.802717148694      6.342518188084      1.010842191189
H     -2.930244693575      8.197794171749     -1.293100747838
H     -4.298902429878      7.091643890509     -1.384265126001
H     -3.020367687353      7.030633965958     -2.609889124884
H     -3.114903893557     -5.098825842874     -2.915501249724
H     -4.736420282901     -5.702838655303     -2.553113193942
H     -3.370205395257     -6.816081615764     -2.582475515478
H     -3.967893351052     -7.584844212840     -0.233112606619
H     -5.311080440676     -6.439885345182     -0.166686969319
H     -4.064946179178     -6.410845514598      1.086688212204
H     -1.667377387663     -6.833260242815     -0.810662402584
H     -1.681709692282     -5.652114493795      0.512299341782
H     -1.305369228328     -5.127252796147     -1.123080189225
O     -1.461852913342      2.027307808147      4.039401453054
Ar    -0.937034283777     -0.594436685509      3.956801626448
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`"frequency_analysis": true`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`"frequency_analysis": true`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -152.3969             11.1225             16.6837
Reduced mass [au]                  30.6343              4.1918              3.8063
Force const [Dyne/A]               -0.4192              0.0003              0.0006
Char temp [K]                       0.0000             16.0028             24.0041
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00438    0.00085   -0.00744   -0.00046   -0.00729    0.01329   -0.00337   -0.00528   -0.00482
       C                 0.00582    0.00088   -0.00484   -0.00315   -0.00624    0.01566   -0.00400   -0.00386   -0.00017
       C                 0.00267    0.00112   -0.00669   -0.00590   -0.00214    0.01535   -0.00244    0.00092    0.00284
       C                 0.00300   -0.00035   -0.00866   -0.00591   -0.00193    0.01477   -0.00305   -0.00032    0.00600
       C                 0.00390   -0.00887   -0.01003   -0.00382   -0.00504    0.01426   -0.00368   -0.00450    0.00622
       C                 0.00315    0.00145   -0.00750   -0.00118   -0.00927    0.01405   -0.00437   -0.00926    0.00422
       C                 0.00353   -0.00562   -0.00733    0.00075   -0.00981    0.01066   -0.00463   -0.01218    0.00277
       C                 0.00115   -0.01005   -0.01241   -0.00092   -0.00622    0.00951   -0.00415   -0.00890    0.00424
       C                 0.00517   -0.00066   -0.00526   -0.00044   -0.00406    0.00632   -0.00393   -0.00791    0.00255
       C                 0.00708    0.00140   -0.00356    0.00133   -0.00331    0.00192   -0.00329   -0.00759   -0.00291
       C                 0.00684    0.00291   -0.00578    0.00287   -0.00420    0.00008   -0.00264   -0.00801   -0.00790
       C                 0.00962    0.00392   -0.00588    0.00398   -0.00692    0.00154   -0.00293   -0.00950   -0.01084
       C                 0.00719    0.00394   -0.00547    0.00292   -0.00419    0.00004   -0.00072   -0.00705   -0.01307
       C                 0.00878    0.01030   -0.00498    0.00161   -0.00334    0.00195   -0.00055   -0.00471   -0.01284
       C                 0.00414    0.00045   -0.00824    0.00147   -0.00685    0.00480    0.00166   -0.00298   -0.00870
       C                 0.00110    0.00003   -0.00752   -0.00123   -0.00488    0.00907    0.00042   -0.00231   -0.00673
       N                -0.00022    0.00123   -0.00956    0.00143    0.00074   -0.00534   -0.00296   -0.01402    0.02109
       O                -0.00387   -0.03556   -0.03711    0.00300   -0.01163    0.00321    0.00484   -0.00030   -0.00537
       N                -0.00069    0.00014   -0.00101    0.01583   -0.00343   -0.01719    0.00852    0.00292   -0.00263
       C                 0.00166    0.00086   -0.00726   -0.00376   -0.00104    0.00855   -0.00023    0.00245   -0.00558
       C                 0.00181    0.00064   -0.00567   -0.00781    0.00412    0.01112   -0.00123    0.00859    0.00049
       O                 0.02260    0.02613    0.00238    0.00290   -0.01277    0.00968   -0.00514   -0.01639    0.00118
       C                 0.00255    0.00085   -0.00546   -0.00330    0.00165    0.00467   -0.00031    0.00497   -0.00991
       C                 0.00224    0.00150   -0.00677   -0.00751    0.00135    0.01434   -0.00260    0.00382    0.00774
       O                 0.02117   -0.00792   -0.00213    0.00558   -0.01059    0.00316   -0.00554   -0.01101   -0.01193
       C                 0.00258    0.00041   -0.00499   -0.01041    0.00836    0.01111   -0.00171    0.01260    0.00591
       C                -0.00085    0.00050   -0.00027    0.01692   -0.00858   -0.02510    0.01310    0.00434   -0.00515
       C                 0.00247    0.00042   -0.00411   -0.01047    0.00880    0.01072   -0.00221    0.01172    0.00867
       C                -0.00008    0.00014   -0.00290   -0.00869   -0.00449    0.01514   -0.00060    0.00341    0.00366
       C                 0.00237    0.00049   -0.00589   -0.00895    0.00480    0.01275   -0.00188    0.00877    0.00527
       C                 0.00249    0.00008   -0.00468   -0.00787    0.00673    0.00784   -0.00044    0.01200   -0.00334
       C                 0.00115    0.00096   -0.00664   -0.00557    0.00014    0.01176   -0.00127    0.00393   -0.00095
       C                 0.00263    0.00041   -0.00402   -0.00917    0.00556    0.01216   -0.00295    0.00697    0.01088
       C                 0.00307   -0.00022   -0.00383   -0.00924    0.01027    0.00620   -0.00032    0.01589   -0.00277
       C                 0.00236   -0.00182   -0.00500   -0.00564   -0.00102    0.01308   -0.00371   -0.00148    0.01027
       C                 0.00283   -0.00004   -0.00422   -0.01051    0.01105    0.00774   -0.00092    0.01615    0.00184
       C                 0.00222   -0.00031   -0.00533   -0.00554    0.00546    0.00450    0.00009    0.01023   -0.00863
       C                 0.00521    0.00369   -0.00344   -0.00041    0.00047    0.00122   -0.00051    0.00126   -0.01374
       C                 0.00249    0.00032   -0.00469   -0.00786    0.00193    0.01402   -0.00324    0.00327    0.01043
       C                -0.00002    0.00061   -0.00439   -0.00811   -0.00962    0.02872    0.01386    0.00458   -0.04444
       C                 0.00020    0.00056   -0.00696   -0.00242   -0.00443    0.01050    0.00365   -0.00407   -0.01005
       C                 0.00271    0.00094   -0.00338   -0.00735    0.00722    0.00614   -0.00268    0.00646    0.00792
       C                 0.00381    0.00156   -0.00207   -0.00048    0.00299   -0.00224    0.00027    0.00405   -0.01594
       C                 0.00283   -0.00039   -0.00345   -0.00537    0.00818    0.00086    0.00049    0.01284   -0.01128
       C                -0.00120   -0.00002   -0.00193   -0.00948   -0.00928    0.03031    0.01750    0.00366   -0.04883
       C                 0.00244   -0.00860   -0.00879   -0.00353   -0.00427    0.01278   -0.00385   -0.00512    0.00776
       C                 0.00274    0.00009   -0.00340   -0.01042    0.01288    0.00517   -0.00085    0.01704    0.00201
       C                -0.00105    0.00130   -0.00036   -0.00807   -0.01495    0.00186    0.00746    0.00641   -0.00050
       C                 0.00342    0.00128   -0.00332   -0.00472    0.00564    0.00270   -0.00266    0.00329    0.00431
       C                 0.00253    0.00001   -0.00284   -0.00895    0.01362    0.00108   -0.00026    0.01736   -0.00252
       C                 0.00272    0.00069   -0.00361   -0.00531    0.00072    0.01019   -0.00368   -0.00108    0.00973
       C                -0.00257   -0.00038   -0.00092   -0.00521   -0.00356    0.01333    0.01025   -0.00717   -0.01574
       C                -0.00037    0.00034    0.00017    0.04848   -0.00771   -0.06605    0.02601    0.00313   -0.01438
       C                -0.00047    0.00080   -0.00259   -0.03452   -0.01063    0.04313   -0.00634    0.00553    0.00808
       C                 0.00516    0.00228   -0.00262   -0.00275   -0.00076    0.00691   -0.00376   -0.00412    0.00594
       C                -0.00157    0.00041   -0.00458    0.00046    0.00161   -0.00485   -0.00105   -0.01692    0.02171
       C                 0.00299   -0.00012   -0.00325   -0.00775    0.01117    0.00184    0.00034    0.01640   -0.00753
       C                 0.00307    0.00073   -0.00303   -0.00466    0.00821   -0.00083   -0.00174    0.00663    0.00010
       C                 0.00468    0.00079   -0.00255    0.00009    0.00269   -0.00344   -0.00186   -0.00075   -0.00595
       C                 0.00255    0.00076   -0.00365   -0.00761    0.00481    0.00980   -0.00319    0.00429    0.01051
       C                 0.00385   -0.00047   -0.00232    0.00115    0.00205   -0.00465    0.00029    0.00133   -0.01647
       C                 0.00250    0.00029   -0.00340   -0.01039    0.01141    0.00706   -0.00166    0.01418    0.00623
       C                 0.00242    0.00034   -0.00281   -0.00727    0.01278   -0.00136   -0.00044    0.01462   -0.00302
       C                 0.00526    0.00194   -0.00279   -0.00246    0.00179    0.00307   -0.00320   -0.00183    0.00323
       C                -0.00120    0.00155   -0.00121   -0.03422   -0.01605    0.03649   -0.00242    0.00698    0.00625
       C                 0.00494    0.00032   -0.00264    0.00260   -0.00133   -0.00322   -0.00026   -0.00394   -0.01439
       C                 0.00632    0.00141   -0.00276    0.00001    0.00022    0.00002   -0.00286   -0.00392   -0.00206
       C                 0.00239    0.00039   -0.00286   -0.00720    0.01130    0.00046   -0.00126    0.01177    0.00103
       C                 0.00245    0.00040   -0.00323   -0.00882    0.01066    0.00478   -0.00187    0.01162    0.00581
       C                 0.00581    0.00008   -0.00235    0.00278   -0.00147   -0.00341   -0.00129   -0.00472   -0.01148
       C                 0.00273   -0.00015   -0.00288   -0.00759    0.01276   -0.00066    0.00038    0.01706   -0.00749
       C                 0.00289   -0.00007   -0.00270   -0.00502    0.01137   -0.00423    0.00059    0.01412   -0.01110
       C                 0.00311    0.00021   -0.00266   -0.00294    0.00687   -0.00256    0.00070    0.01003   -0.01479
       C                 0.00274    0.00056   -0.00277   -0.00237    0.00839   -0.00587   -0.00034    0.00769   -0.00921
       C                 0.00302    0.00023   -0.00244   -0.00277    0.00850   -0.00515    0.00081    0.01068   -0.01477
       C                -0.00043    0.00020   -0.00022    0.04636   -0.04007   -0.10272    0.02635   -0.01053   -0.02276
       C                 0.00366    0.00002   -0.00240   -0.00021    0.00545   -0.00646    0.00050    0.00543   -0.01574
       C                 0.00481    0.00034   -0.00229    0.00150    0.00184   -0.00524   -0.00103   -0.00112   -0.01083
       C                 0.00309    0.00080   -0.00311   -0.00229    0.00676   -0.00388   -0.00133    0.00464   -0.00487
       C                 0.00379   -0.00015   -0.00262   -0.00002    0.00536   -0.00676   -0.00013    0.00406   -0.01296
       C                 0.00279    0.00027   -0.00273   -0.00483    0.01133   -0.00462    0.00006    0.01256   -0.00831
       C                 0.00014   -0.00007    0.00033    0.08545    0.03179   -0.06587    0.03566    0.01353   -0.01438
       C                -0.00024    0.00073    0.00056    0.04706   -0.01412   -0.07201    0.02983    0.00481   -0.01591
       C                -0.00122    0.00011   -0.00234    0.00561    0.00811   -0.02415   -0.01153   -0.03017    0.06128
       C                -0.00104   -0.00130   -0.00200   -0.01545    0.01906   -0.02205    0.05919   -0.03999    0.04994
       C                -0.00100    0.00098   -0.00121    0.02582   -0.00553   -0.02006   -0.07391   -0.00420    0.02954
       C                -0.00131    0.00051   -0.00161    0.01164    0.01711   -0.04914   -0.03060   -0.05828    0.14019
       H                -0.02321    0.00483   -0.02721    0.00179   -0.01001    0.01410   -0.00496   -0.00885   -0.00694
       H                -0.00173    0.00157   -0.01097   -0.00312   -0.00862    0.01878   -0.00624   -0.00655    0.00172
       H                -0.00045    0.00029   -0.00432   -0.01189   -0.01392    0.04164    0.01947    0.01185   -0.06664
       H                -0.00160   -0.00021   -0.00010   -0.01393   -0.01334    0.04476    0.02590    0.01082   -0.07714
       H                -0.00111    0.00179    0.00032   -0.00736   -0.01930   -0.00425    0.01096    0.00744   -0.00242
       H                -0.00413   -0.00117    0.00252   -0.00617   -0.00307    0.01421    0.01298   -0.00866   -0.01814
       H                -0.00014    0.00107   -0.00475   -0.05373   -0.01182    0.06935   -0.01294    0.00578    0.01225
       H                -0.00154    0.00199   -0.00106   -0.05400   -0.02094    0.05771   -0.00665    0.00857    0.00962
       H                -0.00021    0.00001    0.00028    0.06906   -0.03944   -0.13460    0.03566   -0.01142   -0.03069
       H                -0.00077    0.00085   -0.00044    0.02063   -0.07049   -0.10296    0.01976   -0.01918   -0.02266
       H                -0.00030   -0.00025   -0.00089    0.04780   -0.03451   -0.09796    0.02388   -0.01118   -0.02115
       H                 0.00078   -0.00032    0.00063    0.10963    0.03253   -0.09545    0.04581    0.01244   -0.02116
       H                -0.00009   -0.00063   -0.00004    0.08690    0.03615   -0.06246    0.03291    0.01200   -0.01359
       H                 0.00013    0.00045    0.00055    0.08780    0.05595   -0.03982    0.03562    0.02385   -0.00842
       H                 0.00003    0.00061    0.00074    0.06978   -0.01329   -0.10147    0.03884    0.00384   -0.02236
       H                -0.00024    0.00091    0.00067    0.04900    0.00792   -0.04752    0.02987    0.01394   -0.01079
       H                -0.00038    0.00089    0.00050    0.02230   -0.04183   -0.07289    0.02406   -0.00210   -0.01605
       H                -0.00041   -0.00215   -0.00239   -0.03095    0.02924   -0.02457    0.10925   -0.06127    0.07152
       H                -0.00098   -0.00047   -0.00200   -0.02013    0.01193   -0.00499    0.07447   -0.01356   -0.00459
       H                -0.00181   -0.00176   -0.00115   -0.01100    0.02417   -0.03564    0.04658   -0.05118    0.07647
       H                -0.00036    0.00079    0.00030    0.02941   -0.00127   -0.03347   -0.07993   -0.01221    0.05568
       H                -0.00101    0.00010   -0.00175    0.02207   -0.01154   -0.00252   -0.06205    0.01268   -0.02697
       H                -0.00139    0.00263   -0.00138    0.04121   -0.01370   -0.02149   -0.12636    0.00452    0.03706
       H                -0.00120    0.00049   -0.00136    0.01575    0.02202   -0.06371   -0.04017   -0.06923    0.17233
       H                -0.00179    0.00046   -0.00152    0.02652    0.00826   -0.05132   -0.08054   -0.04463    0.14993
       H                -0.00112    0.00047   -0.00138   -0.00270    0.02817   -0.05160    0.01419   -0.08324    0.15918
       O                 0.01216    0.04124   -0.00512   -0.00062   -0.01213    0.01603   -0.00486   -0.01097    0.00377
      Ar                -0.08351   -0.01749    0.11913    0.00303   -0.01167    0.00869   -0.00688   -0.00801   -0.00195
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在することを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、Ar原子のフラーレンへの内包過程の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- T. Futagoishi, M. Murata, A. Wakamiya, T. Sasamori, Y. Murata, _Org. Lett._ 15, 2750 (2013)