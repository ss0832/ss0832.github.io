---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(BH9データセットの2. Pericyclic, No. 54の化学反応, NNP(UMA)使用, 失敗例)
published: 2025-11-15
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-11-15

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、BH9データセットの2. Pericyclic, No. 54の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

BH9のデータセットについて:

- _J. Chem. Theory Comput._ 2022, 18, 1, 151–166 

https://doi.org/10.1021/acs.jctc.1c00694


この文献のSupporting Informationから、データセットの詳細を確認できる。

有機金属錯体が関わる反応を除いたさまざまなカテゴリの反応がまとめられたデータセットである。DFTの汎関数の電子エネルギーの精度の比較などのベンチマークに主に使われる。

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.19.6
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.19.6.zip
unzip v1.19.6.zip
cd MultiOptPy-v1.19.6
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.19.6 にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.19.6`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.19.6`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`bh9_2_54.xyz`とした。
初期構造は以下のものを使用した。

```
43
OptimizedStructure
C      2.120526580061     -2.054845804648      0.447766697133
C     -1.516094753636     -0.739557344512      1.033170817691
C     -0.381654480701     -0.126985810887      0.696879430868
C      2.507745489413     -0.742279288635      0.220522453289
O      0.702547505705     -0.039536481107      1.551398473189
C      1.144809772438      1.220017178308     -0.224891515077
H      1.705495817272      1.208720977935     -1.159809018082
N      1.806200665105      0.382675214610      0.764284704951
H      1.244689448408     -2.269953681321      1.041989197144
O     -0.094130430986      0.526858324955     -0.452188388608
C      2.873051140819     -3.089311447488     -0.093775112647
C      3.997959522528     -2.825361871681     -0.857512092611
H      4.576315676552     -3.637537578275     -1.276826337294
C      4.383450284563     -1.508066411785     -1.071447426834
H      5.268697427273     -1.288037414148     -1.653822511414
C      3.649593902563     -0.468918417059     -0.527154809982
H      3.967055010004      0.558005511558     -0.662780330100
H      2.567329715770     -4.112165352187      0.084421126148
C     -2.713433818001     -0.722762674643      0.165650136089
C     -3.980086497578     -0.832152466405      0.745402915396
C     -2.640702285360     -0.631236491210     -1.227974990107
C     -5.129316643948     -0.826900851738     -0.030316795700
H     -4.072459775996     -0.915453752948      1.820328873818
C     -3.790386342158     -0.627523499014     -2.001584909583
H     -1.677006541186     -0.575050513068     -1.712079730538
C     -5.042027690201     -0.721123367417     -1.409748524217
H     -6.097272940994     -0.905853371631      0.448389216534
H     -3.704981834387     -0.559527005751     -3.078934314910
H     -5.937508909201     -0.719387770181     -2.017408652019
C     -1.598779927062     -1.422005374859      2.375091655768
H     -2.099827382034     -2.386989292938      2.280634827733
H     -2.163906907099     -0.829828388006      3.099697497662
H     -0.609442239882     -1.587358389308      2.796701909372
C      0.906758787330      2.637352883000      0.268001183047
H      0.391635237017      2.560747489763      1.230635900084
C      0.023118414247      3.393921247124     -0.718286028306
H     -0.152404797938      4.410571240314     -0.365614865514
H     -0.940828644391      2.904428118858     -0.850491440973
H      0.508338546448      3.461449240219     -1.696195310314
C      2.245853241917      3.337237871885      0.470557151315
H      2.785651824264      3.416508269535     -0.478000562916
H      2.872985301970      2.797987209724      1.179638280848
H      2.092443531072      4.349229335063      0.845681219665
```

<MoleculeViewer 
  xyzData={`43
OptimizedStructure
C      2.120526580061     -2.054845804648      0.447766697133
C     -1.516094753636     -0.739557344512      1.033170817691
C     -0.381654480701     -0.126985810887      0.696879430868
C      2.507745489413     -0.742279288635      0.220522453289
O      0.702547505705     -0.039536481107      1.551398473189
C      1.144809772438      1.220017178308     -0.224891515077
H      1.705495817272      1.208720977935     -1.159809018082
N      1.806200665105      0.382675214610      0.764284704951
H      1.244689448408     -2.269953681321      1.041989197144
O     -0.094130430986      0.526858324955     -0.452188388608
C      2.873051140819     -3.089311447488     -0.093775112647
C      3.997959522528     -2.825361871681     -0.857512092611
H      4.576315676552     -3.637537578275     -1.276826337294
C      4.383450284563     -1.508066411785     -1.071447426834
H      5.268697427273     -1.288037414148     -1.653822511414
C      3.649593902563     -0.468918417059     -0.527154809982
H      3.967055010004      0.558005511558     -0.662780330100
H      2.567329715770     -4.112165352187      0.084421126148
C     -2.713433818001     -0.722762674643      0.165650136089
C     -3.980086497578     -0.832152466405      0.745402915396
C     -2.640702285360     -0.631236491210     -1.227974990107
C     -5.129316643948     -0.826900851738     -0.030316795700
H     -4.072459775996     -0.915453752948      1.820328873818
C     -3.790386342158     -0.627523499014     -2.001584909583
H     -1.677006541186     -0.575050513068     -1.712079730538
C     -5.042027690201     -0.721123367417     -1.409748524217
H     -6.097272940994     -0.905853371631      0.448389216534
H     -3.704981834387     -0.559527005751     -3.078934314910
H     -5.937508909201     -0.719387770181     -2.017408652019
C     -1.598779927062     -1.422005374859      2.375091655768
H     -2.099827382034     -2.386989292938      2.280634827733
H     -2.163906907099     -0.829828388006      3.099697497662
H     -0.609442239882     -1.587358389308      2.796701909372
C      0.906758787330      2.637352883000      0.268001183047
H      0.391635237017      2.560747489763      1.230635900084
C      0.023118414247      3.393921247124     -0.718286028306
H     -0.152404797938      4.410571240314     -0.365614865514
H     -0.940828644391      2.904428118858     -0.850491440973
H      0.508338546448      3.461449240219     -1.696195310314
C      2.245853241917      3.337237871885      0.470557151315
H      2.785651824264      3.416508269535     -0.478000562916
H      2.872985301970      2.797987209724      1.179638280848
H      2.092443531072      4.349229335063      0.845681219665`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`bh9_2_54.xyz`として保存する。その後、同じディレクトリ内で、`config_bh9_2_54.json`を作成し、以下のように記述する。

`config_bh9_2_54.json`
```json
{
  "work_dir": "bh9_2_54",
  "top_n_candidates": 3,
  "multioptpy_version": "v1.19.6b",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"NSTEP": 15,
	"manual_AFIR": ["-400", "5", "3", "-400", "6", "10"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 15,
    "ANEB": [3, 5],
    "QSM": true,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance_bernstein": 0.80,
    "align_distances": 9999,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py bh9_2_54.xyz -cfg config_bh9_2_54.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.19.6/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。


Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`bh9_2_54_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`bh9_2_54_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`bh9_2_54_step1_traj.xyz`はStep2のNEB計算に使用している。

※`bh9_2_54_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`bh9_2_54_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。
- `"align_distances": X`は線形補間で、各ノード間の距離を全て等しくするための処理である。X回の反復計算ごとに本処理を行う。Xを`"NSTEP": n`よりも大きな数値を指定することで、初期経路に対してのみ処理を行うことが出来る。
- `"node_distance_bernstein": N`はノード間の距離をN Åとして初期経路を作成することを示す。経路作成時に元のノードをベルンシュタイン多項式を用いてがたついた経路を滑らかにする。

→プログラムの仕様上`"align_distances": X`の処理を行った後に、`"node_distance_bernstein": N`の処理を行うようになっている。

- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"ANEB": [A, B]`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


`MultiOptPy-v1.19.6/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-941.7867794588557,-941.7867794588557,-941.7166177086367,-941.6843725230332,-941.6480694660238,-941.6384497743184,-941.6362686585261];

export const dataset1_itr5 = [-941.7867795245685,-941.7867795092355,-941.7199783838566,-941.6961936445741,-941.659988136152,-941.6582933833256,-941.6763661439855];

export const dataset1_itr10 = [-941.786779511426,-941.7867788608684,-941.7232152910482,-941.7094808424828,-941.6792064388694,-941.6806357204024,-941.6799875197435,-941.6774409264084,-941.6726338536395,-941.6809263290648,-941.6856187459921,-941.6881647917198,-941.6960836850134];

export const dataset2 = [-941.7867795311398,-941.7867793712385,-941.726201832148,-941.718553071382,-941.7157908171201,-941.7115097409484,-941.7056719221512,-941.6978701993123,-941.696323427522,-941.696685352188,-941.6963320709567,-941.6968024262638,-941.6969063095733,-941.69201685037,-941.689982585352,-941.6891114164936,-941.6887895504022,-941.6880906894899,-941.6858694012205,-941.6876641208685,-941.6890923466144,-941.6925693511641,-941.6969958061417,-941.6977795286737,-941.7068210827981];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [9.725243073793794e-06,9.725190495407384e-06,0.0049812777095230975,0.00971189723867066,0.012043525986268783,0.011497063404069205,0.011407849697808814];

export const dataset1_grad_itr5 = [4.002076266371738e-06,4.9782540571084e-06,0.0035939767313954113,0.007499638197664775,0.010924383903334835,0.009466671308246128,0.006381707080702688];

export const dataset1_grad_itr10 = [2.364297197607732e-06,4.8198305389508266e-05,0.003186537606284086,0.005540523277117701,0.00849757028768729,0.0080572693061576,0.00794082131738209,0.007801733899894004,0.007934533549428711,0.006722681535977022,0.005948404120205921,0.005444729313438104,0.004457085852521678];

export const dataset2_grad = [1.7234180594618215e-06,6.795610729250639e-06,0.0033321910030285635,0.003827636814472196,0.004362008026597686,0.004886757809335143,0.005489169600904997,0.005926270022002281,0.006149033335466734,0.006086238171652021,0.00604356823978164,0.006042441523206262,0.005990851269604525,0.006347273497560793,0.006602857270374648,0.006617446237114745,0.006530126181467572,0.006309298665918074,0.006440373168041552,0.0062015486449140435,0.0059407326944066925,0.0054701843811437705,0.004861165306211499,0.004850406590251554,0.0035343477096300823];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`bh9_2_54_step3_TS_Opt_Inputs`内に保存された`bh9_2_54_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`bh9_2_54_ts_guess_1.xyz`
```
43
0 1
C       2.154929825439     -1.988947695295      0.439951186428
C      -1.739949802756     -0.898211437061      0.929209993179
C      -0.980909206485     -0.443399712347     -0.040450427944
C       2.646817365557     -0.710176609878      0.207089955805
O       2.011064167499      0.521955540722      2.105016350688
C       1.924637974486      1.509981169599      0.041702303473
H       2.133143104410      1.353360441859     -1.003634238206
N       2.123819393200      0.505918310545      0.828359727446
H       1.272932960917     -2.157958903267      1.045578583890
O      -0.609159351341     -0.028760984117     -1.066308661382
C       2.850507983756     -3.066300045853     -0.107723389400
C       3.993694962017     -2.864138518318     -0.873053232287
H       4.547814201163     -3.704714737262     -1.268149129518
C       4.440226022030     -1.577297365255     -1.119617753362
H       5.336341077636     -1.387082905832     -1.691422088383
C       3.761983889520     -0.507573121742     -0.578595970729
H       4.110352035736      0.504984439297     -0.713476073264
H       2.522758122308     -4.081827940442      0.085292647430
C      -3.022920071152     -0.986054797396      0.108749137590
C      -4.252290355784     -0.953503324447      0.733199094146
C      -3.001196439251     -0.954460192972     -1.295576278312
C      -5.400680735402     -0.869162518230     -0.046193695170
H      -4.284561193063     -0.981032104941      1.815620536587
C      -4.114072294704     -0.751070506627     -2.052999831453
H      -2.092445462119     -0.965660759931     -1.862838145080
C      -5.343442260049     -0.737020252517     -1.425475583154
H      -6.356067387391     -0.888681550316      0.448256875518
H      -3.950149480959     -0.608103949468     -3.114710660172
H      -6.227920386843     -0.657695586085     -2.029917920980
C      -1.638957216397     -1.401074130004      2.364838496904
H      -2.075599286770     -2.403535017436      2.416217065113
H      -2.190917724386     -0.789173364301      3.086826889038
H      -0.613469829238     -1.459143452565      2.729994791909
C       1.179545552562      2.758909776572      0.401885230565
H       0.605569237555      2.545987394180      1.305891444316
C       0.188265927200      3.297767294481     -0.658159991039
H      -0.087765998230      4.308900610093     -0.350600400956
H      -0.751197419933      2.743496848407     -0.749374900054
H       0.605539683143      3.385868006118     -1.665089304152
C       2.350372868399      3.710026603006      0.632152660885
H       2.878378489594      3.755283716064     -0.325467270432
H       3.003641518411      3.206881935637      1.344247061588
H       2.091335539715      4.712439397327      0.968754912929
```

<MoleculeViewer 
  xyzData={`43
0 1
C       2.154929825439     -1.988947695295      0.439951186428
C      -1.739949802756     -0.898211437061      0.929209993179
C      -0.980909206485     -0.443399712347     -0.040450427944
C       2.646817365557     -0.710176609878      0.207089955805
O       2.011064167499      0.521955540722      2.105016350688
C       1.924637974486      1.509981169599      0.041702303473
H       2.133143104410      1.353360441859     -1.003634238206
N       2.123819393200      0.505918310545      0.828359727446
H       1.272932960917     -2.157958903267      1.045578583890
O      -0.609159351341     -0.028760984117     -1.066308661382
C       2.850507983756     -3.066300045853     -0.107723389400
C       3.993694962017     -2.864138518318     -0.873053232287
H       4.547814201163     -3.704714737262     -1.268149129518
C       4.440226022030     -1.577297365255     -1.119617753362
H       5.336341077636     -1.387082905832     -1.691422088383
C       3.761983889520     -0.507573121742     -0.578595970729
H       4.110352035736      0.504984439297     -0.713476073264
H       2.522758122308     -4.081827940442      0.085292647430
C      -3.022920071152     -0.986054797396      0.108749137590
C      -4.252290355784     -0.953503324447      0.733199094146
C      -3.001196439251     -0.954460192972     -1.295576278312
C      -5.400680735402     -0.869162518230     -0.046193695170
H      -4.284561193063     -0.981032104941      1.815620536587
C      -4.114072294704     -0.751070506627     -2.052999831453
H      -2.092445462119     -0.965660759931     -1.862838145080
C      -5.343442260049     -0.737020252517     -1.425475583154
H      -6.356067387391     -0.888681550316      0.448256875518
H      -3.950149480959     -0.608103949468     -3.114710660172
H      -6.227920386843     -0.657695586085     -2.029917920980
C      -1.638957216397     -1.401074130004      2.364838496904
H      -2.075599286770     -2.403535017436      2.416217065113
H      -2.190917724386     -0.789173364301      3.086826889038
H      -0.613469829238     -1.459143452565      2.729994791909
C       1.179545552562      2.758909776572      0.401885230565
H       0.605569237555      2.545987394180      1.305891444316
C       0.188265927200      3.297767294481     -0.658159991039
H      -0.087765998230      4.308900610093     -0.350600400956
H      -0.751197419933      2.743496848407     -0.749374900054
H       0.605539683143      3.385868006118     -1.665089304152
C       2.350372868399      3.710026603006      0.632152660885
H       2.878378489594      3.755283716064     -0.325467270432
H       3.003641518411      3.206881935637      1.344247061588
H       2.091335539715      4.712439397327      0.968754912929`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`bh9_2_54_ts_guess_2.xyz`
```
43
0 1
C       2.135334803233     -2.023256010188      0.420122368419
C      -1.706334889385     -0.872372254287      0.980195450613
C      -0.907227979630     -0.366492701981      0.067687342644
C       2.591390178454     -0.736853839700      0.176575683722
O       1.541598922994      0.338289855149      1.961044017051
C       1.867952872511      1.495263146041      0.013910162182
H       2.184673453518      1.391536087912     -1.007439500075
N       1.936906469875      0.428987164567      0.744105487389
H       1.251455798223     -2.193850746471      1.020845420048
O      -0.524879432030      0.051813405744     -0.956368890590
C       2.858601550490     -3.085875594939     -0.110647003651
C       4.000012317831     -2.860484574571     -0.870102470628
H       4.565208152311     -3.690727699538     -1.270349757381
C       4.428056271130     -1.564608681598     -1.107855406402
H       5.321913438662     -1.362433256776     -1.679845981251
C       3.725183996288     -0.504834990983     -0.576290297439
H       4.059307971679      0.512392272444     -0.709870770363
H       2.542780304492     -4.104112944520      0.081864384870
C      -2.962105610451     -0.926368770199      0.137017691723
C      -4.200097068313     -0.942268371131      0.747005410330
C      -2.911799958283     -0.848282720863     -1.262729026201
C      -5.342208305104     -0.878728845722     -0.042098715802
H      -4.245041688803     -0.987931522855      1.828171391578
C      -4.027376375867     -0.708573901368     -2.029945836414
H      -1.986323761949     -0.804094714138     -1.799563451458
C      -5.265742827601     -0.748746915996     -1.419778615050
H      -6.303924957266     -0.917363786341      0.441737847586
H      -3.879997728370     -0.576969943520     -3.094355232877
H      -6.148492509306     -0.696748327525     -2.032460326820
C      -1.622330271349     -1.398333408428      2.398120676619
H      -2.067116806645     -2.399895881876      2.428206156178
H      -2.169579600267     -0.786413009675      3.122470271371
H      -0.593992427140     -1.466222956715      2.745403424720
C       1.133885590747      2.736981205410      0.380573556241
H       0.574490949631      2.548272437238      1.296196270597
C       0.162076488413      3.296363419082     -0.677411648965
H      -0.097155739577      4.313340561467     -0.369770929757
H      -0.780012408406      2.748710146419     -0.770457822551
H       0.597045470872      3.372983347037     -1.677762734515
C       2.331682379090      3.668585670044      0.598324852708
H       2.860455851614      3.702386341575     -0.361814366442
H       2.988178149958      3.172292189368      1.311597341838
H       2.083548963725      4.674649122405      0.925743576203
```

<MoleculeViewer 
  xyzData={`43
0 1
C       2.135334803233     -2.023256010188      0.420122368419
C      -1.706334889385     -0.872372254287      0.980195450613
C      -0.907227979630     -0.366492701981      0.067687342644
C       2.591390178454     -0.736853839700      0.176575683722
O       1.541598922994      0.338289855149      1.961044017051
C       1.867952872511      1.495263146041      0.013910162182
H       2.184673453518      1.391536087912     -1.007439500075
N       1.936906469875      0.428987164567      0.744105487389
H       1.251455798223     -2.193850746471      1.020845420048
O      -0.524879432030      0.051813405744     -0.956368890590
C       2.858601550490     -3.085875594939     -0.110647003651
C       4.000012317831     -2.860484574571     -0.870102470628
H       4.565208152311     -3.690727699538     -1.270349757381
C       4.428056271130     -1.564608681598     -1.107855406402
H       5.321913438662     -1.362433256776     -1.679845981251
C       3.725183996288     -0.504834990983     -0.576290297439
H       4.059307971679      0.512392272444     -0.709870770363
H       2.542780304492     -4.104112944520      0.081864384870
C      -2.962105610451     -0.926368770199      0.137017691723
C      -4.200097068313     -0.942268371131      0.747005410330
C      -2.911799958283     -0.848282720863     -1.262729026201
C      -5.342208305104     -0.878728845722     -0.042098715802
H      -4.245041688803     -0.987931522855      1.828171391578
C      -4.027376375867     -0.708573901368     -2.029945836414
H      -1.986323761949     -0.804094714138     -1.799563451458
C      -5.265742827601     -0.748746915996     -1.419778615050
H      -6.303924957266     -0.917363786341      0.441737847586
H      -3.879997728370     -0.576969943520     -3.094355232877
H      -6.148492509306     -0.696748327525     -2.032460326820
C      -1.622330271349     -1.398333408428      2.398120676619
H      -2.067116806645     -2.399895881876      2.428206156178
H      -2.169579600267     -0.786413009675      3.122470271371
H      -0.593992427140     -1.466222956715      2.745403424720
C       1.133885590747      2.736981205410      0.380573556241
H       0.574490949631      2.548272437238      1.296196270597
C       0.162076488413      3.296363419082     -0.677411648965
H      -0.097155739577      4.313340561467     -0.369770929757
H      -0.780012408406      2.748710146419     -0.770457822551
H       0.597045470872      3.372983347037     -1.677762734515
C       2.331682379090      3.668585670044      0.598324852708
H       2.860455851614      3.702386341575     -0.361814366442
H       2.988178149958      3.172292189368      1.311597341838
H       2.083548963725      4.674649122405      0.925743576203`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`bh9_2_54_ts_guess_3.xyz`
```
43
0 1
C       2.142619057568     -2.016817331321      0.426101346742
C      -1.710852304846     -0.875239918637      0.973776013496
C      -0.918920883381     -0.370485410427      0.054436321136
C       2.603966220532     -0.732215214609      0.183160321947
O       1.599579445970      0.362943262284      1.982586940294
C       1.867969174623      1.497932689892      0.016167749348
H       2.174330356705      1.383738112506     -1.012105419453
N       1.962129629982      0.438282244171      0.754631113402
H       1.259062177199     -2.185765584400      1.028049649912
O      -0.537225553575      0.054351392865     -0.965131684143
C       2.859308499487     -3.081992173060     -0.108923379789
C       3.999860067498     -2.860612357802     -0.871006696069
H       4.561289627935     -3.692739026677     -1.272626339324
C       4.432149918111     -1.566311776457     -1.109307003205
H       5.325055585171     -1.366635951785     -1.683498057643
C       3.735017791974     -0.504261470169     -0.574630752029
H       4.072006338325      0.512046125723     -0.708635962608
H       2.539542098524     -4.099259998418      0.082289406607
C      -2.971062454520     -0.935383215663      0.132780215911
C      -4.208223709167     -0.943825268033      0.744766022557
C      -2.924090835991     -0.865091090983     -1.267577730192
C      -5.351399911853     -0.875970361987     -0.042629443381
H      -4.251622998535     -0.986885949254      1.826084489334
C      -4.039841953301     -0.715906707162     -2.033217378169
H      -1.999930832695     -0.831020885061     -1.807762959350
C      -5.277264658448     -0.745906211594     -1.420502833193
H      -6.312532213494     -0.909920108226      0.442760994887
H      -3.890825034819     -0.583508592423     -3.097411889881
H      -6.160610486577     -0.687743934622     -2.031728080967
C      -1.624644439215     -1.399252875054      2.392045675259
H      -2.067145432953     -2.401788379070      2.423501839145
H      -2.173523235941     -0.787901201114      3.115285985264
H      -0.596544226367     -1.464688382780      2.740243427169
C       1.138577713420      2.737367356787      0.381958896901
H       0.578235304779      2.545338143482      1.296601981289
C       0.165045914586      3.296924277973     -0.674851327930
H      -0.095839312081      4.313027252490     -0.365570694515
H      -0.776314161604      2.748480881951     -0.768279529445
H       0.598602384962      3.375892927643     -1.675522598062
C       2.334482312647      3.668980854470      0.602577185155
H       2.863452567566      3.706542243215     -0.357412415808
H       2.990503538758      3.171072751479      1.315630939935
H       2.085628913043      4.674208859855      0.932895659467
```

<MoleculeViewer 
  xyzData={`43
0 1
C       2.142619057568     -2.016817331321      0.426101346742
C      -1.710852304846     -0.875239918637      0.973776013496
C      -0.918920883381     -0.370485410427      0.054436321136
C       2.603966220532     -0.732215214609      0.183160321947
O       1.599579445970      0.362943262284      1.982586940294
C       1.867969174623      1.497932689892      0.016167749348
H       2.174330356705      1.383738112506     -1.012105419453
N       1.962129629982      0.438282244171      0.754631113402
H       1.259062177199     -2.185765584400      1.028049649912
O      -0.537225553575      0.054351392865     -0.965131684143
C       2.859308499487     -3.081992173060     -0.108923379789
C       3.999860067498     -2.860612357802     -0.871006696069
H       4.561289627935     -3.692739026677     -1.272626339324
C       4.432149918111     -1.566311776457     -1.109307003205
H       5.325055585171     -1.366635951785     -1.683498057643
C       3.735017791974     -0.504261470169     -0.574630752029
H       4.072006338325      0.512046125723     -0.708635962608
H       2.539542098524     -4.099259998418      0.082289406607
C      -2.971062454520     -0.935383215663      0.132780215911
C      -4.208223709167     -0.943825268033      0.744766022557
C      -2.924090835991     -0.865091090983     -1.267577730192
C      -5.351399911853     -0.875970361987     -0.042629443381
H      -4.251622998535     -0.986885949254      1.826084489334
C      -4.039841953301     -0.715906707162     -2.033217378169
H      -1.999930832695     -0.831020885061     -1.807762959350
C      -5.277264658448     -0.745906211594     -1.420502833193
H      -6.312532213494     -0.909920108226      0.442760994887
H      -3.890825034819     -0.583508592423     -3.097411889881
H      -6.160610486577     -0.687743934622     -2.031728080967
C      -1.624644439215     -1.399252875054      2.392045675259
H      -2.067145432953     -2.401788379070      2.423501839145
H      -2.173523235941     -0.787901201114      3.115285985264
H      -0.596544226367     -1.464688382780      2.740243427169
C       1.138577713420      2.737367356787      0.381958896901
H       0.578235304779      2.545338143482      1.296601981289
C       0.165045914586      3.296924277973     -0.674851327930
H      -0.095839312081      4.313027252490     -0.365570694515
H      -0.776314161604      2.748480881951     -0.768279529445
H       0.598602384962      3.375892927643     -1.675522598062
C       2.334482312647      3.668980854470      0.602577185155
H       2.863452567566      3.706542243215     -0.357412415808
H       2.990503538758      3.171072751479      1.315630939935
H       2.085628913043      4.674208859855      0.932895659467`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-v1.19.6/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`bh9_2_54_ts_final_X.xyz`として保存されている。)

`bh9_2_54_ts_final_1.xyz`
```
43
OptimizedStructure
C      3.081145210722     -2.138485641367     -0.386893685965
C     -2.027609568121     -1.412095190999      0.677263377582
C     -1.279483661348     -2.091607965754     -0.167244429919
C      3.168214785133     -0.819594048846      0.024468963713
O      1.069908783340     -0.816577282918      1.003952035463
C      1.726576852045      1.073508684265     -0.081860157610
H      2.511600575184      1.509577214585     -0.684497655054
N      1.925435831531     -0.135620018478      0.336946821782
H      2.107818617027     -2.604329719501     -0.453810335510
O     -0.633669993878     -2.691107546717     -0.921472104194
C      4.246871021709     -2.818037736375     -0.698168208711
C      5.479436795153     -2.186984438543     -0.581155107672
H      6.387439737237     -2.725599618117     -0.818191218174
C      5.548192250628     -0.871780810071     -0.148213691687
H      6.507803221356     -0.384702255301     -0.036554797475
C      4.386001273842     -0.178055657194      0.161017743532
H      4.428345166481      0.839279470766      0.526847781669
H      4.193633893597     -3.846135742826     -1.031029083558
C     -3.109879694902     -0.565707811934      0.153420893607
C     -3.749708973641      0.345072894944      0.994420945163
C     -3.504699084217     -0.614033588723     -1.188585633236
C     -4.739050483723      1.188701975613      0.505934477586
H     -3.470940502515      0.402231389031      2.038174414743
C     -4.486543238960      0.230508571439     -1.671749151495
H     -3.034695223722     -1.321437035828     -1.863341494152
C     -5.110954648674      1.141980725591     -0.827513498489
H     -5.219941605800      1.888243851581      1.178209999742
H     -4.770407185929      0.175654951208     -2.715125382802
H     -5.880787254418      1.801001081638     -1.206382248624
C     -1.652344585308     -1.433264876230      2.138203501659
H     -2.503429821213     -1.743959928441      2.747780870632
H     -1.325253898618     -0.444999938369      2.466732508778
H     -0.824319595949     -2.114633557763      2.318035351989
C      0.447667277978      1.788691849207      0.185122650298
H      0.025229655315      1.354890696468      1.094187877558
C     -0.530417530504      1.532918171166     -0.967626156878
H     -1.507908558617      1.964021748962     -0.744843936519
H     -0.663426647899      0.464125361995     -1.130879714065
H     -0.158902562525      1.981444011860     -1.892137942704
C      0.693301831087      3.282163020060      0.382291668722
H      1.140163349533      3.724745092282     -0.511610096947
H      1.358659343005      3.472358752632      1.225502237127
H     -0.249071151424      3.797630895004      0.570371610095
```

<MoleculeViewer 
  xyzData={`43
OptimizedStructure
C      3.081145210722     -2.138485641367     -0.386893685965
C     -2.027609568121     -1.412095190999      0.677263377582
C     -1.279483661348     -2.091607965754     -0.167244429919
C      3.168214785133     -0.819594048846      0.024468963713
O      1.069908783340     -0.816577282918      1.003952035463
C      1.726576852045      1.073508684265     -0.081860157610
H      2.511600575184      1.509577214585     -0.684497655054
N      1.925435831531     -0.135620018478      0.336946821782
H      2.107818617027     -2.604329719501     -0.453810335510
O     -0.633669993878     -2.691107546717     -0.921472104194
C      4.246871021709     -2.818037736375     -0.698168208711
C      5.479436795153     -2.186984438543     -0.581155107672
H      6.387439737237     -2.725599618117     -0.818191218174
C      5.548192250628     -0.871780810071     -0.148213691687
H      6.507803221356     -0.384702255301     -0.036554797475
C      4.386001273842     -0.178055657194      0.161017743532
H      4.428345166481      0.839279470766      0.526847781669
H      4.193633893597     -3.846135742826     -1.031029083558
C     -3.109879694902     -0.565707811934      0.153420893607
C     -3.749708973641      0.345072894944      0.994420945163
C     -3.504699084217     -0.614033588723     -1.188585633236
C     -4.739050483723      1.188701975613      0.505934477586
H     -3.470940502515      0.402231389031      2.038174414743
C     -4.486543238960      0.230508571439     -1.671749151495
H     -3.034695223722     -1.321437035828     -1.863341494152
C     -5.110954648674      1.141980725591     -0.827513498489
H     -5.219941605800      1.888243851581      1.178209999742
H     -4.770407185929      0.175654951208     -2.715125382802
H     -5.880787254418      1.801001081638     -1.206382248624
C     -1.652344585308     -1.433264876230      2.138203501659
H     -2.503429821213     -1.743959928441      2.747780870632
H     -1.325253898618     -0.444999938369      2.466732508778
H     -0.824319595949     -2.114633557763      2.318035351989
C      0.447667277978      1.788691849207      0.185122650298
H      0.025229655315      1.354890696468      1.094187877558
C     -0.530417530504      1.532918171166     -0.967626156878
H     -1.507908558617      1.964021748962     -0.744843936519
H     -0.663426647899      0.464125361995     -1.130879714065
H     -0.158902562525      1.981444011860     -1.892137942704
C      0.693301831087      3.282163020060      0.382291668722
H      1.140163349533      3.724745092282     -0.511610096947
H      1.358659343005      3.472358752632      1.225502237127
H     -0.249071151424      3.797630895004      0.570371610095`}
  caption="遷移状態構造 (No.1)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -29.3061              3.7236             17.0070
Reduced mass [au]                   4.3139              5.0026              5.7094
Force const [Dyne/A]               -0.0022              0.0000              0.0010
Char temp [K]                       0.0000              5.3575             24.4693
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.02359   -0.02589    0.02419    0.01708    0.01165   -0.00556   -0.02855    0.00962   -0.01464
       C                 0.01511    0.03761    0.00467   -0.01031   -0.03885   -0.00420    0.00214   -0.01541    0.02464
       C                 0.02602    0.05104    0.00326   -0.03064   -0.04814   -0.01466    0.00372   -0.04080    0.04649
       C                 0.00159   -0.01754    0.00199   -0.00266    0.01024    0.00325   -0.02113    0.00720   -0.00843
       O                 0.03080   -0.04210    0.06020   -0.02383   -0.01852   -0.04256   -0.00411    0.00123    0.02852
       C                -0.04860   -0.06031   -0.02780   -0.01814   -0.00130   -0.00761   -0.02326    0.00672    0.02548
       H                -0.07220   -0.06540   -0.06274   -0.00973    0.01345    0.01410   -0.03309    0.00931    0.01452
       N                -0.00848   -0.03987    0.01184   -0.01514   -0.00379   -0.01608   -0.01581    0.00520    0.01760
       H                 0.03260   -0.04769    0.04588    0.02249    0.00292   -0.02470   -0.02956    0.00939    0.00149
       O                 0.03160    0.06334   -0.00173   -0.04554   -0.05620   -0.02092    0.00588   -0.06451    0.06721
       C                 0.03338   -0.00586    0.01783    0.02895    0.02413    0.01164   -0.03425    0.01236   -0.04207
       C                 0.02166    0.02238   -0.00950    0.02096    0.03497    0.03725   -0.03235    0.01246   -0.06291
       H                 0.02974    0.03793   -0.01390    0.03024    0.04473    0.05063   -0.03673    0.01459   -0.08455
       C                -0.00009    0.03069   -0.03161    0.00091    0.03321    0.04583   -0.02456    0.00979   -0.05600
       H                -0.00883    0.05292   -0.05341   -0.00561    0.04146    0.06589   -0.02266    0.00974   -0.07215
       C                -0.01063    0.01110   -0.02643   -0.01104    0.02074    0.02881   -0.01884    0.00714   -0.02856
       H                -0.02798    0.01842   -0.04459   -0.02688    0.01901    0.03541   -0.01221    0.00501   -0.02342
       H                 0.05065   -0.01220    0.03466    0.04449    0.02543    0.00515   -0.04027    0.01438   -0.04739
       C                 0.00869    0.02824    0.00206    0.01136   -0.00285    0.00991    0.02233   -0.00792   -0.00463
       C                 0.00765    0.03180   -0.00254    0.06069    0.02699    0.01515    0.03435    0.02650   -0.03286
       C                 0.00191    0.01400    0.00455   -0.01371    0.00325    0.01714    0.03359   -0.03267   -0.00699
       C                 0.00092    0.02242   -0.00506    0.08609    0.06317    0.02623    0.05879    0.03751   -0.06337
       H                 0.01207    0.04174   -0.00424    0.08062    0.02262    0.01010    0.02574    0.04582   -0.03159
       C                -0.00445    0.00507    0.00185    0.01219    0.03955    0.02791    0.05832   -0.02145   -0.03757
       H                 0.00101    0.00914    0.00902   -0.05333   -0.02046    0.01442    0.02388   -0.06030    0.01520
       C                -0.00493    0.00924   -0.00300    0.06274    0.07006    0.03242    0.07159    0.01414   -0.06617
       H                 0.00022    0.02546   -0.00873    0.12470    0.08629    0.02981    0.06810    0.06495   -0.08525
       H                -0.00972   -0.00586    0.00386   -0.00759    0.04400    0.03305    0.06731   -0.04046   -0.03901
       H                -0.01031    0.00185   -0.00491    0.08276    0.09836    0.04097    0.09104    0.02315   -0.09004
       C                -0.00121    0.02540    0.00859    0.00215   -0.05800   -0.00764   -0.01335    0.00860    0.02898
       H                -0.00818    0.01759   -0.00509   -0.00351   -0.02989   -0.00130   -0.02482    0.03561    0.02669
       H                -0.00821    0.02275    0.02386    0.04255   -0.07166   -0.00713    0.00064    0.00967    0.01169
       H                -0.00135    0.02626    0.01154   -0.02142   -0.08953   -0.01754   -0.02697   -0.00209    0.05176
       C                -0.05472   -0.07082   -0.02865   -0.03363   -0.02055   -0.03021   -0.02086    0.00435    0.04301
       H                -0.08724   -0.11988   -0.06823   -0.04018   -0.02183   -0.03365   -0.01717   -0.00821    0.03854
       C                -0.01476    0.00709   -0.07956   -0.01256   -0.04618   -0.04246   -0.02459    0.02130    0.04238
       H                -0.01774    0.00545   -0.08957   -0.02346   -0.06205   -0.05958   -0.02343    0.02006    0.05001
       H                -0.02259    0.01871   -0.15090    0.00952   -0.05002   -0.03615   -0.02732    0.02359    0.02910
       H                 0.02364    0.05679   -0.04020   -0.00672   -0.04640   -0.04023   -0.02594    0.03231    0.04715
       C                -0.05130   -0.08280    0.06586   -0.06270   -0.01512   -0.03678   -0.01876    0.00134    0.06350
       H                -0.01396   -0.03506    0.10812   -0.05813   -0.01317   -0.03352   -0.02134    0.01373    0.06833
       H                -0.08193   -0.13624    0.10191   -0.07780    0.00240   -0.02878   -0.01574   -0.01139    0.06397
       H                -0.05509   -0.08710    0.05931   -0.07449   -0.03064   -0.05335   -0.01770   -0.00048    0.07394
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_2_54_ts_final_2.xyz`
```
43
OptimizedStructure
C      0.638171505851     -1.380772773289     -0.134385973606
C     -2.422131889619      0.247798439862      0.685172275480
C     -1.949050639830      1.274393384709      0.008942382566
C      1.765419066406     -0.597588006150      0.038482844653
O      0.671766865657      0.867524143095      1.465394346520
C      2.271808859647      1.727495626467      0.084033957830
H      2.948725486667      1.484063037693     -0.723683524256
N      1.572043257159      0.747836188357      0.560759844155
H     -0.326090241097     -0.977066074918      0.135114542165
O     -1.543045470615      2.174058780870     -0.599354423167
C      0.777464064014     -2.660646073179     -0.645103509626
C      2.038140601464     -3.154438526220     -0.955809973265
H      2.146557639275     -4.157398297932     -1.347316918613
C      3.161439091707     -2.367287458109     -0.749327597524
H      4.146702908473     -2.757883085861     -0.967107179508
C      3.031303824088     -1.079928443147     -0.246287098810
H      3.905786023499     -0.472504276835     -0.054976936139
H     -0.104560571895     -3.269968599378     -0.796368609588
C     -2.949421984782     -0.913109706385     -0.050273219768
C     -3.315547633227     -2.066539924827      0.643638077500
C     -3.058556447797     -0.919402276737     -1.446120795488
C     -3.773235123175     -3.188421840556     -0.035775273930
H     -3.239353463902     -2.093527636019      1.722292819823
C     -3.512908633021     -2.038680076145     -2.118064006958
H     -2.780808014895     -0.037832140372     -2.013649620255
C     -3.873555230561     -3.184215691152     -1.417062784991
H     -4.050874384019     -4.071918131732      0.525225751572
H     -3.586640113906     -2.018016763204     -3.197962221496
H     -4.229765073640     -4.059183532857     -1.944369832756
C     -2.257277390106      0.248181334253      2.185392690282
H     -1.583228902618     -0.553034501101      2.494555743382
H     -3.221568720491      0.112312516672      2.679394563549
H     -1.817172003969      1.181870748469      2.527577596322
C      2.150398343979      3.123156761314      0.588708137411
H      1.478149508386      3.094331701206      1.446041785850
C      1.548275582515      4.023346651483     -0.493691884138
H      1.454101183215      5.045175832631     -0.122837240301
H      0.561763228147      3.672863825884     -0.793751096146
H      2.190042272127      4.046684808385     -1.378187348610
C      3.523587763589      3.635036575196      1.028587084251
H      4.224716959547      3.640161876733      0.190054983857
H      3.944436018798      3.015790910148      1.821430630644
H      3.443991878954      4.657280692675      1.400667011126
```

<MoleculeViewer 
  xyzData={`43
OptimizedStructure
C      0.638171505851     -1.380772773289     -0.134385973606
C     -2.422131889619      0.247798439862      0.685172275480
C     -1.949050639830      1.274393384709      0.008942382566
C      1.765419066406     -0.597588006150      0.038482844653
O      0.671766865657      0.867524143095      1.465394346520
C      2.271808859647      1.727495626467      0.084033957830
H      2.948725486667      1.484063037693     -0.723683524256
N      1.572043257159      0.747836188357      0.560759844155
H     -0.326090241097     -0.977066074918      0.135114542165
O     -1.543045470615      2.174058780870     -0.599354423167
C      0.777464064014     -2.660646073179     -0.645103509626
C      2.038140601464     -3.154438526220     -0.955809973265
H      2.146557639275     -4.157398297932     -1.347316918613
C      3.161439091707     -2.367287458109     -0.749327597524
H      4.146702908473     -2.757883085861     -0.967107179508
C      3.031303824088     -1.079928443147     -0.246287098810
H      3.905786023499     -0.472504276835     -0.054976936139
H     -0.104560571895     -3.269968599378     -0.796368609588
C     -2.949421984782     -0.913109706385     -0.050273219768
C     -3.315547633227     -2.066539924827      0.643638077500
C     -3.058556447797     -0.919402276737     -1.446120795488
C     -3.773235123175     -3.188421840556     -0.035775273930
H     -3.239353463902     -2.093527636019      1.722292819823
C     -3.512908633021     -2.038680076145     -2.118064006958
H     -2.780808014895     -0.037832140372     -2.013649620255
C     -3.873555230561     -3.184215691152     -1.417062784991
H     -4.050874384019     -4.071918131732      0.525225751572
H     -3.586640113906     -2.018016763204     -3.197962221496
H     -4.229765073640     -4.059183532857     -1.944369832756
C     -2.257277390106      0.248181334253      2.185392690282
H     -1.583228902618     -0.553034501101      2.494555743382
H     -3.221568720491      0.112312516672      2.679394563549
H     -1.817172003969      1.181870748469      2.527577596322
C      2.150398343979      3.123156761314      0.588708137411
H      1.478149508386      3.094331701206      1.446041785850
C      1.548275582515      4.023346651483     -0.493691884138
H      1.454101183215      5.045175832631     -0.122837240301
H      0.561763228147      3.672863825884     -0.793751096146
H      2.190042272127      4.046684808385     -1.378187348610
C      3.523587763589      3.635036575196      1.028587084251
H      4.224716959547      3.640161876733      0.190054983857
H      3.944436018798      3.015790910148      1.821430630644
H      3.443991878954      4.657280692675      1.400667011126`}
  caption="遷移状態構造 (No.2)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -38.8125              7.6655             13.2336
Reduced mass [au]                   3.5633              4.9665              5.2262
Force const [Dyne/A]               -0.0032              0.0002              0.0005
Char temp [K]                       0.0000             11.0289             19.0402
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                -0.00318    0.02744   -0.02702    0.00618    0.00684   -0.01211    0.03943    0.00100   -0.01710
       C                -0.01737   -0.00330   -0.00896    0.00064    0.00659   -0.02740    0.01761   -0.03568    0.00472
       C                -0.04578    0.00636   -0.01418    0.03028   -0.02305   -0.05151    0.01919   -0.03327    0.00929
       C                 0.00695    0.00663    0.00106    0.00388    0.01058   -0.01399    0.03155    0.00794    0.00491
       O                -0.02424    0.03168   -0.04743   -0.00366   -0.00792    0.00025    0.00465    0.00665   -0.01520
       C                 0.06823   -0.00542    0.03998    0.00694    0.00994    0.02473    0.01335    0.01171   -0.00247
       H                 0.09913   -0.01500    0.06900    0.01093    0.02271    0.02434    0.02371    0.01200    0.00606
       N                 0.01752    0.00986   -0.00286    0.00234    0.00342    0.00459    0.01494    0.00923   -0.00534
       H                -0.00209    0.04559   -0.05030    0.00712   -0.00216    0.00466    0.02990   -0.00349   -0.04259
       O                -0.07211    0.01430   -0.01969    0.05719   -0.05011   -0.07368    0.01855   -0.03267    0.00981
       C                -0.01462    0.02459   -0.02345    0.00729    0.01415   -0.03042    0.05961   -0.00154   -0.00531
       C                -0.01654    0.00173    0.00577    0.00624    0.02441   -0.05037    0.06978    0.00342    0.02771
       H                -0.02551   -0.00008    0.00793    0.00708    0.03009   -0.06467    0.08436    0.00135    0.03709
       C                -0.00700   -0.01866    0.03255    0.00449    0.02719   -0.05120    0.06042    0.01103    0.04858
       H                -0.00898   -0.03648    0.05554    0.00425    0.03485   -0.06603    0.06776    0.01537    0.07406
       C                 0.00497   -0.01709    0.03110    0.00338    0.01974   -0.03280    0.04084    0.01343    0.03741
       H                 0.01239   -0.03501    0.05356    0.00297    0.02029   -0.03296    0.03242    0.02031    0.05421
       H                -0.02242    0.04084   -0.04374    0.00880    0.01158   -0.02880    0.06736   -0.00841   -0.02198
       C                -0.00891   -0.00957   -0.00482   -0.00911   -0.00619   -0.00023   -0.02248   -0.01330   -0.00204
       C                 0.00431   -0.01192   -0.00180   -0.05912    0.02847    0.03092   -0.05513   -0.00761   -0.00972
       C                -0.01436   -0.01250   -0.00444    0.02955   -0.05334   -0.00307   -0.03568    0.00353   -0.00114
       C                 0.01080   -0.01657    0.00156   -0.07113    0.01672    0.05853   -0.10160    0.01521   -0.01596
       H                 0.00928   -0.00988   -0.00210   -0.08932    0.06494    0.03395   -0.04612   -0.02045   -0.01069
       C                -0.00804   -0.01706   -0.00107    0.01693   -0.06482    0.02452   -0.08250    0.02623   -0.00735
       H                -0.02356   -0.01120   -0.00692    0.07029   -0.08168   -0.02719   -0.01026   -0.00090    0.00440
       C                 0.00445   -0.01912    0.00198   -0.03370   -0.02979    0.05567   -0.11633    0.03240   -0.01482
       H                 0.02079   -0.01826    0.00384   -0.11016    0.04421    0.08247   -0.12695    0.01950   -0.02175
       H                -0.01267   -0.01907   -0.00079    0.04729   -0.10146    0.02173   -0.09274    0.03934   -0.00640
       H                 0.00939   -0.02276    0.00470   -0.04323   -0.03894    0.07727   -0.15297    0.05024   -0.01964
       C                 0.00158   -0.00354   -0.01117   -0.02416    0.05034   -0.02472    0.04078   -0.05909    0.00202
       H                 0.01364    0.00279   -0.02121   -0.04963    0.04286    0.01139    0.02139   -0.08328   -0.01824
       H                 0.00937   -0.01387    0.00125   -0.03540    0.09025   -0.03568    0.04448   -0.03765    0.01528
       H                -0.00353    0.00049   -0.01559   -0.00608    0.05014   -0.04747    0.07408   -0.07664    0.00654
       C                 0.07296   -0.00671    0.04455    0.00775    0.00146    0.04839   -0.00101    0.01318   -0.00998
       H                 0.14267   -0.02230    0.09915    0.01220   -0.01364    0.05139    0.00231    0.01023   -0.00741
       C                -0.04785   -0.02788    0.09254    0.00124    0.01950    0.06693   -0.01591    0.00040   -0.01246
       H                -0.05219   -0.03073    0.09957    0.00066    0.01267    0.08564   -0.02655    0.00118   -0.01729
       H                -0.06012   -0.06262    0.17397    0.00117    0.02249    0.06392   -0.01283   -0.01291   -0.00677
       H                -0.12117   -0.00777    0.04005   -0.00232    0.03665    0.06482   -0.01946    0.00335   -0.01494
       C                 0.09364    0.03595   -0.07441    0.00955   -0.00454    0.04967   -0.00529    0.03169   -0.01849
       H                 0.02283    0.05383   -0.13357    0.00501    0.01042    0.04596   -0.00886    0.03537   -0.02145
       H                 0.18056    0.05302   -0.10707    0.01459   -0.01741    0.03695    0.00549    0.04118   -0.01678
       H                 0.09469    0.03511   -0.07227    0.01047   -0.01092    0.06734   -0.01578    0.03279   -0.02385
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_2_54_ts_final_3.xyz`
```
43
OptimizedStructure
C      0.637416696206     -1.381326755225     -0.132265661652
C     -2.422581929564      0.250108109420      0.682724338291
C     -1.948239967247      1.275627269974      0.005745813825
C      1.765005766202     -0.598659001441      0.040717192955
O      0.671014512556      0.868748610811      1.465008101504
C      2.272829001640      1.726153700686      0.084107168702
H      2.950308691827      1.481385643939     -0.722734135214
N      1.572018971572      0.747473771347      0.561310182642
H     -0.326827088113     -0.976709332283      0.135930444866
O     -1.541115338618      2.174337457548     -0.603214477096
C      0.776351166837     -2.661861246722     -0.641421029445
C      2.036988911552     -3.156797709656     -0.950459699833
H      2.145117790879     -4.160265332918     -1.340743107599
C      3.160602030734     -2.370123428655     -0.743870702389
H      4.145810390235     -2.761585231820     -0.960341316071
C      3.030836367117     -1.082117917742     -0.242392788223
H      3.905533169373     -0.475031060342     -0.050993578233
H     -0.105924464553     -3.270797241705     -0.792779401609
C     -2.949954061859     -0.911304232646     -0.051865601759
C     -3.317441346687     -2.063704823351      0.643035882590
C     -3.057838346808     -0.919125641012     -1.447802687023
C     -3.775236085159     -3.186071152097     -0.035504220182
H     -3.242233462645     -2.089505962001      1.721788960881
C     -3.512302908136     -2.038881789786     -2.118872581695
H     -2.779015343948     -0.038383845770     -2.016090230844
C     -3.874312121065     -3.183383186790     -1.416885294503
H     -4.053944183428     -4.068747119648      0.526257765829
H     -3.585050496425     -2.019408110466     -3.198859667539
H     -4.230608283691     -4.058726190845     -1.943510519900
C     -2.259071010838      0.252102113643      2.183090656066
H     -1.585812043566     -0.549189662576      2.493773501119
H     -3.223890824677      0.117414362513      2.676383171624
H     -1.818675165374      1.185901418531      2.524601770806
C      2.151855307989      3.122457343159      0.587106024048
H      1.478828613392      3.095020538635      1.443874717544
C      1.551262988704      4.021812255383     -0.496837684087
H      1.457406850514      5.044116481990     -0.127213972705
H      0.564795641887      3.671616038602     -0.797379334695
H      2.193828628249      4.043751213885     -1.380788837189
C      3.524978220801      3.633962105494      1.027628251233
H      4.226853550441      3.637702351241      0.189713378674
H      3.944731062947      3.015341189808      1.821539533454
H      3.445700140747      4.656673998886      1.398489672830
```

<MoleculeViewer 
  xyzData={`43
OptimizedStructure
C      0.637416696206     -1.381326755225     -0.132265661652
C     -2.422581929564      0.250108109420      0.682724338291
C     -1.948239967247      1.275627269974      0.005745813825
C      1.765005766202     -0.598659001441      0.040717192955
O      0.671014512556      0.868748610811      1.465008101504
C      2.272829001640      1.726153700686      0.084107168702
H      2.950308691827      1.481385643939     -0.722734135214
N      1.572018971572      0.747473771347      0.561310182642
H     -0.326827088113     -0.976709332283      0.135930444866
O     -1.541115338618      2.174337457548     -0.603214477096
C      0.776351166837     -2.661861246722     -0.641421029445
C      2.036988911552     -3.156797709656     -0.950459699833
H      2.145117790879     -4.160265332918     -1.340743107599
C      3.160602030734     -2.370123428655     -0.743870702389
H      4.145810390235     -2.761585231820     -0.960341316071
C      3.030836367117     -1.082117917742     -0.242392788223
H      3.905533169373     -0.475031060342     -0.050993578233
H     -0.105924464553     -3.270797241705     -0.792779401609
C     -2.949954061859     -0.911304232646     -0.051865601759
C     -3.317441346687     -2.063704823351      0.643035882590
C     -3.057838346808     -0.919125641012     -1.447802687023
C     -3.775236085159     -3.186071152097     -0.035504220182
H     -3.242233462645     -2.089505962001      1.721788960881
C     -3.512302908136     -2.038881789786     -2.118872581695
H     -2.779015343948     -0.038383845770     -2.016090230844
C     -3.874312121065     -3.183383186790     -1.416885294503
H     -4.053944183428     -4.068747119648      0.526257765829
H     -3.585050496425     -2.019408110466     -3.198859667539
H     -4.230608283691     -4.058726190845     -1.943510519900
C     -2.259071010838      0.252102113643      2.183090656066
H     -1.585812043566     -0.549189662576      2.493773501119
H     -3.223890824677      0.117414362513      2.676383171624
H     -1.818675165374      1.185901418531      2.524601770806
C      2.151855307989      3.122457343159      0.587106024048
H      1.478828613392      3.095020538635      1.443874717544
C      1.551262988704      4.021812255383     -0.496837684087
H      1.457406850514      5.044116481990     -0.127213972705
H      0.564795641887      3.671616038602     -0.797379334695
H      2.193828628249      4.043751213885     -1.380788837189
C      3.524978220801      3.633962105494      1.027628251233
H      4.226853550441      3.637702351241      0.189713378674
H      3.944731062947      3.015341189808      1.821539533454
H      3.445700140747      4.656673998886      1.398489672830`}
  caption="遷移状態構造 (No.3)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -38.8076              7.5906             13.2999
Reduced mass [au]                   3.5624              4.9615              5.2296
Force const [Dyne/A]               -0.0032              0.0002              0.0005
Char temp [K]                       0.0000             10.9211             19.1356
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00311   -0.02740    0.02698   -0.00615   -0.00683    0.01204   -0.03947   -0.00095    0.01715
       C                 0.01735    0.00333    0.00900   -0.00067   -0.00653    0.02734   -0.01760    0.03563   -0.00469
       C                 0.04571   -0.00632    0.01427   -0.03029    0.02312    0.05135   -0.01923    0.03329   -0.00919
       C                -0.00696   -0.00664   -0.00107   -0.00387   -0.01058    0.01402   -0.03157   -0.00792   -0.00491
       O                 0.02418   -0.03165    0.04748    0.00360    0.00791   -0.00031   -0.00463   -0.00658    0.01523
       C                -0.06821    0.00540   -0.04008   -0.00687   -0.00999   -0.02464   -0.01336   -0.01169    0.00242
       H                -0.09906    0.01497   -0.06913   -0.01081   -0.02274   -0.02420   -0.02376   -0.01202   -0.00615
       N                -0.01754   -0.00986    0.00284   -0.00233   -0.00344   -0.00457   -0.01495   -0.00920    0.00534
       H                 0.00198   -0.04550    0.05023   -0.00709    0.00214   -0.00481   -0.02995    0.00356    0.04267
       O                 0.07200   -0.01425    0.01983   -0.05719    0.05018    0.07343   -0.01864    0.03276   -0.00963
       C                 0.01455   -0.02457    0.02344   -0.00724   -0.01411    0.03035   -0.05966    0.00157    0.00535
       C                 0.01652   -0.00178   -0.00573   -0.00619   -0.02434    0.05039   -0.06981   -0.00342   -0.02771
       H                 0.02550    0.00002   -0.00787   -0.00703   -0.03000    0.06467   -0.08440   -0.00136   -0.03709
       C                 0.00702    0.01857   -0.03248   -0.00446   -0.02713    0.05132   -0.06043   -0.01105   -0.04861
       H                 0.00904    0.03632   -0.05543   -0.00422   -0.03477    0.06623   -0.06775   -0.01542   -0.07412
       C                -0.00494    0.01701   -0.03106   -0.00337   -0.01971    0.03292   -0.04085   -0.01344   -0.03745
       H                -0.01234    0.03489   -0.05350   -0.00297   -0.02027    0.03316   -0.03241   -0.02034   -0.05427
       H                 0.02232   -0.04077    0.04369   -0.00874   -0.01155    0.02864   -0.06742    0.00846    0.02205
       C                 0.00892    0.00959    0.00483    0.00907    0.00621    0.00021    0.02252    0.01326    0.00205
       C                -0.00421    0.01191    0.00177    0.05930   -0.02858   -0.03083    0.05493    0.00760    0.00971
       C                 0.01433    0.01255    0.00446   -0.02983    0.05343    0.00298    0.03597   -0.00360    0.00116
       C                -0.01065    0.01655   -0.00162    0.07131   -0.01688   -0.05841    0.10139   -0.01520    0.01596
       H                -0.00914    0.00984    0.00207    0.08967   -0.06511   -0.03381    0.04572    0.02046    0.01067
       C                 0.00806    0.01710    0.00106   -0.01720    0.06486   -0.02457    0.08279   -0.02628    0.00737
       H                 0.02346    0.01128    0.00696   -0.07077    0.08188    0.02702    0.01076    0.00080   -0.00438
       C                -0.00434    0.01913   -0.00203    0.03366    0.02971   -0.05562    0.11637   -0.03242    0.01483
       H                -0.02057    0.01821   -0.00393    0.11052   -0.04447   -0.08227    0.12655   -0.01947    0.02174
       H                 0.01265    0.01914    0.00079   -0.04773    0.10158   -0.02184    0.09321   -0.03942    0.00643
       H                -0.00924    0.02277   -0.00476    0.04319    0.03881   -0.07719    0.15297   -0.05025    0.01966
       C                -0.00158    0.00354    0.01120    0.02414   -0.05027    0.02473   -0.04076    0.05895   -0.00204
       H                -0.01363   -0.00276    0.02119    0.04970   -0.04281   -0.01137   -0.02144    0.08308    0.01816
       H                -0.00934    0.01382   -0.00125    0.03537   -0.09021    0.03578   -0.04448    0.03756   -0.01528
       H                 0.00350   -0.00048    0.01563    0.00602   -0.05001    0.04742   -0.07397    0.07647   -0.00657
       C                -0.07294    0.00670   -0.04467   -0.00768   -0.00153   -0.04831    0.00105   -0.01316    0.00992
       H                -0.14263    0.02228   -0.09937   -0.01205    0.01355   -0.05129   -0.00216   -0.01018    0.00742
       C                 0.04797    0.02774   -0.09261   -0.00128   -0.01962   -0.06679    0.01583   -0.00041    0.01244
       H                 0.05231    0.03057   -0.09963   -0.00071   -0.01282   -0.08549    0.02648   -0.00119    0.01727
       H                 0.06035    0.06237   -0.17411   -0.00121   -0.02267   -0.06372    0.01274    0.01287    0.00683
       H                 0.12127    0.00764   -0.04000    0.00223   -0.03674   -0.06468    0.01929   -0.00336    0.01485
       C                -0.09377   -0.03583    0.07437   -0.00946    0.00453   -0.04970    0.00537   -0.03164    0.01826
       H                -0.02300   -0.05368    0.13363   -0.00501   -0.01038   -0.04603    0.00883   -0.03535    0.02114
       H                -0.18075   -0.05282    0.10698   -0.01440    0.01743   -0.03704   -0.00531   -0.04110    0.01651
       H                -0.09481   -0.03501    0.07225   -0.01038    0.01088   -0.06737    0.01590   -0.03274    0.02361
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在しないことを確認できた。


結合の組み換えが伴わないTS構造が得られた。初期構造とワークフローの設定を変えて再度計算する予定である。



## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、BH9データセットの2. Pericyclic, No. 54の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- _J. Phys. Chem. A_ 2019, 123, 3761−3781 http://dx.doi.org/10.1021/acs.jpca.9b01546 (MOBH35のデータセットについて)

