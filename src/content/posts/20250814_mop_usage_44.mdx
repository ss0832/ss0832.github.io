---
title:  【計算化学】自作pythonモジュールで遷移状態構造を求めてみる((R)-BINAP-Rh系触媒によるヒドリド挿入反応(ヒドロホルミル化), NNP使用）
published: 2025-08-14
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-08-14

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作モジュール(MultiOptPy)で、(R)-BINAP-Rh系触媒によるヒドリド挿入反応(ヒドロホルミル化)の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonモジュールである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

本反応について：
- https://www.chem-station.com/odos/2009/07/-hydroformylation.html
- https://en.wikipedia.org/wiki/Hydroformylation

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)

:::note

今回は反応に関わる系中の(R)-BINAP配位子のフェニル基の最安定な立体配座の探索は行わずに算出した。本来は、適当に１つ遷移状態構造を求めた後に、その構造のフェニル基を回転させることで立体配座探索を行うことで最安定な遷移状態構造を探す必要がある。

:::

## 使用した自作モジュールMultiOptPyのバージョン
```
v1.12
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.12.zip
unzip v1.12.zip
cd MultiOptPy-v1.12
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作モジュールへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.12`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.12`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。

:::important

モデルをダウンロードした時点(2025/8/9)で、`uma-s-1`のモデルが存在していたが、https://huggingface.co/facebook/UMA より、

” *Note uma-s-1 is now deprecated and will be removed by the next release. uma-s-1p1 should be used instead for a replacement.

とあり、今後のアップデートで削除されるため、使用しなかった。

:::

- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。



※自作モジュールでの具体的な使用の仕方に関しては、`MultiOptPy-v1.12`ディレクトリ内の`ase_calculation_tools.py` を参照



## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`binap_insertion.xyz`とした。
初期構造は以下のものを使用した。

```
98

C     -4.629045891134     -0.868312894860      2.217515132415
C     -3.307254504158     -1.055500325752      1.936029534489
C     -2.403134800800      0.039853574627      1.887644451497
C     -2.914735128967      1.330066667259      2.149246903956
C     -4.295951542255      1.499296111606      2.418989026332
C     -5.137125920350      0.427358864652      2.454426227062
H     -5.296347693279     -1.720264885468      2.252114719627
H     -2.941367189395     -2.054554589576      1.742660609525
C     -1.012646866463     -0.126399604532      1.577117364776
C     -2.026625356560      2.428454887369      2.153263651263
H     -4.666982845716      2.500560074792      2.603690498428
H     -6.189659920703      0.564012574972      2.666943949128
C     -0.700866463620      2.249179055828      1.905370777483
C     -0.170423668073      0.969242916412      1.601539467480
H     -2.413544486378      3.417122073479      2.371210900802
H     -0.040626659718      3.102686920235      1.942640156047
C     -0.548908366195     -1.521815916039      1.269064611793
C     -0.461726016422     -2.452091211864      2.356401744800
C     -0.291736415206     -1.950900197170     -0.019966523051
C     -0.103482490853     -3.796399582169      2.106914548868
C      0.071210835451     -3.305076564887     -0.246774245696
C     -0.662090398885     -2.979515846058      4.713925174452
C     -0.027644291750     -4.715366526697      3.182163375609
C      0.162800468358     -4.196389528772      0.777516136342
H      0.265469120346     -3.638745440672     -1.256545731662
C     -0.303808854848     -4.320070443497      4.457751711621
H     -0.873299490953     -2.666144870589      5.728547403080
H      0.250844934063     -5.740595677161      2.968140385326
H      0.430313023944     -5.228392921103      0.582089339126
H     -0.248733021490     -5.028870792151      5.274037463207
P     -0.153396582427     -0.758046953524     -1.416868530908
P      1.602749015689      0.798890025394      1.114597074575
Rh     1.786133432323      0.451601683252     -1.137170137526
H      0.816521144931      1.708922580830     -1.033549724509
C     -0.733560511815     -2.072423495139      3.696738399514
H     -0.997962052845     -1.045426253245      3.910157138882
C      3.137281939764     -0.928225767804     -1.259073031591
O      3.994083346548     -1.673295354385     -1.372143488468
C      3.141162110257      1.852619143882     -2.095847859105
H      2.952782543730      2.867569656182     -1.774326468892
H      4.178513918006      1.555489504005     -1.999754512647
C      2.348663821607      1.247335966532     -3.095979107755
H      2.798651583719      0.445282815658     -3.674248927503
C      1.216348950418      1.897777848989     -3.801207417796
C      0.843140830032      3.223753269911     -3.577895372772
C      0.473123714651      1.155325950806     -4.721030994957
C     -0.253018462598      3.774722466743     -4.225752457005
H      1.410790716390      3.829807561004     -2.882517969943
C     -0.624462275374      1.702823363125     -5.365851096645
H      0.750663857533      0.124170490913     -4.912586947409
C     -0.999525348616      3.016634947348     -5.117837313868
H     -0.524517546036      4.805825734397     -4.032952508013
H     -1.191841054611      1.097683644910     -6.062624848675
H     -1.857672119147      3.446345214238     -5.618370056699
C      2.165054577354     -0.367377771892      2.404257691063
C      1.929907702345     -0.087586763010      3.751591981424
C      2.771453023003     -1.568079266190      2.061599756813
C      2.318411611898     -0.980887587131      4.734039326138
H      1.435347219266      0.836762184845      4.029812958595
C      3.142922747228     -2.476673810691      3.045293006751
H      2.930284305479     -1.813671931595      1.021380928437
C      2.922654148250     -2.181673807895      4.380577573091
H      2.131926319159     -0.752330324301      5.775876248140
H      3.598734587070     -3.417165943181      2.763136785639
H      3.209543869428     -2.889949947721      5.147413088877
C      2.406438379222      2.376902972505      1.605662207097
C      3.426497796519      2.434247362276      2.551230020819
C      2.100372991580      3.540078219057      0.891850296971
C      4.102076643679      3.624478849072      2.796715992374
H      3.717907086149      1.547116064012      3.095294352126
C      2.758794067176      4.729321890031      1.150350858472
H      1.349001362243      3.502796238847      0.112180274600
C      3.765719708321      4.776141917089      2.106833622966
H      4.897771559254      3.642695155013      3.530529843165
H      2.497297822673      5.618993162278      0.591339486116
H      4.291437974130      5.702214479221      2.300397097774
C     -0.228963630965     -1.780249090459     -2.943486882815
C     -1.355945891015     -1.830577650250     -3.760258277660
C      0.930856943620     -2.426330164405     -3.377044059748
C     -1.324571751782     -2.512519614308     -4.970588721657
H     -2.261886464014     -1.316436032579     -3.472552541716
C      0.959351861081     -3.119304702008     -4.575865530027
H      1.829110673528     -2.378381863318     -2.776941485924
C     -0.171141373191     -3.160180643023     -5.381596445693
H     -2.208563469434     -2.528364778165     -5.595519814225
H      1.870617216529     -3.613300413825     -4.887938574978
H     -0.147881372147     -3.686644106904     -6.327068017690
C     -1.774518657247      0.075014952943     -1.451513614690
C     -2.944747708304     -0.624669876267     -1.161048483589
C     -1.858700695075      1.405922602820     -1.846276997395
C     -4.177229028801      0.002389275697     -1.237730000560
H     -2.889117557292     -1.665090105075     -0.860932241069
C     -3.094761419716      2.033205656576     -1.928205472785
H     -0.958213786044      1.951499009355     -2.095799472536
C     -4.252462230711      1.336694114544     -1.616751592378
H     -5.077110388617     -0.545817738042     -0.989327447876
H     -3.146224485412      3.069260118127     -2.238371641086
H     -5.214977356536      1.829939761694     -1.670118685760

```

<MoleculeViewer 
  xyzData={`98

C     -4.629045891134     -0.868312894860      2.217515132415
C     -3.307254504158     -1.055500325752      1.936029534489
C     -2.403134800800      0.039853574627      1.887644451497
C     -2.914735128967      1.330066667259      2.149246903956
C     -4.295951542255      1.499296111606      2.418989026332
C     -5.137125920350      0.427358864652      2.454426227062
H     -5.296347693279     -1.720264885468      2.252114719627
H     -2.941367189395     -2.054554589576      1.742660609525
C     -1.012646866463     -0.126399604532      1.577117364776
C     -2.026625356560      2.428454887369      2.153263651263
H     -4.666982845716      2.500560074792      2.603690498428
H     -6.189659920703      0.564012574972      2.666943949128
C     -0.700866463620      2.249179055828      1.905370777483
C     -0.170423668073      0.969242916412      1.601539467480
H     -2.413544486378      3.417122073479      2.371210900802
H     -0.040626659718      3.102686920235      1.942640156047
C     -0.548908366195     -1.521815916039      1.269064611793
C     -0.461726016422     -2.452091211864      2.356401744800
C     -0.291736415206     -1.950900197170     -0.019966523051
C     -0.103482490853     -3.796399582169      2.106914548868
C      0.071210835451     -3.305076564887     -0.246774245696
C     -0.662090398885     -2.979515846058      4.713925174452
C     -0.027644291750     -4.715366526697      3.182163375609
C      0.162800468358     -4.196389528772      0.777516136342
H      0.265469120346     -3.638745440672     -1.256545731662
C     -0.303808854848     -4.320070443497      4.457751711621
H     -0.873299490953     -2.666144870589      5.728547403080
H      0.250844934063     -5.740595677161      2.968140385326
H      0.430313023944     -5.228392921103      0.582089339126
H     -0.248733021490     -5.028870792151      5.274037463207
P     -0.153396582427     -0.758046953524     -1.416868530908
P      1.602749015689      0.798890025394      1.114597074575
Rh     1.786133432323      0.451601683252     -1.137170137526
H      0.816521144931      1.708922580830     -1.033549724509
C     -0.733560511815     -2.072423495139      3.696738399514
H     -0.997962052845     -1.045426253245      3.910157138882
C      3.137281939764     -0.928225767804     -1.259073031591
O      3.994083346548     -1.673295354385     -1.372143488468
C      3.141162110257      1.852619143882     -2.095847859105
H      2.952782543730      2.867569656182     -1.774326468892
H      4.178513918006      1.555489504005     -1.999754512647
C      2.348663821607      1.247335966532     -3.095979107755
H      2.798651583719      0.445282815658     -3.674248927503
C      1.216348950418      1.897777848989     -3.801207417796
C      0.843140830032      3.223753269911     -3.577895372772
C      0.473123714651      1.155325950806     -4.721030994957
C     -0.253018462598      3.774722466743     -4.225752457005
H      1.410790716390      3.829807561004     -2.882517969943
C     -0.624462275374      1.702823363125     -5.365851096645
H      0.750663857533      0.124170490913     -4.912586947409
C     -0.999525348616      3.016634947348     -5.117837313868
H     -0.524517546036      4.805825734397     -4.032952508013
H     -1.191841054611      1.097683644910     -6.062624848675
H     -1.857672119147      3.446345214238     -5.618370056699
C      2.165054577354     -0.367377771892      2.404257691063
C      1.929907702345     -0.087586763010      3.751591981424
C      2.771453023003     -1.568079266190      2.061599756813
C      2.318411611898     -0.980887587131      4.734039326138
H      1.435347219266      0.836762184845      4.029812958595
C      3.142922747228     -2.476673810691      3.045293006751
H      2.930284305479     -1.813671931595      1.021380928437
C      2.922654148250     -2.181673807895      4.380577573091
H      2.131926319159     -0.752330324301      5.775876248140
H      3.598734587070     -3.417165943181      2.763136785639
H      3.209543869428     -2.889949947721      5.147413088877
C      2.406438379222      2.376902972505      1.605662207097
C      3.426497796519      2.434247362276      2.551230020819
C      2.100372991580      3.540078219057      0.891850296971
C      4.102076643679      3.624478849072      2.796715992374
H      3.717907086149      1.547116064012      3.095294352126
C      2.758794067176      4.729321890031      1.150350858472
H      1.349001362243      3.502796238847      0.112180274600
C      3.765719708321      4.776141917089      2.106833622966
H      4.897771559254      3.642695155013      3.530529843165
H      2.497297822673      5.618993162278      0.591339486116
H      4.291437974130      5.702214479221      2.300397097774
C     -0.228963630965     -1.780249090459     -2.943486882815
C     -1.355945891015     -1.830577650250     -3.760258277660
C      0.930856943620     -2.426330164405     -3.377044059748
C     -1.324571751782     -2.512519614308     -4.970588721657
H     -2.261886464014     -1.316436032579     -3.472552541716
C      0.959351861081     -3.119304702008     -4.575865530027
H      1.829110673528     -2.378381863318     -2.776941485924
C     -0.171141373191     -3.160180643023     -5.381596445693
H     -2.208563469434     -2.528364778165     -5.595519814225
H      1.870617216529     -3.613300413825     -4.887938574978
H     -0.147881372147     -3.686644106904     -6.327068017690
C     -1.774518657247      0.075014952943     -1.451513614690
C     -2.944747708304     -0.624669876267     -1.161048483589
C     -1.858700695075      1.405922602820     -1.846276997395
C     -4.177229028801      0.002389275697     -1.237730000560
H     -2.889117557292     -1.665090105075     -0.860932241069
C     -3.094761419716      2.033205656576     -1.928205472785
H     -0.958213786044      1.951499009355     -2.095799472536
C     -4.252462230711      1.336694114544     -1.616751592378
H     -5.077110388617     -0.545817738042     -0.989327447876
H     -3.146224485412      3.069260118127     -2.238371641086
H     -5.214977356536      1.829939761694     -1.670118685760
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`binap_insertion.xyz`として保存し、以下を実行する。
```
python .\optmain.py binap_insertion.xyz -os uma-s-1p1 -opt rsirfo_fsb -ma 200 34 42 -modelhess
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。

これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`binap_insertion_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.12`ディレクトリに置く。

`binap_insertion_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`binap_insertion_traj.xyz`は次のNEB計算に使用する。

※`binap_insertion_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`binap_insertion_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）

```
98
OptimizedStructure
C     -4.829851038055     -0.944462671960      2.174933464873
C     -3.504915381341     -1.135280166747      1.909477919887
C     -2.639595964508     -0.035233969540      1.666372414899
C     -3.192482297768      1.263011362886      1.703138402530
C     -4.574106101422      1.433074152518      1.967956448125
C     -5.377129652014      0.356327416065      2.201776710064
H     -5.469260485131     -1.798635796762      2.358646126544
H     -3.106611175841     -2.140297317085      1.876744711570
C     -1.244932102972     -0.209224899462      1.378948435657
C     -2.342488791255      2.369397821251      1.482103158121
H     -4.977245138134      2.438835046465      1.984526561384
H     -6.430798356134      0.493984180046      2.408057377475
C     -1.018799441321      2.189326454535      1.226517279718
C     -0.442031100654      0.892655105374      1.161284648939
H     -2.757992579155      3.369565238979      1.523485676192
H     -0.397690319431      3.058276240397      1.074692914695
C     -0.725349048259     -1.613285742290      1.366556490054
C     -0.601667606452     -2.282801528045      2.627256298366
C     -0.414784102655     -2.277209119335      0.197756081097
C     -0.127732044123     -3.611867891339      2.670217733635
C      0.024916358643     -3.625807894466      0.264062874436
C     -0.778488093946     -2.301406431404      5.045474754819
C      0.028609635959     -4.262234061540      3.919408305165
C      0.170583145509     -4.267804424343      1.454596482729
H      0.246259439641     -4.159826046099     -0.647666762714
C     -0.288799167159     -3.625058917257      5.082380790590
H     -1.032809262850     -1.798355919027      5.969856817134
H      0.402297458703     -5.279391385944      3.929668694763
H      0.512853518140     -5.295818878506      1.482218968953
H     -0.170309797690     -4.129691555962      6.032652669326
P     -0.345795899659     -1.375416505142     -1.410692657503
P      1.302897859238      0.730754590105      0.569355245365
Rh     1.467718217057      0.033221232441     -1.658435246232
H      3.099338206438      1.590183599282     -4.079542643337
C     -0.925959379214     -1.648779834131      3.856138158247
H     -1.288648040451     -0.629677299559      3.846632042889
C      1.819221354584     -0.527833539288     -3.406638612932
O      2.075533033150     -0.846459101745     -4.472388652317
C      3.210855810372      1.242569614804     -1.974530523905
H      3.428543319589      1.861249560351     -1.101469153008
H      4.058604766641      0.553499730978     -2.075115248762
C      3.201842457894      2.155950166928     -3.217167600404
H      4.166083713952      2.671577585051     -3.298507188901
C      2.118586833463      3.205483702029     -3.188753161718
C      2.414780244713      4.535199239595     -2.909578433922
C      0.783497031545      2.868583910704     -3.416099811494
C      1.413955798367      5.496443617058     -2.832286691832
H      3.447371155193      4.819082771240     -2.739082393589
C     -0.222163228875      3.819352718934     -3.328657028604
H      0.531090697034      1.843317615067     -3.659406960570
C      0.088333452644      5.140642591828     -3.028136500415
H      1.672185566092      6.526643072348     -2.617255525392
H     -1.251168589326      3.531056499902     -3.510104396076
H     -0.693775649810      5.886719675492     -2.966323314021
C      2.068764272666     -0.442211249622      1.733165569887
C      1.882502774198     -0.352093462940      3.111603692450
C      2.861812957627     -1.461922268129      1.217292015121
C      2.483265489091     -1.266084598996      3.960896120218
H      1.249466097652      0.427879237851      3.519914683692
C      3.458950233842     -2.382355386528      2.067671858362
H      2.991109262458     -1.530834267232      0.141847397491
C      3.269757422719     -2.284780730309      3.438067655739
H      2.321666792124     -1.197267435896      5.029017209846
H      4.066600646805     -3.178915353850      1.657600215887
H      3.728998939165     -3.006470601094      4.101803341489
C      2.051146618559      2.340055518553      1.021212272263
C      2.936975365711      2.498603297122      2.083560420815
C      1.758177324611      3.446988588951      0.222378965766
C      3.484220298528      3.743049321199      2.367696188276
H      3.222090300542      1.651636681289      2.690248294799
C      2.288164695179      4.692060428334      0.519498146944
H      1.123104990080      3.332266334475     -0.649950370911
C      3.149767606442      4.844423899312      1.597084762433
H      4.176162240103      3.845524017390      3.193887367726
H      2.040430174789      5.537176092227     -0.108066861290
H      3.571832823170      5.815479164488      1.822629097396
C     -0.362707330344     -2.727828464116     -2.651249969955
C     -1.462297800712     -3.049401562471     -3.440496990522
C      0.834649842735     -3.415718769593     -2.865281805252
C     -1.372883007397     -4.047929481486     -4.403444421691
H     -2.392734693660     -2.511647500707     -3.326203319583
C      0.920513841488     -4.421238685303     -3.812351933960
H      1.712617543896     -3.142302409898     -2.289855836535
C     -0.187966931639     -4.741110777464     -4.585933744295
H     -2.235732866032     -4.276625582589     -5.015839335675
H      1.857707388495     -4.941973342890     -3.960793735678
H     -0.121063395842     -5.516873925035     -5.337701942890
C     -2.004686979768     -0.630481522824     -1.546037496542
C     -3.175667993619     -1.339010737458     -1.283379500707
C     -2.085373129988      0.716712297372     -1.884820484074
C     -4.407939562482     -0.712026473763     -1.370177466218
H     -3.121173458007     -2.381666330151     -0.989529706922
C     -3.318771442826      1.348076377949     -1.962087354849
H     -1.168756640790      1.270123154635     -2.061275579747
C     -4.479972584787      0.633747929359     -1.706554970875
H     -5.312069519704     -1.266515865825     -1.153388867009
H     -3.370429942292      2.401177481643     -2.209203090082
H     -5.442807901743      1.126183348340     -1.758506641930

```

<MoleculeViewer 
  xyzData={`98
OptimizedStructure
C     -4.829851038055     -0.944462671960      2.174933464873
C     -3.504915381341     -1.135280166747      1.909477919887
C     -2.639595964508     -0.035233969540      1.666372414899
C     -3.192482297768      1.263011362886      1.703138402530
C     -4.574106101422      1.433074152518      1.967956448125
C     -5.377129652014      0.356327416065      2.201776710064
H     -5.469260485131     -1.798635796762      2.358646126544
H     -3.106611175841     -2.140297317085      1.876744711570
C     -1.244932102972     -0.209224899462      1.378948435657
C     -2.342488791255      2.369397821251      1.482103158121
H     -4.977245138134      2.438835046465      1.984526561384
H     -6.430798356134      0.493984180046      2.408057377475
C     -1.018799441321      2.189326454535      1.226517279718
C     -0.442031100654      0.892655105374      1.161284648939
H     -2.757992579155      3.369565238979      1.523485676192
H     -0.397690319431      3.058276240397      1.074692914695
C     -0.725349048259     -1.613285742290      1.366556490054
C     -0.601667606452     -2.282801528045      2.627256298366
C     -0.414784102655     -2.277209119335      0.197756081097
C     -0.127732044123     -3.611867891339      2.670217733635
C      0.024916358643     -3.625807894466      0.264062874436
C     -0.778488093946     -2.301406431404      5.045474754819
C      0.028609635959     -4.262234061540      3.919408305165
C      0.170583145509     -4.267804424343      1.454596482729
H      0.246259439641     -4.159826046099     -0.647666762714
C     -0.288799167159     -3.625058917257      5.082380790590
H     -1.032809262850     -1.798355919027      5.969856817134
H      0.402297458703     -5.279391385944      3.929668694763
H      0.512853518140     -5.295818878506      1.482218968953
H     -0.170309797690     -4.129691555962      6.032652669326
P     -0.345795899659     -1.375416505142     -1.410692657503
P      1.302897859238      0.730754590105      0.569355245365
Rh     1.467718217057      0.033221232441     -1.658435246232
H      3.099338206438      1.590183599282     -4.079542643337
C     -0.925959379214     -1.648779834131      3.856138158247
H     -1.288648040451     -0.629677299559      3.846632042889
C      1.819221354584     -0.527833539288     -3.406638612932
O      2.075533033150     -0.846459101745     -4.472388652317
C      3.210855810372      1.242569614804     -1.974530523905
H      3.428543319589      1.861249560351     -1.101469153008
H      4.058604766641      0.553499730978     -2.075115248762
C      3.201842457894      2.155950166928     -3.217167600404
H      4.166083713952      2.671577585051     -3.298507188901
C      2.118586833463      3.205483702029     -3.188753161718
C      2.414780244713      4.535199239595     -2.909578433922
C      0.783497031545      2.868583910704     -3.416099811494
C      1.413955798367      5.496443617058     -2.832286691832
H      3.447371155193      4.819082771240     -2.739082393589
C     -0.222163228875      3.819352718934     -3.328657028604
H      0.531090697034      1.843317615067     -3.659406960570
C      0.088333452644      5.140642591828     -3.028136500415
H      1.672185566092      6.526643072348     -2.617255525392
H     -1.251168589326      3.531056499902     -3.510104396076
H     -0.693775649810      5.886719675492     -2.966323314021
C      2.068764272666     -0.442211249622      1.733165569887
C      1.882502774198     -0.352093462940      3.111603692450
C      2.861812957627     -1.461922268129      1.217292015121
C      2.483265489091     -1.266084598996      3.960896120218
H      1.249466097652      0.427879237851      3.519914683692
C      3.458950233842     -2.382355386528      2.067671858362
H      2.991109262458     -1.530834267232      0.141847397491
C      3.269757422719     -2.284780730309      3.438067655739
H      2.321666792124     -1.197267435896      5.029017209846
H      4.066600646805     -3.178915353850      1.657600215887
H      3.728998939165     -3.006470601094      4.101803341489
C      2.051146618559      2.340055518553      1.021212272263
C      2.936975365711      2.498603297122      2.083560420815
C      1.758177324611      3.446988588951      0.222378965766
C      3.484220298528      3.743049321199      2.367696188276
H      3.222090300542      1.651636681289      2.690248294799
C      2.288164695179      4.692060428334      0.519498146944
H      1.123104990080      3.332266334475     -0.649950370911
C      3.149767606442      4.844423899312      1.597084762433
H      4.176162240103      3.845524017390      3.193887367726
H      2.040430174789      5.537176092227     -0.108066861290
H      3.571832823170      5.815479164488      1.822629097396
C     -0.362707330344     -2.727828464116     -2.651249969955
C     -1.462297800712     -3.049401562471     -3.440496990522
C      0.834649842735     -3.415718769593     -2.865281805252
C     -1.372883007397     -4.047929481486     -4.403444421691
H     -2.392734693660     -2.511647500707     -3.326203319583
C      0.920513841488     -4.421238685303     -3.812351933960
H      1.712617543896     -3.142302409898     -2.289855836535
C     -0.187966931639     -4.741110777464     -4.585933744295
H     -2.235732866032     -4.276625582589     -5.015839335675
H      1.857707388495     -4.941973342890     -3.960793735678
H     -0.121063395842     -5.516873925035     -5.337701942890
C     -2.004686979768     -0.630481522824     -1.546037496542
C     -3.175667993619     -1.339010737458     -1.283379500707
C     -2.085373129988      0.716712297372     -1.884820484074
C     -4.407939562482     -0.712026473763     -1.370177466218
H     -3.121173458007     -2.381666330151     -0.989529706922
C     -3.318771442826      1.348076377949     -1.962087354849
H     -1.168756640790      1.270123154635     -2.061275579747
C     -4.479972584787      0.633747929359     -1.706554970875
H     -5.312069519704     -1.266515865825     -1.153388867009
H     -3.370429942292      2.401177481643     -2.209203090082
H     -5.442807901743      1.126183348340     -1.758506641930
`}
  caption="初期パスを求めるための構造最適化の結果（安定構造ではない）"
  backgroundColor="#333333"
/>



#### b. `binap_insertion_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`binap_insertion_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py binap_insertion_traj.xyz -os uma-s-1p1 -ns 15 -modelhess -spng -nd 0.4
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.12`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-2912.848949819567,-2912.848949819567,-2912.840045145382,-2912.8225266860495,-2912.8170705539733,-2912.811801116584,-2912.8044783180126,-2912.7939168380017,-2912.7839004069438,-2912.795683550818,-2912.800855627997,-2912.8039731524,-2912.8072562031793,-2912.8102071848466,-2912.812923492659,-2912.81530660986,-2912.8174899248434,-2912.8190157605086,-2912.8202690016037,-2912.8214095670055,-2912.8223383091126,-2912.8235157788704,-2912.8243414481276,-2912.825339232573,-2912.826159224236,-2912.826825079757,-2912.8276486462014,-2912.8284321891183,-2912.829194178209,-2912.829970992126,-2912.830759792074,-2912.8317031837737,-2912.832449366725,-2912.833511532274,-2912.834333556656,-2912.8355533279887,-2912.8368717212184,-2912.838256212849,-2912.83926580809,-2912.8411882692058,-2912.8428169674403,-2912.843920453251,-2912.8445195094337,-2912.8458720383173,-2912.8466774504823,-2912.8470582697933,-2912.847493551943,-2912.8478973620017,-2912.8482469545497,-2912.848363800821,-2912.848464911047,-2912.848710729807,-2912.848896302994,-2912.8490112917807,-2912.8490576587924,-2912.8491590143462,-2912.8492308954806,-2912.8492813980233,-2912.8493045990526,-2912.8493180570513];

export const dataset2 = [-2912.8489500648957,-2912.8489500648957,-2912.8481553069796,-2912.84372394544,-2912.840016126572,-2912.836787748913,-2912.829771505331,-2912.8083780185043,-2912.8021419883858,-2912.8044856077618,-2912.8084088947985,-2912.811139291454,-2912.8137666503053,-2912.816326193459,-2912.818294601024,-2912.8201149355546,-2912.821664848421,-2912.8229468980444,-2912.8240215402802,-2912.8250055513045,-2912.82597375619,-2912.8268912482513,-2912.8277496512865,-2912.8285529255922,-2912.8293026482775,-2912.83000747592,-2912.8306910651577,-2912.8313662431465,-2912.8320649025395,-2912.832810139225,-2912.833602619094,-2912.834497050314,-2912.8354793089948,-2912.8364467778956,-2912.8375393641295,-2912.8388001052554,-2912.8401430663425,-2912.8415469388933,-2912.842987260191,-2912.8443986678194,-2912.8457071427847,-2912.846935675835,-2912.8478732848007,-2912.848635904735,-2912.849219049638,-2912.849745243374,-2912.850065817112,-2912.850381133819,-2912.8506410063746,-2912.8508047453606,-2912.850928601006,-2912.8509824330013,-2912.8510418724964,-2912.8511316275353,-2912.851223205012,-2912.851301745052,-2912.851359537344,-2912.8513980188095,-2912.851416418417,-2912.8514158226203];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [5.610230220290915e-06,5.610169890732922e-06,0.0024943823968544315,0.0038315783674545073,0.0034298434840273955,0.0032380810024402085,0.0029526399653731794,0.002904067773100646,0.006262840542876277,0.003725228929743335,0.003216497860712112,0.003540622846184316,0.0035423920761994392,0.0034493395205129453,0.003345998713775781,0.003359537217437008,0.0032714114896922795,0.003316655932468096,0.0033402143892754246,0.003353524808374151,0.0034616090644986105,0.0033120643495429436,0.0033603072001190267,0.0032626371946149835,0.0032999322954404622,0.0034311919046912352,0.003436935896894958,0.0034308714867160714,0.0034018342427885226,0.003347596515018905,0.0032912946117255827,0.0032124272562437583,0.0033410364026463532,0.0032889101708075737,0.0035257437304740537,0.0034855061892299297,0.0034010612986620542,0.0033305021203780764,0.0035160091768536186,0.0032042441692990958,0.003108346594239057,0.003334331240835493,0.0037054032798380437,0.0033983976430522114,0.003363553326905428,0.0035197985623970913,0.003535454535910555,0.0034898889704596966,0.0034297219677205614,0.0034957776869453967,0.0035522864058326067,0.003453891960033261,0.003399818603236861,0.003365330682821643,0.003434604390232807,0.003423254535872143,0.0034177853111643855,0.003413356675061629,0.00341501190468568,0.003415215864653666];

export const dataset2_grad = [2.6390581319239335e-06,2.2079676672096652e-06,0.0004852410749936429,0.0011130576492279461,0.0014765780241099923,0.0015742521078239862,0.002040168115572049,0.0017288312408052064,0.0008129670339560116,0.0009788422283817282,0.0008690350182336207,0.0008721586896081267,0.0007262692578974709,0.0005567265666057276,0.0006038262641239285,0.0004971750405567389,0.0003483371774311928,0.0002834602529293407,0.0003119661718060281,0.0003651990730598195,0.00040326024157269936,0.0004232427983448655,0.0004058841968169832,0.0003516824310332264,0.00030094931983339827,0.0002881695209785441,0.0002806686421829383,0.0002716081100766021,0.0002331052681038874,0.00019797299526961199,0.0002041912727422807,0.00021787365287297394,0.00021059733776166302,0.00017871902217006768,0.00021582841939696786,0.00021999710887616821,0.00019793460026895795,0.00019756337123024033,0.0002479587471041118,0.00024137507916631556,0.00023625054606087604,0.00023247918917667295,0.00022161601241275428,0.00022472348942488164,0.00021638380793233185,0.0001891075703068241,0.0001467770245931973,0.000156216623119886,0.00010133602650935539,7.110517466333127e-05,6.115377223224416e-05,5.090199897853086e-05,4.9884852230845815e-05,4.729470353484219e-05,3.722346847389723e-05,3.3847108741291345e-05,3.1084661280603154e-05,2.814741108799834e-05,1.3419481735794935e-05,6.551024160427225e-05];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

私が実行した環境では、8番のノード(グラフでは9番)がエネルギー極大値を示していた。
今回はエネルギー極大値を示すノードを遷移状態構造を求めるための初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`binap_insertion_traj_8.xyz`
```
98
0 1
C      -4.652080157449     -0.914657762190      2.199198219157
C      -3.328038487011     -1.111242535513      1.932774739021
C      -2.417944269543     -0.021268536405      1.880658005430
C      -2.928959344848      1.274788523020      2.114821659432
C      -4.310075793626      1.452862396118      2.377402426080
C      -5.156203462497      0.385084723307      2.421121046060
H      -5.323968821104     -1.762908388736      2.234932800432
H      -2.964871433614     -2.113490730681      1.750970122452
C      -1.025498892372     -0.199165457097      1.582971911774
C      -2.040295460519      2.372078616066      2.092174141575
H      -4.677637900430      2.458211983106      2.547129598702
H      -6.209112545806      0.528445781197      2.627179244723
C      -0.717662763563      2.186917408845      1.834701330786
C      -0.185082564548      0.900213852535      1.560382631609
H      -2.424742300665      3.365806152870      2.291931683184
H      -0.058916734540      3.042652313122      1.843972109820
C      -0.565313895426     -1.608248140334      1.321602269171
C      -0.489363701464     -2.516079138828      2.428318586462
C      -0.287304866804     -2.075070244641      0.051769885483
C      -0.127433925078     -3.865498997912      2.209781835803
C       0.080395335580     -3.430361168085     -0.149149767075
C      -0.698271939189     -2.990517119807      4.795117964383
C      -0.056447053072     -4.759547951796      3.304992964315
C       0.155968086833     -4.298920965464      0.893615529027
H       0.299193083846     -3.774524013198     -1.151248213248
C      -0.338026637552     -4.335858388101      4.570250879723
H      -0.912220245025     -2.654680842631      5.801816033626
H       0.225049685457     -5.788514435697      3.114186425765
H       0.431407296014     -5.333638590639      0.726638286826
H      -0.284766057149     -5.026509681189      5.401927943837
P      -0.074848883862     -0.914723770660     -1.341281099592
P       1.584945814539      0.738345741240      1.047850347790
Rh      1.926000608276      0.203074480178     -1.183718425235
H       1.180230127872      1.097477038600     -2.301870134117
C      -0.767693144570     -2.106515979197      3.757286113281
H      -1.032282943557     -1.074397497721      3.944195038029
C       3.355098539202     -1.108162969869     -1.217683073880
O       4.293881005362     -1.758699059880     -1.315669961685
C       3.153797688709      1.737703975516     -2.085362358611
H       3.084650610732      2.721608790652     -1.634002356059
H       4.173999329457      1.454005454570     -2.317467770166
C       2.164915371789      1.364699173230     -3.095492418248
H       2.485534623136      0.556230125362     -3.746782916255
C       1.141686374980      2.196842799680     -3.828060216067
C       0.872216259890      3.530328255269     -3.552342395000
C       0.326094460027      1.512895296902     -4.732743639802
C      -0.198291023573      4.167889654219     -4.171908679427
H       1.490324307888      4.064477434096     -2.840403712181
C      -0.737501843979      2.147492142266     -5.348652148326
H       0.511441524083      0.458493991330     -4.918757725029
C      -1.006320574192      3.481565415393     -5.066211768477
H      -0.403344780024      5.207745533701     -3.950010038328
H      -1.366419922760      1.596745530889     -6.037754680992
H      -1.841676396357      3.979499894290     -5.541045687665
C       2.137102792222     -0.383990659237      2.393191883406
C       1.888018259860     -0.056868943695      3.728281962493
C       2.744240580801     -1.597816141092      2.102117163776
C       2.267915447711     -0.913321541831      4.746663983124
H       1.388085253479      0.875119707883      3.969311280375
C       3.105985961205     -2.470085135122      3.122090246517
H       2.908261082446     -1.878917096242      1.071478790875
C       2.875563387435     -2.126139080787      4.443638958624
H       2.072511995157     -0.646851258557      5.778028610598
H       3.563590015652     -3.420445583069      2.878228711968
H       3.156376527140     -2.805069168522      5.238828454550
C       2.358474919275      2.333634315479      1.510159151610
C       3.341155831300      2.470322141609      2.484225731837
C       2.044008470511      3.442982490242      0.720514976469
C       3.970926811544      3.693519769402      2.686294341263
H       3.637247419303      1.621183860599      3.084070397242
C       2.651416220020      4.666741431310      0.937540892623
H       1.324185314681      3.325576976715     -0.083594424582
C       3.621222329331      4.795576440678      1.925540687344
H       4.740151646360      3.777433688699      3.443429634133
H       2.384259044906      5.518417682952      0.324808186884
H       4.110182474619      5.747271519476      2.088307952580
C      -0.194712906052     -1.902085610031     -2.893841396371
C      -1.323524908372     -1.926926265659     -3.711344294970
C       0.961346087324     -2.543690181048     -3.344287964573
C      -1.299971840796     -2.590142024570     -4.932322323081
H      -2.224654818027     -1.407753224353     -3.418396919895
C       0.982275833770     -3.215871709895     -4.555343098207
H       1.860692167125     -2.491972521853     -2.744976515089
C      -0.151648302761     -3.239236085780     -5.356479798239
H      -2.185171155520     -2.588869248096     -5.555941678801
H       1.891500154219     -3.704574041943     -4.881110484912
H      -0.134577532849     -3.749693425619     -6.310915595771
C      -1.659187049100      0.000807631152     -1.379324426710
C      -2.866735057432     -0.674193298105     -1.192697217031
C      -1.683525303702      1.366573886882     -1.634143271967
C      -4.072775740531      0.002205609067     -1.262322546338
H      -2.860059143009     -1.737251045630     -0.976666186235
C      -2.892996212177      2.046520951715     -1.708387153679
H      -0.751992059131      1.903951231199     -1.765137979847
C      -4.086898445146      1.367054542552     -1.521733496528
H      -5.000248783889     -0.531973422705     -1.099077378210
H      -2.896661178418      3.110149689918     -1.910915136560
H      -5.029566958390      1.897713034613     -1.571845298985
```


<MoleculeViewer 
  xyzData={`98
0 1
C      -4.652080157449     -0.914657762190      2.199198219157
C      -3.328038487011     -1.111242535513      1.932774739021
C      -2.417944269543     -0.021268536405      1.880658005430
C      -2.928959344848      1.274788523020      2.114821659432
C      -4.310075793626      1.452862396118      2.377402426080
C      -5.156203462497      0.385084723307      2.421121046060
H      -5.323968821104     -1.762908388736      2.234932800432
H      -2.964871433614     -2.113490730681      1.750970122452
C      -1.025498892372     -0.199165457097      1.582971911774
C      -2.040295460519      2.372078616066      2.092174141575
H      -4.677637900430      2.458211983106      2.547129598702
H      -6.209112545806      0.528445781197      2.627179244723
C      -0.717662763563      2.186917408845      1.834701330786
C      -0.185082564548      0.900213852535      1.560382631609
H      -2.424742300665      3.365806152870      2.291931683184
H      -0.058916734540      3.042652313122      1.843972109820
C      -0.565313895426     -1.608248140334      1.321602269171
C      -0.489363701464     -2.516079138828      2.428318586462
C      -0.287304866804     -2.075070244641      0.051769885483
C      -0.127433925078     -3.865498997912      2.209781835803
C       0.080395335580     -3.430361168085     -0.149149767075
C      -0.698271939189     -2.990517119807      4.795117964383
C      -0.056447053072     -4.759547951796      3.304992964315
C       0.155968086833     -4.298920965464      0.893615529027
H       0.299193083846     -3.774524013198     -1.151248213248
C      -0.338026637552     -4.335858388101      4.570250879723
H      -0.912220245025     -2.654680842631      5.801816033626
H       0.225049685457     -5.788514435697      3.114186425765
H       0.431407296014     -5.333638590639      0.726638286826
H      -0.284766057149     -5.026509681189      5.401927943837
P      -0.074848883862     -0.914723770660     -1.341281099592
P       1.584945814539      0.738345741240      1.047850347790
Rh      1.926000608276      0.203074480178     -1.183718425235
H       1.180230127872      1.097477038600     -2.301870134117
C      -0.767693144570     -2.106515979197      3.757286113281
H      -1.032282943557     -1.074397497721      3.944195038029
C       3.355098539202     -1.108162969869     -1.217683073880
O       4.293881005362     -1.758699059880     -1.315669961685
C       3.153797688709      1.737703975516     -2.085362358611
H       3.084650610732      2.721608790652     -1.634002356059
H       4.173999329457      1.454005454570     -2.317467770166
C       2.164915371789      1.364699173230     -3.095492418248
H       2.485534623136      0.556230125362     -3.746782916255
C       1.141686374980      2.196842799680     -3.828060216067
C       0.872216259890      3.530328255269     -3.552342395000
C       0.326094460027      1.512895296902     -4.732743639802
C      -0.198291023573      4.167889654219     -4.171908679427
H       1.490324307888      4.064477434096     -2.840403712181
C      -0.737501843979      2.147492142266     -5.348652148326
H       0.511441524083      0.458493991330     -4.918757725029
C      -1.006320574192      3.481565415393     -5.066211768477
H      -0.403344780024      5.207745533701     -3.950010038328
H      -1.366419922760      1.596745530889     -6.037754680992
H      -1.841676396357      3.979499894290     -5.541045687665
C       2.137102792222     -0.383990659237      2.393191883406
C       1.888018259860     -0.056868943695      3.728281962493
C       2.744240580801     -1.597816141092      2.102117163776
C       2.267915447711     -0.913321541831      4.746663983124
H       1.388085253479      0.875119707883      3.969311280375
C       3.105985961205     -2.470085135122      3.122090246517
H       2.908261082446     -1.878917096242      1.071478790875
C       2.875563387435     -2.126139080787      4.443638958624
H       2.072511995157     -0.646851258557      5.778028610598
H       3.563590015652     -3.420445583069      2.878228711968
H       3.156376527140     -2.805069168522      5.238828454550
C       2.358474919275      2.333634315479      1.510159151610
C       3.341155831300      2.470322141609      2.484225731837
C       2.044008470511      3.442982490242      0.720514976469
C       3.970926811544      3.693519769402      2.686294341263
H       3.637247419303      1.621183860599      3.084070397242
C       2.651416220020      4.666741431310      0.937540892623
H       1.324185314681      3.325576976715     -0.083594424582
C       3.621222329331      4.795576440678      1.925540687344
H       4.740151646360      3.777433688699      3.443429634133
H       2.384259044906      5.518417682952      0.324808186884
H       4.110182474619      5.747271519476      2.088307952580
C      -0.194712906052     -1.902085610031     -2.893841396371
C      -1.323524908372     -1.926926265659     -3.711344294970
C       0.961346087324     -2.543690181048     -3.344287964573
C      -1.299971840796     -2.590142024570     -4.932322323081
H      -2.224654818027     -1.407753224353     -3.418396919895
C       0.982275833770     -3.215871709895     -4.555343098207
H       1.860692167125     -2.491972521853     -2.744976515089
C      -0.151648302761     -3.239236085780     -5.356479798239
H      -2.185171155520     -2.588869248096     -5.555941678801
H       1.891500154219     -3.704574041943     -4.881110484912
H      -0.134577532849     -3.749693425619     -6.310915595771
C      -1.659187049100      0.000807631152     -1.379324426710
C      -2.866735057432     -0.674193298105     -1.192697217031
C      -1.683525303702      1.366573886882     -1.634143271967
C      -4.072775740531      0.002205609067     -1.262322546338
H      -2.860059143009     -1.737251045630     -0.976666186235
C      -2.892996212177      2.046520951715     -1.708387153679
H      -0.751992059131      1.903951231199     -1.765137979847
C      -4.086898445146      1.367054542552     -1.521733496528
H      -5.000248783889     -0.531973422705     -1.099077378210
H      -2.896661178418      3.110149689918     -1.910915136560
H      -5.029566958390      1.897713034613     -1.571845298985
`}
  caption="NEB法により緩和したパスのエネルギー極大値を示す構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`binap_insertion_traj_8.xyz`を`MultiOptPy-v1.12`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py binap_insertion_traj_8.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた構造を以下に示す。


(実行して得られた構造は`binap_insertion_traj_8_optimized.xyz`として保存されている。)

```
98
OptimizedStructure
C     -4.701034842399     -1.335891417737      2.215698901976
C     -3.376057843406     -1.442032441829      1.906796320042
C     -2.557053277763     -0.288071007482      1.778624956272
C     -3.155410847146      0.974312748917      1.986039637517
C     -4.535967674280      1.057144686415      2.295277012404
C     -5.294900801908     -0.069691797259      2.408620627787
H     -5.304373838316     -2.230172997112      2.307729383506
H     -2.942287279896     -2.420164415254      1.748444968452
C     -1.168597871853     -0.370916737082      1.432259357175
C     -2.352239184683      2.132121593423      1.889044128306
H     -4.974591819947      2.037173292471      2.442670990094
H     -6.348201670958      0.001411010822      2.647909854739
C     -1.031782317501      2.036468624875      1.575120355228
C     -0.416581118607      0.782582881651      1.322762719629
H     -2.801185595248      3.101407242529      2.073454909622
H     -0.440705932622      2.938454998054      1.522645080227
C     -0.601864148040     -1.749673159577      1.250797221726
C     -0.413095151983     -2.541763963087      2.431220715887
C     -0.338628615666     -2.299008351501      0.011089272121
C      0.033254366643     -3.877625889501      2.319806113304
C      0.098673927228     -3.646600578812     -0.078453888645
C     -0.480244029163     -2.801525308174      4.840096074881
C      0.218499675949     -4.657477702961      3.487716582996
C      0.276041096622     -4.410372376970      1.033390351519
H      0.283390770712     -4.081651501189     -1.049757031304
C     -0.033986135254     -4.134915472111      4.721580252970
H     -0.671699597954     -2.386195738363      5.821463129647
H      0.563724447863     -5.678860867899      3.378656483864
H      0.602588552031     -5.439812764987      0.942812493559
H      0.107412264012     -4.736983451667      5.609989009316
P     -0.264018665847     -1.241398752612     -1.493611538931
P      1.337815293053      0.695346895658      0.754511625856
Rh     1.692310436226     -0.049134790591     -1.430227056550
H      0.915107189445      1.027060716893     -2.312902751186
C     -0.661488790240     -2.027654726881      3.730755812030
H     -0.991227461773     -1.003237851108      3.838779546170
C      2.927105531003     -1.502664222774     -1.486706454720
O      3.741854081180     -2.307204193148     -1.559211748879
C      3.314146143724      1.274416011512     -1.945370746804
H      3.466693910227      2.073669737744     -1.229620641290
H      4.207608335051      0.710746206816     -2.183089404559
C      2.346936362998      1.461278812888     -2.974181634886
H      2.479196353545      0.868402399113     -3.873881028867
C      1.740388853544      2.804601162570     -3.283346381249
C      2.482295057253      3.966562044305     -3.104757266771
C      0.460241189111      2.911012684969     -3.826727625400
C      1.952924243803      5.206672724050     -3.441262775545
H      3.482678250186      3.898815867897     -2.696490874267
C     -0.070226094442      4.145225965756     -4.164662376527
H     -0.126097323508      2.011065804021     -3.979868993633
C      0.674187984947      5.302254273840     -3.966413520096
H      2.546368488504      6.100405059960     -3.291558379907
H     -1.067045869893      4.205590824315     -4.583710501575
H      0.260623509197      6.268214693526     -4.226257284285
C      2.052014288720     -0.201364786641      2.184243806940
C      1.801814666963      0.224925318128      3.489682586246
C      2.795019848070     -1.357036744470      1.984163548097
C      2.300450845357     -0.482324258596      4.569579134676
H      1.205485494626      1.115175617350      3.658757718503
C      3.278839658755     -2.081077973657      3.067560478751
H      2.977362424929     -1.704772241284      0.976787538319
C      3.035685383016     -1.643050005258      4.358996249694
H      2.099958026432     -0.141552469252      5.577718752212
H      3.842144222743     -2.989817535616      2.897566966800
H      3.409537194929     -2.207984819976      5.203551930455
C      1.957061736744      2.402794106070      0.990733641418
C      2.969977184793      2.738057114142      1.885074743696
C      1.475771819894      3.390470555026      0.127902802459
C      3.463590579385      4.036337793803      1.938732205982
H      3.389347375749      1.986697082175      2.539853820165
C      1.948638897634      4.689846604216      0.198707940513
H      0.731451795567      3.132655760541     -0.618542954732
C      2.946287992551      5.017463225875      1.108322771980
H      4.255780664064      4.276853339373      2.636386390374
H      1.553469374744      5.438802242829     -0.475248429323
H      3.327041429275      6.029618963187      1.157820458012
C     -0.435467440646     -2.385495942993     -2.928905700800
C     -1.561511853949     -2.411995946828     -3.749189499747
C      0.656597056896     -3.179784024820     -3.289739692070
C     -1.605570673620     -3.227851610105     -4.873487019372
H     -2.412121685201     -1.783107780828     -3.531935732122
C      0.607161465521     -4.006987274936     -4.398990886293
H      1.565739029060     -3.145092979443     -2.706513971111
C     -0.528516486234     -4.035071924294     -5.197059798421
H     -2.489406685325     -3.223713015021     -5.498656849801
H      1.465751636833     -4.616858593211     -4.649223092803
H     -0.565088503996     -4.670655280060     -6.072378363696
C     -1.884314997298     -0.398699881829     -1.482926226525
C     -3.054595282867     -1.129325129700     -1.275146916602
C     -1.971699382270      0.974588029354     -1.674410917044
C     -4.287654931227     -0.499605128222     -1.272421490050
H     -2.998004820195     -2.198577101254     -1.102183391488
C     -3.206842936779      1.609011967584     -1.666516085064
H     -1.063739108713      1.549722814702     -1.807285208152
C     -4.365249748341      0.873537170436     -1.467842476931
H     -5.186957290907     -1.076450162654     -1.098147350067
H     -3.258483060469      2.681768981647     -1.805157299259
H     -5.328227718977      1.368209437185     -1.453928116766
```

<MoleculeViewer 
  xyzData={`98
OptimizedStructure
C     -4.701034842399     -1.335891417737      2.215698901976
C     -3.376057843406     -1.442032441829      1.906796320042
C     -2.557053277763     -0.288071007482      1.778624956272
C     -3.155410847146      0.974312748917      1.986039637517
C     -4.535967674280      1.057144686415      2.295277012404
C     -5.294900801908     -0.069691797259      2.408620627787
H     -5.304373838316     -2.230172997112      2.307729383506
H     -2.942287279896     -2.420164415254      1.748444968452
C     -1.168597871853     -0.370916737082      1.432259357175
C     -2.352239184683      2.132121593423      1.889044128306
H     -4.974591819947      2.037173292471      2.442670990094
H     -6.348201670958      0.001411010822      2.647909854739
C     -1.031782317501      2.036468624875      1.575120355228
C     -0.416581118607      0.782582881651      1.322762719629
H     -2.801185595248      3.101407242529      2.073454909622
H     -0.440705932622      2.938454998054      1.522645080227
C     -0.601864148040     -1.749673159577      1.250797221726
C     -0.413095151983     -2.541763963087      2.431220715887
C     -0.338628615666     -2.299008351501      0.011089272121
C      0.033254366643     -3.877625889501      2.319806113304
C      0.098673927228     -3.646600578812     -0.078453888645
C     -0.480244029163     -2.801525308174      4.840096074881
C      0.218499675949     -4.657477702961      3.487716582996
C      0.276041096622     -4.410372376970      1.033390351519
H      0.283390770712     -4.081651501189     -1.049757031304
C     -0.033986135254     -4.134915472111      4.721580252970
H     -0.671699597954     -2.386195738363      5.821463129647
H      0.563724447863     -5.678860867899      3.378656483864
H      0.602588552031     -5.439812764987      0.942812493559
H      0.107412264012     -4.736983451667      5.609989009316
P     -0.264018665847     -1.241398752612     -1.493611538931
P      1.337815293053      0.695346895658      0.754511625856
Rh     1.692310436226     -0.049134790591     -1.430227056550
H      0.915107189445      1.027060716893     -2.312902751186
C     -0.661488790240     -2.027654726881      3.730755812030
H     -0.991227461773     -1.003237851108      3.838779546170
C      2.927105531003     -1.502664222774     -1.486706454720
O      3.741854081180     -2.307204193148     -1.559211748879
C      3.314146143724      1.274416011512     -1.945370746804
H      3.466693910227      2.073669737744     -1.229620641290
H      4.207608335051      0.710746206816     -2.183089404559
C      2.346936362998      1.461278812888     -2.974181634886
H      2.479196353545      0.868402399113     -3.873881028867
C      1.740388853544      2.804601162570     -3.283346381249
C      2.482295057253      3.966562044305     -3.104757266771
C      0.460241189111      2.911012684969     -3.826727625400
C      1.952924243803      5.206672724050     -3.441262775545
H      3.482678250186      3.898815867897     -2.696490874267
C     -0.070226094442      4.145225965756     -4.164662376527
H     -0.126097323508      2.011065804021     -3.979868993633
C      0.674187984947      5.302254273840     -3.966413520096
H      2.546368488504      6.100405059960     -3.291558379907
H     -1.067045869893      4.205590824315     -4.583710501575
H      0.260623509197      6.268214693526     -4.226257284285
C      2.052014288720     -0.201364786641      2.184243806940
C      1.801814666963      0.224925318128      3.489682586246
C      2.795019848070     -1.357036744470      1.984163548097
C      2.300450845357     -0.482324258596      4.569579134676
H      1.205485494626      1.115175617350      3.658757718503
C      3.278839658755     -2.081077973657      3.067560478751
H      2.977362424929     -1.704772241284      0.976787538319
C      3.035685383016     -1.643050005258      4.358996249694
H      2.099958026432     -0.141552469252      5.577718752212
H      3.842144222743     -2.989817535616      2.897566966800
H      3.409537194929     -2.207984819976      5.203551930455
C      1.957061736744      2.402794106070      0.990733641418
C      2.969977184793      2.738057114142      1.885074743696
C      1.475771819894      3.390470555026      0.127902802459
C      3.463590579385      4.036337793803      1.938732205982
H      3.389347375749      1.986697082175      2.539853820165
C      1.948638897634      4.689846604216      0.198707940513
H      0.731451795567      3.132655760541     -0.618542954732
C      2.946287992551      5.017463225875      1.108322771980
H      4.255780664064      4.276853339373      2.636386390374
H      1.553469374744      5.438802242829     -0.475248429323
H      3.327041429275      6.029618963187      1.157820458012
C     -0.435467440646     -2.385495942993     -2.928905700800
C     -1.561511853949     -2.411995946828     -3.749189499747
C      0.656597056896     -3.179784024820     -3.289739692070
C     -1.605570673620     -3.227851610105     -4.873487019372
H     -2.412121685201     -1.783107780828     -3.531935732122
C      0.607161465521     -4.006987274936     -4.398990886293
H      1.565739029060     -3.145092979443     -2.706513971111
C     -0.528516486234     -4.035071924294     -5.197059798421
H     -2.489406685325     -3.223713015021     -5.498656849801
H      1.465751636833     -4.616858593211     -4.649223092803
H     -0.565088503996     -4.670655280060     -6.072378363696
C     -1.884314997298     -0.398699881829     -1.482926226525
C     -3.054595282867     -1.129325129700     -1.275146916602
C     -1.971699382270      0.974588029354     -1.674410917044
C     -4.287654931227     -0.499605128222     -1.272421490050
H     -2.998004820195     -2.198577101254     -1.102183391488
C     -3.206842936779      1.609011967584     -1.666516085064
H     -1.063739108713      1.549722814702     -1.807285208152
C     -4.365249748341      0.873537170436     -1.467842476931
H     -5.186957290907     -1.076450162654     -1.098147350067
H     -3.258483060469      2.681768981647     -1.805157299259
H     -5.328227718977      1.368209437185     -1.453928116766
`}
  caption="収束構造"
  backgroundColor="#333333"
/>



220回程度の反復計算で収束した。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```

Mode                                 0                   1                   2
Freq [cm^-1]                     -926.8265             18.5700             23.3565
Reduced mass [au]                   1.1632              5.5848              4.7423
Force const [Dyne/A]               -0.5887              0.0011              0.0015
Char temp [K]                       0.0000             26.7182             33.6048
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00009   -0.00003   -0.00000    0.00190   -0.00205   -0.00128    0.00020    0.00066    0.01187
       C                 0.00007   -0.00001    0.00009    0.00241   -0.00235    0.00098    0.00049    0.00040    0.01325
       C                 0.00024    0.00002    0.00039    0.00349   -0.00265    0.00496   -0.00151    0.00076    0.00371
       C                 0.00008   -0.00003    0.00001    0.00419   -0.00274    0.00744   -0.00377    0.00141   -0.00739
       C                 0.00007    0.00005   -0.00002    0.00377   -0.00243    0.00543   -0.00402    0.00163   -0.00856
       C                 0.00014    0.00002   -0.00001    0.00254   -0.00205    0.00088   -0.00215    0.00132    0.00079
       H                 0.00012    0.00000   -0.00012    0.00105   -0.00181   -0.00446    0.00177    0.00038    0.01944
       H                -0.00007   -0.00007    0.00018    0.00187   -0.00236   -0.00042    0.00229   -0.00018    0.02181
       C                 0.00021   -0.00007   -0.00053    0.00331   -0.00277    0.00439   -0.00192    0.00048    0.00276
       C                 0.00025   -0.00001    0.00024    0.00492   -0.00297    0.01082   -0.00626    0.00214   -0.01906
       H                 0.00016    0.00005   -0.00016    0.00436   -0.00245    0.00726   -0.00582    0.00215   -0.01738
       H                 0.00011    0.00006   -0.00014    0.00215   -0.00180   -0.00094   -0.00238    0.00151   -0.00030
       C                -0.00006   -0.00015   -0.00063    0.00502   -0.00311    0.01148   -0.00607    0.00193   -0.01794
       C                -0.00014   -0.00006   -0.00346    0.00403   -0.00287    0.00804   -0.00346    0.00075   -0.00589
       H                 0.00066    0.00009    0.00035    0.00529   -0.00314    0.01257   -0.00846    0.00304   -0.02921
       H                 0.00011   -0.00030   -0.00138    0.00572   -0.00341    0.01399   -0.00834    0.00283   -0.02705
       C                 0.00028    0.00011   -0.00002    0.00071   -0.00288   -0.00377    0.00211    0.00243    0.00359
       C                 0.00004    0.00018    0.00006    0.00221   -0.01061   -0.00934    0.00262   -0.00018    0.00216
       C                 0.00129    0.00119   -0.00030   -0.00330    0.00401   -0.00757    0.01167    0.00852    0.00297
       C                -0.00000    0.00004    0.00014   -0.00088   -0.01092   -0.01894    0.01979    0.00578    0.00012
       C                 0.00054    0.00006   -0.00011   -0.00564    0.00387   -0.01756    0.03326    0.01541    0.00149
       C                 0.00001   -0.00003    0.00001    0.01097   -0.02441   -0.01073   -0.02112   -0.01434    0.00028
       C                -0.00004    0.00001   -0.00010    0.00154   -0.01817   -0.02421    0.01750    0.00207   -0.00202
       C                -0.00004    0.00007   -0.00030   -0.00491   -0.00355   -0.02284    0.03857    0.01467   -0.00007
       H                -0.00082    0.00019   -0.00040   -0.00687    0.01087   -0.02112    0.04720    0.02171    0.00121
       C                -0.00004    0.00005   -0.00000    0.00749   -0.02472   -0.02019   -0.00327   -0.00809   -0.00195
       H                 0.00020    0.00002   -0.00002    0.01590   -0.02964   -0.00755   -0.03804   -0.02222    0.00032
       H                 0.00004    0.00003   -0.00004   -0.00109   -0.01828   -0.03142    0.03151    0.00700   -0.00386
       H                -0.00096   -0.00024   -0.00028   -0.00655   -0.00345   -0.02986    0.05582    0.02027   -0.00144
       H                 0.00005    0.00007   -0.00004    0.00967   -0.03016   -0.02422   -0.00611   -0.01137   -0.00372
       P                 0.00339   -0.00259   -0.00254    0.00391    0.01225   -0.00059    0.00093    0.00450   -0.00129
       P                 0.00461   -0.00213    0.00419    0.00528   -0.00260    0.01207   -0.00271    0.00204   -0.00544
      Rh                -0.00749    0.00384   -0.00611    0.01112   -0.00015    0.01416    0.00141    0.00736   -0.00911
       H                -0.67636   -0.11937    0.60579    0.01504    0.00486    0.01987    0.00487    0.00379   -0.01740
       C                 0.00001    0.00010    0.00003    0.00798   -0.01765   -0.00556   -0.01676   -0.01016    0.00243
       H                 0.00013    0.00012    0.00038    0.01042   -0.01758    0.00141   -0.03014   -0.01471    0.00459
       C                 0.01053    0.00069    0.02611    0.01161   -0.00164    0.02579    0.00448    0.01107   -0.01321
       O                -0.00052   -0.00249   -0.00733    0.00868   -0.00518    0.03407    0.00918    0.01626   -0.01956
       C                 0.01154    0.01999   -0.02425    0.00094    0.00949    0.00444    0.00566    0.00622    0.00477
       H                -0.00557   -0.00174    0.00137   -0.00663    0.01726   -0.00268    0.00087    0.00474    0.00736
       H                -0.01698   -0.06235    0.06407    0.00662    0.01617    0.00991    0.00728    0.00630    0.01058
       C                 0.08832    0.01110   -0.01923    0.00067   -0.00942    0.00052    0.01391    0.00887   -0.00232
       H                 0.00473   -0.02800    0.00053    0.00641   -0.02045    0.00861    0.02038    0.01021   -0.00220
       C                -0.00331   -0.01715    0.01432   -0.01675   -0.02234   -0.02068    0.01735    0.00963   -0.00496
       C                -0.00312   -0.00371    0.00213   -0.05453   -0.00239    0.00344    0.01203    0.01026    0.01325
       C                -0.00055   -0.00619    0.00207   -0.00149   -0.05817   -0.06451    0.02619    0.00980   -0.02589
       C                 0.00032   -0.00260    0.00038   -0.07759   -0.01730   -0.01642    0.01512    0.01091    0.01061
       H                -0.00080   -0.00320   -0.00494   -0.06630    0.02579    0.03688    0.00557    0.01043    0.02904
       C                 0.00143   -0.00218    0.00147   -0.02333   -0.07373   -0.08570    0.02965    0.01034   -0.02914
       H                 0.00194   -0.00457   -0.00496    0.02798   -0.07470   -0.08091    0.03062    0.00928   -0.03990
       C                -0.00038   -0.00101    0.00035   -0.06159   -0.05308   -0.06159    0.02396    0.01089   -0.01083
       H                 0.00326   -0.00375   -0.00320   -0.10718   -0.00075    0.00224    0.01090    0.01133    0.02485
       H                 0.00212   -0.00272   -0.00075   -0.01045   -0.10168   -0.12031    0.03672    0.01045   -0.04591
       H                 0.00021   -0.00141   -0.00253   -0.07862   -0.06477   -0.07789    0.02649    0.01130   -0.01329
       C                 0.00007    0.00036    0.00295   -0.00067   -0.00013    0.01684   -0.00217   -0.00938   -0.01290
       C                 0.00044   -0.00046    0.00160   -0.00237    0.00610    0.01461   -0.02146   -0.03482   -0.00841
       C                -0.00027    0.00023    0.00083   -0.00511   -0.00405    0.02354    0.02221    0.00814   -0.02442
       C                 0.00010   -0.00024    0.00115   -0.00731    0.00907    0.01878   -0.01840   -0.04315   -0.01521
       H                 0.00044    0.00001    0.00048    0.00055    0.00901    0.00951   -0.04006   -0.04898    0.00058
       C                 0.00015   -0.00007    0.00020   -0.01052   -0.00141    0.02786    0.02623    0.00011   -0.03178
       H                -0.00256    0.00087    0.00036   -0.00422   -0.00949    0.02558    0.03877    0.02792   -0.02797
       C                 0.00013   -0.00006    0.00028   -0.01121    0.00534    0.02537    0.00525   -0.02590   -0.02685
       H                 0.00052   -0.00115    0.00160   -0.00801    0.01441    0.01683   -0.03496   -0.06365   -0.01157
       H                -0.00013   -0.00042    0.00052   -0.01405   -0.00455    0.03302    0.04554    0.01387   -0.04141
       H                 0.00004   -0.00036    0.00017   -0.01503    0.00763    0.02859    0.00748   -0.03274   -0.03243
       C                -0.00067   -0.00071   -0.00159    0.00461   -0.00219    0.01192   -0.00522    0.00110    0.01061
       C                -0.00009   -0.00024   -0.00049    0.00458   -0.00197    0.01178   -0.03175    0.00380    0.03955
       C                -0.00088   -0.00025   -0.00072    0.00597   -0.00267    0.01052    0.01153    0.00155    0.00186
       C                -0.00024   -0.00056   -0.00008    0.00577   -0.00233    0.01060   -0.04191    0.00688    0.05858
       H                -0.00073   -0.00037   -0.00026    0.00387   -0.00160    0.01266   -0.04467    0.00401    0.04795
       C                 0.00040   -0.00004   -0.00004    0.00718   -0.00308    0.00923    0.00138    0.00432    0.01984
       H                -0.00051    0.00223   -0.00115    0.00623   -0.00301    0.01029    0.03220   -0.00058   -0.01805
       C                -0.00012   -0.00003   -0.00022    0.00704   -0.00279    0.00936   -0.02570    0.00696    0.04859
       H                -0.00081   -0.00052    0.00058    0.00577   -0.00235    0.01059   -0.06259    0.00922    0.08127
       H                 0.00064   -0.00032   -0.00050    0.00796   -0.00339    0.00837    0.01450    0.00466    0.01249
       H                -0.00043    0.00009    0.00026    0.00784   -0.00305    0.00841   -0.03375    0.00927    0.06339
       C                -0.00102   -0.00103   -0.00017   -0.00223    0.01946   -0.00576   -0.01222   -0.00992    0.01033
       C                -0.00024   -0.00055    0.00018   -0.01292    0.00614    0.00935   -0.04014   -0.06005    0.05007
       C                -0.00041   -0.00012   -0.00020    0.00314    0.03392   -0.02095   -0.00133    0.01596   -0.01282
       C                 0.00019   -0.00002   -0.00044   -0.01708    0.00740    0.00864   -0.05556   -0.08441    0.06852
       H                 0.00018   -0.00042    0.00062   -0.01823   -0.00529    0.02155   -0.05121   -0.08090    0.06601
       C                -0.00001   -0.00007    0.00034   -0.00057    0.03521   -0.02184   -0.01528   -0.00776    0.00524
       H                 0.00065    0.00336   -0.00173    0.00953    0.04486   -0.03145    0.01720    0.05400   -0.04436
       C                -0.00023   -0.00002   -0.00014   -0.01064    0.02213   -0.00701   -0.04280   -0.05879    0.04657
       H                 0.00073    0.00075   -0.00129   -0.02539   -0.00329    0.02030   -0.07788   -0.12353    0.09982
       H                 0.00012    0.00015    0.00001    0.00392    0.04657   -0.03407   -0.00561    0.01320   -0.01267
       H                 0.00029    0.00046   -0.00049   -0.01388    0.02333   -0.00776   -0.05499   -0.07788    0.06094
       C                 0.00205    0.00291    0.00070    0.01061    0.02577   -0.00083    0.00279    0.00872    0.00080
       C                 0.00203    0.00006    0.00026    0.00454    0.03767    0.00752    0.00134    0.01796    0.02608
       C                -0.00329    0.00160    0.00035    0.02137    0.02478   -0.01351    0.00561    0.00466   -0.03053
       C                 0.00090   -0.00034   -0.00030    0.00976    0.04790    0.00364    0.00329    0.02175    0.01796
       H                 0.00208    0.00006    0.00002   -0.00423    0.03892    0.01801   -0.00123    0.02221    0.05294
       C                -0.00224   -0.00017    0.00017    0.02655    0.03506   -0.01823    0.00752    0.00864   -0.03908
       H                -0.01640    0.01586   -0.00330    0.02516    0.01690   -0.02156    0.00629   -0.00084   -0.04944
       C                -0.00102   -0.00038    0.00009    0.02076    0.04668   -0.00952    0.00629    0.01715   -0.01552
       H                 0.00152   -0.00150   -0.00092    0.00537    0.05692    0.01087    0.00271    0.02868    0.03798
       H                -0.00105   -0.00024   -0.00054    0.03552    0.03408   -0.02918    0.01028    0.00547   -0.06462
       H                -0.00165   -0.00159   -0.00021    0.02485    0.05476   -0.01305    0.00784    0.02039   -0.02264

(...snip...)
```
その結果、虚振動が１つであることが確認できた。

次に、`vibration_animation`内の`mode_1_927i_wave_number.xyz`をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。

しかしながら、併進と回転成分を取り除いたHessianを対角化して得られた固有値の数が3N-7個(Nは原子数)となっている。プログラムの仕様上絶対値が10の-7乗以下の固有値は表示しないようにしているため、一概には言えないが、これは1方向の振動成分だけ変曲点となってしまっていると考えられる。遷移状態構造の数学上の定義では、Hessianの対角化の結果得られる基準座標軸の振動成分の3N-7個の固有値が正で、それ以外の1つの振動基準座標軸の固有値が負であるため、この構造は遷移状態構造ではない可能性がある。

#### (参考) 固有値の出力
```   
EIGENVALUES (NORMAL COORDINATE, NUMBER OF VALUES: 287):
 -0.05960527   0.00007105   0.00010072   0.00014959   0.00030113   0.00034875
  0.00036409   0.00046487   0.00052390   0.00055622   0.00070454   0.00073631
  0.00088532   0.00108007   0.00124742   0.00137112   0.00156497   0.00167959
  0.00185812   0.00204794   0.00221454   0.00287879   0.00330543   0.00366285
  0.00376818   0.00409426   0.00445455   0.00481074   0.00603396   0.00677311
  0.00691017   0.00818705   0.00820222   0.00872553   0.00904190   0.00962469
  0.01019839   0.01100066   0.01120016   0.01296330   0.01356121   0.01414983
  0.01430057   0.01462908   0.01521286   0.01530458   0.01555828   0.01584977
  0.01610695   0.01908475   0.02189299   0.02240222   0.02260592   0.02454246
  0.02510114   0.02521396   0.02551398   0.02623489   0.02651059   0.02671383
  0.02712480   0.02767839   0.02904416   0.02959888   0.03130158   0.03466115
  0.03544397   0.03663528   0.03690939   0.03858008   0.04494079   0.04824115
  0.04950672   0.05112458   0.05125856   0.05137999   0.05140865   0.05152263
  0.05161149   0.05167144   0.05177024   0.05179154   0.05199209   0.05208595
  0.05248403   0.05294067   0.05380814   0.05427347   0.05627891   0.05652345
  0.05879119   0.06024862   0.06063754   0.06086329   0.06099988   0.06126150
  0.06176496   0.06182145   0.06764450   0.06893617   0.06973012   0.06983852
  0.07040997   0.07297081   0.07495903   0.07661101   0.07769523   0.08145955
  0.08424985   0.08534035   0.08737382   0.08857923   0.09151495   0.09313776
  0.09382463   0.09518820   0.09560076   0.09659229   0.09710758   0.09770840
  0.09829912   0.09886104   0.09978084   0.10060416   0.10069311   0.10168150
  0.10314446   0.10467308   0.10663254   0.10895397   0.11345480   0.11582852
  0.11694350   0.11777511   0.12151424   0.12337667   0.12509719   0.12854882
  0.13045348   0.13801521   0.14009413   0.15929202   0.16422519   0.17310925
  0.17664809   0.17809002   0.17942360   0.18411310   0.18466311   0.18561001
  0.18587275   0.18694690   0.18788352   0.18820652   0.19156026   0.19243082
  0.19620862   0.19688465   0.19813976   0.20162322   0.20206397   0.20279776
  0.20339678   0.20363406   0.20467079   0.20770966   0.20817172   0.21202023
  0.21795118   0.22216764   0.22571856   0.22644295   0.22729758   0.23561618
  0.24071291   0.24721835   0.25056275   0.25665962   0.25710026   0.26293946
  0.26553941   0.27591614   0.28352529   0.28735519   0.29531685   0.29763218
  0.29796024   0.29960029   0.30351713   0.30596694   0.32407131   0.32592014
  0.33125954   0.33535516   0.36720305   0.37692993   0.38017880   0.39042546
  0.40792636   0.41547393   0.42922907   0.43270952   0.44110708   0.44574505
  0.44626029   0.44762644   0.45474365   0.46478894   0.48171434   0.50616745
  0.54428511   0.58018094   0.58234400   0.59218177   0.59261607   0.59519692
  0.61581224   0.64328846   0.65460058   0.67703324   0.67730852   0.67839568
  0.67866881   0.68301580   0.69848593   0.70344840   0.71486577   0.73823446
  0.74030497   0.74053644   0.74474907   0.74672547   0.74895040   0.75829327
  0.83027789   0.83296126   0.85978792   0.86040762   0.86153088   0.86292502
  0.87969576   0.88857426   0.90236941   0.92377736   0.93525522   0.95625584
  0.97842549   0.98609194   0.99059024   0.99347309   0.99846236   1.00030309
  1.00808781   1.02593020   1.06188227   1.06675798   1.09078289   1.09136616
  1.09301152   1.09647973   1.09694895   1.09770032   1.09841947   1.11087901
  1.11514254   1.11918539   1.12032395   1.12258461   1.13914873   1.14380154
  1.25318733   1.25674304   1.26739528   1.27666604   1.27838981   1.27947087
  1.28035824   1.28240513   1.28375227   1.28543150   1.28877738   1.29045969
  1.30694946   1.31059084   1.34373442   1.34499455   2.12220459
```


## 終わりに
　
自作モジュールで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、(R)-BINAP-Rh系触媒によるヒドリド挿入反応(ヒドロホルミル化)のある1つの遷移状態構造を算出する試みについて説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作モジュールMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.

