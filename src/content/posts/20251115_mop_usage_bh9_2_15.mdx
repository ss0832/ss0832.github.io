---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(BH9データセットの2. Pericyclic, No. 15の化学反応, NNP(UMA)使用, 失敗例)
published: 2025-11-15
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-11-15

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、BH9データセットの2. Pericyclic, No. 15の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

BH9のデータセットについて:

- _J. Chem. Theory Comput._ 2022, 18, 1, 151–166 

https://doi.org/10.1021/acs.jctc.1c00694


この文献のSupporting Informationから、データセットの詳細を確認できる。

有機金属錯体が関わる反応を除いたさまざまなカテゴリの反応がまとめられたデータセットである。DFTの汎関数の電子エネルギーの精度の比較などのベンチマークに主に使われる。

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.19.6
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.19.6.zip
unzip v1.19.6.zip
cd MultiOptPy-v1.19.6
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.19.6 にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.19.6`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.19.6`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`bh9_2_15.xyz`とした。
初期構造は以下のものを使用した。

```
47
OptimizedStructure
C      0.797202073314      0.696543408864      0.579870571915
C      2.293693584592      0.790043401385      0.585802057530
C     -3.075464001001      0.463892839488     -1.660790601620
C      0.158936361251      1.882156626621     -0.130173426000
H      0.494983346798     -0.239377158406      0.091947662602
C     -1.339452743825      1.685501154940     -0.340238258929
H      0.333722290433      2.770582810071      0.481774968405
H      0.648619811402      2.047712316521     -1.093433288098
C     -1.628282528354      0.840764928609     -1.578291885527
H     -1.755688629814      1.184242672475      0.540290067260
C      3.103495718100     -0.131415036727      0.071416029793
C      4.558645337639     -0.030265347937      0.071999652923
C     -3.692171881604     -0.585484551875     -1.109299506619
C      5.371994043714     -0.954268586908     -0.434902889371
H     -1.362560304540      1.441933074109     -2.451070019818
H     -0.995384475228     -0.043642659284     -1.559646291000
C      6.862467431080     -0.842444531125     -0.432769656781
H      7.310566496429     -1.687797398485      0.091634524198
H      7.168210303047      0.072613005420      0.086457129154
C     -2.933490088753     -1.577075853682     -0.300368626352
C     -3.033686635686     -3.649551385682      0.784612552536
H     -3.768968633523     -4.433550912900      0.936436805290
H     -2.716810817258     -3.231821274384      1.738939904139
H     -2.161252659630     -4.038868427956      0.262499462161
O     -3.687130341238     -2.652363458306     -0.005351946884
O      0.288216987257      0.707266695694      1.910756983533
O     -2.006593558519      2.927880863230     -0.534070238321
O     -1.788604150616     -1.475710825598      0.078631359144
O      7.405621735817     -0.891270708450     -1.748876603741
H      6.975613521561     -0.206425988734     -2.271016925036
C      0.464836277877     -0.526815837932      2.577371140586
H     -0.055138344530     -1.330263442808      2.045611056322
H      1.524355320127     -0.786429017122      2.672377841570
H      0.037380204111     -0.415855437686      3.572075937085
C     -2.329442335193      3.576453293777      0.675420895291
H     -2.801825680749      4.522935769587      0.419820096284
H     -3.026350719422      2.974603798482      1.269797328771
H     -1.442785083467      3.777498822027      1.285730264089
C     -5.168989109459     -0.817674074689     -1.282498871386
H     -5.364079862135     -1.757426511683     -1.800000697057
H     -5.677206275873     -0.875461557441     -0.319129796327
H     -5.608945742178     -0.004899673537     -1.858033192938
H      4.957091680144     -1.843816447261     -0.901981732319
H      4.985216004146      0.860184347907      0.528508367556
H      2.710339075940      1.679283241556      1.054846289715
H      2.674561330722     -1.021523431139     -0.383416016566
H     -3.705464332906      1.149406466971     -2.219268477160
```

<MoleculeViewer 
  xyzData={`47
OptimizedStructure
C      0.797202073314      0.696543408864      0.579870571915
C      2.293693584592      0.790043401385      0.585802057530
C     -3.075464001001      0.463892839488     -1.660790601620
C      0.158936361251      1.882156626621     -0.130173426000
H      0.494983346798     -0.239377158406      0.091947662602
C     -1.339452743825      1.685501154940     -0.340238258929
H      0.333722290433      2.770582810071      0.481774968405
H      0.648619811402      2.047712316521     -1.093433288098
C     -1.628282528354      0.840764928609     -1.578291885527
H     -1.755688629814      1.184242672475      0.540290067260
C      3.103495718100     -0.131415036727      0.071416029793
C      4.558645337639     -0.030265347937      0.071999652923
C     -3.692171881604     -0.585484551875     -1.109299506619
C      5.371994043714     -0.954268586908     -0.434902889371
H     -1.362560304540      1.441933074109     -2.451070019818
H     -0.995384475228     -0.043642659284     -1.559646291000
C      6.862467431080     -0.842444531125     -0.432769656781
H      7.310566496429     -1.687797398485      0.091634524198
H      7.168210303047      0.072613005420      0.086457129154
C     -2.933490088753     -1.577075853682     -0.300368626352
C     -3.033686635686     -3.649551385682      0.784612552536
H     -3.768968633523     -4.433550912900      0.936436805290
H     -2.716810817258     -3.231821274384      1.738939904139
H     -2.161252659630     -4.038868427956      0.262499462161
O     -3.687130341238     -2.652363458306     -0.005351946884
O      0.288216987257      0.707266695694      1.910756983533
O     -2.006593558519      2.927880863230     -0.534070238321
O     -1.788604150616     -1.475710825598      0.078631359144
O      7.405621735817     -0.891270708450     -1.748876603741
H      6.975613521561     -0.206425988734     -2.271016925036
C      0.464836277877     -0.526815837932      2.577371140586
H     -0.055138344530     -1.330263442808      2.045611056322
H      1.524355320127     -0.786429017122      2.672377841570
H      0.037380204111     -0.415855437686      3.572075937085
C     -2.329442335193      3.576453293777      0.675420895291
H     -2.801825680749      4.522935769587      0.419820096284
H     -3.026350719422      2.974603798482      1.269797328771
H     -1.442785083467      3.777498822027      1.285730264089
C     -5.168989109459     -0.817674074689     -1.282498871386
H     -5.364079862135     -1.757426511683     -1.800000697057
H     -5.677206275873     -0.875461557441     -0.319129796327
H     -5.608945742178     -0.004899673537     -1.858033192938
H      4.957091680144     -1.843816447261     -0.901981732319
H      4.985216004146      0.860184347907      0.528508367556
H      2.710339075940      1.679283241556      1.054846289715
H      2.674561330722     -1.021523431139     -0.383416016566
H     -3.705464332906      1.149406466971     -2.219268477160`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`bh9_2_15.xyz`として保存する。その後、同じディレクトリ内で、`config_bh9_2_15.json`を作成し、以下のように記述する。

`config_bh9_2_15.json`
```json
{
  "work_dir": "bh9_2_15",
  "top_n_candidates": 3,
  "multioptpy_version": "v1.19.6b",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"manual_AFIR": ["200", "2", "3", "200", "13", "14"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 15,
    "ANEB": [3, 5],
    "QSM": true,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance_bernstein": 0.80,
    "align_distances": 9999,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py bh9_2_15.xyz -cfg config_bh9_2_15.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.19.6/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。


Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`bh9_2_15_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`bh9_2_15_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`bh9_2_15_step1_traj.xyz`はStep2のNEB計算に使用している。

※`bh9_2_15_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`bh9_2_15_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。
- `"align_distances": X`は線形補間で、各ノード間の距離を全て等しくするための処理である。X回の反復計算ごとに本処理を行う。Xを`"NSTEP": n`よりも大きな数値を指定することで、初期経路に対してのみ処理を行うことが出来る。
- `"node_distance_bernstein": N`はノード間の距離をN Åとして初期経路を作成することを示す。経路作成時に元のノードをベルンシュタイン多項式を用いてがたついた経路を滑らかにする。

→プログラムの仕様上`"align_distances": X`の処理を行った後に、`"node_distance_bernstein": N`の処理を行うようになっている。

- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"ANEB": [A, B]`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


`MultiOptPy-v1.19.6/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-1001.3916194890437,-1001.3916194890437,-1001.3811097097403,-1001.3682462022286,-1001.3575025025782,-1001.3476030020545,-1001.338070759482,-1001.3288950344319,-1001.320351668307,-1001.3125327045976,-1001.3050236275207,-1001.2971081600589,-1001.2884240226965,-1001.27936675005,-1001.2707473749263,-1001.2634026457746,-1001.2581910532476,-1001.2557994108953,-1001.2562072075359,-1001.25835421396,-1001.2607590777449,-1001.2624345197448,-1001.2631207199747,-1001.2631246977948,-1001.2628188612664,-1001.262381572683,-1001.2623902204987,-1001.2639247127413,-1001.2677377160336,-1001.2731700950923,-1001.2786141403786,-1001.2831534068563,-1001.2868544222499,-1001.2897719429162,-1001.2910210835272,-1001.2886950620618,-1001.2800447274076,-1001.2626282939,-1001.248097466501,-1001.2643723313902,-1001.2953020589392,-1001.3148439275213,-1001.3260913098636,-1001.3325650946759,-1001.3355669151167,-1001.3372305660347,-1001.3385198342189,-1001.338798581158];

export const dataset1_itr5 = [-1001.3916194759012,-1001.3916194759012,-1001.3848759101254,-1001.3746577361297,-1001.3649165500617,-1001.3550895506326,-1001.3458616816553,-1001.3366098990746,-1001.3281916842343,-1001.3208314906503,-1001.313584621127,-1001.3056525261148,-1001.2970991223467,-1001.2882151214353,-1001.2795937574016,-1001.2724601856536,-1001.2677890246541,-1001.266246936002,-1001.2676702420432,-1001.2698705284746,-1001.2715710377498,-1001.2730573755904,-1001.2740500256688,-1001.2748769785173,-1001.2753574054193,-1001.2750123996307,-1001.2752639923629,-1001.277616277078,-1001.2829323355687,-1001.2889023774521,-1001.2941676836914,-1001.2986458766137,-1001.3026186804996,-1001.3053537121035,-1001.306196545566,-1001.3035647839512,-1001.2923648901203,-1001.2728127221387,-1001.2585691564259,-1001.2769600156385,-1001.3041296957189,-1001.3204403609878,-1001.3319460650619,-1001.3381810678687,-1001.3412822724767,-1001.3433014046386,-1001.3445438241905,-1001.3446351703029];

export const dataset1_itr10 = [-1001.3916194671394,-1001.3916194715202,-1001.3873675061566,-1001.3790841056806,-1001.3706733229676,-1001.3611017790929,-1001.3520075654005,-1001.3429666243226,-1001.334730801892,-1001.3280434096806,-1001.3210892538225,-1001.3132557084239,-1001.3047550501981,-1001.2957688219419,-1001.2867865276971,-1001.2795675072945,-1001.2754886734783,-1001.2757575224141,-1001.275777131139,-1001.2754622437559,-1001.2748867215478,-1001.2756577089227,-1001.2762942915435,-1001.2768210416485,-1001.2772617078742,-1001.2792980625618,-1001.2806894058559,-1001.2824707857882,-1001.2837028673342,-1001.2844549907303,-1001.2850056428019,-1001.2850703305659,-1001.2850080084658,-1001.2849913612016,-1001.2848251119835,-1001.2849626315283,-1001.2850807920572,-1001.2853305754946,-1001.2853097707953,-1001.2884352114104,-1001.2942983910004,-1001.2997412052654,-1001.3048335420488,-1001.309295425033,-1001.3133759608129,-1001.3161095379717,-1001.317129579371,-1001.3133553663948,-1001.3013954044801,-1001.2799798775518,-1001.2756031672282,-1001.2696545433643,-1001.265002701953,-1001.263397231033,-1001.2652221654654,-1001.270100646236,-1001.2772281504942,-1001.2829794648497,-1001.3078027437086,-1001.3231370075052,-1001.3340603880874,-1001.3402199262173,-1001.3427850557881,-1001.3443497959455,-1001.3454405913665,-1001.3450658533724];

export const dataset2 = [-1001.3916195065672,-1001.3916194934246,-1001.3888287679601,-1001.3822218039393,-1001.3747656804954,-1001.3657199251272,-1001.3568110716027,-1001.3480410882964,-1001.3399421786617,-1001.3338229521011,-1001.3268872615636,-1001.3193417685962,-1001.3109427134427,-1001.3019079956488,-1001.2927469054057,-1001.2856171931945,-1001.2810709261042,-1001.2811081940717,-1001.2810967775531,-1001.2810897331319,-1001.2810304995373,-1001.2812067152097,-1001.2813620604697,-1001.2815149612104,-1001.2822221501358,-1001.2818946020702,-1001.2809490199409,-1001.2813489967482,-1001.2812846156444,-1001.2811390090338,-1001.2811829753348,-1001.281230660985,-1001.2812380383515,-1001.2807662767887,-1001.2829032291415,-1001.2844739948966,-1001.2851293801643,-1001.2861178990927,-1001.2873926764906,-1001.2899646656653,-1001.2914598002707,-1001.292088414109,-1001.2911327779083,-1001.2910996148056,-1001.2910400526467,-1001.2909556028278,-1001.2908817064982,-1001.2910055227161,-1001.2910388829573,-1001.2910259988511,-1001.2918588483359,-1001.2914391708056,-1001.2906394844234,-1001.2910593941392,-1001.2910550921356,-1001.2910477585776,-1001.291038957432,-1001.2910310718858,-1001.2910533529346,-1001.2915964085968,-1001.2926012067971,-1001.2930116450958,-1001.2929639068753,-1001.2963609563675,-1001.3018175309105,-1001.3071383251097,-1001.3121087842054,-1001.3165721413487,-1001.3206435671324,-1001.3236336632992,-1001.3246482746239,-1001.3184666920115,-1001.3060894072784,-1001.2889509305124,-1001.2842986553961,-1001.277899223618,-1001.2708872908009,-1001.2685544395764,-1001.2675270317626,-1001.2668640062768,-1001.2664033414299,-1001.2662295965621,-1001.266317555449,-1001.2668330686506,-1001.2675747656023,-1001.2739878349945,-1001.2823953298728,-1001.286615713624,-1001.3101452700604,-1001.3246823664686,-1001.335382313385,-1001.3413967957974,-1001.3436768995631,-1001.3448758582557,-1001.3456763601621,-1001.3452481602184];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [1.4911901434318038e-06,1.4911202705762626e-06,0.00540288913727155,0.00661284085957741,0.006714206517761692,0.006613894592762521,0.006503604869056954,0.006496429467841624,0.006613636568668245,0.006752855758255322,0.00682392066003064,0.006833488202502849,0.006812374046622824,0.0067710962907726385,0.006740982427297007,0.0068030161885255045,0.00704572346211188,0.007438292559844413,0.007733047199609632,0.0076887559881288195,0.00740485516140962,0.007170075315910764,0.007094722525990898,0.007084899524091747,0.007034159983403092,0.006908201892470363,0.006797880907758691,0.006845599440241167,0.007002443069247399,0.007114300321268597,0.007209478254838405,0.007368213548144194,0.007545333887222619,0.00761783020742759,0.007606492784502483,0.007694892659768968,0.00799083114721756,0.008088437977052344,0.007666971280698275,0.00948740472508081,0.00746292502497002,0.006419589575775322,0.006968178578300618,0.007198987689366808,0.007105537141936729,0.007066604601548941,0.007039059527180173,0.006972849987011705];

export const dataset1_grad_itr5 = [5.80301900567537e-07,4.971052193150493e-07,0.003279235658319324,0.0042210151091247785,0.004738821023655471,0.004895385354866099,0.004866184874145462,0.0048920902248470455,0.005032844066776036,0.005208686453207091,0.00534216524786885,0.005382931137799896,0.0053206786416032485,0.005172693909574082,0.004957971046506701,0.004763840793532517,0.004741867577673585,0.004961448172309546,0.0051543929107439,0.005380263245386705,0.0054776147953608315,0.005472184631189511,0.005413390431945434,0.005097819439619945,0.004771616855571235,0.004799042841660796,0.00487502529957547,0.004889119520397088,0.004605357021193082,0.00453216047340524,0.004650143069105148,0.004727208780098424,0.004580653993052864,0.004779219448128174,0.004994313613397392,0.005301574582603847,0.006591280130029418,0.006729543380012416,0.0037938442324756206,0.004729231695065703,0.0033729631768490455,0.0034982492941375257,0.003517553013804924,0.0036045478880392984,0.0031097473944602825,0.0023845261196623734,0.0021913815655618457,0.0011409549216614301];

export const dataset1_grad_itr10 = [3.7222904098663637e-07,2.1121269635075217e-07,0.002025595620948312,0.002996097917349902,0.0035396201378567666,0.003729832682458183,0.003815469349160964,0.0038749813713575914,0.0039855163164432906,0.004153666050092321,0.004298156185237479,0.004347344415358035,0.004297735952626294,0.004174164474142276,0.0039583103310876335,0.003784375393319534,0.003797259585950931,0.003835275870640232,0.0038869840925973226,0.00392204930540155,0.003994133931760159,0.004107578793039598,0.004193181692631128,0.004239616678619833,0.004295005447813845,0.004484505698072998,0.004581311699825373,0.004499978232261093,0.004409689751235787,0.004168729109727647,0.003796853867515943,0.0037658499323392006,0.003752232022073242,0.0037350735530600966,0.0037559557679556965,0.003814339513513774,0.00385188610232254,0.003854117758821492,0.0038340322307967244,0.003685064171854268,0.0033095718924577014,0.003401743628349981,0.003495356785874745,0.0035802689677239805,0.0032543754610618383,0.0036184315994578953,0.0037020598562925704,0.004214471556769628,0.005638609707070893,0.006096200089855762,0.005916741808567936,0.005260714669717126,0.0038548578841381713,0.002655074318536326,0.0026043550944297006,0.0033862368510259584,0.003926856453840733,0.0038712981313843275,0.0026126638959950914,0.0020031206871156423,0.0024919002186721707,0.0024419717041551906,0.0021575194965846446,0.0013637104155649056,0.000823339988930218,0.0005651260329322652];

export const dataset2_grad = [3.2171618250727974e-07,1.9830934763411903e-07,0.0014016003869843515,0.002287899725863044,0.00274234004478763,0.002995026074766315,0.0030109637652816408,0.0032317798587439116,0.003313127496093014,0.0034744900804297373,0.003622239258098258,0.0036573225050996164,0.0036223604750576658,0.0035364860171739885,0.0033625931650915868,0.0032080489498739055,0.0033733253945542672,0.003388337481778655,0.003407546850952603,0.0034226876738573985,0.003448786411648737,0.0034493430904274985,0.00344695485811405,0.0034284969675542603,0.0033778316911624376,0.0033624928400702095,0.003452075302929876,0.0034245963963887224,0.003409542927109162,0.0034286665204099807,0.0034593594628857345,0.0034846845996850152,0.0035189042637620628,0.0035347920183643974,0.0034718267474693827,0.003688632889469987,0.003747350982861585,0.0038822960121442647,0.003925224010420593,0.003870317338990929,0.0037248260794636202,0.003495934574854612,0.0032724327018957425,0.003277872716499643,0.003298123352447687,0.003330753059313342,0.003297769685109191,0.00322595512648031,0.0032240470245967134,0.0032018028112936973,0.0030455779054095094,0.003185918191123629,0.003198150066140622,0.003194553038716486,0.0031747808858810385,0.003152354018781924,0.0032059468045596944,0.0032309637461350035,0.0032798221897145994,0.003360199394868722,0.003200654695431323,0.0030998318073945453,0.0031595732672679206,0.002995933929110638,0.0027141083826987037,0.0027189482554124587,0.0027313246386094624,0.0027818503411003517,0.0025006772798321876,0.00278965806051048,0.0028001006326770594,0.0036291419776098566,0.0049965859409622495,0.005920618945036317,0.005592751886021986,0.005379062062051281,0.004163784042595192,0.003632485707986516,0.00310066343975858,0.0026206285735855296,0.0021958778044125367,0.0018996867573078606,0.001826687299846798,0.00194882555373908,0.0021394540359526686,0.003179597088840271,0.0036845885901312533,0.0036317668372902235,0.0022432566837650714,0.0015249473403860213,0.0016520722630022756,0.001779299791302229,0.0015423086362774316,0.0006752848326918479,0.00019467046590217305,0.000432301315978083];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`bh9_2_15_step3_TS_Opt_Inputs`内に保存された`bh9_2_15_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`bh9_2_15_ts_guess_1.xyz`
```
47
0 1
C      -0.082207511426      0.908802889212      1.741315501151
C       1.007730125765      0.552641414782      0.733150649637
C       0.312442316862      0.328897094279     -1.135919738236
C      -0.923174144770      2.093990487608      1.322956344095
H      -0.723327641686      0.030956184404      1.874881145686
C      -1.613388631588      1.889403304733     -0.015119001924
H      -1.654993170868      2.288670622796      2.109792306297
H      -0.283701561313      2.980705460697      1.249181014625
C      -0.621987915069      1.553099539977     -1.124026610142
H      -2.400935067641      1.127862870594      0.070359640938
C       1.652472553743     -0.680468572479      0.910638414177
C       2.593026106235     -1.017279223289     -0.042836936936
C       0.150596036503     -1.060769832224     -1.494840679490
C       2.191744961125     -1.936111013930     -1.001169353623
H      -1.162352971143      1.588495515245     -2.071903446419
H       0.067420081940      2.405940854228     -1.129236778167
C       3.162150936516     -2.130957242528     -2.169931995839
H       2.951917751610     -3.053691965584     -2.703027923197
H       4.163347768903     -2.233737470619     -1.735772859928
C      -0.765672597648     -1.889306269890     -0.667638244478
C      -2.434626148305     -1.875178629027      0.986682871925
H      -3.154778640225     -1.187622501032      1.422941383268
H      -1.796060486296     -2.278866767408      1.774292606349
H      -2.961617861010     -2.694345205126      0.505538866553
O      -1.644489771865     -1.143600501169      0.046231143219
O       0.482536804922      1.253078314569      3.002772335904
O      -2.184500986025      3.116491814360     -0.469523347492
O      -0.742880900570     -3.095534319718     -0.583384624336
O       3.191042942836     -1.105408121917     -3.159958375162
H       3.427437012988     -0.269038005506     -2.747435072210
C       0.790009986500      0.157901299161      3.837889928273
H      -0.065170044751     -0.526981460021      3.918840100515
H       1.663293235238     -0.401565518842      3.486198545923
H       1.012742295604      0.561693138461      4.824227585657
C      -3.168014463568      3.659629535719      0.381502862595
H      -3.650447257907      4.467277105345     -0.167433513333
H      -3.921858031448      2.909438129062      0.655283056417
H      -2.730214246952      4.075098738078      1.295578026529
C       0.261007324877     -1.604348131459     -2.905530190274
H       0.533067559246     -2.663142076676     -2.867372901557
H      -0.696977831470     -1.539492556363     -3.431380083114
H       1.015518397793     -1.080427479287     -3.485121308686
H       1.559536407330     -2.782769896930     -0.758036100239
H       3.338299499304     -0.266377512186     -0.309188467238
H       1.626659676690      1.396223963924      0.429028816212
H       1.062352999572     -1.501353586293      1.323425009360
H       1.167025101444      0.672075582271     -1.726920603284
```

<MoleculeViewer 
  xyzData={`47
0 1
C      -0.082207511426      0.908802889212      1.741315501151
C       1.007730125765      0.552641414782      0.733150649637
C       0.312442316862      0.328897094279     -1.135919738236
C      -0.923174144770      2.093990487608      1.322956344095
H      -0.723327641686      0.030956184404      1.874881145686
C      -1.613388631588      1.889403304733     -0.015119001924
H      -1.654993170868      2.288670622796      2.109792306297
H      -0.283701561313      2.980705460697      1.249181014625
C      -0.621987915069      1.553099539977     -1.124026610142
H      -2.400935067641      1.127862870594      0.070359640938
C       1.652472553743     -0.680468572479      0.910638414177
C       2.593026106235     -1.017279223289     -0.042836936936
C       0.150596036503     -1.060769832224     -1.494840679490
C       2.191744961125     -1.936111013930     -1.001169353623
H      -1.162352971143      1.588495515245     -2.071903446419
H       0.067420081940      2.405940854228     -1.129236778167
C       3.162150936516     -2.130957242528     -2.169931995839
H       2.951917751610     -3.053691965584     -2.703027923197
H       4.163347768903     -2.233737470619     -1.735772859928
C      -0.765672597648     -1.889306269890     -0.667638244478
C      -2.434626148305     -1.875178629027      0.986682871925
H      -3.154778640225     -1.187622501032      1.422941383268
H      -1.796060486296     -2.278866767408      1.774292606349
H      -2.961617861010     -2.694345205126      0.505538866553
O      -1.644489771865     -1.143600501169      0.046231143219
O       0.482536804922      1.253078314569      3.002772335904
O      -2.184500986025      3.116491814360     -0.469523347492
O      -0.742880900570     -3.095534319718     -0.583384624336
O       3.191042942836     -1.105408121917     -3.159958375162
H       3.427437012988     -0.269038005506     -2.747435072210
C       0.790009986500      0.157901299161      3.837889928273
H      -0.065170044751     -0.526981460021      3.918840100515
H       1.663293235238     -0.401565518842      3.486198545923
H       1.012742295604      0.561693138461      4.824227585657
C      -3.168014463568      3.659629535719      0.381502862595
H      -3.650447257907      4.467277105345     -0.167433513333
H      -3.921858031448      2.909438129062      0.655283056417
H      -2.730214246952      4.075098738078      1.295578026529
C       0.261007324877     -1.604348131459     -2.905530190274
H       0.533067559246     -2.663142076676     -2.867372901557
H      -0.696977831470     -1.539492556363     -3.431380083114
H       1.015518397793     -1.080427479287     -3.485121308686
H       1.559536407330     -2.782769896930     -0.758036100239
H       3.338299499304     -0.266377512186     -0.309188467238
H       1.626659676690      1.396223963924      0.429028816212
H       1.062352999572     -1.501353586293      1.323425009360
H       1.167025101444      0.672075582271     -1.726920603284`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`bh9_2_15_ts_guess_2.xyz`
```
47
0 1
C      -0.210175775471      0.929297356695      1.393227990489
C       1.086231303166      0.644762018301      0.670925758444
C      -0.955752666297      0.339760784516     -1.549251176274
C      -0.641635895745      2.358608704008      1.101813223581
H      -1.031639239341      0.241465479336      1.151591029195
C      -1.303199018472      2.423588249966     -0.266016954944
H      -1.310751395127      2.706445155990      1.888428682219
H       0.240655154041      3.007122953334      1.102768577374
C      -0.425208299677      1.760865158128     -1.341943120993
H      -2.252202366898      1.869728886810     -0.215673391295
C       1.503768849713     -0.256997212286     -0.198849004455
C       2.888515303447     -0.357369526093     -0.541059317894
C      -1.255497247850     -0.917369382340     -1.139430354146
C       3.350431192548     -1.399869709379     -1.218921855186
H      -0.654107983317      2.269463223087     -2.280752634048
H       0.626848342542      1.914282225027     -1.140319386975
C       4.836534110912     -1.626936624101     -1.201573442316
H       5.057318420439     -2.600009699851     -0.759472087783
H       5.276677324371     -0.875991938610     -0.536766685418
C      -0.921967747510     -2.024068817147     -0.119767248152
C      -2.051534611361     -3.679138885861      1.149681855633
H      -3.078053017948     -4.034893124570      1.116806330163
H      -1.729610940105     -3.574287498039      2.183545259377
H      -1.391756902368     -4.374937711775      0.635196218933
O      -2.062981509034     -2.398317164582      0.499290478925
O       0.066266751044      0.829344015543      2.780862318107
O      -1.600996248918      3.743223998402     -0.679886786410
O       0.091583853724     -2.654585443047      0.027585347905
O       5.485762692115     -1.611348593667     -2.466218748900
H       5.529034466799     -0.695453350946     -2.756784611920
C       0.414307818774     -0.490953569213      3.149857251902
H      -0.273352447992     -1.217655439428      2.700223008954
H       1.428206878800     -0.750614101556      2.833373728038
H       0.340035092758     -0.546627848583      4.231864676944
C      -2.583696915059      4.347383622365      0.137246173020
H      -3.049733352306      5.145652388115     -0.435437005762
H      -3.355039030435      3.619820551052      0.418739307405
H      -2.153801197312      4.765893009605      1.051285024800
C      -2.566033900471     -1.402613189006     -1.793003378828
H      -2.603481331275     -2.465928773599     -2.015670676754
H      -3.373606637649     -1.198705777223     -1.089974303259
H      -2.766331564473     -0.840026818336     -2.698857295382
H       2.702347149082     -2.161795664175     -1.634775760650
H       3.576412351927      0.371412561381     -0.121498309583
H       1.830611651293      1.370034683230      0.988649108717
H       0.930751313994     -1.026550383114     -0.665456229972
H      -1.660152779077      0.524891221637     -2.345601582828
```

<MoleculeViewer 
  xyzData={`47
0 1
C      -0.210175775471      0.929297356695      1.393227990489
C       1.086231303166      0.644762018301      0.670925758444
C      -0.955752666297      0.339760784516     -1.549251176274
C      -0.641635895745      2.358608704008      1.101813223581
H      -1.031639239341      0.241465479336      1.151591029195
C      -1.303199018472      2.423588249966     -0.266016954944
H      -1.310751395127      2.706445155990      1.888428682219
H       0.240655154041      3.007122953334      1.102768577374
C      -0.425208299677      1.760865158128     -1.341943120993
H      -2.252202366898      1.869728886810     -0.215673391295
C       1.503768849713     -0.256997212286     -0.198849004455
C       2.888515303447     -0.357369526093     -0.541059317894
C      -1.255497247850     -0.917369382340     -1.139430354146
C       3.350431192548     -1.399869709379     -1.218921855186
H      -0.654107983317      2.269463223087     -2.280752634048
H       0.626848342542      1.914282225027     -1.140319386975
C       4.836534110912     -1.626936624101     -1.201573442316
H       5.057318420439     -2.600009699851     -0.759472087783
H       5.276677324371     -0.875991938610     -0.536766685418
C      -0.921967747510     -2.024068817147     -0.119767248152
C      -2.051534611361     -3.679138885861      1.149681855633
H      -3.078053017948     -4.034893124570      1.116806330163
H      -1.729610940105     -3.574287498039      2.183545259377
H      -1.391756902368     -4.374937711775      0.635196218933
O      -2.062981509034     -2.398317164582      0.499290478925
O       0.066266751044      0.829344015543      2.780862318107
O      -1.600996248918      3.743223998402     -0.679886786410
O       0.091583853724     -2.654585443047      0.027585347905
O       5.485762692115     -1.611348593667     -2.466218748900
H       5.529034466799     -0.695453350946     -2.756784611920
C       0.414307818774     -0.490953569213      3.149857251902
H      -0.273352447992     -1.217655439428      2.700223008954
H       1.428206878800     -0.750614101556      2.833373728038
H       0.340035092758     -0.546627848583      4.231864676944
C      -2.583696915059      4.347383622365      0.137246173020
H      -3.049733352306      5.145652388115     -0.435437005762
H      -3.355039030435      3.619820551052      0.418739307405
H      -2.153801197312      4.765893009605      1.051285024800
C      -2.566033900471     -1.402613189006     -1.793003378828
H      -2.603481331275     -2.465928773599     -2.015670676754
H      -3.373606637649     -1.198705777223     -1.089974303259
H      -2.766331564473     -0.840026818336     -2.698857295382
H       2.702347149082     -2.161795664175     -1.634775760650
H       3.576412351927      0.371412561381     -0.121498309583
H       1.830611651293      1.370034683230      0.988649108717
H       0.930751313994     -1.026550383114     -0.665456229972
H      -1.660152779077      0.524891221637     -2.345601582828`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`bh9_2_15_ts_guess_3.xyz`
```
47
0 1
C      -0.185463411075      0.931147357294      1.381791319782
C       1.102415821616      0.633239384590      0.652359222786
C      -0.986980210021      0.333646913381     -1.553825048555
C      -0.605629191317      2.363615682223      1.084452471279
H      -1.017038607920      0.250367097734      1.150800500834
C      -1.294953370615      2.417259300352     -0.269663892444
H      -1.255100290237      2.726068825736      1.881006516884
H       0.282873768360      3.003214076274      1.060540158553
C      -0.434190845423      1.746846005282     -1.356719337423
H      -2.239262991911      1.857844695926     -0.194583041772
C       1.511489318497     -0.271252874124     -0.224174347890
C       2.900533411208     -0.363653321959     -0.552566342891
C      -1.306080719767     -0.918496132824     -1.138715813962
C       3.391244417912     -1.403380784651     -1.212312357292
H      -0.665449451725      2.255355206880     -2.294128559932
H       0.621755569920      1.886797386504     -1.165701078402
C       4.882292635451     -1.600617425180     -1.178442350651
H       5.121324274540     -2.564151535344     -0.724693926413
H       5.301466959166     -0.832950038588     -0.518309463846
C      -0.968121153527     -2.024172655733     -0.117895585449
C      -2.072266925754     -3.709947863926      1.133403295199
H      -3.086452618991     -4.100017492620      1.095595175221
H      -1.765970676517     -3.573753957448      2.168485983293
H      -1.385064207026     -4.395638105874      0.641037084759
O      -2.117052833172     -2.444783160446      0.456669811484
O       0.100909929200      0.838107728335      2.766751783784
O      -1.610583371962      3.730790243925     -0.687446446492
O       0.062956009019     -2.612166305907      0.077150542224
O       5.541874928071     -1.585161552037     -2.438268837266
H       5.572056323443     -0.671395592878     -2.737284949263
C       0.431606354958     -0.484736632885      3.144551552388
H      -0.256133324936     -1.207064186876      2.687717504224
H       1.447333677168     -0.755495651195      2.843668518700
H       0.340213621405     -0.536751679446      4.226194757970
C      -2.586456857417      4.328154300747      0.143133570923
H      -3.069177257016      5.120331318762     -0.424014804232
H      -3.346097774768      3.593400252163      0.438851270291
H      -2.146108092974      4.752710270379      1.049373854672
C      -2.643060231526     -1.369036758400     -1.766056349314
H      -2.706066210187     -2.425938105536     -2.012962884537
H      -3.429905556732     -1.167539314757     -1.038229779561
H      -2.860517403306     -0.782494691516     -2.652974326361
H       2.763965597461     -2.182194707103     -1.632079968190
H       3.573542134152      0.376032247089     -0.128295044310
H       1.856032587798      1.347508499473      0.965228167911
H       0.936441033903     -1.040981714122     -0.693986614651
H      -1.703144787427      0.531335448327     -2.335431912060
```

<MoleculeViewer 
  xyzData={`47
0 1
C      -0.185463411075      0.931147357294      1.381791319782
C       1.102415821616      0.633239384590      0.652359222786
C      -0.986980210021      0.333646913381     -1.553825048555
C      -0.605629191317      2.363615682223      1.084452471279
H      -1.017038607920      0.250367097734      1.150800500834
C      -1.294953370615      2.417259300352     -0.269663892444
H      -1.255100290237      2.726068825736      1.881006516884
H       0.282873768360      3.003214076274      1.060540158553
C      -0.434190845423      1.746846005282     -1.356719337423
H      -2.239262991911      1.857844695926     -0.194583041772
C       1.511489318497     -0.271252874124     -0.224174347890
C       2.900533411208     -0.363653321959     -0.552566342891
C      -1.306080719767     -0.918496132824     -1.138715813962
C       3.391244417912     -1.403380784651     -1.212312357292
H      -0.665449451725      2.255355206880     -2.294128559932
H       0.621755569920      1.886797386504     -1.165701078402
C       4.882292635451     -1.600617425180     -1.178442350651
H       5.121324274540     -2.564151535344     -0.724693926413
H       5.301466959166     -0.832950038588     -0.518309463846
C      -0.968121153527     -2.024172655733     -0.117895585449
C      -2.072266925754     -3.709947863926      1.133403295199
H      -3.086452618991     -4.100017492620      1.095595175221
H      -1.765970676517     -3.573753957448      2.168485983293
H      -1.385064207026     -4.395638105874      0.641037084759
O      -2.117052833172     -2.444783160446      0.456669811484
O       0.100909929200      0.838107728335      2.766751783784
O      -1.610583371962      3.730790243925     -0.687446446492
O       0.062956009019     -2.612166305907      0.077150542224
O       5.541874928071     -1.585161552037     -2.438268837266
H       5.572056323443     -0.671395592878     -2.737284949263
C       0.431606354958     -0.484736632885      3.144551552388
H      -0.256133324936     -1.207064186876      2.687717504224
H       1.447333677168     -0.755495651195      2.843668518700
H       0.340213621405     -0.536751679446      4.226194757970
C      -2.586456857417      4.328154300747      0.143133570923
H      -3.069177257016      5.120331318762     -0.424014804232
H      -3.346097774768      3.593400252163      0.438851270291
H      -2.146108092974      4.752710270379      1.049373854672
C      -2.643060231526     -1.369036758400     -1.766056349314
H      -2.706066210187     -2.425938105536     -2.012962884537
H      -3.429905556732     -1.167539314757     -1.038229779561
H      -2.860517403306     -0.782494691516     -2.652974326361
H       2.763965597461     -2.182194707103     -1.632079968190
H       3.573542134152      0.376032247089     -0.128295044310
H       1.856032587798      1.347508499473      0.965228167911
H       0.936441033903     -1.040981714122     -0.693986614651
H      -1.703144787427      0.531335448327     -2.335431912060`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-v1.19.6/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`bh9_2_15_ts_final_X.xyz`として保存されている。)

`bh9_2_15_ts_final_1.xyz`
```
47
OptimizedStructure
C      0.339154697595      1.618148887438      1.831864313004
C      1.125044964738      0.777862854948      0.832607007217
C      0.293640086855      0.663406055511     -0.943573405750
C     -0.728773246721      2.502452495615      1.232978055226
H     -0.152167986338      0.922739561855      2.530187344198
C     -1.695261501769      1.656928381346      0.420963524894
H     -1.239410312774      3.013656360073      2.049982114936
H     -0.279773616789      3.269323302785      0.595642865311
C     -1.097123309165      1.319051593145     -0.927721002718
H     -1.920676038082      0.726299400124      0.965097158108
C      1.299109458664     -0.588951954054      1.111306486806
C      2.104741311543     -1.302017308061      0.256120171178
C      0.438129966384     -0.591791169599     -1.664356567465
C      1.448853807423     -2.252143653081     -0.514046458657
H     -1.822064903203      0.717254024174     -1.471057632137
H     -1.020563710844      2.266604115721     -1.468233823364
C      2.110761111961     -3.155599996606     -1.510973680045
H      1.480478672219     -3.272885739755     -2.392732052024
H      2.185542265249     -4.149605460507     -1.050250900668
C     -0.709046718291     -1.499278153562     -1.764429919810
C     -2.606176380125     -2.361893349469     -0.678718052022
H     -3.117843117251     -2.225757966193      0.270187047766
H     -2.286223548233     -3.397139810769     -0.793496488664
H     -3.266359199373     -2.108120804338     -1.506755741659
O     -1.479693170610     -1.483671304770     -0.643792586286
O      1.219225512816      2.453003427443      2.568127812429
O     -2.911137339157      2.337940575178      0.152021935375
O     -0.943581394738     -2.246654055356     -2.688607823611
O      3.378428474922     -2.709554755095     -1.953297107761
H      3.997888797311     -2.775698747111     -1.219669511450
C      2.047457963832      1.752418513964      3.471880690993
H      1.449446807578      1.150621779956      4.166428954975
H      2.752645613647      1.090448358885      2.960455179166
H      2.604364978499      2.497673413614      4.035426429417
C     -3.813086799603      2.334795332281      1.233315846169
H     -4.713482330368      2.849364412867      0.904507508874
H     -4.074596099439      1.310728142476      1.526316839496
H     -3.414577604413      2.855972478900      2.110213455809
C      1.330496321944     -0.531908769556     -2.882343081088
H      1.420921016098     -1.488892548642     -3.386031234258
H      0.918857298230      0.173432384311     -3.609247678242
H      2.330329345715     -0.189221220580     -2.611127861664
H      0.536857115181     -2.659501535960     -0.088029433154
H      2.985766230110     -0.823052031398     -0.164461852134
H      2.016676805000      1.298733435679      0.489846741351
H      0.464068375927     -1.107016560220      1.579529690139
H      1.012731327844      1.361497606397     -1.362053278208
```

<MoleculeViewer 
  xyzData={`47
OptimizedStructure
C      0.339154697595      1.618148887438      1.831864313004
C      1.125044964738      0.777862854948      0.832607007217
C      0.293640086855      0.663406055511     -0.943573405750
C     -0.728773246721      2.502452495615      1.232978055226
H     -0.152167986338      0.922739561855      2.530187344198
C     -1.695261501769      1.656928381346      0.420963524894
H     -1.239410312774      3.013656360073      2.049982114936
H     -0.279773616789      3.269323302785      0.595642865311
C     -1.097123309165      1.319051593145     -0.927721002718
H     -1.920676038082      0.726299400124      0.965097158108
C      1.299109458664     -0.588951954054      1.111306486806
C      2.104741311543     -1.302017308061      0.256120171178
C      0.438129966384     -0.591791169599     -1.664356567465
C      1.448853807423     -2.252143653081     -0.514046458657
H     -1.822064903203      0.717254024174     -1.471057632137
H     -1.020563710844      2.266604115721     -1.468233823364
C      2.110761111961     -3.155599996606     -1.510973680045
H      1.480478672219     -3.272885739755     -2.392732052024
H      2.185542265249     -4.149605460507     -1.050250900668
C     -0.709046718291     -1.499278153562     -1.764429919810
C     -2.606176380125     -2.361893349469     -0.678718052022
H     -3.117843117251     -2.225757966193      0.270187047766
H     -2.286223548233     -3.397139810769     -0.793496488664
H     -3.266359199373     -2.108120804338     -1.506755741659
O     -1.479693170610     -1.483671304770     -0.643792586286
O      1.219225512816      2.453003427443      2.568127812429
O     -2.911137339157      2.337940575178      0.152021935375
O     -0.943581394738     -2.246654055356     -2.688607823611
O      3.378428474922     -2.709554755095     -1.953297107761
H      3.997888797311     -2.775698747111     -1.219669511450
C      2.047457963832      1.752418513964      3.471880690993
H      1.449446807578      1.150621779956      4.166428954975
H      2.752645613647      1.090448358885      2.960455179166
H      2.604364978499      2.497673413614      4.035426429417
C     -3.813086799603      2.334795332281      1.233315846169
H     -4.713482330368      2.849364412867      0.904507508874
H     -4.074596099439      1.310728142476      1.526316839496
H     -3.414577604413      2.855972478900      2.110213455809
C      1.330496321944     -0.531908769556     -2.882343081088
H      1.420921016098     -1.488892548642     -3.386031234258
H      0.918857298230      0.173432384311     -3.609247678242
H      2.330329345715     -0.189221220580     -2.611127861664
H      0.536857115181     -2.659501535960     -0.088029433154
H      2.985766230110     -0.823052031398     -0.164461852134
H      2.016676805000      1.298733435679      0.489846741351
H      0.464068375927     -1.107016560220      1.579529690139
H      1.012731327844      1.361497606397     -1.362053278208`}
  caption="遷移状態構造 (No.1)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -503.3898             19.9906             37.8273
Reduced mass [au]                   8.0482              4.6243              3.6166
Force const [Dyne/A]               -1.2016              0.0011              0.0030
Char temp [K]                       0.0000             28.7620             54.4251
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                -0.00199    0.00125   -0.02042    0.02005    0.02642    0.00315    0.00299   -0.00645    0.00491
       C                -0.05817    0.01678   -0.11127    0.00482    0.00634    0.00662    0.02038    0.01151    0.00221
       C                 0.06646    0.00324    0.14603   -0.00496    0.00087    0.00977    0.03622    0.01174   -0.01929
       C                -0.00703    0.00305    0.00139   -0.00101    0.00382    0.00702   -0.01531   -0.02224    0.01331
       H                 0.01179   -0.01066   -0.02251    0.04079    0.03891    0.03009    0.01593   -0.02098   -0.00048
       C                -0.00058   -0.00118   -0.00536    0.00272   -0.01839    0.02502    0.01946   -0.02569   -0.02468
       H                -0.01068   -0.00200    0.00182    0.00068    0.00417    0.00784   -0.04198   -0.05892    0.01981
       H                -0.01129    0.00711    0.00285   -0.01999    0.00452   -0.00539   -0.02816    0.00830    0.04120
       C                 0.02843   -0.00455    0.00244   -0.00882   -0.00909    0.01784    0.04916    0.03725   -0.02654
       H                -0.00062   -0.00079   -0.00371    0.03041   -0.02229    0.03029    0.04168   -0.05105   -0.06011
       C                 0.01112   -0.02303   -0.00007   -0.01296    0.00567    0.01534    0.02088    0.01103   -0.00629
       C                 0.00161    0.02953    0.01983   -0.02006   -0.00802    0.02082    0.01451    0.00373   -0.00682
       C                 0.06870   -0.09205    0.07696    0.00943    0.00203    0.00876    0.01278    0.00251   -0.00490
       C                -0.05727    0.06759   -0.07783   -0.03254    0.00209    0.01721    0.00118    0.00620    0.00139
       H                 0.05559   -0.02255   -0.01456   -0.00934   -0.01231    0.02293    0.05483    0.07497   -0.07740
       H                 0.03294   -0.00948   -0.00277   -0.01895   -0.00702    0.02002    0.07820    0.06253    0.02210
       C                -0.00992    0.01020   -0.00678   -0.03841   -0.01588    0.02877   -0.01413   -0.01080    0.00656
       H                 0.01281   -0.03350   -0.01809   -0.02825   -0.00558    0.02000   -0.02093   -0.01512    0.01209
       H                -0.00841    0.03285    0.04114   -0.06555   -0.01573    0.03341   -0.02048   -0.00619    0.01752
       C                 0.00417   -0.01151    0.00975    0.00636    0.00881   -0.03507   -0.00935    0.02786    0.01493
       C                -0.00395   -0.00099    0.00003   -0.02677   -0.00395   -0.10420   -0.03236    0.10719    0.03935
       H                -0.00479   -0.00089   -0.00055   -0.04984   -0.02277   -0.11401   -0.01860    0.13504    0.04290
       H                -0.00292   -0.00073    0.00077   -0.03186   -0.00357   -0.12125   -0.07411    0.09376    0.04517
       H                -0.00330   -0.00086   -0.00036   -0.00356    0.02157   -0.11488   -0.03004    0.12677    0.04341
       O                -0.00468   -0.00184    0.00062   -0.02071   -0.01345   -0.05409    0.00190    0.06362    0.02180
       O                 0.00095   -0.00745   -0.01143    0.02943    0.05033   -0.03556   -0.01426    0.00573    0.01172
       O                -0.00038   -0.00232   -0.00516   -0.01559   -0.04429    0.04323    0.00226   -0.05242   -0.01526
       O                -0.00254    0.00613   -0.00199    0.02578    0.03073   -0.05755   -0.03770    0.02306    0.02642
       O                -0.00217    0.00180   -0.00000   -0.02282   -0.04447    0.04465   -0.01276   -0.02821   -0.00692
       H                -0.00905    0.01114    0.00628   -0.03630   -0.04803    0.05574   -0.00884   -0.02537   -0.00997
       C                -0.00245   -0.00522   -0.00672    0.05631    0.07617   -0.04014   -0.00391    0.01578    0.01001
       H                -0.00414   -0.00172   -0.00514    0.07724    0.09035   -0.00987    0.00509    0.00410    0.00762
       H                -0.00110   -0.00792   -0.00313    0.04571    0.06669   -0.04260    0.00681    0.02854    0.00825
       H                -0.00148   -0.00442   -0.00815    0.06800    0.09227   -0.07303   -0.01591    0.02260    0.01284
       C                 0.00114   -0.00071   -0.00242    0.00258   -0.06067    0.05836   -0.01962   -0.14483   -0.03399
       H                 0.00097   -0.00057   -0.00159   -0.01331   -0.07930    0.07274   -0.02571   -0.14508   -0.01774
       H                 0.00121   -0.00035   -0.00119    0.02825   -0.06551    0.06440   -0.00036   -0.17049   -0.10622
       H                 0.00291   -0.00017   -0.00380    0.00686   -0.05132    0.05087   -0.04911   -0.19302    0.00831
       C                -0.01806    0.00711    0.01042    0.04048    0.00919    0.03113    0.00047   -0.02493   -0.01539
       H                -0.02452    0.02460   -0.02584    0.06256    0.01075    0.03239   -0.02451   -0.03106   -0.00835
       H                -0.06971    0.02791    0.05898    0.05427    0.00714    0.02154    0.00560   -0.02349   -0.01686
       H                -0.01143    0.01487   -0.02353    0.03046    0.01688    0.05870    0.01030   -0.04232   -0.03011
       H                -0.00435    0.01095   -0.01659   -0.04094    0.01812    0.01458   -0.00110    0.01875    0.00893
       H                -0.04377    0.07540   -0.02675   -0.01122   -0.02160    0.02379    0.01708   -0.00543   -0.01175
       H                 0.01320    0.00416    0.04023    0.01086   -0.00937   -0.00153    0.01647    0.02155    0.00824
       H                -0.03952   -0.02434   -0.08735   -0.02088    0.01870    0.01597    0.02094    0.01306   -0.00386
       H                -0.00484   -0.02413   -0.02984   -0.01124    0.00776    0.01077    0.05571   -0.00667   -0.01624
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_2_15_ts_final_2.xyz`
```
47
OptimizedStructure
C      0.753884794079      0.028184231259      1.728036358006
C      1.822981823758      0.504001004045      0.788678790522
C     -1.053693505054     -0.853225563038     -0.720904188991
C     -0.426757137336      0.984615659365      1.851206598679
H      0.419470069405     -0.973399780039      1.427526102077
C     -1.317789802247      1.298557025541      0.626265859189
H     -1.041639231045      0.600941798943      2.666690244785
H     -0.009861744555      1.931716151140      2.203184750439
C     -0.973848844561      0.646261588797     -0.714978608235
H     -2.344345832162      1.004442123356      0.870847932858
C      2.491452912478     -0.286827728462     -0.046910363013
C      3.552823163860      0.173406926246     -0.934960102766
C     -2.114580756456     -1.665428811338     -0.703149604575
C      4.206836323243     -0.616721047400     -1.783563126684
H     -1.669570764568      1.067326460297     -1.437232062884
H      0.029543143691      0.951218950752     -1.009825628102
C      5.288316161964     -0.142355770088     -2.700400940399
H      6.217183196074     -0.681227146912     -2.507592600112
H      5.479939458407      0.923353834191     -2.533775076304
C     -3.541446074387     -1.231370860521     -0.692159929120
C     -5.102162381298      0.497054811281     -0.922272700461
H     -5.081712608063      1.562958497060     -1.128476250343
H     -5.552528771426      0.301315939469      0.049558443079
H     -5.670227956116     -0.030828682932     -1.685982583014
O     -3.734091688587      0.076283373970     -0.934484880497
O      1.275416082420     -0.052710058010      3.056120300861
O     -1.315610685175      2.698140394951      0.356950833310
O     -4.455592879071     -1.994631909396     -0.497260898418
O      4.983248750553     -0.403104225159     -4.066395042008
H      4.136429630186      0.009133426238     -4.265353215518
C      2.174653927495     -1.122906053617      3.245623767947
H      1.698391082523     -2.082556336504      3.009780992010
H      3.073599863385     -1.018228307861      2.630901208976
H      2.458763129058     -1.116953910149      4.295606499235
C     -2.071809203983      3.441586405316      1.283915664317
H     -2.035505406181      4.483160052316      0.971515389659
H     -3.116581414431      3.107255912492      1.296532586869
H     -1.673399029834      3.366902522910      2.301649843487
C     -1.958739873265     -3.160925721834     -0.671392712111
H     -2.417879338551     -3.577764336452      0.225465803852
H     -2.461734218764     -3.624128630977     -1.521122363242
H     -0.905192595442     -3.435967896097     -0.692673928007
H      3.948951275109     -1.670729181557     -1.851033117440
H      3.810741903045      1.228607894316     -0.881455123758
H      2.074176163239      1.560838296349      0.849424887655
H      2.242343018485     -1.345187603274     -0.095429868946
H     -0.092844129900     -1.360083718983     -0.736697942864
```

<MoleculeViewer 
  xyzData={`47
OptimizedStructure
C      0.753884794079      0.028184231259      1.728036358006
C      1.822981823758      0.504001004045      0.788678790522
C     -1.053693505054     -0.853225563038     -0.720904188991
C     -0.426757137336      0.984615659365      1.851206598679
H      0.419470069405     -0.973399780039      1.427526102077
C     -1.317789802247      1.298557025541      0.626265859189
H     -1.041639231045      0.600941798943      2.666690244785
H     -0.009861744555      1.931716151140      2.203184750439
C     -0.973848844561      0.646261588797     -0.714978608235
H     -2.344345832162      1.004442123356      0.870847932858
C      2.491452912478     -0.286827728462     -0.046910363013
C      3.552823163860      0.173406926246     -0.934960102766
C     -2.114580756456     -1.665428811338     -0.703149604575
C      4.206836323243     -0.616721047400     -1.783563126684
H     -1.669570764568      1.067326460297     -1.437232062884
H      0.029543143691      0.951218950752     -1.009825628102
C      5.288316161964     -0.142355770088     -2.700400940399
H      6.217183196074     -0.681227146912     -2.507592600112
H      5.479939458407      0.923353834191     -2.533775076304
C     -3.541446074387     -1.231370860521     -0.692159929120
C     -5.102162381298      0.497054811281     -0.922272700461
H     -5.081712608063      1.562958497060     -1.128476250343
H     -5.552528771426      0.301315939469      0.049558443079
H     -5.670227956116     -0.030828682932     -1.685982583014
O     -3.734091688587      0.076283373970     -0.934484880497
O      1.275416082420     -0.052710058010      3.056120300861
O     -1.315610685175      2.698140394951      0.356950833310
O     -4.455592879071     -1.994631909396     -0.497260898418
O      4.983248750553     -0.403104225159     -4.066395042008
H      4.136429630186      0.009133426238     -4.265353215518
C      2.174653927495     -1.122906053617      3.245623767947
H      1.698391082523     -2.082556336504      3.009780992010
H      3.073599863385     -1.018228307861      2.630901208976
H      2.458763129058     -1.116953910149      4.295606499235
C     -2.071809203983      3.441586405316      1.283915664317
H     -2.035505406181      4.483160052316      0.971515389659
H     -3.116581414431      3.107255912492      1.296532586869
H     -1.673399029834      3.366902522910      2.301649843487
C     -1.958739873265     -3.160925721834     -0.671392712111
H     -2.417879338551     -3.577764336452      0.225465803852
H     -2.461734218764     -3.624128630977     -1.521122363242
H     -0.905192595442     -3.435967896097     -0.692673928007
H      3.948951275109     -1.670729181557     -1.851033117440
H      3.810741903045      1.228607894316     -0.881455123758
H      2.074176163239      1.560838296349      0.849424887655
H      2.242343018485     -1.345187603274     -0.095429868946
H     -0.092844129900     -1.360083718983     -0.736697942864`}
  caption="遷移状態構造 (No.2)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -55.2824              8.5551             23.4824
Reduced mass [au]                   3.3967              6.7281              5.4970
Force const [Dyne/A]               -0.0061              0.0003              0.0018
Char temp [K]                       0.0000             12.3089             33.7860
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00579    0.02207    0.00239   -0.01750   -0.01748   -0.02468   -0.00403    0.00730   -0.03230
       C                 0.02329   -0.02357   -0.00150   -0.00673   -0.01078   -0.00909   -0.01563    0.01473   -0.04198
       C                 0.01992    0.01942   -0.00895    0.00378    0.00195   -0.03819   -0.02775    0.01990   -0.01192
       C                 0.05935    0.09021   -0.01430   -0.01497   -0.01428   -0.02523   -0.00514    0.00223   -0.00839
       H                -0.04122    0.03460    0.01308   -0.01858   -0.01269   -0.03935   -0.00499    0.00809   -0.03367
       C                -0.00546    0.00120    0.00950   -0.00666   -0.00556   -0.02901   -0.01985    0.01307    0.00559
       H                 0.09428    0.20432    0.06541   -0.02080   -0.01745   -0.03113    0.00524   -0.00865   -0.00567
       H                 0.12729    0.10871   -0.14345   -0.01447   -0.01738   -0.01744   -0.00393   -0.00059   -0.00229
       C                 0.01308    0.02030    0.00488    0.00384    0.00237   -0.02991   -0.03962    0.02046   -0.00310
       H                 0.02481   -0.08219    0.03782   -0.00843   -0.00694   -0.03704   -0.01752    0.01556    0.01718
       C                 0.00267   -0.03560   -0.00601   -0.00121   -0.00355   -0.01152   -0.00493    0.01378   -0.03273
       C                 0.01176   -0.04396    0.00017    0.01015    0.00298    0.00543    0.00377    0.01216   -0.02331
       C                 0.02194    0.01626   -0.01075    0.00204    0.00551   -0.00438   -0.01920    0.00863   -0.00807
       C                -0.00015   -0.03994   -0.01240    0.01723    0.01062    0.00377    0.04135    0.00136    0.01570
       H                 0.01121    0.02136    0.00729    0.00927    0.00522   -0.03370   -0.05451    0.01987    0.01067
       H                 0.01174    0.03018    0.01005    0.00560    0.00497   -0.02081   -0.04638    0.02892   -0.01824
       C                 0.00623   -0.03799   -0.00403    0.02950    0.01771    0.02190    0.06352   -0.00632    0.03788
       H                -0.00131   -0.05501   -0.01538    0.02537    0.01214    0.02621    0.06949    0.02402    0.09442
       H                 0.02157   -0.04397    0.01674    0.03134    0.01504    0.03684    0.03106    0.00470    0.00482
       C                 0.02017    0.01142   -0.00333    0.00528    0.01510    0.05473   -0.02420   -0.00865    0.00911
       C                 0.01413    0.00712    0.00290    0.00441    0.00831    0.00989   -0.04603   -0.01883    0.08221
       H                 0.01103    0.00727    0.00362   -0.00091   -0.01066   -0.08847   -0.05972   -0.00981    0.12739
       H                 0.01983    0.00539    0.00522    0.07485    0.10102    0.06133   -0.04349   -0.06590    0.07387
       H                 0.01122    0.00623    0.00564   -0.05755   -0.05590    0.10035   -0.03925    0.00637    0.05976
       O                 0.01498    0.01011   -0.00469   -0.00054   -0.00594   -0.05363   -0.04056   -0.00075    0.06440
       O                 0.00585    0.01367    0.00151   -0.02999   -0.03424   -0.02080    0.01442   -0.00009   -0.03956
       O                -0.12593   -0.00076    0.00120   -0.00557   -0.00405   -0.01965   -0.01783    0.01473    0.01325
       O                 0.02373    0.00850    0.00253    0.01300    0.03920    0.18467   -0.01492   -0.02776   -0.02196
       O                 0.00133   -0.00666   -0.00883    0.04443    0.03513    0.01522    0.12325   -0.06622    0.03618
       H                 0.00671    0.00875    0.00019    0.04826    0.04063    0.01032    0.12187   -0.09306   -0.01350
       C                -0.01958   -0.00767    0.00298   -0.03644   -0.04030   -0.02434    0.01733   -0.00049   -0.05665
       H                -0.04188    0.00367    0.00179   -0.03857   -0.03557   -0.03926    0.01611    0.00075   -0.05936
       H                -0.01596   -0.02898    0.00478   -0.03034   -0.03750   -0.01496    0.01147    0.00511   -0.06423
       H                -0.02171   -0.01446    0.00357   -0.04602   -0.05310   -0.02168    0.02738   -0.00820   -0.05931
       C                -0.09974   -0.04542    0.05821   -0.01044   -0.01025   -0.01860   -0.00515    0.01222    0.02556
       H                -0.20589   -0.04719    0.03996   -0.00878   -0.00816   -0.01137   -0.00424    0.01395    0.03142
       H                -0.07356   -0.12404    0.15524   -0.01056   -0.01027   -0.02647   -0.00636    0.01637    0.03459
       H                -0.00370   -0.00092    0.02368   -0.01583   -0.01726   -0.01703    0.00520    0.00458    0.02096
       C                 0.02593    0.01637   -0.01927   -0.00463    0.00500   -0.00132   -0.00185    0.00994   -0.02831
       H                 0.03081    0.01090   -0.01929    0.03314    0.01476    0.02246    0.00976   -0.00726   -0.03032
       H                 0.02337    0.01920   -0.01930   -0.04488    0.00121    0.02433   -0.00310    0.01536   -0.03044
       H                 0.02652    0.01896   -0.02515   -0.00713   -0.00101   -0.04690    0.00115    0.02232   -0.03982
       H                -0.01519   -0.03504   -0.03062    0.01457    0.01224   -0.01136    0.06276   -0.00530    0.03743
       H                 0.02898   -0.04888    0.01605    0.01319    0.00148    0.02055   -0.01592    0.01796   -0.04304
       H                 0.05733   -0.03157    0.00096   -0.00307   -0.01250    0.00582   -0.02555    0.01748   -0.04929
       H                -0.01992   -0.02959   -0.01581   -0.00475   -0.00202   -0.02646    0.00575    0.01075   -0.02322
       H                 0.02122    0.02243   -0.01656    0.00275    0.00080   -0.06880   -0.02293    0.02936   -0.02819
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_2_15_ts_final_3.xyz`
```
47
OptimizedStructure
C      0.759120359711      0.035132801446      1.725602772341
C      1.824128400394      0.510859390857      0.781566454737
C     -1.053762201915     -0.857960028821     -0.715164107748
C     -0.423529035137      0.988971829858      1.849615273413
H      0.426292012690     -0.968159146967      1.429054675806
C     -1.319105640566      1.297098955261      0.626513194258
H     -1.034938950277      0.606155110181      2.668106731824
H     -0.007927124708      1.938136683968      2.197538849985
C     -0.977658709713      0.641732955426     -0.713871336926
H     -2.344165804465      1.001145094610      0.875117293491
C      2.492005214183     -0.280746345964     -0.053761735405
C      3.549483425029      0.179527838958     -0.946422284210
C     -2.112550712569     -1.672753531295     -0.691738845975
C      4.202859814439     -0.611452282530     -1.794721539627
H     -1.676652269183      1.058937886931     -1.435205337021
H      0.024053523304      0.948330360877     -1.012701912647
C      5.280322383133     -0.137081979514     -2.716274367128
H      6.211125149028     -0.673065802021     -2.524755156628
H      5.469787938602      0.929586793499     -2.553359425775
C     -3.540457387962     -1.242225783470     -0.677583959733
C     -5.106203209296      0.481609289631     -0.907960776965
H     -5.089064252101      1.546940392396     -1.117399828004
H     -5.553045017466      0.287650149161      0.065852489616
H     -5.675326516217     -0.049966163955     -1.668315475306
O     -3.737129187831      0.064214875429     -0.923198102606
O      1.284934472429     -0.040565736664      3.052303576583
O     -1.321255540411      2.695887717877      0.353100851177
O     -4.452079230035     -2.007179399235     -0.477560819637
O      4.971707920394     -0.402597739138     -4.080552397081
H      4.123249970024      0.006937803243     -4.278102292238
C      2.187427186524     -1.107954972870      3.242163121086
H      1.712845179954     -2.069477517893      3.010597191794
H      3.084213805335     -1.002838159504      2.624368895058
H      2.474748204106     -1.098215587030      4.291243126775
C     -2.076458560738      3.440161563123      1.280212973828
H     -2.043719367474      4.480902309184      0.964658631451
H     -3.120347827386      3.103267395507      1.297025250265
H     -1.674737358943      3.369454114961      2.296929048517
C     -1.952867371667     -3.167757289840     -0.656082888757
H     -2.408176378001     -3.583101635102      0.243417572933
H     -2.457334358681     -3.634709318434     -1.502882556923
H     -0.898705481944     -3.440230924521     -0.679834652656
H      3.947409787423     -1.666294169462     -1.858310722852
H      3.804921945488      1.235521800373     -0.896801243597
H      2.072860399755      1.568494120762      0.838445725207
H      2.245399039492     -1.339862614627     -0.098415988724
H     -0.091698636749     -1.362461104659     -0.732455945973
```

<MoleculeViewer 
  xyzData={`47
OptimizedStructure
C      0.759120359711      0.035132801446      1.725602772341
C      1.824128400394      0.510859390857      0.781566454737
C     -1.053762201915     -0.857960028821     -0.715164107748
C     -0.423529035137      0.988971829858      1.849615273413
H      0.426292012690     -0.968159146967      1.429054675806
C     -1.319105640566      1.297098955261      0.626513194258
H     -1.034938950277      0.606155110181      2.668106731824
H     -0.007927124708      1.938136683968      2.197538849985
C     -0.977658709713      0.641732955426     -0.713871336926
H     -2.344165804465      1.001145094610      0.875117293491
C      2.492005214183     -0.280746345964     -0.053761735405
C      3.549483425029      0.179527838958     -0.946422284210
C     -2.112550712569     -1.672753531295     -0.691738845975
C      4.202859814439     -0.611452282530     -1.794721539627
H     -1.676652269183      1.058937886931     -1.435205337021
H      0.024053523304      0.948330360877     -1.012701912647
C      5.280322383133     -0.137081979514     -2.716274367128
H      6.211125149028     -0.673065802021     -2.524755156628
H      5.469787938602      0.929586793499     -2.553359425775
C     -3.540457387962     -1.242225783470     -0.677583959733
C     -5.106203209296      0.481609289631     -0.907960776965
H     -5.089064252101      1.546940392396     -1.117399828004
H     -5.553045017466      0.287650149161      0.065852489616
H     -5.675326516217     -0.049966163955     -1.668315475306
O     -3.737129187831      0.064214875429     -0.923198102606
O      1.284934472429     -0.040565736664      3.052303576583
O     -1.321255540411      2.695887717877      0.353100851177
O     -4.452079230035     -2.007179399235     -0.477560819637
O      4.971707920394     -0.402597739138     -4.080552397081
H      4.123249970024      0.006937803243     -4.278102292238
C      2.187427186524     -1.107954972870      3.242163121086
H      1.712845179954     -2.069477517893      3.010597191794
H      3.084213805335     -1.002838159504      2.624368895058
H      2.474748204106     -1.098215587030      4.291243126775
C     -2.076458560738      3.440161563123      1.280212973828
H     -2.043719367474      4.480902309184      0.964658631451
H     -3.120347827386      3.103267395507      1.297025250265
H     -1.674737358943      3.369454114961      2.296929048517
C     -1.952867371667     -3.167757289840     -0.656082888757
H     -2.408176378001     -3.583101635102      0.243417572933
H     -2.457334358681     -3.634709318434     -1.502882556923
H     -0.898705481944     -3.440230924521     -0.679834652656
H      3.947409787423     -1.666294169462     -1.858310722852
H      3.804921945488      1.235521800373     -0.896801243597
H      2.072860399755      1.568494120762      0.838445725207
H      2.245399039492     -1.339862614627     -0.098415988724
H     -0.091698636749     -1.362461104659     -0.732455945973`}
  caption="遷移状態構造 (No.3)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -55.2572              8.5763             23.4659
Reduced mass [au]                   3.3966              6.7289              5.4924
Force const [Dyne/A]               -0.0061              0.0003              0.0018
Char temp [K]                       0.0000             12.3394             33.7623
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00577    0.02210    0.00231   -0.01755   -0.01761   -0.02453   -0.00426    0.00718   -0.03234
       C                 0.02337   -0.02352   -0.00150   -0.00674   -0.01084   -0.00899   -0.01586    0.01454   -0.04197
       C                 0.01982    0.01942   -0.00904    0.00372    0.00186   -0.03822   -0.02774    0.01992   -0.01204
       C                 0.05910    0.09032   -0.01475   -0.01504   -0.01440   -0.02513   -0.00524    0.00222   -0.00843
       H                -0.04123    0.03453    0.01312   -0.01868   -0.01286   -0.03921   -0.00526    0.00798   -0.03374
       C                -0.00543    0.00120    0.00951   -0.00672   -0.00566   -0.02898   -0.01988    0.01313    0.00553
       H                 0.09399    0.20473    0.06450   -0.02090   -0.01761   -0.03102    0.00513   -0.00860   -0.00574
       H                 0.12658    0.10859   -0.14415   -0.01451   -0.01749   -0.01731   -0.00396   -0.00060   -0.00230
       C                 0.01305    0.02031    0.00477    0.00379    0.00232   -0.02993   -0.03967    0.02048   -0.00313
       H                 0.02515   -0.08204    0.03798   -0.00852   -0.00707   -0.03703   -0.01753    0.01568    0.01707
       C                 0.00278   -0.03562   -0.00590   -0.00124   -0.00361   -0.01144   -0.00512    0.01363   -0.03274
       C                 0.01190   -0.04395    0.00028    0.01012    0.00301    0.00540    0.00363    0.01205   -0.02332
       C                 0.02183    0.01627   -0.01084    0.00208    0.00551   -0.00443   -0.01910    0.00862   -0.00812
       C                -0.00006   -0.03999   -0.01227    0.01716    0.01067    0.00369    0.04134    0.00146    0.01560
       H                 0.01119    0.02138    0.00719    0.00922    0.00516   -0.03376   -0.05453    0.01988    0.01070
       H                 0.01170    0.03019    0.00991    0.00558    0.00495   -0.02082   -0.04651    0.02894   -0.01827
       C                 0.00633   -0.03798   -0.00395    0.02940    0.01787    0.02169    0.06359   -0.00612    0.03772
       H                -0.00120   -0.05507   -0.01527    0.02532    0.01233    0.02599    0.06964    0.02438    0.09411
       H                 0.02177   -0.04387    0.01682    0.03126    0.01526    0.03660    0.03105    0.00472    0.00476
       C                 0.02010    0.01147   -0.00343    0.00548    0.01528    0.05465   -0.02402   -0.00870    0.00928
       C                 0.01411    0.00717    0.00279    0.00449    0.00835    0.00976   -0.04572   -0.01881    0.08261
       H                 0.01102    0.00732    0.00347   -0.00108   -0.01094   -0.08856   -0.05937   -0.00969    0.12782
       H                 0.01981    0.00551    0.00510    0.07486    0.10143    0.06072   -0.04295   -0.06592    0.07446
       H                 0.01121    0.00626    0.00556   -0.05704   -0.05576    0.10064   -0.03913    0.00631    0.06014
       O                 0.01493    0.01014   -0.00480   -0.00063   -0.00612   -0.05370   -0.04033   -0.00070    0.06456
       O                 0.00584    0.01371    0.00146   -0.03002   -0.03439   -0.02056    0.01414   -0.00024   -0.03962
       O                -0.12592   -0.00108    0.00159   -0.00560   -0.00411   -0.01960   -0.01778    0.01482    0.01322
       O                 0.02368    0.00858    0.00243    0.01354    0.03980    0.18456   -0.01472   -0.02793   -0.02160
       O                 0.00128   -0.00662   -0.00882    0.04421    0.03527    0.01494    0.12342   -0.06582    0.03601
       H                 0.00663    0.00882    0.00019    0.04799    0.04074    0.01004    0.12196   -0.09277   -0.01355
       C                -0.01953   -0.00770    0.00308   -0.03647   -0.04047   -0.02404    0.01695   -0.00073   -0.05672
       H                -0.04186    0.00359    0.00191   -0.03864   -0.03579   -0.03900    0.01568    0.00053   -0.05947
       H                -0.01585   -0.02899    0.00493   -0.03032   -0.03761   -0.01464    0.01108    0.00481   -0.06427
       H                -0.02166   -0.01449    0.00370   -0.04606   -0.05331   -0.02129    0.02698   -0.00847   -0.05938
       C                -0.09945   -0.04552    0.05866   -0.01046   -0.01033   -0.01853   -0.00505    0.01238    0.02551
       H                -0.20568   -0.04761    0.04075   -0.00877   -0.00821   -0.01131   -0.00408    0.01414    0.03139
       H                -0.07277   -0.12380    0.15585   -0.01061   -0.01037   -0.02642   -0.00626    0.01660    0.03449
       H                -0.00362   -0.00088    0.02370   -0.01584   -0.01736   -0.01692    0.00527    0.00470    0.02090
       C                 0.02579    0.01636   -0.01937   -0.00457    0.00500   -0.00131   -0.00171    0.00992   -0.02848
       H                 0.03065    0.01092   -0.01940    0.03331    0.01494    0.02236    0.01006   -0.00731   -0.03045
       H                 0.02324    0.01919   -0.01941   -0.04477    0.00116    0.02451   -0.00306    0.01533   -0.03058
       H                 0.02635    0.01893   -0.02522   -0.00718   -0.00114   -0.04692    0.00123    0.02234   -0.04018
       H                -0.01516   -0.03518   -0.03048    0.01448    0.01223   -0.01141    0.06281   -0.00508    0.03727
       H                 0.02919   -0.04878    0.01612    0.01318    0.00157    0.02048   -0.01612    0.01774   -0.04298
       H                 0.05743   -0.03143    0.00086   -0.00306   -0.01250    0.00588   -0.02579    0.01723   -0.04923
       H                -0.01987   -0.02970   -0.01564   -0.00479   -0.00213   -0.02635    0.00558    0.01066   -0.02326
       H                 0.02109    0.02239   -0.01665    0.00261    0.00064   -0.06881   -0.02297    0.02940   -0.02846
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在していないことが確認された。

初期構造として採用した安定構造が反応に関わる箇所をs-trans体にしたために、SIに記載されたs-cis体の2つのC-C結合を作るTS構造を求めるはずが、s-trans体でのTS構造が得られた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、BH9データセットの2. Pericyclic, No. 15の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- _J. Phys. Chem. A_ 2019, 123, 3761−3781 http://dx.doi.org/10.1021/acs.jpca.9b01546 (MOBH35のデータセットについて)

