---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Co錯体触媒が関わる酸化的環化反応(配位子:Tris(3,5-ditrifluoromethylphenyl)phosphine, NNP使用）
published: 2025-09-14
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-09-14

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(3,5-ditrifluoromethylphenyl)phosphineの遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

酸化的環化について
- https://www.sciencedirect.com/topics/chemistry/oxidative-cyclization

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.15.3
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.15.3.zip
unzip v1.15.3.zip
cd MultiOptPy-v1.15.3
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.15.3`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1::(uma-s-1.ptの絶対パス)
```

これで、`MultiOptPy-v1.15.3`がNNP`uma-s-1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3.xyz`とした。
初期構造は以下のものを使用した。

```
71
OptimizedStructure
Co     2.877811463081     -0.357700146945     -0.212753455818
C      4.154038718311      0.234488206334     -1.705002944421
C      3.385265267608      1.403834877311     -1.522237475646
C      3.324277437253     -0.693797415809     -2.373664963378
H      5.171856902014      0.085331143823     -1.383682133861
C      2.203615201587      1.290150703278     -2.340355103798
H      3.738346996600      2.315035713872     -1.062164326503
C      2.171281513591      0.021648648521     -2.861576439670
H      3.597784632275     -1.696833648051     -2.659008327264
H      1.473613695847      2.073248537845     -2.475229279711
H      1.394477351551     -0.406995665693     -3.475428755175
P      0.528586908074     -0.185925016008     -0.073076408888
C      2.748049438177      0.317557435343      1.744007943258
H      1.996081860136      0.204467743500      2.498074063688
C      3.844412766308      0.638872451437      1.280731879900
H      4.818185795821      1.080493151947      1.242205120173
C      3.079459827555     -2.289057027248      0.485009943773
H      2.414461130956     -3.029672604834      0.872442272246
C      4.191267988379     -1.871553215819      0.154786571581
H      5.247167017471     -1.856780305532     -0.015163785412
C     -0.711226606725     -0.562591389678     -1.397464036194
C     -1.349019648886     -1.787128212309     -1.543050832241
C     -0.981747587159      0.427388382074     -2.344193110820
C     -2.217923466988     -2.016691960742     -2.603151722641
H     -1.199765524473     -2.588095097420     -0.835501399597
C     -1.842378757102      0.190656969776     -3.399061779769
H     -0.513523036964      1.397736774322     -2.264354007328
C     -2.471361085153     -1.037755982524     -3.543630699620
H     -3.140330874971     -1.224405810204     -4.371228559205
C     -0.095679484724      1.491094732769      0.362588640133
C     -1.461556087886      1.743489786419      0.499368838987
C      0.802357850413      2.535255238336      0.539275601528
C     -1.910159123666      3.012909145513      0.816616080607
H     -2.183609036757      0.948907279819      0.360144375775
C      0.342583281013      3.807943619440      0.850603826560
H      1.861221153402      2.352263695959      0.431886417453
C     -1.010799725786      4.055972048025      0.993277108013
H     -1.365510068709      5.049532636486      1.238793416758
C     -0.137711366974     -1.179301288323      1.329599794015
C     -0.628596350209     -0.614041165967      2.498387161240
C     -0.039882113600     -2.571682167462      1.267800867300
C     -1.021021380181     -1.415496545791      3.565164583219
H     -0.701156724672      0.460213523714      2.606034940404
C     -0.447744856078     -3.362648770118      2.324365869604
H      0.379980895940     -3.048191657058      0.392203153223
C     -0.943630917358     -2.791302528965      3.489567442195
H     -1.244747448426     -3.409833462826      4.323208906072
C     -2.129505670286      1.305046446908     -4.369404830343
C     -2.909921189714     -3.351260588047     -2.673686376681
C     -0.378954045028     -4.862194960547      2.207097117747
C     -1.552336785992     -0.735185229435      4.798186738379
C     -3.382521343468      3.299705122805      0.948048337544
C      1.310239573677      4.943158194945      1.053911659062
F     -1.708662921238     -1.584386840864      5.821324893466
F     -0.725756184296      0.244498318969      5.206238675393
F     -2.746160570688     -0.162642061337      4.562208797082
F     -0.049454966567     -5.436279162298      3.373693453409
F      0.527426970596     -5.250041402366      1.294781776533
F     -1.562875392576     -5.376916511660      1.832013716250
F     -3.533072422019     -3.539135534244     -3.844300040978
F     -3.834695563279     -3.470522563426     -1.702670340536
F     -2.041927357433     -4.364444768336     -2.508085389394
F     -2.503763950201      0.839038184136     -5.569875867771
F     -3.122171096798      2.096947759437     -3.922698462992
F     -1.056734835492      2.090298886447     -4.555527748488
F     -3.822426491917      4.062789415081     -0.067589869199
F     -4.116781028369      2.178788418988      0.953868546623
F     -3.652478013865      3.966474037710      2.083088198842
F      0.986955909690      6.005214111174      0.295831398553
F      1.310280051964      5.362383537867      2.331992507308
F      2.568193503379      4.597655827558      0.746387839446

```

<MoleculeViewer 
  xyzData={`71
OptimizedStructure
Co     2.877811463081     -0.357700146945     -0.212753455818
C      4.154038718311      0.234488206334     -1.705002944421
C      3.385265267608      1.403834877311     -1.522237475646
C      3.324277437253     -0.693797415809     -2.373664963378
H      5.171856902014      0.085331143823     -1.383682133861
C      2.203615201587      1.290150703278     -2.340355103798
H      3.738346996600      2.315035713872     -1.062164326503
C      2.171281513591      0.021648648521     -2.861576439670
H      3.597784632275     -1.696833648051     -2.659008327264
H      1.473613695847      2.073248537845     -2.475229279711
H      1.394477351551     -0.406995665693     -3.475428755175
P      0.528586908074     -0.185925016008     -0.073076408888
C      2.748049438177      0.317557435343      1.744007943258
H      1.996081860136      0.204467743500      2.498074063688
C      3.844412766308      0.638872451437      1.280731879900
H      4.818185795821      1.080493151947      1.242205120173
C      3.079459827555     -2.289057027248      0.485009943773
H      2.414461130956     -3.029672604834      0.872442272246
C      4.191267988379     -1.871553215819      0.154786571581
H      5.247167017471     -1.856780305532     -0.015163785412
C     -0.711226606725     -0.562591389678     -1.397464036194
C     -1.349019648886     -1.787128212309     -1.543050832241
C     -0.981747587159      0.427388382074     -2.344193110820
C     -2.217923466988     -2.016691960742     -2.603151722641
H     -1.199765524473     -2.588095097420     -0.835501399597
C     -1.842378757102      0.190656969776     -3.399061779769
H     -0.513523036964      1.397736774322     -2.264354007328
C     -2.471361085153     -1.037755982524     -3.543630699620
H     -3.140330874971     -1.224405810204     -4.371228559205
C     -0.095679484724      1.491094732769      0.362588640133
C     -1.461556087886      1.743489786419      0.499368838987
C      0.802357850413      2.535255238336      0.539275601528
C     -1.910159123666      3.012909145513      0.816616080607
H     -2.183609036757      0.948907279819      0.360144375775
C      0.342583281013      3.807943619440      0.850603826560
H      1.861221153402      2.352263695959      0.431886417453
C     -1.010799725786      4.055972048025      0.993277108013
H     -1.365510068709      5.049532636486      1.238793416758
C     -0.137711366974     -1.179301288323      1.329599794015
C     -0.628596350209     -0.614041165967      2.498387161240
C     -0.039882113600     -2.571682167462      1.267800867300
C     -1.021021380181     -1.415496545791      3.565164583219
H     -0.701156724672      0.460213523714      2.606034940404
C     -0.447744856078     -3.362648770118      2.324365869604
H      0.379980895940     -3.048191657058      0.392203153223
C     -0.943630917358     -2.791302528965      3.489567442195
H     -1.244747448426     -3.409833462826      4.323208906072
C     -2.129505670286      1.305046446908     -4.369404830343
C     -2.909921189714     -3.351260588047     -2.673686376681
C     -0.378954045028     -4.862194960547      2.207097117747
C     -1.552336785992     -0.735185229435      4.798186738379
C     -3.382521343468      3.299705122805      0.948048337544
C      1.310239573677      4.943158194945      1.053911659062
F     -1.708662921238     -1.584386840864      5.821324893466
F     -0.725756184296      0.244498318969      5.206238675393
F     -2.746160570688     -0.162642061337      4.562208797082
F     -0.049454966567     -5.436279162298      3.373693453409
F      0.527426970596     -5.250041402366      1.294781776533
F     -1.562875392576     -5.376916511660      1.832013716250
F     -3.533072422019     -3.539135534244     -3.844300040978
F     -3.834695563279     -3.470522563426     -1.702670340536
F     -2.041927357433     -4.364444768336     -2.508085389394
F     -2.503763950201      0.839038184136     -5.569875867771
F     -3.122171096798      2.096947759437     -3.922698462992
F     -1.056734835492      2.090298886447     -4.555527748488
F     -3.822426491917      4.062789415081     -0.067589869199
F     -4.116781028369      2.178788418988      0.953868546623
F     -3.652478013865      3.966474037710      2.083088198842
F      0.986955909690      6.005214111174      0.295831398553
F      1.310280051964      5.362383537867      2.331992507308
F      2.568193503379      4.597655827558      0.746387839446
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3.xyz`として保存し、以下を実行する。
```
python optmain.py .\co_cat_oxidative_cyclization_P_mmdiCF3Ph_3.xyz -os uma-s-1 -opt rsirfo_fsb -ma 100 1 13 100 1 17 200 15 19
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）今回はUMAモデルのNNPを使用し、ラジカル反応を扱うためスピンだ重度を2とした。
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。


これを実行すると、`omol`のデータセットを使用した`uma-s-1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.15.3`ディレクトリに置く。

`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj.xyz`は次のNEB計算に使用する。

※`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）



```
python .\nebmain.py co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj.xyz -os uma-s-1 -ns 15 -modelhess -spng -nd 0.3 -aneb 3 5
```

- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `-aneb A B`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.15.3`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-4789.978056310936,-4789.953228195609,-4789.953843268213,-4789.935031623112,-4789.930613228916,-4789.9418391800955,-4789.932410029472,-4789.952589361227,-4789.971100146455,-4789.9876281549,-4790.02438240534,-4790.038144295605,-4790.053699288983,-4790.055088161472,-4790.057109559907,-4790.057350822573,-4790.057740035611,-4790.057831981079,-4790.058061292762,-4790.0584015277955,-4790.058646558001,-4790.058866582263,-4790.059034684585,-4790.059186647822,-4790.059074199933,-4790.059262103737,-4790.059364282893,-4790.059565048899,-4790.059692847317,-4790.059683717607,-4790.059807625823,-4790.059865540778,-4790.059904810799,-4790.0599863648695,-4790.060058649044,-4790.060146651739];

export const dataset1_itr5 = [-4789.977960632976,-4789.970846424625,-4789.96373505507,-4789.942873246815,-4789.939107311472,-4789.955078398836,-4789.954166908552,-4789.962030690639,-4789.996278546506,-4790.015710021822,-4790.036269445665,-4790.0509356153225,-4790.060242347223,-4790.061272725259,-4790.061463362719,-4790.062313354505,-4790.063180449165,-4790.063326822426,-4790.063504913105,-4790.0637707962,-4790.064045511106,-4790.064220447567,-4790.06431945498,-4790.064571231709,-4790.0644928669035,-4790.064613778612,-4790.065238716909,-4790.065497362824,-4790.065749437451,-4790.065612667033,-4790.065484045012,-4790.065724939687,-4790.065624530399,-4790.0659066051485,-4790.065919817819,-4790.066477133178];

export const dataset1_itr10 = [-4789.978270342183,-4789.975562708472,-4789.971623299874,-4789.951748639339,-4789.944436337305,-4789.93993308587,-4789.941036527872,-4789.946838081918,-4789.949417479125,-4789.954009372862,-4789.957650742861,-4789.960181188349,-4789.9607013365,-4789.960863218002,-4789.960427068441,-4789.960629551744,-4789.9627875453625,-4789.965023351799,-4789.967355966457,-4789.969724530444,-4790.0172392219865,-4790.032445691745,-4790.045050176588,-4790.056040332413,-4790.0621655092755,-4790.062760727826,-4790.063044239497,-4790.0635452520555,-4790.064247994409,-4790.064438929767,-4790.064686062785,-4790.064985030126,-4790.065130895207,-4790.065498694606,-4790.065529027673,-4790.065878900596,-4790.065629436961,-4790.065633257071,-4790.065628070133,-4790.065612334088,-4790.065715985212,-4790.065690208237,-4790.065697235135,-4790.065699092619,-4790.066194269873,-4790.066347512321,-4790.06658236141,-4790.066561999178,-4790.066385923693,-4790.066417588542,-4790.066422232252,-4790.066415660964,-4790.066601567096,-4790.066665422497,-4790.066713524328,-4790.066745925162,-4790.066685924917,-4790.066656993724,-4790.066633634984,-4790.06661714543,-4790.066667928349,-4790.066716170368,-4790.066760627325,-4790.066802280532,-4790.067055967314,-4790.066919319561];


export const dataset2 = [-4789.978152654788,-4789.9768941391385,-4789.975386895839,-4789.960396165862,-4789.94928337227,-4789.947380800254,-4789.945760180324,-4789.9445457624015,-4789.943862891624,-4789.943565256064,-4789.943798869751,-4789.944482756887,-4789.945596818092,-4789.952083564771,-4789.953707093591,-4789.956906811671,-4789.960284129774,-4789.9631008819215,-4789.964616773037,-4789.9659949912775,-4789.965449626903,-4789.964479678436,-4789.96465304655,-4789.965328119398,-4789.964797457185,-4789.964688400082,-4789.964569258241,-4789.964457756618,-4789.967553727194,-4789.9704116418925,-4789.973928875871,-4789.977841158189,-4790.03425141173,-4790.043986521547,-4790.051903574879,-4790.059373412602,-4790.063148381277,-4790.0636095805885,-4790.0638524554115,-4790.064215576052,-4790.06479379687,-4790.064948301005,-4790.0652178815435,-4790.065505283417,-4790.065590534933,-4790.065986915056,-4790.0659556532455,-4790.066350403688,-4790.0661336212615,-4790.066097663171,-4790.066013007452,-4790.066005577515,-4790.065974771314,-4790.065988387024,-4790.0660006183825,-4790.066017984108,-4790.066036471332,-4790.066026798396,-4790.06602457292,-4790.066023433896,-4790.066019158177,-4790.066114993849,-4790.066158154072,-4790.066194234827,-4790.066228177722,-4790.066238341315,-4790.066156892384,-4790.066132674996,-4790.066103375811,-4790.066118813958,-4790.066113521881,-4790.066116097825,-4790.0661040241785,-4790.066087937664,-4790.066083171289,-4790.066077160751,-4790.066071710962,-4790.066281834484,-4790.066376916647,-4790.066443978836,-4790.066499037473,-4790.066656222693,-4790.066883606798,-4790.066861527269,-4790.0667980573835,-4790.066831316865,-4790.066743682162,-4790.06673071482,-4790.066686275386,-4790.0666893419875,-4790.066693109526,-4790.066697192487,-4790.066701152783,-4790.066706024299,-4790.066707285985,-4790.06671317386,-4790.06670639229,-4790.066785615744,-4790.066826357733,-4790.06686561023,-4790.066902216688,-4790.066969068595,-4790.067028683325,-4790.067058508213,-4790.066988764937,-4790.067052848143,-4790.067034501106,-4790.066979092001,-4790.066970049908,-4790.066967298729,-4790.066925452764,-4790.066948566176,-4790.0669542788155,-4790.0669626199715,-4790.066969646869,-4790.067061679955,-4790.067071826024,-4790.067102772412,-4790.067402510785,-4790.067193088202];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [7.06571799850362e-05,0.011464194820481775,0.005490184114886649,0.004881293497050474,0.006577057437510895,0.009067002962214356,0.01357947986716341,0.0070366758833522855,0.010492988699097412,0.010497361406593263,0.005751035484923882,0.00690271161580149,0.005549588132286056,0.005586746177974998,0.005490748713003663,0.005532755403417084,0.00551402777404124,0.005516637754710592,0.005534409645172899,0.005523595576849827,0.005514604099106037,0.005509564134680946,0.005488262230088565,0.00547563501342906,0.005569893574490993,0.005532853228320672,0.005539688084779341,0.005501141802201015,0.00549887578883509,0.005555192643351318,0.005527817842862313,0.0055253016438136975,0.0055399432866754085,0.00553429516133646,0.0055313684723770195,0.005528820277910175];

export const dataset1_grad_itr5 = [0.0006030194673524289,0.0036409882088056806,0.0038084967659440545,0.004127087868867443,0.003934417381763527,0.0031460797598346865,0.004010231039267671,0.004979978607127801,0.00825608356006764,0.006040126242115959,0.0036562541254023953,0.002688968064173309,0.0015684539840549985,0.0017114341236295386,0.0024966426852082277,0.0021543617203242708,0.0020035705006551034,0.001963389615351029,0.0020725544552068773,0.002109755493340033,0.00206684672055853,0.0021509284850243183,0.002313842086668127,0.002210985172801836,0.002238269005001231,0.002243877891903407,0.0016023040246301076,0.0013543196772022783,0.0012652604070269703,0.0014683837082311343,0.0017406338283406557,0.0017903361498395655,0.0018901830658195349,0.0014643595824956443,0.0016133611065493002,0.0014908245241830214];

export const dataset1_grad_itr10 = [0.00022111474751489895,0.0017406938288709157,0.002401614030260933,0.0037721880429929006,0.0033563961596272678,0.0023780539522279586,0.0026517393539394678,0.0036843470065271253,0.003814858741381775,0.0034264373318085785,0.002836828133462367,0.0027032411656441016,0.002785888443879766,0.002940151839272842,0.0031574423455359747,0.003347546394058607,0.0035113120376723613,0.003976769965459811,0.0045479857699166825,0.005189834123412843,0.007463657623659962,0.0048080606823712084,0.003059147234162051,0.0018986025238759104,0.000816718680741066,0.0011151221253372476,0.0015790226098933969,0.001498094074822401,0.0014024359383266502,0.0012613341833830095,0.001435879833064099,0.0014284276127401177,0.0013080436337771072,0.00124951990844383,0.0013792877214270096,0.0012174277047891317,0.001484658519181084,0.001484515184152153,0.0014866262187380262,0.0014417622931862453,0.0013573423184716192,0.0014659441735819856,0.0014998711972727054,0.0015319501906434427,0.0008671635857805191,0.0007742318965387454,0.0006776809489986049,0.0008696776368988585,0.0010527371163069072,0.0010655987698637709,0.0010848008983040719,0.001104470122394848,0.0008523693530736847,0.0008040815438582954,0.0007770541564179383,0.0007639607097218753,0.0009606870658584375,0.001001960181453448,0.001016281309545298,0.000971981857442557,0.0008782038885078324,0.0008349889205909698,0.0008158301352766745,0.000805372516121873,0.0007173871007412217,0.000853226192427577];


export const dataset2_grad = [0.0006628704030031406,0.001093098870157337,0.0014914698627851036,0.003378519212255474,0.0030842601468973325,0.0028863034015822347,0.0026117688860825103,0.0022694974383996795,0.00200968470814202,0.001964829577559242,0.0021018081253335076,0.002387188318053475,0.002749021198646137,0.003489722444248745,0.003514875528985134,0.00313509021818667,0.002643410434362039,0.0028077176001112766,0.0031690804707332,0.0034479420243496337,0.0034680501035822524,0.0034175677837362884,0.0034921787652764293,0.0036748492539818256,0.0035876271914085304,0.0036077840549855016,0.003629841520959875,0.0036566827033871698,0.004028424431609966,0.004564863838188129,0.0052214182712368665,0.005865172387578028,0.006142400443855913,0.0037753437531897246,0.002540445257436456,0.0014905912076334314,0.0006412613746201693,0.0008571678638777013,0.0011774236028278286,0.0011654938609077072,0.0010925890713520813,0.0010136403342360107,0.0011614290281972083,0.001101762435569239,0.0009831791210128016,0.0008220414371467262,0.0010267769225106257,0.0006770620863272519,0.0009695741211584668,0.0010769660946193763,0.0011533243896152908,0.0011461389760156987,0.0011578922096951083,0.0011435724093591974,0.0011460487944977248,0.0011362075831589226,0.0011308322523996613,0.001191867577730598,0.0011931757682510755,0.0011931362342930364,0.001185545666944495,0.0009714048862086365,0.0009372959300297139,0.0008961390141296483,0.0008721052473141439,0.0009288085674193136,0.0010297190253326701,0.0010814567913461897,0.0010849986722120876,0.0010714419974872113,0.0010982648722356728,0.0011038292530779312,0.0011762737212841908,0.0012230913127001977,0.0012427741746896693,0.0012693526211515693,0.0012821588467118847,0.0009212732816590921,0.0008040997442583144,0.0007337487752871349,0.0006812007712547548,0.000619499870464192,0.0004988466580771168,0.0006267384704556099,0.0007031654491016827,0.0006932722063346342,0.0007839298703255004,0.000786133656241301,0.0008753629200461713,0.000891970339027155,0.000892728480873924,0.0008939780322967787,0.0008949229252070863,0.0008802554514967953,0.0008840683519784383,0.0008769447188284902,0.0008915138128759987,0.0007676687099329059,0.0007210722701735831,0.0006756102256650522,0.0006333823034812585,0.0005825320934694152,0.0005220253200240538,0.0004894247754507136,0.0006614458604338832,0.0005794506258592668,0.0005555009209427596,0.0005948056831361692,0.0006022838799190216,0.0006038488078033666,0.0006457577247682294,0.0006661534542763698,0.0006772943334971714,0.0006869832103206579,0.0006989223946337544,0.0005827801507727622,0.0005993753694281726,0.000580757064613999,0.00033329349500555604,0.000791296944908438];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、緩和後に得られた経路の9番(グラフ上では10番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj_9.xyz`
```
71
0 1
Co      2.770652641320     -0.378291936579     -0.173787722323
C       4.107894571039      0.241504016850     -1.735640925012
C       3.363442788631      1.420610754326     -1.569154494482
C       3.293630754349     -0.680781098773     -2.423973263316
H       5.109116625745      0.070840342839     -1.373275944730
C       2.179674197263      1.304582608944     -2.386839263532
H       3.721632156696      2.319354756146     -1.088263218098
C       2.142107573593      0.038279508688     -2.905800183589
H       3.571250941907     -1.689654694150     -2.687608101766
H       1.449362505215      2.088095000674     -2.508105077531
H       1.365312217918     -0.394132796286     -3.514140396362
P       0.494477999451     -0.189674192029     -0.078821854729
C       2.770680119556      0.188465610869      1.625168249673
H       2.088773798024      0.433901731333      2.430051161014
C       4.001666348334      0.137874787471      1.250739086278
H       4.909205029867      0.719173065481      1.334054518098
C       3.072761318226     -2.092623554467      0.506964548574
H       2.574197523071     -3.032519538760      0.680560283468
C       4.220101508209     -1.508208054638      0.490206366783
H       5.259966022446     -1.700095055214      0.276903695765
C      -0.719591383682     -0.563589882846     -1.405396430896
C      -1.353268525586     -1.788984183311     -1.548682970057
C      -0.985028913040      0.428866410982     -2.349004028211
C      -2.221443784480     -2.016841076710     -2.608455271042
H      -1.203055191035     -2.587590830632     -0.838373320600
C      -1.846282260110      0.192979152970     -3.402370923495
H      -0.515234172822      1.397814842654     -2.264776906380
C      -2.475548281818     -1.035460807223     -3.546127702569
H      -3.147140233010     -1.219978154993     -4.371939561666
C      -0.100178943204      1.489784462571      0.364558347101
C      -1.464696924271      1.743476790432      0.500334066002
C       0.802837960541      2.529772713138      0.543989382249
C      -1.911664876909      3.013164533430      0.815277840207
H      -2.183686463608      0.946293018850      0.359650772284
C       0.343571021426      3.804027868869      0.851289182573
H       1.862919401329      2.347190819426      0.431249776256
C      -1.010051517264      4.054083721102      0.990110674580
H      -1.364269236311      5.048680479712      1.230680922750
C      -0.152353679595     -1.182038855375      1.331465912169
C      -0.636979882510     -0.614608556570      2.500850854494
C      -0.038231686641     -2.572676780991      1.272317018298
C      -1.023701413330     -1.416489702454      3.569358918116
H      -0.707762026225      0.459961720647      2.605851192238
C      -0.446256117987     -3.363626370145      2.328338662961
H       0.388686361783     -3.047111038337      0.398823089493
C      -0.945404747039     -2.792054550850      3.491845334963
H      -1.248496670035     -3.410802578334      4.324330151505
C      -2.133318950337      1.307852058500     -4.371641946972
C      -2.913346379646     -3.350719583432     -2.677275169788
C      -0.377250327756     -4.862379737757      2.209818831804
C      -1.552711788067     -0.736732298421      4.802790309384
C      -3.383663501024      3.299384204288      0.945208391595
C       1.309286179514      4.941749331709      1.050561609096
F      -1.710794792539     -1.587089958512      5.824349999086
F      -0.724836500262      0.241709125696      5.211975705694
F      -2.745592389113     -0.161993442958      4.566609429029
F      -0.050962130010     -5.438321285802      3.376107937702
F       0.530161776625     -5.249190275927      1.298035781438
F      -1.560803974915     -5.375903836028      1.831476429877
F      -3.536151807672     -3.540382613474     -3.847460748261
F      -3.838187233845     -3.467343793750     -1.706092745815
F      -2.045199568382     -4.363388304892     -2.508689379392
F      -2.508908467171      0.842485850874     -5.571841762641
F      -3.125898624310      2.099205401794     -3.923414375345
F      -1.060770939040      2.092506746637     -4.556664868394
F      -3.823629932413      4.059932948185     -0.071951178101
F      -4.116675121149      2.177608991826      0.953192537193
F      -3.652500774040      3.967938603250      2.079283556933
F       0.979553672068      6.002058809032      0.293526671944
F       1.311946751463      5.361177000688      2.328665444060
F       2.566660366591      4.598891629738      0.738997092375

```


<MoleculeViewer 
  xyzData={`71
0 1
Co      2.770652641320     -0.378291936579     -0.173787722323
C       4.107894571039      0.241504016850     -1.735640925012
C       3.363442788631      1.420610754326     -1.569154494482
C       3.293630754349     -0.680781098773     -2.423973263316
H       5.109116625745      0.070840342839     -1.373275944730
C       2.179674197263      1.304582608944     -2.386839263532
H       3.721632156696      2.319354756146     -1.088263218098
C       2.142107573593      0.038279508688     -2.905800183589
H       3.571250941907     -1.689654694150     -2.687608101766
H       1.449362505215      2.088095000674     -2.508105077531
H       1.365312217918     -0.394132796286     -3.514140396362
P       0.494477999451     -0.189674192029     -0.078821854729
C       2.770680119556      0.188465610869      1.625168249673
H       2.088773798024      0.433901731333      2.430051161014
C       4.001666348334      0.137874787471      1.250739086278
H       4.909205029867      0.719173065481      1.334054518098
C       3.072761318226     -2.092623554467      0.506964548574
H       2.574197523071     -3.032519538760      0.680560283468
C       4.220101508209     -1.508208054638      0.490206366783
H       5.259966022446     -1.700095055214      0.276903695765
C      -0.719591383682     -0.563589882846     -1.405396430896
C      -1.353268525586     -1.788984183311     -1.548682970057
C      -0.985028913040      0.428866410982     -2.349004028211
C      -2.221443784480     -2.016841076710     -2.608455271042
H      -1.203055191035     -2.587590830632     -0.838373320600
C      -1.846282260110      0.192979152970     -3.402370923495
H      -0.515234172822      1.397814842654     -2.264776906380
C      -2.475548281818     -1.035460807223     -3.546127702569
H      -3.147140233010     -1.219978154993     -4.371939561666
C      -0.100178943204      1.489784462571      0.364558347101
C      -1.464696924271      1.743476790432      0.500334066002
C       0.802837960541      2.529772713138      0.543989382249
C      -1.911664876909      3.013164533430      0.815277840207
H      -2.183686463608      0.946293018850      0.359650772284
C       0.343571021426      3.804027868869      0.851289182573
H       1.862919401329      2.347190819426      0.431249776256
C      -1.010051517264      4.054083721102      0.990110674580
H      -1.364269236311      5.048680479712      1.230680922750
C      -0.152353679595     -1.182038855375      1.331465912169
C      -0.636979882510     -0.614608556570      2.500850854494
C      -0.038231686641     -2.572676780991      1.272317018298
C      -1.023701413330     -1.416489702454      3.569358918116
H      -0.707762026225      0.459961720647      2.605851192238
C      -0.446256117987     -3.363626370145      2.328338662961
H       0.388686361783     -3.047111038337      0.398823089493
C      -0.945404747039     -2.792054550850      3.491845334963
H      -1.248496670035     -3.410802578334      4.324330151505
C      -2.133318950337      1.307852058500     -4.371641946972
C      -2.913346379646     -3.350719583432     -2.677275169788
C      -0.377250327756     -4.862379737757      2.209818831804
C      -1.552711788067     -0.736732298421      4.802790309384
C      -3.383663501024      3.299384204288      0.945208391595
C       1.309286179514      4.941749331709      1.050561609096
F      -1.710794792539     -1.587089958512      5.824349999086
F      -0.724836500262      0.241709125696      5.211975705694
F      -2.745592389113     -0.161993442958      4.566609429029
F      -0.050962130010     -5.438321285802      3.376107937702
F       0.530161776625     -5.249190275927      1.298035781438
F      -1.560803974915     -5.375903836028      1.831476429877
F      -3.536151807672     -3.540382613474     -3.847460748261
F      -3.838187233845     -3.467343793750     -1.706092745815
F      -2.045199568382     -4.363388304892     -2.508689379392
F      -2.508908467171      0.842485850874     -5.571841762641
F      -3.125898624310      2.099205401794     -3.923414375345
F      -1.060770939040      2.092506746637     -4.556664868394
F      -3.823629932413      4.059932948185     -0.071951178101
F      -4.116675121149      2.177608991826      0.953192537193
F      -3.652500774040      3.967938603250      2.079283556933
F       0.979553672068      6.002058809032      0.293526671944
F       1.311946751463      5.361177000688      2.328665444060
F       2.566660366591      4.598891629738      0.738997092375
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj_9.xyz`を`MultiOptPy-v1.15.3`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py .\co_cat_oxidative_cyclization_P_mmdiCF3Ph_3_traj_9.xyz -fc 5 -order 1 -opt rsirfo_bofill -freq -tcc -os uma-s-1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
71
OptimizedStructure
Co     2.641367323011     -0.510922025468     -0.605880995607
C      3.918478127115      0.335760187863     -2.016330098979
C      3.337765198017      1.445256137744     -1.362150226739
C      2.929568785320     -0.195394792327     -2.858442515744
H      4.891266387316     -0.084792051508     -1.819192904858
C      2.135196619828      1.804611239217     -2.109002887676
H      3.859226677146      2.100201587534     -0.679929035379
C      1.886460086534      0.810966722428     -3.002177273917
H      3.026232655409     -1.078334713001     -3.470394461758
H      1.535639518659      2.685392526162     -1.933460726119
H      1.057900541358      0.742580193264     -3.689230652659
P      0.530056744852     -0.095695427803     -0.105632376302
C      3.212210456447     -0.255288447386      1.257912981072
H      2.955481773370      0.330322457940      2.124280365648
C      4.138090340919     -0.964278970590      0.769579147261
H      5.148944487526     -1.314198356145      0.866441859418
C      2.218519088339     -2.413741196652     -0.639551160272
H      1.403580976286     -3.063073902622     -0.906538259975
C      3.479637900603     -2.379333861938     -0.542418290744
H      4.405161067382     -2.903821858387     -0.689925044386
C     -0.749710587983     -0.517059326316     -1.347456897141
C     -1.233736208776     -1.818908637621     -1.420280517172
C     -1.183780691344      0.406974962905     -2.293203736094
C     -2.130217474898     -2.183899254786     -2.413128765364
H     -0.926627676800     -2.559814643509     -0.691562962442
C     -2.088723795975      0.036123451368     -3.274124422168
H     -0.819391262343      1.426042731352     -2.267653940703
C     -2.568191252260     -1.262076452533     -3.348296922536
H     -3.272948321215     -1.546733221604     -4.115672906444
C      0.041993010962      1.599709749613      0.412622257395
C     -1.258462840813      2.090029795886      0.355566040966
C      1.033722599475      2.418344893353      0.942640917656
C     -1.554889624309      3.360852896696      0.824360737628
H     -2.058626509456      1.497984081716     -0.070370042334
C      0.727943834127      3.683662157483      1.416741360051
H      2.057881194902      2.070712822684      0.962595923698
C     -0.568152274506      4.169133148991      1.363068121518
H     -0.803324313059      5.158759141271      1.726192886246
C     -0.122455305267     -1.054130540534      1.331435829441
C     -1.454917192592     -0.919716697531      1.731210180526
C      0.693438109433     -1.928897924158      2.029565161337
C     -1.942856904644     -1.635650652456      2.804449947341
H     -2.128186759783     -0.261943567686      1.200321260821
C      0.192756731680     -2.647714507057      3.112363067597
H      1.725952711121     -2.058514122684      1.731151357406
C     -1.119872392072     -2.508367526729      3.509895847010
H     -1.505249324004     -3.069018970483      4.350609750212
C     -2.509027341114      1.073004393501     -4.280395706589
C     -2.632965823854     -3.601919535180     -2.425581996185
C      1.128000372584     -3.579127666097      3.834163120404
C     -3.377048033153     -1.494857221873      3.236554440238
C     -2.981104786949      3.831513056034      0.726291334784
C      1.849889961355      4.519345663164      1.970066193637
F     -4.025461578683     -2.671021854059      3.171329020082
F     -3.464009767208     -1.072971732081      4.510483277858
F     -4.052744709134     -0.620904033890      2.477213226554
F      2.170887730850     -2.912730070851      4.360057087793
F      1.636763259781     -4.503418360051      3.000709257241
F      0.522649353885     -4.231900354682      4.836649528528
F     -3.413092160252     -3.857607955090     -3.483312000056
F     -3.349669977443     -3.874317147088     -1.319934423027
F     -1.613852225591     -4.480250180459     -2.451948827589
F     -3.553455789294      0.672947728786     -5.017173184215
F     -2.851002866282      2.226227615432     -3.681420674595
F     -1.504298112675      1.358501576981     -5.129990050900
F     -3.404421223448      3.835721416079     -0.550108106742
F     -3.808503057008      3.017935347016      1.406793495854
F     -3.143826779488      5.069295906478      1.210382786001
F      1.428715192507      5.710825889210      2.413474760386
F      2.459838715765      3.898478389976      2.996325665635
F      2.793587409811      4.745129892784      1.038374798166

```

<MoleculeViewer 
  xyzData={`71
OptimizedStructure
Co     2.641367323011     -0.510922025468     -0.605880995607
C      3.918478127115      0.335760187863     -2.016330098979
C      3.337765198017      1.445256137744     -1.362150226739
C      2.929568785320     -0.195394792327     -2.858442515744
H      4.891266387316     -0.084792051508     -1.819192904858
C      2.135196619828      1.804611239217     -2.109002887676
H      3.859226677146      2.100201587534     -0.679929035379
C      1.886460086534      0.810966722428     -3.002177273917
H      3.026232655409     -1.078334713001     -3.470394461758
H      1.535639518659      2.685392526162     -1.933460726119
H      1.057900541358      0.742580193264     -3.689230652659
P      0.530056744852     -0.095695427803     -0.105632376302
C      3.212210456447     -0.255288447386      1.257912981072
H      2.955481773370      0.330322457940      2.124280365648
C      4.138090340919     -0.964278970590      0.769579147261
H      5.148944487526     -1.314198356145      0.866441859418
C      2.218519088339     -2.413741196652     -0.639551160272
H      1.403580976286     -3.063073902622     -0.906538259975
C      3.479637900603     -2.379333861938     -0.542418290744
H      4.405161067382     -2.903821858387     -0.689925044386
C     -0.749710587983     -0.517059326316     -1.347456897141
C     -1.233736208776     -1.818908637621     -1.420280517172
C     -1.183780691344      0.406974962905     -2.293203736094
C     -2.130217474898     -2.183899254786     -2.413128765364
H     -0.926627676800     -2.559814643509     -0.691562962442
C     -2.088723795975      0.036123451368     -3.274124422168
H     -0.819391262343      1.426042731352     -2.267653940703
C     -2.568191252260     -1.262076452533     -3.348296922536
H     -3.272948321215     -1.546733221604     -4.115672906444
C      0.041993010962      1.599709749613      0.412622257395
C     -1.258462840813      2.090029795886      0.355566040966
C      1.033722599475      2.418344893353      0.942640917656
C     -1.554889624309      3.360852896696      0.824360737628
H     -2.058626509456      1.497984081716     -0.070370042334
C      0.727943834127      3.683662157483      1.416741360051
H      2.057881194902      2.070712822684      0.962595923698
C     -0.568152274506      4.169133148991      1.363068121518
H     -0.803324313059      5.158759141271      1.726192886246
C     -0.122455305267     -1.054130540534      1.331435829441
C     -1.454917192592     -0.919716697531      1.731210180526
C      0.693438109433     -1.928897924158      2.029565161337
C     -1.942856904644     -1.635650652456      2.804449947341
H     -2.128186759783     -0.261943567686      1.200321260821
C      0.192756731680     -2.647714507057      3.112363067597
H      1.725952711121     -2.058514122684      1.731151357406
C     -1.119872392072     -2.508367526729      3.509895847010
H     -1.505249324004     -3.069018970483      4.350609750212
C     -2.509027341114      1.073004393501     -4.280395706589
C     -2.632965823854     -3.601919535180     -2.425581996185
C      1.128000372584     -3.579127666097      3.834163120404
C     -3.377048033153     -1.494857221873      3.236554440238
C     -2.981104786949      3.831513056034      0.726291334784
C      1.849889961355      4.519345663164      1.970066193637
F     -4.025461578683     -2.671021854059      3.171329020082
F     -3.464009767208     -1.072971732081      4.510483277858
F     -4.052744709134     -0.620904033890      2.477213226554
F      2.170887730850     -2.912730070851      4.360057087793
F      1.636763259781     -4.503418360051      3.000709257241
F      0.522649353885     -4.231900354682      4.836649528528
F     -3.413092160252     -3.857607955090     -3.483312000056
F     -3.349669977443     -3.874317147088     -1.319934423027
F     -1.613852225591     -4.480250180459     -2.451948827589
F     -3.553455789294      0.672947728786     -5.017173184215
F     -2.851002866282      2.226227615432     -3.681420674595
F     -1.504298112675      1.358501576981     -5.129990050900
F     -3.404421223448      3.835721416079     -0.550108106742
F     -3.808503057008      3.017935347016      1.406793495854
F     -3.143826779488      5.069295906478      1.210382786001
F      1.428715192507      5.710825889210      2.413474760386
F      2.459838715765      3.898478389976      2.996325665635
F      2.793587409811      4.745129892784      1.038374798166
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -427.5178              4.7804              5.9872
Reduced mass [au]                   5.4667             18.6649             16.0891
Force const [Dyne/A]               -0.5887              0.0003              0.0003
Char temp [K]                       0.0000              6.8779              8.6143
Normal mode                   x         y         z            x         y         z            x         y         z     
      Co                 0.02331   -0.00842    0.00114    0.00081    0.00127    0.00068    0.00035    0.00454   -0.00159
       C                 0.00588   -0.00686    0.00313    0.00300    0.00371    0.00407    0.00354    0.01351    0.00675
       C                -0.00094   -0.01099    0.00823    0.00228    0.00248    0.00558    0.00169    0.00922    0.01259
       C                 0.00241   -0.00509    0.00560    0.00401    0.00551    0.00179    0.00561    0.01867    0.00120
       H                 0.00976   -0.00039   -0.00502    0.00268    0.00318    0.00451    0.00314    0.01244    0.00643
       C                 0.00154   -0.00446    0.00424    0.00328    0.00412    0.00479    0.00358    0.01392    0.01188
       H                -0.00091   -0.01340    0.01082    0.00155    0.00104    0.00751    0.00011    0.00497    0.01787
       C                 0.00112   -0.00409    0.00467    0.00425    0.00587    0.00257    0.00569    0.01937    0.00524
       H                -0.00348   -0.01012    0.01179    0.00461    0.00669    0.00018    0.00705    0.02251   -0.00412
       H                 0.00209   -0.00448    0.00586    0.00316    0.00384    0.00578    0.00318    0.01287    0.01569
       H                -0.00020   -0.00594    0.00663    0.00514    0.00729    0.00135    0.00767    0.02373    0.00240
       P                 0.00076   -0.00007    0.00003    0.00056    0.00080    0.00003    0.00054    0.00228    0.00043
       C                -0.00834    0.03412    0.06562   -0.00063   -0.00268    0.00165   -0.00004   -0.00809    0.00018
       H                -0.21154   -0.03741    0.04932   -0.00106   -0.00395    0.00239    0.00031   -0.01261    0.00334
       C                 0.03466    0.15884    0.05608   -0.00080   -0.00263    0.00129   -0.00127   -0.00723   -0.00330
       H                 0.01406    0.07765   -0.07600   -0.00121   -0.00372    0.00158   -0.00213   -0.01012   -0.00484
       C                -0.04367   -0.05254   -0.01676   -0.00053    0.00161   -0.00368   -0.00308    0.00542   -0.01477
       H                -0.15423    0.03195    0.12760   -0.00077    0.00286   -0.00600   -0.00410    0.00898   -0.02043
       C                -0.06876   -0.07352   -0.14251   -0.00061    0.00052   -0.00233   -0.00309    0.00255   -0.01344
       H                 0.00509    0.04866   -0.07944   -0.00084    0.00016   -0.00254   -0.00392    0.00191   -0.01639
       C                -0.00176    0.00021    0.00179    0.00140    0.00049   -0.00077    0.00091   -0.00234    0.00153
       C                -0.00283    0.00070    0.00077    0.00011    0.00093    0.00012   -0.00297   -0.00138    0.00878
       C                -0.00015   -0.00039    0.00002    0.00337   -0.00005   -0.00226    0.00524   -0.00695   -0.00493
       C                -0.00074    0.00014   -0.00053    0.00092    0.00076   -0.00058   -0.00200   -0.00493    0.00925
       H                -0.01027    0.00079    0.00377   -0.00154    0.00141    0.00131   -0.00639    0.00215    0.01379
       C                 0.00000   -0.00023   -0.00023    0.00419   -0.00020   -0.00293    0.00619   -0.01048   -0.00452
       H                -0.00029   -0.00028   -0.00024    0.00414   -0.00034   -0.00274    0.00772   -0.00771   -0.01017
       C                -0.00012   -0.00012   -0.00089    0.00301    0.00017   -0.00212    0.00259   -0.00949    0.00254
       H                 0.00036   -0.00007   -0.00130    0.00365    0.00004   -0.00267    0.00360   -0.01231    0.00266
       C                -0.00062   -0.00072    0.00051   -0.00059    0.00037    0.00025   -0.00301    0.00148   -0.00076
       C                -0.00037    0.00005    0.00082   -0.00008    0.00110   -0.00394   -0.00179    0.00314   -0.01153
       C                -0.00031    0.00020   -0.00121   -0.00187   -0.00038    0.00393   -0.00681   -0.00140    0.01117
       C                -0.00007    0.00015    0.00014   -0.00093    0.00119   -0.00468   -0.00453    0.00241   -0.01099
       H                -0.00052   -0.00006    0.00118    0.00130    0.00229   -0.00823    0.00116    0.00440   -0.01892
       C                 0.00004    0.00002   -0.00014   -0.00280   -0.00043    0.00340   -0.00969   -0.00247    0.01189
       H                 0.00063    0.00225   -0.00484   -0.00208   -0.00083    0.00702   -0.00766   -0.00342    0.02138
       C                 0.00001    0.00005    0.00022   -0.00241    0.00029   -0.00073   -0.00855   -0.00033    0.00017
       H                 0.00014    0.00008    0.00025   -0.00292    0.00065   -0.00200   -0.01084   -0.00139    0.00162
       C                -0.00100    0.00035   -0.00027    0.00024    0.00039   -0.00045    0.00328    0.00265    0.00185
       C                -0.00107   -0.00034    0.00064    0.00113    0.00339    0.00140    0.00741    0.01308    0.01208
       C                -0.00074   -0.00026   -0.00035   -0.00127   -0.00293   -0.00285    0.00009   -0.00886   -0.00885
       C                -0.00031   -0.00018    0.00029    0.00045    0.00305    0.00086    0.00820    0.01126    0.01123
       H                -0.00112   -0.00037    0.00071    0.00246    0.00640    0.00347    0.01020    0.02338    0.02124
       C                -0.00022   -0.00032    0.00001   -0.00198   -0.00342   -0.00350    0.00079   -0.01086   -0.00984
       H                -0.00083   -0.00278    0.00124   -0.00190   -0.00504   -0.00411   -0.00303   -0.01625   -0.01638
       C                 0.00007   -0.00029    0.00020   -0.00112   -0.00045   -0.00165    0.00485   -0.00093    0.00008
       H                 0.00025   -0.00040    0.00021   -0.00158   -0.00062   -0.00198    0.00540   -0.00243   -0.00066
       C                 0.00002   -0.00001   -0.00011    0.00669   -0.00117   -0.00497    0.01059   -0.01455   -0.01053
       C                -0.00018   -0.00001   -0.00021   -0.00049    0.00126    0.00036   -0.00761   -0.00301    0.01791
       C                 0.00008   -0.00041   -0.00003   -0.00362   -0.00704   -0.00604   -0.00303   -0.02421   -0.02211
       C                -0.00052   -0.00009    0.00028    0.00106    0.00557    0.00207    0.01300    0.02341    0.02318
       C                -0.00014    0.00015   -0.00001   -0.00306   -0.00361    0.00354   -0.00260    0.00535   -0.02508
       C                 0.00014    0.00010   -0.00010   -0.00348    0.00117    0.00240   -0.01288   -0.00110    0.01635
       F                -0.00008   -0.00005    0.00005   -0.00502    0.00963   -0.01165    0.00285    0.02866    0.03000
       F                -0.00003    0.00001    0.00010    0.00281   -0.00858    0.00679    0.02730    0.02550    0.02354
       F                -0.00001   -0.00004    0.00007    0.00579    0.01761    0.01168    0.01375    0.02823    0.02812
       F                -0.00007    0.00021   -0.00014   -0.00171   -0.01053   -0.00542    0.00718   -0.03752   -0.02558
       F                -0.00001    0.00012   -0.00013   -0.00635   -0.00651   -0.00830   -0.01798   -0.02413   -0.03136
       F                 0.00006    0.00006    0.00001   -0.00442   -0.00769   -0.00695   -0.00219   -0.02442   -0.02174
       F                -0.00009   -0.00017   -0.00005    0.00072    0.00082   -0.00043    0.00711   -0.01175    0.00914
       F                -0.00003    0.00002    0.00003   -0.00229    0.00324   -0.00032   -0.02546    0.01251    0.01019
       F                 0.00003    0.00023    0.00013   -0.00132    0.00021    0.00278   -0.01089   -0.00754    0.04323
       F                 0.00003    0.00003   -0.00000    0.00487    0.00040   -0.00324    0.02026   -0.02129   -0.02046
       F                 0.00005   -0.00006    0.00008    0.01085    0.00134   -0.00752   -0.00179   -0.01548   -0.01565
       F                 0.00008    0.00003    0.00001    0.00695   -0.00644   -0.00649    0.01771   -0.01017   -0.00064
       F                 0.00005   -0.00001    0.00002   -0.04972   -0.12078    0.01889    0.02014    0.03584   -0.03257
       F                 0.00004   -0.00000    0.00000    0.01943    0.06165    0.10940   -0.01504   -0.01042   -0.05915
       F                -0.00000    0.00002    0.00001    0.01793    0.04118   -0.10398   -0.01060   -0.00596    0.00113
       F                -0.00004   -0.00012   -0.00009   -0.01026   -0.01298    0.03406   -0.02992   -0.03576    0.09348
       F                -0.00012   -0.00007   -0.00003    0.02099   -0.01303   -0.02090    0.04093   -0.03822   -0.03845
       F                 0.00005   -0.00009   -0.00006   -0.02169    0.03210   -0.00867   -0.05244    0.07445   -0.00568
              
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(3,5-ditrifluoromethylphenyl)phosphineのある1つの遷移状態構造を算出する手順を説明した。




## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.

