---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応2, NNP使用）
published: 2025-09-01
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-09-01

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

移動挿入反応について：
- https://en.wikipedia.org/wiki/Migratory_insertion
- https://chem.libretexts.org/Bookshelves/Inorganic_Chemistry/Organometallic_Chemistry_(Evans)/04%3A_Fundamentals_of_Organometallic_Chemistry/4.05%3A_Migratory_Insertion-_12-Insertions

今回参考にした論文
- _Org. Lett._ 2025, 27, 2005-2010 (論文中の計算に使用している系の基質の置換基を変えて計算を行った。)

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)

:::note

今回は反応に関わる系中のDPPBZ配位子のフェニル基の最安定な立体配座の探索は行わずに算出した。本来は、適当に１つ遷移状態構造を求めた後に、その構造のフェニル基を回転させることで立体配座探索を行うことで最安定な遷移状態構造を探す必要がある。

:::

## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.15.1b
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.15.1b.zip
unzip v1.15.1b.zip
cd MultiOptPy-v1.15.1b
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.15.1b`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.15.1b`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`migratory_insertion_CuH_Et_dppbz.xyz`とした。
初期構造は以下のものを使用した。

```
74

Cu     1.050109634259      0.534897950352     -1.141827447570
H      1.857086284500      1.835240484043     -0.759546860882
P      1.405822916389     -0.870444831665      0.603910105479
P     -0.806958092868      1.202578907698      0.263974934942
C      0.068801666139      1.188268984096      1.870533450833
C     -0.195036788845      2.078154217643      2.905875547620
C      1.068185802183      0.218691182047      2.031819236853
C      0.514816072149      2.000427697516      4.095600656791
H     -0.945363422388      2.848865371202      2.774112805022
C      1.774639575978      0.146345252915      3.227087616793
C      1.496915477411      1.033941558001      4.257048155886
H      0.307126337352      2.701839112388      4.893580552612
H      2.555477348370     -0.594539680297      3.348099775493
H      2.056836757577      0.977714392612      5.181723175999
C      0.616823714599     -0.415688622627     -2.928834347243
H     -0.368651418552     -0.865224796745     -2.877991649270
C      0.784858471995      0.930354556896     -3.161146983230
H      1.754807816078      1.289800838150     -3.483673682248
Se     2.075503124597     -1.630990658622     -3.166151447798
C      1.722073950056     -1.980134342822     -5.057651596270
F      2.602573853615     -2.882969290687     -5.515399042677
F      0.488511606470     -2.468939521523     -5.271907677566
F      1.832443302552     -0.881047333200     -5.818851546311
C     -0.379179807397      1.858258838685     -3.381486606679
H     -1.281907005455      1.421357045760     -2.945890494056
H     -0.196091521203      2.798446403997     -2.857640148927
C     -0.591486166475      2.118612193880     -4.873646565959
H     -0.795802540375      1.188941822164     -5.407022897075
H     -1.431023008032      2.796341914717     -5.031222870247
H      0.295265688963      2.570731714257     -5.320753837480
C     -1.432175753820      2.906993477893      0.134871820870
C     -2.785490013401      3.211035723894      0.025380661809
C     -0.489489646888      3.934497242422      0.045745322169
C     -3.193789241206      4.526515676989     -0.159602741323
H     -3.525988494371      2.423337986463      0.084004693217
C     -0.902075649143      5.245065893649     -0.128099659837
H      0.566152015568      3.692913255102      0.100977251210
C     -2.255576819163      5.543915758371     -0.232166434255
H     -4.248960767060      4.753125437392     -0.244288123836
H     -0.165115485794      6.035514708266     -0.190897240901
H     -2.575732093081      6.568250535096     -0.373539737824
C     -2.293944348664      0.205360031410      0.641152467233
C     -2.683666901967     -0.740791021380     -0.301914916480
C     -3.011661333444      0.307767861002      1.832199589159
C     -3.773743744976     -1.568066820738     -0.067619881548
H     -2.112875850447     -0.842737822315     -1.218120459487
C     -4.099572988495     -0.517022958586      2.069320412423
H     -2.713383777269      1.030169591285      2.582623774184
C     -4.481707079756     -1.456238209547      1.118661342180
H     -4.059467377325     -2.306069697369     -0.806040366570
H     -4.649300589414     -0.430891581076      2.998139157448
H     -5.328300262286     -2.103948978926      1.308024401414
C      3.043401161200     -1.575156268546      0.951605852200
C      3.233509435768     -2.789427511400      1.605531735832
C      4.148202253750     -0.838494683531      0.525311836031
C      4.519101282087     -3.257769277741      1.838593808877
H      2.378404496281     -3.371560936884      1.927084957402
C      5.430477071535     -1.305620698922      0.768694730843
H      3.989652878688      0.098421811397      0.001476266496
C      5.616068659695     -2.515643866419      1.424149561239
H      4.663396113334     -4.204275398759      2.343560212693
H      6.285271174558     -0.730185273294      0.437679645613
H      6.617432544134     -2.884422630933      1.605823163929
C      0.246008475360     -2.255724929961      0.864348055708
C      0.090793316760     -3.173189427078     -0.175004121960
C     -0.527653412426     -2.396668335057      2.013402979843
C     -0.810855626310     -4.219454418195     -0.061038177509
H      0.676491298309     -3.066902689832     -1.081572841122
C     -1.442589968887     -3.435603940289      2.119393760242
H     -0.430779197804     -1.685933451480      2.824672764039
C     -1.583315707568     -4.349050945089      1.085791520265
H     -0.917631429538     -4.927466582938     -0.873116004011
H     -2.048912874906     -3.526357024620      3.011650305468
H     -2.297785371263     -5.158040970558      1.170428343790

```

<MoleculeViewer 
  xyzData={`74

Cu     1.050109634259      0.534897950352     -1.141827447570
H      1.857086284500      1.835240484043     -0.759546860882
P      1.405822916389     -0.870444831665      0.603910105479
P     -0.806958092868      1.202578907698      0.263974934942
C      0.068801666139      1.188268984096      1.870533450833
C     -0.195036788845      2.078154217643      2.905875547620
C      1.068185802183      0.218691182047      2.031819236853
C      0.514816072149      2.000427697516      4.095600656791
H     -0.945363422388      2.848865371202      2.774112805022
C      1.774639575978      0.146345252915      3.227087616793
C      1.496915477411      1.033941558001      4.257048155886
H      0.307126337352      2.701839112388      4.893580552612
H      2.555477348370     -0.594539680297      3.348099775493
H      2.056836757577      0.977714392612      5.181723175999
C      0.616823714599     -0.415688622627     -2.928834347243
H     -0.368651418552     -0.865224796745     -2.877991649270
C      0.784858471995      0.930354556896     -3.161146983230
H      1.754807816078      1.289800838150     -3.483673682248
Se     2.075503124597     -1.630990658622     -3.166151447798
C      1.722073950056     -1.980134342822     -5.057651596270
F      2.602573853615     -2.882969290687     -5.515399042677
F      0.488511606470     -2.468939521523     -5.271907677566
F      1.832443302552     -0.881047333200     -5.818851546311
C     -0.379179807397      1.858258838685     -3.381486606679
H     -1.281907005455      1.421357045760     -2.945890494056
H     -0.196091521203      2.798446403997     -2.857640148927
C     -0.591486166475      2.118612193880     -4.873646565959
H     -0.795802540375      1.188941822164     -5.407022897075
H     -1.431023008032      2.796341914717     -5.031222870247
H      0.295265688963      2.570731714257     -5.320753837480
C     -1.432175753820      2.906993477893      0.134871820870
C     -2.785490013401      3.211035723894      0.025380661809
C     -0.489489646888      3.934497242422      0.045745322169
C     -3.193789241206      4.526515676989     -0.159602741323
H     -3.525988494371      2.423337986463      0.084004693217
C     -0.902075649143      5.245065893649     -0.128099659837
H      0.566152015568      3.692913255102      0.100977251210
C     -2.255576819163      5.543915758371     -0.232166434255
H     -4.248960767060      4.753125437392     -0.244288123836
H     -0.165115485794      6.035514708266     -0.190897240901
H     -2.575732093081      6.568250535096     -0.373539737824
C     -2.293944348664      0.205360031410      0.641152467233
C     -2.683666901967     -0.740791021380     -0.301914916480
C     -3.011661333444      0.307767861002      1.832199589159
C     -3.773743744976     -1.568066820738     -0.067619881548
H     -2.112875850447     -0.842737822315     -1.218120459487
C     -4.099572988495     -0.517022958586      2.069320412423
H     -2.713383777269      1.030169591285      2.582623774184
C     -4.481707079756     -1.456238209547      1.118661342180
H     -4.059467377325     -2.306069697369     -0.806040366570
H     -4.649300589414     -0.430891581076      2.998139157448
H     -5.328300262286     -2.103948978926      1.308024401414
C      3.043401161200     -1.575156268546      0.951605852200
C      3.233509435768     -2.789427511400      1.605531735832
C      4.148202253750     -0.838494683531      0.525311836031
C      4.519101282087     -3.257769277741      1.838593808877
H      2.378404496281     -3.371560936884      1.927084957402
C      5.430477071535     -1.305620698922      0.768694730843
H      3.989652878688      0.098421811397      0.001476266496
C      5.616068659695     -2.515643866419      1.424149561239
H      4.663396113334     -4.204275398759      2.343560212693
H      6.285271174558     -0.730185273294      0.437679645613
H      6.617432544134     -2.884422630933      1.605823163929
C      0.246008475360     -2.255724929961      0.864348055708
C      0.090793316760     -3.173189427078     -0.175004121960
C     -0.527653412426     -2.396668335057      2.013402979843
C     -0.810855626310     -4.219454418195     -0.061038177509
H      0.676491298309     -3.066902689832     -1.081572841122
C     -1.442589968887     -3.435603940289      2.119393760242
H     -0.430779197804     -1.685933451480      2.824672764039
C     -1.583315707568     -4.349050945089      1.085791520265
H     -0.917631429538     -4.927466582938     -0.873116004011
H     -2.048912874906     -3.526357024620      3.011650305468
H     -2.297785371263     -5.158040970558      1.170428343790
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`migratory_insertion_CuH_Et_dppbz.xyz`として保存し、以下を実行する。
```
python .\optmain.py .\migratory_insertion_CuH_Et_dppbz.xyz -opt rsirfo_fsb -os uma-s-1p1 -modelhess -ma 200 1 15 200 2 17
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。


これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`migratory_insertion_CuH_Et_dppbz_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.15.1b`ディレクトリに置く。

`migratory_insertion_CuH_Et_dppbz_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`migratory_insertion_CuH_Et_dppbz_traj.xyz`は次のNEB計算に使用する。

※`migratory_insertion_CuH_Et_dppbz_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`migratory_insertion_CuH_Et_dppbz_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `migratory_insertion_CuH_Et_dppbz_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`migratory_insertion_CuH_Et_dppbz_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py migratory_insertion_CuH_Et_dppbz_traj.xyz -os uma-s-1p1 -modelhess -ns 20 -spng -nd 0.2
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.15.1b`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-6377.12420638501,-6377.118186523998,-6377.109477341265,-6377.103753293376,-6377.101100840964,-6377.098109169879,-6377.097874373359,-6377.104402887148,-6377.110267105001,-6377.105629772996,-6377.116371271264,-6377.123026532065,-6377.128337447427,-6377.132568428477,-6377.135948226146,-6377.138199637202,-6377.139934737739,-6377.141565941825,-6377.142803026312,-6377.143394932933,-6377.14419382638,-6377.144737771357,-6377.145385752972,-6377.146153752601,-6377.146684870423,-6377.147164241538,-6377.147661013425,-6377.1482188895325,-6377.149048852031,-6377.149317749157,-6377.1494299867645,-6377.149434612951,-6377.149304186018,-6377.149041071626,-6377.149359051896,-6377.1496900170305,-6377.149975491327,-6377.150238132585,-6377.150321579187,-6377.150366754605,-6377.1505098685075,-6377.150905915684,-6377.150781937375,-6377.150801563623,-6377.151164754357,-6377.151392138462,-6377.151626584512,-6377.151771625992,-6377.151790989389,-6377.151934996986,-6377.152108952135,-6377.152244250584,-6377.152362253402,-6377.152454917332,-6377.152510939756,-6377.15258490618,-6377.1527153331135,-6377.152858815008,-6377.152971473178,-6377.153107752939,-6377.15324841356,-6377.153396504117,-6377.153341673286,-6377.15321715175,-6377.153552602886,-6377.153632579847,-6377.153548274597,-6377.15358649321,-6377.153765144641,-6377.153737019526,-6377.1538840762005,-6377.153821272206,-6377.153877820334,-6377.153863503687,-6377.153945653555,-6377.15396133703,-6377.153978282192];

export const dataset1_itr5 = [-6377.124256782412,-6377.121852146432,-6377.11823176951,-6377.114988269125,-6377.1107090635805,-6377.105862449178,-6377.104298780415,-6377.112637377523,-6377.1195231591255,-6377.123785682359,-6377.128219339469,-6377.132515244848,-6377.136527866362,-6377.14002016449,-6377.142784433947,-6377.145032200128,-6377.14657067019,-6377.147748946027,-6377.148721409107,-6377.149493526743,-6377.149956758773,-6377.151050045944,-6377.152057906365,-6377.15275851086,-6377.153361755144,-6377.153797860895,-6377.154182097276,-6377.154544008799,-6377.15485526007,-6377.1550150562825,-6377.155305104195,-6377.15521042507,-6377.155201961251,-6377.155520046661,-6377.155971047333,-6377.155883395106,-6377.155901461769,-6377.156498327522,-6377.156760583265,-6377.156419664818,-6377.156419910146,-6377.15672001651,-6377.156343805863,-6377.156470272501,-6377.156971810762,-6377.15740907306,-6377.157879174278,-6377.158011739071,-6377.15826586394,-6377.15825510455,-6377.158580900272,-6377.158726555072,-6377.158831327695,-6377.158958372606,-6377.1590555050125,-6377.159149413105,-6377.159250628471,-6377.1593385961205,-6377.159407691029,-6377.159504175067,-6377.159599362371,-6377.159648901125,-6377.159774421497,-6377.159824731281,-6377.159944293686,-6377.160039621177,-6377.1600981144065,-6377.160133459177,-6377.1602704574,-6377.1602850719455,-6377.160337975199,-6377.160320994989,-6377.160428641456,-6377.160433215073,-6377.160434564377,-6377.16035521826,-6377.160883567378];

export const dataset1_itr10 = [-6377.1242838035505,-6377.123453297825,-6377.121472010535,-6377.119083128124,-6377.115024700349,-6377.109460238392,-6377.10973991243,-6377.118474977278,-6377.124332641367,-6377.128867951928,-6377.132481477187,-6377.13601332571,-6377.139204466068,-6377.142243941087,-6377.144635031451,-6377.146622189092,-6377.1480872009115,-6377.149183729918,-6377.15008520556,-6377.1508473173135,-6377.151414743695,-6377.152491611407,-6377.153102969041,-6377.1537825454125,-6377.154299662008,-6377.154691976693,-6377.155033175515,-6377.155354327527,-6377.155661811258,-6377.155841899609,-6377.156086001073,-6377.15613678399,-6377.156393957937,-6377.156677399514,-6377.156882826755,-6377.156871664325,-6377.156903136417,-6377.157303319124,-6377.157553238369,-6377.157445118768,-6377.157535171706,-6377.15781651047,-6377.157837836492,-6377.157962322982,-6377.158219479405,-6377.1584553799,-6377.158710398464,-6377.158832449196,-6377.158972251168,-6377.15902622335,-6377.159262526885,-6377.159392340499,-6377.159513532582,-6377.159628398705,-6377.159730209868,-6377.159828639008,-6377.159927453664,-6377.160012267093,-6377.160085322298,-6377.160170766572,-6377.160262221385,-6377.160326777723,-6377.1604156215435,-6377.160497175614,-6377.160583671294,-6377.160663420452,-6377.160733006016,-6377.160784156926,-6377.160857177083,-6377.160890506659,-6377.16092993439,-6377.160841160663,-6377.161003865766,-6377.161053930223,-6377.16106365573,-6377.160985816627,-6377.161160893276];

export const dataset1_itr15 = [-6377.124284977621,-6377.123936033439,-6377.12288182353,-6377.121107225168,-6377.117435644766,-6377.111157593448,-6377.115227043464,-6377.12250156497,-6377.12739458143,-6377.132179232963,-6377.1350961315475,-6377.138166430291,-6377.141000653304,-6377.1436877145015,-6377.145842028199,-6377.1476215681705,-6377.148977286319,-6377.14999814913,-6377.150850243727,-6377.151570351806,-6377.152208975907,-6377.153046753859,-6377.153662001696,-6377.154219422195,-6377.15470511927,-6377.155066312333,-6377.155390075336,-6377.155695719107,-6377.155993862846,-6377.156181223424,-6377.156413373904,-6377.156548234268,-6377.1568549469675,-6377.157074568191,-6377.157234416974,-6377.157320386951,-6377.157315585529,-6377.157652017977,-6377.157869361154,-6377.157844845867,-6377.157952247006,-6377.1582136441,-6377.158301909648,-6377.158476688398,-6377.158571542757,-6377.158746899781,-6377.158942636561,-6377.159068472355,-6377.159186720501,-6377.159263788572,-6377.159446803338,-6377.15956901178,-6377.159684613887,-6377.159796290745,-6377.159897418494,-6377.159995392025,-6377.160092454336,-6377.160177863564,-6377.160251356854,-6377.160335364207,-6377.160421088855,-6377.160487835623,-6377.160560838257,-6377.160640499797,-6377.1607159557125,-6377.16078836255,-6377.160852848795,-6377.16090510368,-6377.160960933348,-6377.1609914416495,-6377.161026453475,-6377.160889665533,-6377.16108752265,-6377.161126424678,-6377.161143106989,-6377.16102566492,-6377.161192505554];

export const dataset2 = [-6377.124298505713,-6377.124142389422,-6377.123524968678,-6377.122391044659,-6377.1192861721765,-6377.112333205721,-6377.120055118071,-6377.125668417845,-6377.12991804383,-6377.134760049568,-6377.137305223506,-6377.140004656249,-6377.142552528795,-6377.144943917057,-6377.146882499734,-6377.148482582197,-6377.149722382817,-6377.150664793205,-6377.15146051491,-6377.152133414851,-6377.152763137047,-6377.1534827719925,-6377.154055210076,-6377.15455263033,-6377.1550171766185,-6377.155354940847,-6377.155665350992,-6377.155958815974,-6377.156242362692,-6377.156430862293,-6377.1566512195,-6377.156837335914,-6377.157087710768,-6377.15729860532,-6377.157449131635,-6377.157560405453,-6377.15758772449,-6377.157874267716,-6377.158071564081,-6377.158037077959,-6377.158238001676,-6377.158422558504,-6377.158511630129,-6377.158667360905,-6377.158769189591,-6377.158920329227,-6377.159083735268,-6377.159205575718,-6377.159310523576,-6377.159399525108,-6377.159557866875,-6377.159675326467,-6377.159786057058,-6377.159893791143,-6377.159993113978,-6377.160089422782,-6377.160184382282,-6377.160270948056,-6377.160344371253,-6377.160426451027,-6377.160507724723,-6377.160572929428,-6377.160639676195,-6377.160714658979,-6377.160784454824,-6377.160852375662,-6377.160912358383,-6377.160963526816,-6377.161010945234,-6377.161040472224,-6377.1610727854395,-6377.1609038945635,-6377.161124164154,-6377.1611541818,-6377.161168112932,-6377.161038597216,-6377.1611982707645];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.0003907002426504623,0.0035901087696457506,0.005778716709619169,0.006222940988655378,0.005507161221881943,0.005032175060558877,0.004525241534403534,0.00491652319865804,0.005904004806506058,0.011138690713087589,0.00714987317196855,0.00622909349701783,0.0057410130246357055,0.005458372814744985,0.005376835758389291,0.005452424895552572,0.005503716418497721,0.005552154533485462,0.005471807934706519,0.005549735892212582,0.005546048884321908,0.005566131134818244,0.0056213129661875786,0.005625958685064096,0.005604099411040977,0.005607781205670087,0.005575954636067425,0.0054808450948247356,0.005275008595753289,0.005300447645507567,0.00538392109258714,0.005473929528643059,0.0055795417074654486,0.0057738470724966445,0.005724587529672763,0.005650348113158229,0.005588707374093637,0.005558971007139339,0.005633009404754944,0.005683378941390064,0.0056501328598921145,0.005436423542110923,0.005620143302271002,0.005690998338397968,0.0056121351562000935,0.0055960874187731815,0.005529804345077649,0.005501893807134657,0.005550708497890085,0.0055404719993853236,0.00553704178701579,0.005542433297105808,0.005550649825748871,0.005564122163310178,0.0055831087244227395,0.005590088024112604,0.0055702694284854816,0.005541628126131451,0.005527999463898962,0.005505747151026688,0.005481498154408488,0.005453286953742418,0.005528781189217301,0.005605300746886057,0.005494664390992123,0.005497194562794227,0.005572234630521262,0.005580363160100829,0.005532303874128456,0.005583135421438289,0.005507055336891207,0.005568719928501549,0.005550806348839579,0.005574491296878673,0.005548347740210826,0.005556528808884263,0.005558328765808022];

export const dataset1_grad_itr5 = [0.0003151658784968616,0.00171640300302853,0.0026539924537067137,0.0029851999538071778,0.0028324887703064278,0.002841494062740099,0.0027645784671271475,0.0034484595910350027,0.002911406633544345,0.003674142607904251,0.0025235690897898034,0.0022114331509952056,0.0017704994207650812,0.0015963222402423846,0.0015775607066632264,0.001511611858976267,0.0016631912313775398,0.0017765630509121353,0.0017686843057217005,0.0017873648013755328,0.002014064388786945,0.0017164709080413577,0.001441002849610097,0.0013301761721195298,0.0012024814320992715,0.0011716744788248827,0.0011426443231930207,0.0011298571941886699,0.001231868287750384,0.0013323606954406429,0.0012421002011216437,0.0014944276355674658,0.001732989871896281,0.001646907124953271,0.0013871445655217424,0.0016159842925252245,0.0016988982507641546,0.0013286579786005509,0.0012395676275241698,0.0016917188872508273,0.001823501431956042,0.0016193596886388975,0.0020554831214073766,0.0021177824744843888,0.001928678580497492,0.001641652025023339,0.0012979004166879717,0.0012520373750647027,0.0011329386546796378,0.0013379411932865793,0.0010839465657138674,0.0010651931683127065,0.0010942350549084257,0.0010660212306717427,0.001065623102905211,0.0010588770230530915,0.0010527609664196884,0.0010511550350655948,0.0010786057385815404,0.0010466936607894197,0.001016898433413396,0.0011010601877496605,0.0010258510106075174,0.001034771113941413,0.001035274361656286,0.0010173035045831014,0.0010197761029452736,0.0010507062725116584,0.0009669379861861042,0.001033484741538492,0.0009733286000115852,0.0010468191117178264,0.0009424716115724584,0.0010162276502227662,0.0010448785319038536,0.0011912503826532277,0.0008205488314121543];

export const dataset1_grad_itr10 = [0.00025739846341693237,0.0008119273669425347,0.0014048531129777937,0.0017378879054121678,0.001788118210068515,0.0018056107190639306,0.0024709808632540115,0.0023856918161140306,0.0018203572543194495,0.002217178872971284,0.0012372936741061845,0.001074831905970338,0.000971313306460643,0.000870839187260622,0.0009595569340422493,0.0009344849779292264,0.001004350595764302,0.0010834896355500726,0.001075809381338829,0.0010593970194191546,0.0012400254647038122,0.0007525833926616966,0.0007629427699886264,0.000537162426438673,0.00039853226267940573,0.00037943204546972886,0.0003799487858345175,0.00039907232217637487,0.0004975768327756307,0.0005909842487059304,0.0005491732450219375,0.0008071066199722566,0.0007758671898171847,0.0006749042334054541,0.0005994675012243901,0.0008609913409611628,0.001013978771177152,0.0007222736566516194,0.0005509892133613533,0.000915985881925535,0.0009792316444690256,0.0007387154864017132,0.0009016112941929095,0.0009851249703921713,0.0008653503058119925,0.000720732184410527,0.0005112330280159144,0.0005004289233910843,0.00042564529723184905,0.0005919200839621029,0.00038256485175726287,0.0003681616099108317,0.00032693595266445686,0.0003243532027890359,0.00032508775727526474,0.0003202947011154958,0.0003214002670362537,0.000318820621558472,0.0003368551435366793,0.0003274586099283028,0.00030599994706058474,0.0003369213807655043,0.00030620256318860826,0.00028860644047194815,0.0002858395257187192,0.00027492984985205763,0.00026572672295198244,0.0003142016922700943,0.00025353039787891847,0.00027667692621022647,0.0002667703651579261,0.00034771881992413754,0.0002379909081479713,0.00021546117615827855,0.000271650132248223,0.0004043624429872646,0.00024180622151770946];

export const dataset1_grad_itr15 = [0.00028725244935163044,0.0004734956059120693,0.0008476827848121461,0.0011289689390999095,0.001311376060127585,0.0014141885167856672,0.002686556906282404,0.0018755611940158463,0.0015507097687803945,0.0015699334650833663,0.0011000563520129295,0.0009452733391488601,0.0008505243429500828,0.0007660749827936318,0.0008267505443885463,0.0008107138238374036,0.0008220382033904903,0.0008601923125420429,0.0008298977270106754,0.0007985684963713938,0.0008674570088775664,0.0005401914506464599,0.00048193505897117957,0.00034258637922875395,0.00024154670569436545,0.0002293297844848867,0.00023741382582299623,0.00024956574859383545,0.00029504967074317197,0.00036915233952184806,0.0003315220455885368,0.0005366670355101554,0.00036046214746877523,0.0003150592219807779,0.0002966097083064074,0.0004769291537739225,0.0007682217984990952,0.00048347292121800095,0.0003138960485088831,0.0005773988929586242,0.0006954595642633378,0.0003915237572054432,0.00042074411678800377,0.00034362998047488317,0.0005319770608787273,0.00044077566460093274,0.0002838984591170187,0.00028327986558930444,0.00022121333057072777,0.00033772679377030214,0.0002010220339530892,0.00018732957955343307,0.00016909006549048258,0.00016182928249643504,0.00016338998894198557,0.00016065202667232863,0.00016528689173516648,0.00016740613615952928,0.00018970244845343292,0.00018163469061304604,0.0001686529300412822,0.00016677246972689807,0.00017013614060357478,0.0001562990725142602,0.00015159334133813573,0.00014302993171514948,0.0001373037193769144,0.0001628181452690282,0.00012888140228619789,0.00014371824848012285,0.00014296268734095136,0.00023401752979665728,0.00011006380680110026,7.70493643734526e-05,0.00010791785868925096,0.00028808165218947206,8.676514403427864e-05];

export const dataset2_grad = [0.00024211479063857355,0.0003070795178758261,0.0005633892113146464,0.0007470453134336604,0.0010339211494507202,0.00121316244579572,0.0022827405806709585,0.0016689212079632639,0.0014273600890347788,0.001304364297864001,0.0010498437938568249,0.0009035812148593133,0.0007988561063061409,0.0007256216599110429,0.0007514908096150843,0.000729083418382364,0.0007185599832447005,0.0007324778860838947,0.000694306725403576,0.0006613102781171794,0.000666262538439949,0.0004460311652684013,0.0003713272204545353,0.0002937326625126791,0.0002145476775143263,0.00020679990194104458,0.0002131478500886189,0.0002171431702501174,0.00023806146180216557,0.0002880737076629785,0.00025384755413894135,0.0003694735018645529,0.0002725225110177638,0.00021985668576781682,0.00021173814394964363,0.00032060612714890824,0.0006191401541371947,0.0003742832761138681,0.00023686536118827466,0.0003754041097403546,0.0004884255336688475,0.00027045074332505205,0.0003021229465445053,0.00025389936156479777,0.00035105693093521475,0.0003063545318788939,0.0002060526717903683,0.00019622526458913878,0.0001555184030531591,0.00021298010936107321,0.00013983942404601773,0.00012679136594295,0.00012474704737504175,0.00012220811377836952,0.000123825919565977,0.00012473038037578779,0.00013037823424255017,0.00013359329242975643,0.00015250751413686638,0.00014508004261653447,0.00014019577863595242,0.00012900148676921365,0.00013731994743826896,0.00012947126496100006,0.00012286943046786232,0.00011530973226211067,0.00010925496856805734,0.0001164510463225173,9.786069933006944e-05,0.00010202941030252681,9.464904738726923e-05,0.0001939391557172283,7.046638853225704e-05,4.990222341644077e-05,5.787064969575429e-05,0.0002383518315725819,3.433949985325941e-05];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、ITR. 5の経路の6番(グラフ上では7番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`migratory_insertion_CuH_Et_dppbz_traj_6_itr5.xyz`
```
74
0 1
Cu      0.900425417969      0.322876658179     -1.094244309492
H       1.413892950860      1.691877556634     -1.728481161436
P       1.416237165235     -0.884472150486      0.660883638709
P      -0.824985326133      1.186362346056      0.294136776333
C       0.065647045199      1.185982605720      1.890399532933
C      -0.196637184013      2.083334788660      2.918295918304
C       1.066049122730      0.216378490740      2.062246565862
C       0.514452361861      2.010062417301      4.107357699089
H      -0.947932468575      2.852125534292      2.781162589845
C       1.776265198372      0.152258633128      3.252568752789
C       1.497829962011      1.045945589953      4.274717586528
H       0.304791136889      2.713346895909      4.901895438016
H       2.557241120944     -0.589191066891      3.370744338412
H       2.057079788424      0.992491330440      5.199102100173
C       0.650083138991     -0.366603509290     -2.904557335387
H      -0.357371722782     -0.773753610854     -3.008449656421
C       0.908238615235      1.070958548478     -2.962855617578
H       1.833090442301      1.365496808463     -3.437875685408
Se      2.039991986446     -1.624914848771     -3.181865351316
C       1.712408015519     -1.962080673369     -5.069766029298
F       2.593306458061     -2.867516025388     -5.530638175676
F       0.478070065130     -2.453202386561     -5.293272445514
F       1.821219930509     -0.861622180360     -5.832500707548
C      -0.304112530790      1.928972405769     -3.309964361075
H      -1.204357109007      1.466258720651     -2.886767932202
H      -0.206828807302      2.906738513944     -2.838454539234
C      -0.518393744817      2.095828849054     -4.814105542466
H      -0.718730413526      1.145277513195     -5.312273238035
H      -1.375390883580      2.749028810730     -4.995066555757
H       0.347824314847      2.548986256750     -5.297799007220
C      -1.430132720212      2.895834257405      0.134889209411
C      -2.782172837828      3.204385992734      0.023428091686
C      -0.487150258974      3.922226864723      0.040404913308
C      -3.188290404976      4.520265801448     -0.161894566582
H      -3.524315153423      2.418509756407      0.082420073136
C      -0.895573841605      5.234340730666     -0.132504383246
H       0.569972986094      3.686045401995      0.100185996849
C      -2.248839399115      5.536160949211     -0.233566110655
H      -4.243181994996      4.748647669011     -0.245136048665
H      -0.158436683817      6.024471208178     -0.194156292056
H      -2.567362423282      6.561332669546     -0.372402048222
C      -2.306989663775      0.194996604217      0.657179423215
C      -2.690324568585     -0.746478096679     -0.292941331772
C      -3.025819424906      0.301331387774      1.845827924066
C      -3.781549739338     -1.571848759522     -0.062037314954
H      -2.115084360627     -0.844722521830     -1.206952980792
C      -4.114110835607     -0.523290310566      2.077868079441
H      -2.727126640256      1.025391270488      2.594492509536
C      -4.491486178580     -1.461019923420      1.123664495255
H      -4.065578803179     -2.308632742969     -0.802207173418
H      -4.665425080278     -0.438348371871      3.005300516134
H      -5.337511134341     -2.109659897869      1.311021292610
C       3.053901213090     -1.575059312444      0.972576122687
C       3.244984104165     -2.791503935449      1.618209087206
C       4.153822810377     -0.839746286107      0.534053073517
C       4.530844017392     -3.260009084378      1.843136654058
H       2.389151882283     -3.373850146214      1.937070358818
C       5.437057700683     -1.305065024105      0.770465334696
H       3.994737149908      0.092237441777      0.001652866760
C       5.624553628885     -2.514992529033      1.426327433116
H       4.676372763579     -4.207482151683      2.344840392337
H       6.289966990005     -0.730803823686      0.433359964165
H       6.626512327891     -2.882692886891      1.604333480373
C       0.247716425939     -2.264666607416      0.885784524453
C       0.097765425597     -3.173600454881     -0.162504051423
C      -0.529437059446     -2.406209183236      2.030819224587
C      -0.807025037983     -4.217892935843     -0.054585065610
H       0.682216057512     -3.059944578206     -1.069217360711
C      -1.447187802195     -3.443119315792      2.128576956356
H      -0.433340017273     -1.696325967783      2.842671375545
C      -1.583444834644     -4.351173403243      1.089831531597
H      -0.914506927215     -4.921283379995     -0.870784157671
H      -2.057887247491     -3.534769492956      3.017120586252
H      -2.299688456460     -5.159219703589      1.168804108678

```


<MoleculeViewer 
  xyzData={`74
0 1
Cu      0.900425417969      0.322876658179     -1.094244309492
H       1.413892950860      1.691877556634     -1.728481161436
P       1.416237165235     -0.884472150486      0.660883638709
P      -0.824985326133      1.186362346056      0.294136776333
C       0.065647045199      1.185982605720      1.890399532933
C      -0.196637184013      2.083334788660      2.918295918304
C       1.066049122730      0.216378490740      2.062246565862
C       0.514452361861      2.010062417301      4.107357699089
H      -0.947932468575      2.852125534292      2.781162589845
C       1.776265198372      0.152258633128      3.252568752789
C       1.497829962011      1.045945589953      4.274717586528
H       0.304791136889      2.713346895909      4.901895438016
H       2.557241120944     -0.589191066891      3.370744338412
H       2.057079788424      0.992491330440      5.199102100173
C       0.650083138991     -0.366603509290     -2.904557335387
H      -0.357371722782     -0.773753610854     -3.008449656421
C       0.908238615235      1.070958548478     -2.962855617578
H       1.833090442301      1.365496808463     -3.437875685408
Se      2.039991986446     -1.624914848771     -3.181865351316
C       1.712408015519     -1.962080673369     -5.069766029298
F       2.593306458061     -2.867516025388     -5.530638175676
F       0.478070065130     -2.453202386561     -5.293272445514
F       1.821219930509     -0.861622180360     -5.832500707548
C      -0.304112530790      1.928972405769     -3.309964361075
H      -1.204357109007      1.466258720651     -2.886767932202
H      -0.206828807302      2.906738513944     -2.838454539234
C      -0.518393744817      2.095828849054     -4.814105542466
H      -0.718730413526      1.145277513195     -5.312273238035
H      -1.375390883580      2.749028810730     -4.995066555757
H       0.347824314847      2.548986256750     -5.297799007220
C      -1.430132720212      2.895834257405      0.134889209411
C      -2.782172837828      3.204385992734      0.023428091686
C      -0.487150258974      3.922226864723      0.040404913308
C      -3.188290404976      4.520265801448     -0.161894566582
H      -3.524315153423      2.418509756407      0.082420073136
C      -0.895573841605      5.234340730666     -0.132504383246
H       0.569972986094      3.686045401995      0.100185996849
C      -2.248839399115      5.536160949211     -0.233566110655
H      -4.243181994996      4.748647669011     -0.245136048665
H      -0.158436683817      6.024471208178     -0.194156292056
H      -2.567362423282      6.561332669546     -0.372402048222
C      -2.306989663775      0.194996604217      0.657179423215
C      -2.690324568585     -0.746478096679     -0.292941331772
C      -3.025819424906      0.301331387774      1.845827924066
C      -3.781549739338     -1.571848759522     -0.062037314954
H      -2.115084360627     -0.844722521830     -1.206952980792
C      -4.114110835607     -0.523290310566      2.077868079441
H      -2.727126640256      1.025391270488      2.594492509536
C      -4.491486178580     -1.461019923420      1.123664495255
H      -4.065578803179     -2.308632742969     -0.802207173418
H      -4.665425080278     -0.438348371871      3.005300516134
H      -5.337511134341     -2.109659897869      1.311021292610
C       3.053901213090     -1.575059312444      0.972576122687
C       3.244984104165     -2.791503935449      1.618209087206
C       4.153822810377     -0.839746286107      0.534053073517
C       4.530844017392     -3.260009084378      1.843136654058
H       2.389151882283     -3.373850146214      1.937070358818
C       5.437057700683     -1.305065024105      0.770465334696
H       3.994737149908      0.092237441777      0.001652866760
C       5.624553628885     -2.514992529033      1.426327433116
H       4.676372763579     -4.207482151683      2.344840392337
H       6.289966990005     -0.730803823686      0.433359964165
H       6.626512327891     -2.882692886891      1.604333480373
C       0.247716425939     -2.264666607416      0.885784524453
C       0.097765425597     -3.173600454881     -0.162504051423
C      -0.529437059446     -2.406209183236      2.030819224587
C      -0.807025037983     -4.217892935843     -0.054585065610
H       0.682216057512     -3.059944578206     -1.069217360711
C      -1.447187802195     -3.443119315792      2.128576956356
H      -0.433340017273     -1.696325967783      2.842671375545
C      -1.583444834644     -4.351173403243      1.089831531597
H      -0.914506927215     -4.921283379995     -0.870784157671
H      -2.057887247491     -3.534769492956      3.017120586252
H      -2.299688456460     -5.159219703589      1.168804108678
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`migratory_insertion_CuH_Et_dppbz_traj_6_itr5.xyz`を`MultiOptPy-v1.15.1b`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py .\migratory_insertion_CuH_Et_dppbz_traj_6_itr5.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
74
OptimizedStructure
Cu     0.689598969684      0.351701336139     -1.096084493329
H      1.762445482995      1.413026439504     -1.582033343707
P      1.272485790498     -0.913730588680      0.679338714324
P     -0.910638982557      1.222671620587      0.299271892429
C     -0.042335293165      1.195565648401      1.910685289451
C     -0.308031782285      2.092053761907      2.940958326522
C      0.939837323832      0.209398276551      2.086104872536
C      0.388085411146      2.009955932546      4.138051289998
H     -1.050861760597      2.868361485898      2.800301404880
C      1.631288880797      0.135462688299      3.290955756662
C      1.356330424596      1.031609186135      4.313619312562
H      0.180034031150      2.716504024121      4.931326737216
H      2.399971345488     -0.615821325249      3.424688682295
H      1.905845048942      0.971817782935      5.244192467477
C      0.086775651616     -0.124907313300     -3.034696962170
H     -0.932863069346      0.195641824121     -3.216237679320
C      1.131929418328      0.840773766991     -3.102242457867
H      2.116147894313      0.472166812241     -3.368973962346
Se     0.424479963943     -1.957397708847     -3.338898697655
C      0.550243680227     -1.901583939725     -5.291837135836
F      0.752013092086     -3.141235752818     -5.771663969546
F     -0.561001302794     -1.418981082338     -5.874608128036
F      1.565676405821     -1.133120716895     -5.726362962613
C      0.807955175867      2.218862570870     -3.641701418582
H     -0.103981266509      2.585615642355     -3.162647941265
H      1.606253298600      2.911542701769     -3.372385722991
C      0.625065513847      2.184826599242     -5.158201997889
H     -0.181935980785      1.507415583931     -5.439825907785
H      0.387468192291      3.178414326333     -5.540569032011
H      1.532669953118      1.838277387077     -5.655049308264
C     -1.593903490628      2.904465320421      0.210183455711
C     -2.951722064556      3.195766713375      0.282529738058
C     -0.680386896306      3.939235505330      0.000420952421
C     -3.389692699925      4.509339684535      0.163454293141
H     -3.671414377110      2.400183035753      0.426478483633
C     -1.118910002417      5.247984864872     -0.105694558674
H      0.376457274790      3.709049789739     -0.085539339348
C     -2.476538100526      5.534803351205     -0.023620793535
H     -4.448328643022      4.728232663738      0.217295716920
H     -0.403503469426      6.044740191591     -0.262986874404
H     -2.820330362279      6.557050961057     -0.114231153303
C     -2.326517048596      0.120061878383      0.622588773579
C     -2.618466692069     -0.856665236551     -0.325439871847
C     -3.064059858930      0.166318540549      1.805367870920
C     -3.636759008954     -1.772711516275     -0.098202020683
H     -2.027619427505     -0.912762518087     -1.233083481230
C     -4.083383963140     -0.744620480551      2.029950994183
H     -2.831843551609      0.909241142831      2.559894568494
C     -4.368490723584     -1.716249337984      1.077536649973
H     -3.846212128552     -2.536326743031     -0.836000786407
H     -4.651011869440     -0.703284293056      2.950974172364
H     -5.158154316360     -2.434404099932      1.258915343831
C      2.974970312489     -1.480593496862      0.965272111277
C      3.283842876040     -2.620469335994      1.703269459843
C      4.002393801358     -0.711540956219      0.421775888729
C      4.608959967644     -2.980086542256      1.903991420728
H      2.489222825775     -3.230976673516      2.114926028340
C      5.325272698732     -1.068751074486      0.632006542043
H      3.754470646530      0.162492567006     -0.170928387271
C      5.628760927735     -2.203216424024      1.372462730538
H      4.844624008122     -3.869120421012      2.474701838583
H      6.119480988974     -0.468025151106      0.208151779336
H      6.661606252576     -2.486965416888      1.528487892807
C      0.242106541486     -2.371217397657      1.044790075496
C      0.252396777560     -3.409056162468      0.112393391222
C     -0.602096897260     -2.455203083980      2.147212610123
C     -0.562480947364     -4.515362791162      0.284211492272
H      0.900904907495     -3.347898494328     -0.754725254839
C     -1.427339848859     -3.560348247094      2.311902732303
H     -0.630442127282     -1.653893473871      2.874944253589
C     -1.408155715637     -4.590104704899      1.384263343714
H     -0.545698788204     -5.313752004495     -0.446487286537
H     -2.089263050087     -3.610880870706      3.167051639264
H     -2.053696248825     -5.449366231996      1.514059939500

```

<MoleculeViewer 
  xyzData={`74
OptimizedStructure
Cu     0.689598969684      0.351701336139     -1.096084493329
H      1.762445482995      1.413026439504     -1.582033343707
P      1.272485790498     -0.913730588680      0.679338714324
P     -0.910638982557      1.222671620587      0.299271892429
C     -0.042335293165      1.195565648401      1.910685289451
C     -0.308031782285      2.092053761907      2.940958326522
C      0.939837323832      0.209398276551      2.086104872536
C      0.388085411146      2.009955932546      4.138051289998
H     -1.050861760597      2.868361485898      2.800301404880
C      1.631288880797      0.135462688299      3.290955756662
C      1.356330424596      1.031609186135      4.313619312562
H      0.180034031150      2.716504024121      4.931326737216
H      2.399971345488     -0.615821325249      3.424688682295
H      1.905845048942      0.971817782935      5.244192467477
C      0.086775651616     -0.124907313300     -3.034696962170
H     -0.932863069346      0.195641824121     -3.216237679320
C      1.131929418328      0.840773766991     -3.102242457867
H      2.116147894313      0.472166812241     -3.368973962346
Se     0.424479963943     -1.957397708847     -3.338898697655
C      0.550243680227     -1.901583939725     -5.291837135836
F      0.752013092086     -3.141235752818     -5.771663969546
F     -0.561001302794     -1.418981082338     -5.874608128036
F      1.565676405821     -1.133120716895     -5.726362962613
C      0.807955175867      2.218862570870     -3.641701418582
H     -0.103981266509      2.585615642355     -3.162647941265
H      1.606253298600      2.911542701769     -3.372385722991
C      0.625065513847      2.184826599242     -5.158201997889
H     -0.181935980785      1.507415583931     -5.439825907785
H      0.387468192291      3.178414326333     -5.540569032011
H      1.532669953118      1.838277387077     -5.655049308264
C     -1.593903490628      2.904465320421      0.210183455711
C     -2.951722064556      3.195766713375      0.282529738058
C     -0.680386896306      3.939235505330      0.000420952421
C     -3.389692699925      4.509339684535      0.163454293141
H     -3.671414377110      2.400183035753      0.426478483633
C     -1.118910002417      5.247984864872     -0.105694558674
H      0.376457274790      3.709049789739     -0.085539339348
C     -2.476538100526      5.534803351205     -0.023620793535
H     -4.448328643022      4.728232663738      0.217295716920
H     -0.403503469426      6.044740191591     -0.262986874404
H     -2.820330362279      6.557050961057     -0.114231153303
C     -2.326517048596      0.120061878383      0.622588773579
C     -2.618466692069     -0.856665236551     -0.325439871847
C     -3.064059858930      0.166318540549      1.805367870920
C     -3.636759008954     -1.772711516275     -0.098202020683
H     -2.027619427505     -0.912762518087     -1.233083481230
C     -4.083383963140     -0.744620480551      2.029950994183
H     -2.831843551609      0.909241142831      2.559894568494
C     -4.368490723584     -1.716249337984      1.077536649973
H     -3.846212128552     -2.536326743031     -0.836000786407
H     -4.651011869440     -0.703284293056      2.950974172364
H     -5.158154316360     -2.434404099932      1.258915343831
C      2.974970312489     -1.480593496862      0.965272111277
C      3.283842876040     -2.620469335994      1.703269459843
C      4.002393801358     -0.711540956219      0.421775888729
C      4.608959967644     -2.980086542256      1.903991420728
H      2.489222825775     -3.230976673516      2.114926028340
C      5.325272698732     -1.068751074486      0.632006542043
H      3.754470646530      0.162492567006     -0.170928387271
C      5.628760927735     -2.203216424024      1.372462730538
H      4.844624008122     -3.869120421012      2.474701838583
H      6.119480988974     -0.468025151106      0.208151779336
H      6.661606252576     -2.486965416888      1.528487892807
C      0.242106541486     -2.371217397657      1.044790075496
C      0.252396777560     -3.409056162468      0.112393391222
C     -0.602096897260     -2.455203083980      2.147212610123
C     -0.562480947364     -4.515362791162      0.284211492272
H      0.900904907495     -3.347898494328     -0.754725254839
C     -1.427339848859     -3.560348247094      2.311902732303
H     -0.630442127282     -1.653893473871      2.874944253589
C     -1.408155715637     -4.590104704899      1.384263343714
H     -0.545698788204     -5.313752004495     -0.446487286537
H     -2.089263050087     -3.610880870706      3.167051639264
H     -2.053696248825     -5.449366231996      1.514059939500
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -631.5244             12.0855             16.0701
Reduced mass [au]                   1.2102              7.4990              8.0320
Force const [Dyne/A]               -0.2844              0.0006              0.0012
Char temp [K]                       0.0000             17.3883             23.1213
Normal mode                   x         y         z            x         y         z            x         y         z     
      Cu                -0.01531   -0.01335    0.00681    0.01449    0.01183    0.00097   -0.02272    0.01553   -0.00620
       H                -0.13999   -0.23094   -0.83785    0.02772   -0.00452   -0.00549   -0.01203    0.00764   -0.00005
       P                 0.00533    0.00252    0.00320    0.00820    0.00558    0.00028   -0.01422    0.00396   -0.01387
       P                 0.00129    0.00447    0.00286    0.00925    0.00778   -0.00435   -0.01182    0.01091    0.00431
       C                -0.00153   -0.00007    0.00288   -0.00400   -0.00273    0.00264   -0.00407    0.00082    0.00060
       C                -0.00030    0.00031    0.00177   -0.01393   -0.01040    0.00686    0.00145   -0.00402    0.00634
       C                -0.00061   -0.00118    0.00291   -0.00513   -0.00342    0.00441   -0.00459   -0.00115   -0.00806
       C                 0.00069    0.00073    0.00084   -0.02483   -0.01874    0.01256    0.00673   -0.01058    0.00282
       H                -0.00183   -0.00113    0.00210   -0.01330   -0.00999    0.00593    0.00167   -0.00251    0.01372
       C                 0.00014   -0.00027    0.00178   -0.01609   -0.01178    0.01024    0.00091   -0.00768   -0.01165
       C                 0.00064    0.00074    0.00075   -0.02587   -0.01951    0.01429    0.00669   -0.01225   -0.00617
       H                 0.00061    0.00025    0.00116   -0.03258   -0.02473    0.01586    0.01089   -0.01420    0.00715
       H                -0.00134   -0.00161    0.00272   -0.01694   -0.01237    0.01181    0.00051   -0.00940   -0.01888
       H                 0.00018    0.00067    0.00095   -0.03440   -0.02609    0.01890    0.01088   -0.01715   -0.00896
       C                 0.00132   -0.01262    0.03538    0.00682    0.01272    0.00209   -0.00041    0.00271   -0.01040
       H                 0.02436    0.00425   -0.05963    0.01364    0.03352    0.00025    0.00419    0.00638   -0.02937
       C                 0.06245    0.04205    0.06491    0.02692   -0.00963   -0.00236    0.00673   -0.00485   -0.00481
       H                -0.01304   -0.00219   -0.17098    0.02040   -0.03291    0.00534    0.00840   -0.01439    0.01440
      Se                -0.00016    0.00483   -0.00120   -0.03496    0.00274    0.01759   -0.00532   -0.00306    0.01726
       C                -0.00069   -0.00514    0.00228   -0.04649   -0.01903    0.01625    0.04494   -0.02773    0.01988
       F                 0.00091   -0.00293   -0.00646   -0.08174   -0.02911    0.02722    0.05117   -0.03517    0.04155
       F                 0.00029   -0.00064   -0.00099   -0.03818    0.00372    0.01924    0.06303   -0.02951   -0.01582
       F                 0.00047    0.00024   -0.00076   -0.02975   -0.04954    0.00170    0.06065   -0.03890    0.03664
       C                 0.00448    0.00699   -0.02085    0.05812   -0.00814   -0.01725    0.02508   -0.00866   -0.02522
       H                 0.00785   -0.00276   -0.00456    0.06396    0.01558   -0.02435    0.01857    0.00203   -0.04596
       H                -0.01078    0.03945   -0.04639    0.07161   -0.02231   -0.02096    0.02447   -0.01074   -0.01820
       C                -0.00628   -0.00152   -0.00875    0.06330   -0.01946   -0.01760    0.05298   -0.02439   -0.02825
       H                 0.00056   -0.00890   -0.01021    0.04985   -0.00494   -0.01396    0.05410   -0.02264   -0.03566
       H                -0.01595   -0.00520   -0.01278    0.08621   -0.01821   -0.02858    0.06622   -0.02725   -0.04388
       H                -0.00376    0.00549   -0.00952    0.05782   -0.04398   -0.01054    0.06014   -0.03553   -0.00742
       C                -0.00116    0.00096    0.00146    0.00536    0.00674    0.00439   -0.01112    0.01229    0.02168
       C                -0.00043    0.00051    0.00046    0.00392    0.00225   -0.00484   -0.00994    0.01366    0.03810
       C                -0.00200    0.00076    0.00016    0.00424    0.01132    0.02227   -0.01164    0.01295    0.02296
       C                -0.00017    0.00058   -0.00008    0.00127    0.00217    0.00385   -0.00909    0.01557    0.05603
       H                 0.00016   -0.00016   -0.00067    0.00490   -0.00113   -0.01869   -0.00979    0.01339    0.03728
       C                 0.00018    0.00070    0.00020    0.00155    0.01112    0.03102   -0.01066    0.01474    0.04082
       H                -0.00046    0.00501    0.00184    0.00569    0.01529    0.02955   -0.01283    0.01216    0.01052
       C                -0.00015    0.00022    0.00011    0.00002    0.00655    0.02184   -0.00935    0.01609    0.05762
       H                -0.00008    0.00071   -0.00137    0.00018   -0.00135   -0.00341   -0.00821    0.01667    0.06896
       H                -0.00004    0.00061   -0.00044    0.00072    0.01463    0.04507   -0.01096    0.01524    0.04197
       H                 0.00013    0.00008   -0.00099   -0.00204    0.00646    0.02871   -0.00862    0.01760    0.07189
       C                 0.00375   -0.00215   -0.00371    0.00955    0.00147   -0.02315   -0.01095    0.00978    0.00478
       C                 0.00188   -0.00125   -0.00342    0.01913    0.00672   -0.03151   -0.01672    0.01648   -0.00030
       C                 0.00303    0.00061   -0.00174    0.00070   -0.00833   -0.02822   -0.00446    0.00206    0.00914
       C                 0.00053    0.00005   -0.00019    0.02028    0.00213   -0.04470   -0.01589    0.01536   -0.00099
       H                 0.00201    0.00100   -0.00403    0.02531    0.01403   -0.02782   -0.02176    0.02268   -0.00401
       C                 0.00164    0.00156   -0.00095    0.00186   -0.01286   -0.04140   -0.00370    0.00106    0.00849
       H                 0.00298    0.00019   -0.00130   -0.00711   -0.01247   -0.02173    0.00014   -0.00332    0.01302
       C                 0.00083    0.00066   -0.00033    0.01170   -0.00774   -0.04962   -0.00936    0.00765    0.00344
       H                -0.00003    0.00061   -0.00051    0.02807    0.00634   -0.05128   -0.02033    0.02048   -0.00502
       H                 0.00174    0.00361   -0.00105   -0.00493   -0.02039   -0.04524    0.00138   -0.00497    0.01189
       H                 0.00017    0.00147    0.00021    0.01261   -0.01134   -0.05985   -0.00864    0.00673    0.00290
       C                 0.00083   -0.00029    0.00157    0.01076    0.01585    0.00635   -0.01043    0.00535   -0.03367
       C                 0.00078   -0.00032    0.00060    0.01504    0.01509    0.00343   -0.00045    0.00611   -0.03657
       C                 0.00092   -0.00222    0.00092    0.00823    0.02577    0.01559   -0.01768    0.00431   -0.04888
       C                 0.00052   -0.00014   -0.00002    0.01655    0.02414    0.00965    0.00217    0.00578   -0.05483
       H                 0.00006    0.00004   -0.00047    0.01723    0.00747   -0.00365    0.00511    0.00663   -0.02502
       C                 0.00097    0.00046    0.00027    0.00968    0.03478    0.02186   -0.01485    0.00390   -0.06720
       H                 0.00778   -0.00454   -0.00531    0.00515    0.02638    0.01778   -0.02577    0.00370   -0.04637
       C                 0.00031    0.00015    0.00013    0.01388    0.03398    0.01890   -0.00494    0.00457   -0.07035
       H                 0.00092   -0.00034   -0.00076    0.01983    0.02354    0.00737    0.00983    0.00631   -0.05717
       H                 0.00088   -0.00097   -0.00153    0.00765    0.04256    0.02906   -0.02060    0.00302   -0.07923
       H                 0.00024    0.00000   -0.00092    0.01508    0.04109    0.02382   -0.00288    0.00407   -0.08484
       C                -0.00314    0.00365   -0.00621    0.01621   -0.00295   -0.01172   -0.00810    0.00097   -0.00795
       C                -0.00012    0.00128   -0.00297    0.03943   -0.00513   -0.00912   -0.00022   -0.00578   -0.00045
       C                 0.00029    0.00225   -0.00204   -0.00105   -0.00684   -0.02526   -0.01257    0.00551   -0.01101
       C                 0.00054    0.00042   -0.00016    0.04460   -0.01061   -0.02017    0.00246   -0.00712    0.00348
       H                -0.00523    0.00193   -0.00651    0.05343   -0.00242    0.00157    0.00425   -0.01031    0.00265
       C                 0.00200    0.00119    0.00029    0.00448   -0.01264   -0.03635   -0.00963    0.00389   -0.00701
       H                -0.00127    0.00378   -0.00379   -0.01880   -0.00559   -0.02736   -0.01820    0.01003   -0.01625
       C                 0.00123    0.00096   -0.00016    0.02704   -0.01441   -0.03390   -0.00239   -0.00232    0.00010
       H                 0.00008    0.00130   -0.00080    0.06240   -0.01196   -0.01829    0.00867   -0.01225    0.00922
       H                 0.00315    0.00151    0.00105   -0.00895   -0.01572   -0.04693   -0.01290    0.00753   -0.00932
       H                 0.00078    0.00131    0.00012    0.03121   -0.01885   -0.04264   -0.00005   -0.00362    0.00317

(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.

