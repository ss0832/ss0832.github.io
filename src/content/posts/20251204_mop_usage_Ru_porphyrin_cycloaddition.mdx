---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Ruポルフィリン錯体を触媒とする環化付加反応, NNP(UMA)使用)
published: 2025-12-04
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-12-04

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Ruポルフィリン錯体を触媒とする環化付加反応の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy


今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.20.0
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.20.0.zip
unzip v1.20.0.zip
cd MultiOptPy-1.20.0
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.20.0 にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。

#### UMAを使用可能にするための手順

1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-1.20.0`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-1.20.0`がNNP`uma-s-1p1`を使用できるようになる。

#### ※Linuxの場合

すでにAnacondaの導入が終わっている前提で、環境の構築手段について述べる。以下を実行すると可能である。

GitHubのレポジトリのブランチ`stable-v1.0`から`git clone`して得られる`multioptpy`ディレクトリ内は`v1.20.0`と同等であるので安心していただきたい。

```
## 1. Download and install MultiOptPy:
git clone -b stable-v1.0 https://github.com/ss0832/MultiOptPy.git
cd MultiOptPy

## 2. Create and activate a conda environment:
conda env create -f environment.yml
conda activate test_mop

## 3. Copy the test configuration file and run the AutoTS workflow（任意で行う）:
cp test/config_autots_run_xtb_test.json .
python run_autots.py aldol_rxn.xyz -cfg config_autots_run_xtb_test.json
```

あとは、「UMAを使用可能にするための手順」と同じように進めれば問題なく導入できるはずである。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`Ru_porphyrin_cycloaddition.xyz`とした。
初期構造は以下のものを使用した。

```
70
OptimizedStructure
N     -2.896027920902      0.419290340102      0.730908892007
C     -3.215268241624     -0.833785451139      1.292706956673
C     -3.902597986678      0.765884944164     -0.032222438132
C     -4.525432448995     -1.238170120483      0.783116743006
C     -2.442701819700     -1.517266117653      2.154425639399
C     -4.946248018601     -0.259676485772     -0.032581853505
C     -3.981647763972      2.006661502077     -0.776968112493
H     -5.029657401194     -2.155391830364      1.043908251418
C     -1.140552272199     -1.133640365374      2.662677598908
H     -2.825342846810     -2.461066070176      2.521669508914
H     -5.870111745404     -0.200875069655     -0.585536644693
C     -3.071875232556      2.994619001129     -0.807638180154
H     -4.873998359016      2.134882677611     -1.375882059667
N     -0.494767745967     -0.049863601018      2.305414663439
C     -0.390500176184     -1.898814353813      3.656484789275
N     -1.850272444263      2.995243848443     -0.107249335238
C     -3.135055589829      4.218817190522     -1.610321445195
C      0.700774186950     -0.021411940871      3.053623756207
C      0.738562937760     -1.215035913738      3.896676354416
H     -0.715639450500     -2.828654587611      4.095015688390
C     -1.203693474550      4.074222302687     -0.463487646573
C     -1.987214992678      4.878689935524     -1.404644005289
H     -3.963627923461      4.496111936949     -2.242659540128
C      1.626490550730      0.950694889223      2.997446014615
H      1.541306037840     -1.463819896036      4.572826577234
C      0.130059923565      4.422447371834     -0.012147504138
H     -1.668703055883      5.816401586449     -1.831136850097
C      1.588611195695      2.148059876340      2.179139061572
H      2.503712590782      0.838735862966      3.621894643651
C      0.921041545803      3.718879374212      0.814367824655
H      0.524578975800      5.351914882389     -0.402103569657
N      0.575673640523      2.498357823793      1.429050250744
C      2.677686554276      3.122137328879      2.095747394709
C      2.268443271599      4.083500570822      1.256252614833
H      3.615197777722      3.048391945604      2.623180847373
H      2.796731730103      4.971255668232      0.946272455275
Ru    -1.188102881319      1.492025649062      1.124925104443
C     -1.965544279139      2.258988504201      2.619983317904
O     -2.445206163650      2.728447977504      3.532510494070
O     -0.259728901998      0.873753641633     -0.728091645292
C     -0.226935708249     -0.085496530697     -1.515281413522
C     -0.799343346624     -1.425174286208     -1.159689121358
C      0.309384379141      0.120748551135     -2.844253540129
C     -0.256107448660     -2.554349067051     -2.028173600062
H     -1.887766846284     -1.335727089865     -1.282012380500
H     -0.609039722415     -1.598993664516     -0.099091082237
C      0.207248362989     -0.836794217437     -3.776716475314
H      0.713923158401      1.099865104176     -3.065773500149
C     -0.333322484736     -2.200541047050     -3.508372749677
H     -0.799594448310     -3.477274422736     -1.826825343040
H      0.790391655979     -2.726716358843     -1.773721745316
H      0.531328905664     -0.613895367467     -4.787748112220
H      0.217568730773     -2.928705484493     -4.104659777475
H     -1.365005716905     -2.237369508080     -3.879186516155
C      2.792981908172     -1.887226575183     -0.277490548469
C      3.606110983961     -2.636934875288     -1.273197421139
C      3.606095030852     -2.281095795890     -2.555940795793
H      3.008872625777     -1.448895550898     -2.909734122580
C      2.696406980220     -0.558793289168     -0.305764769421
H      3.247756365447      0.035937193663     -1.023169046874
H      4.208884955981     -2.808164792938     -3.283834578750
H      2.073442057070     -0.032188188283      0.408444767692
C      4.396949843032     -3.813686721134     -0.769904356712
H      5.061723991728     -3.517595589045      0.044349619820
H      3.743822050719     -4.599308604193     -0.384472044908
H      5.001667322627     -4.241749437151     -1.566144863758
C      2.093500767265     -2.697785141376      0.780394555703
H      1.502543012403     -3.505241466272      0.339992917613
H      2.811561288954     -3.171341177193      1.453019070333
H      1.435599562948     -2.066451429169      1.377402361522
```

<MoleculeViewer 
  xyzData={`70
OptimizedStructure
N     -2.896027920902      0.419290340102      0.730908892007
C     -3.215268241624     -0.833785451139      1.292706956673
C     -3.902597986678      0.765884944164     -0.032222438132
C     -4.525432448995     -1.238170120483      0.783116743006
C     -2.442701819700     -1.517266117653      2.154425639399
C     -4.946248018601     -0.259676485772     -0.032581853505
C     -3.981647763972      2.006661502077     -0.776968112493
H     -5.029657401194     -2.155391830364      1.043908251418
C     -1.140552272199     -1.133640365374      2.662677598908
H     -2.825342846810     -2.461066070176      2.521669508914
H     -5.870111745404     -0.200875069655     -0.585536644693
C     -3.071875232556      2.994619001129     -0.807638180154
H     -4.873998359016      2.134882677611     -1.375882059667
N     -0.494767745967     -0.049863601018      2.305414663439
C     -0.390500176184     -1.898814353813      3.656484789275
N     -1.850272444263      2.995243848443     -0.107249335238
C     -3.135055589829      4.218817190522     -1.610321445195
C      0.700774186950     -0.021411940871      3.053623756207
C      0.738562937760     -1.215035913738      3.896676354416
H     -0.715639450500     -2.828654587611      4.095015688390
C     -1.203693474550      4.074222302687     -0.463487646573
C     -1.987214992678      4.878689935524     -1.404644005289
H     -3.963627923461      4.496111936949     -2.242659540128
C      1.626490550730      0.950694889223      2.997446014615
H      1.541306037840     -1.463819896036      4.572826577234
C      0.130059923565      4.422447371834     -0.012147504138
H     -1.668703055883      5.816401586449     -1.831136850097
C      1.588611195695      2.148059876340      2.179139061572
H      2.503712590782      0.838735862966      3.621894643651
C      0.921041545803      3.718879374212      0.814367824655
H      0.524578975800      5.351914882389     -0.402103569657
N      0.575673640523      2.498357823793      1.429050250744
C      2.677686554276      3.122137328879      2.095747394709
C      2.268443271599      4.083500570822      1.256252614833
H      3.615197777722      3.048391945604      2.623180847373
H      2.796731730103      4.971255668232      0.946272455275
Ru    -1.188102881319      1.492025649062      1.124925104443
C     -1.965544279139      2.258988504201      2.619983317904
O     -2.445206163650      2.728447977504      3.532510494070
O     -0.259728901998      0.873753641633     -0.728091645292
C     -0.226935708249     -0.085496530697     -1.515281413522
C     -0.799343346624     -1.425174286208     -1.159689121358
C      0.309384379141      0.120748551135     -2.844253540129
C     -0.256107448660     -2.554349067051     -2.028173600062
H     -1.887766846284     -1.335727089865     -1.282012380500
H     -0.609039722415     -1.598993664516     -0.099091082237
C      0.207248362989     -0.836794217437     -3.776716475314
H      0.713923158401      1.099865104176     -3.065773500149
C     -0.333322484736     -2.200541047050     -3.508372749677
H     -0.799594448310     -3.477274422736     -1.826825343040
H      0.790391655979     -2.726716358843     -1.773721745316
H      0.531328905664     -0.613895367467     -4.787748112220
H      0.217568730773     -2.928705484493     -4.104659777475
H     -1.365005716905     -2.237369508080     -3.879186516155
C      2.792981908172     -1.887226575183     -0.277490548469
C      3.606110983961     -2.636934875288     -1.273197421139
C      3.606095030852     -2.281095795890     -2.555940795793
H      3.008872625777     -1.448895550898     -2.909734122580
C      2.696406980220     -0.558793289168     -0.305764769421
H      3.247756365447      0.035937193663     -1.023169046874
H      4.208884955981     -2.808164792938     -3.283834578750
H      2.073442057070     -0.032188188283      0.408444767692
C      4.396949843032     -3.813686721134     -0.769904356712
H      5.061723991728     -3.517595589045      0.044349619820
H      3.743822050719     -4.599308604193     -0.384472044908
H      5.001667322627     -4.241749437151     -1.566144863758
C      2.093500767265     -2.697785141376      0.780394555703
H      1.502543012403     -3.505241466272      0.339992917613
H      2.811561288954     -3.171341177193      1.453019070333
H      1.435599562948     -2.066451429169      1.377402361522`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`Ru_porphyrin_cycloaddition.xyz`として保存する。その後、同じディレクトリ内で、`config_Ru_porphyrin_cycloaddition.json`を作成し、以下のように記述する。

`config_Ru_porphyrin_cycloaddition.json`
```json
{
  "work_dir": "Ru_porphyrin_cycloaddition",
  "top_n_candidates": 3,
  "multioptpy_version": "1.20.0",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 1,
    "electronic_charge": 2,
	"manual_AFIR": ["200", "47", "57", "200", "43", "59"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 20,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance": 0.30,
    "align_distances_energy_predicted": 1,
    "spin_multiplicity": 1,
    "electronic_charge": 2
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 1,
    "electronic_charge": 2
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py Ru_porphyrin_cycloaddition.xyz -cfg config_Ru_porphyrin_cycloaddition.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.20.0/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
-  `"shape_conditions": ["yyy", "lt", "a,b"]`: 構造最適化中に、ラベル番号aの原子とラベル番号bの原子の間の距離yyy(Å)よりも大きくなった時に構造最適化を途中で打ち切る。"lt"を"gt"にすると、yyy(Å)よりも小さくなった時に途中で打ち切る。
- `"shape_conditions": ["yyy", "lt", "a,b,c"]`: 構造最適化中に、角度の中心がラベル番号bの原子で、ラベル番号aの原子とラベル番号cで作る角度yyy(degrees)よりも大きくなった時に構造最適化を途中で打ち切る。"lt"を"gt"にすると、yyy(degrees)よりも小さくなった時に途中で打ち切る。
- `"shape_conditions": ["yyy", "lt", "a,b,c,d"]`: 構造最適化中に、ラベル番号bとラベル番号cを軸とした、ラベル番号aの原子とラベル番号dの原子がなす二面角yyy(degrees)よりも大きくなった時に構造最適化を途中で打ち切る。"lt"を"gt"にすると、yyy(degrees)よりも小さくなった時に途中で打ち切る。

Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`Ru_porphyrin_cycloaddition_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`Ru_porphyrin_cycloaddition_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`Ru_porphyrin_cycloaddition_step1_traj.xyz`はStep2のNEB計算に使用している。

※`Ru_porphyrin_cycloaddition_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`Ru_porphyrin_cycloaddition_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。


- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"node_distance": yyy`: 入力された経路を経路座標上でyyy(Å)間隔で線形補間により構造を再配置して初期経路とする。
- `"align_distances_energy_predicted": a`:経路緩和a回に1回、経路座標上で等間隔に線形補間により構造を置きなおす。エネルギー極大値を示す構造に対しては前後のノードの情報を使って経路座標を変数とした多項式を作り、真のエネルギー極大値の場所を連続最適化により推定し、再配置する。


`MultiOptPy-v1.20.0/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-1739.4053757610889,-1739.4053757610889,-1739.4012857648438,-1739.3951931333831,-1739.3892801171412,-1739.383719466531,-1739.37799367506,-1739.3715502287914,-1739.3639840034089,-1739.3553809338423,-1739.3465436810773,-1739.335782153521,-1739.3280847739818,-1739.3297346492889,-1739.3436394168903,-1739.35294461549,-1739.3384627310477,-1739.393718177014,-1739.4133045989322,-1739.4211894135235,-1739.4248474614521,-1739.4277283209,-1739.4305949491275,-1739.433423369693,-1739.435523730921,-1739.4371643056643,-1739.4386344277552,-1739.4393280798263,-1739.4391813320021,-1739.440550659289,-1739.4409991694429,-1739.4410983148532,-1739.4420898828596,-1739.4429672812996,-1739.443593733184,-1739.4440304873026,-1739.4445195379253,-1739.4451994625747,-1739.4459736567385,-1739.4465334998522,-1739.4468997626639,-1739.4471311727787,-1739.4470595665432,-1739.4475021636324,-1739.4477448237933,-1739.4479076909881,-1739.4479173365444,-1739.447904070208,-1739.448015075699,-1739.4483528859269,-1739.4487627908559,-1739.448955254039,-1739.4489261771826,-1739.4491484072073,-1739.4492375927348,-1739.449308748837,-1739.4491491037638,-1739.449559739201,-1739.4495095268906,-1739.4496376516831,-1739.4497492299713,-1739.4497741953917,-1739.4498822689927,-1739.449984922376,-1739.450162825774,-1739.4503619369107,-1739.450488024604,-1739.4505824036398,-1739.4507382056042,-1739.4497156014024,-1739.4511426300787,-1739.4514428525363,-1739.451671717372,-1739.4518981157842,-1739.4521329068268,-1739.4524098713039,-1739.4526811976154,-1739.4529372358243,-1739.4531800821715,-1739.4528754558555,-1739.453461297177,-1739.4536284444712,-1739.4537605667977,-1739.453916310716,-1739.4539977344566,-1739.4541770298727,-1739.4545856227344,-1739.4545846578503,-1739.4549545655366,-1739.4550598720775,-1739.4550901240993,-1739.455344843122,-1739.4556835662113,-1739.4558918623663,-1739.4554867988343,-1739.4561244306708,-1739.4564755680192,-1739.4566748669852,-1739.4568672660982,-1739.457155650927,-1739.4574471790222,-1739.457822879847,-1739.4582372532523,-1739.45848152995,-1739.4587345711036,-1739.4590019294521,-1739.4588153826192,-1739.4595265701735,-1739.4598387096626,-1739.4602088815695,-1739.4606892501513,-1739.4608018176923,-1739.4613697193963,-1739.4617114357072,-1739.4617547651408,-1739.4620541648183,-1739.462321999722,-1739.4624605126266,-1739.462550443174,-1739.4626304358794,-1739.4627340801583,-1739.4627512364236,-1739.462739850708,-1739.4627999543136,-1739.462862241093,-1739.4629215807865,-1739.4629626099952,-1739.4630602431878,-1739.4631616804036,-1739.4632303273004,-1739.4632865126384,-1739.4633054567732,-1739.4633032033005,-1739.4633234629252,-1739.4633764821342,-1739.463461988767,-1739.4635680363576,-1739.4636645640678,-1739.4637145086326,-1739.4635914573196,-1739.4636783367698];

export const dataset1_itr5 = [-1739.4051981873502,-1739.404220226292,-1739.4010703448644,-1739.3972533856565,-1739.3930997924815,-1739.3885527193133,-1739.383342344665,-1739.3773640054346,-1739.3705308554731,-1739.3623806353012,-1739.3523832346946,-1739.3429972442932,-1739.3388207260832,-1739.3455724709227,-1739.3653316520154,-1739.3882013831833,-1739.403009952662,-1739.4174861507493,-1739.425102269735,-1739.4298158527824,-1739.433099985634,-1739.4354878516858,-1739.4375180162197,-1739.439296301075,-1739.4409447460316,-1739.442366450869,-1739.443492198015,-1739.4444620041043,-1739.4452441517174,-1739.4460892774644,-1739.4467968924282,-1739.4474123089287,-1739.4480625850197,-1739.4486255768759,-1739.4490895985562,-1739.4495593142578,-1739.4501795562746,-1739.4507765633105,-1739.4512679040274,-1739.4517621317304,-1739.4520458536824,-1739.4522599440713,-1739.4524666713312,-1739.452686534597,-1739.4528127372878,-1739.4529531744845,-1739.4531031214312,-1739.4532184179734,-1739.4533428617494,-1739.453469395195,-1739.4536460412867,-1739.4537601812822,-1739.4538910079696,-1739.4541034204894,-1739.4542369227865,-1739.4544039857492,-1739.454508783563,-1739.4545565612111,-1739.4546052128405,-1739.454626038349,-1739.454689292477,-1739.4547506836445,-1739.4548014983231,-1739.4548933977928,-1739.4550519783172,-1739.4551620035909,-1739.455311481238,-1739.455432192522,-1739.455553966712,-1739.4556506462463,-1739.4558622034033,-1739.4561525596189,-1739.4564320983982,-1739.4566571737907,-1739.4568157121496,-1739.456997714389,-1739.457212239578,-1739.4575021144465,-1739.4577434132552,-1739.4578860436197,-1739.4579491761788,-1739.457989276919,-1739.4581078032497,-1739.4582276421952,-1739.4583495987383,-1739.4585045606732,-1739.4587348470977,-1739.458932704761,-1739.459085486671,-1739.4592673454372,-1739.4594520298576,-1739.4596677616996,-1739.4599215738845,-1739.460176039091,-1739.4603736514264,-1739.4604587936947,-1739.4606224089214,-1739.4609937863859,-1739.4614451402647,-1739.4617502257495,-1739.4619844668575,-1739.4622117076267,-1739.4624582811266,-1739.4627600266172,-1739.463046966584,-1739.4633771834824,-1739.4636974172588,-1739.4640140474023,-1739.4643110204177,-1739.4645721612064,-1739.464982188594,-1739.4653913631516,-1739.465657230776,-1739.4659225106807,-1739.466219508963,-1739.4664825961108,-1739.4667206643098,-1739.4669436188192,-1739.4671327484425,-1739.467323976771,-1739.4674999131635,-1739.4675864406047,-1739.4675846896303,-1739.4676138357588,-1739.467665118642,-1739.4677265311661,-1739.4677822723947,-1739.4678686897669,-1739.467935608757,-1739.4679632862028,-1739.4679994425273,-1739.4680628330093,-1739.4681275664984,-1739.4681760393344,-1739.4682298365567,-1739.468282279272,-1739.4683399259004,-1739.4684122547037,-1739.4685013493286,-1739.468528957228,-1739.468535771928];

export const dataset1_itr10 = [-1739.405314481633,-1739.4048758043175,-1739.4033536310503,-1739.4009300829018,-1739.3978177279125,-1739.3940328497351,-1739.389447273197,-1739.383984920301,-1739.3774617073518,-1739.369474192283,-1739.359257336926,-1739.3488971749093,-1739.3453173910268,-1739.351116404175,-1739.3729349832736,-1739.3996255331863,-1739.412664020968,-1739.4226356621234,-1739.4285740698242,-1739.4325495394628,-1739.4354746258725,-1739.4377130016824,-1739.4396012307657,-1739.4412177326888,-1739.4426444777043,-1739.4438653289183,-1739.444879125403,-1739.445753774854,-1739.4465243000484,-1739.4471928300834,-1739.447823418594,-1739.4484430670045,-1739.4490380237983,-1739.4496074106135,-1739.45014123252,-1739.4506498754397,-1739.4511689130422,-1739.4516378818075,-1739.4520411311164,-1739.45236193704,-1739.4526146906999,-1739.4528289092286,-1739.4530090074372,-1739.453152453189,-1739.4532740778823,-1739.453395129778,-1739.4535315957262,-1739.45368364439,-1739.4538406697093,-1739.4539988066717,-1739.4541466431394,-1739.4542978320596,-1739.4544369221423,-1739.4545632606396,-1739.4546740208025,-1739.4547492916265,-1739.454808101373,-1739.4548694301131,-1739.4549309976103,-1739.4549947840126,-1739.4550602504742,-1739.4551380736964,-1739.4552438106566,-1739.4553721736586,-1739.4555240881584,-1739.4556850584413,-1739.4558493926763,-1739.4560498295705,-1739.4562853368836,-1739.4565392334002,-1739.456797745699,-1739.4570610161586,-1739.4573055425653,-1739.4575252026686,-1739.4577422906602,-1739.4579683369607,-1739.4581759403925,-1739.4583341939954,-1739.4584498705772,-1739.4585555878236,-1739.4586711466698,-1739.4587923086347,-1739.4589171132839,-1739.4590597863616,-1739.459229700716,-1739.4594135007503,-1739.4595870375274,-1739.4597556984083,-1739.4599292724226,-1739.460117471387,-1739.4603292013144,-1739.4605496620197,-1739.4607562285569,-1739.460928257497,-1739.461092202657,-1739.4613362737282,-1739.4616791876567,-1739.462007888162,-1739.4622840264362,-1739.4625351083878,-1739.4627871605626,-1739.463061437314,-1739.4633578759417,-1739.4636738581287,-1739.4640019986198,-1739.4643357636974,-1739.464669612833,-1739.464975433857,-1739.465306923669,-1739.4656713430288,-1739.4659947185999,-1739.4662761770169,-1739.4665503485594,-1739.4668073311173,-1739.4670327824424,-1739.467235434956,-1739.4674125300858,-1739.4675550221793,-1739.4676543518594,-1739.4677149832219,-1739.4677543444186,-1739.4677890903802,-1739.4678252165863,-1739.4678700738446,-1739.4679237078797,-1739.4679813701148,-1739.468038782641,-1739.4680918107488,-1739.4681416824476,-1739.4681936711966,-1739.468248918757,-1739.4683028684879,-1739.4683506710523,-1739.4683976563126,-1739.4684444488153,-1739.4684912106518,-1739.468537840241,-1739.4685817049608,-1739.4686177367046,-1739.46864103247,-1739.468540479161];

export const dataset2 = [-1739.4052372646124,-1739.4051695847218,-1739.404470053538,-1739.4031797416142,-1739.4012511648195,-1739.3986183561794,-1739.3951839861495,-1739.3908032498164,-1739.3852285760765,-1739.3780291424944,-1739.3684986538399,-1739.3572087333566,-1739.352433430577,-1739.3550272583338,-1739.371364103616,-1739.4002133349422,-1739.4172811177866,-1739.4251999278438,-1739.430489591659,-1739.434233392712,-1739.437001666274,-1739.4391612961433,-1739.4409114230277,-1739.4423732718665,-1739.4436238143523,-1739.444690084766,-1739.445592686288,-1739.4463801960726,-1739.4470756223914,-1739.44770530735,-1739.4483011403156,-1739.4488845217847,-1739.4494647293216,-1739.4500294669501,-1739.4505609615253,-1739.4510547171908,-1739.4515148585251,-1739.4519305188076,-1739.4522902431872,-1739.4525861910215,-1739.4528272620257,-1739.4530246920078,-1739.4531806232076,-1739.4533045018527,-1739.4534166857948,-1739.4535351058894,-1739.453673067901,-1739.4538360555696,-1739.4540059091394,-1739.4541681235864,-1739.4543173126442,-1739.4544520503437,-1739.4545707201473,-1739.4546733625784,-1739.454759773927,-1739.45483598335,-1739.4549019930382,-1739.4549628650739,-1739.4550197614801,-1739.4550828124457,-1739.4551529593075,-1739.4552349673452,-1739.455339130482,-1739.4554710397892,-1739.4556358329191,-1739.4558301656339,-1739.4560383331013,-1739.4562664411437,-1739.4565291103302,-1739.4568087542502,-1739.4570888159947,-1739.45737491292,-1739.4576624582667,-1739.4579300110158,-1739.4581712079696,-1739.4583936482757,-1739.45859063141,-1739.4587514308394,-1739.4588826441377,-1739.4590075544752,-1739.459139829584,-1739.4592631315986,-1739.4593832098485,-1739.4595107202256,-1739.4596556401364,-1739.4598150409768,-1739.4599761235193,-1739.4601369467696,-1739.4603051827073,-1739.4604889649445,-1739.460685180881,-1739.4608820884455,-1739.4610737899068,-1739.4612542478933,-1739.4614326550904,-1739.4616418517858,-1739.4619115048831,-1739.4622136428711,-1739.4625014840628,-1739.462771668613,-1739.463038707022,-1739.463318493662,-1739.4636144899596,-1739.4639263563981,-1739.4642532946086,-1739.4645931796779,-1739.4649371222868,-1739.4652649031539,-1739.4655838672684,-1739.4659101468014,-1739.4662226535984,-1739.4665020745051,-1739.4667556054937,-1739.4669881119185,-1739.467193280414,-1739.4673692534964,-1739.4675141766927,-1739.4676223368158,-1739.4676920162947,-1739.467738626444,-1739.4677771172187,-1739.4678162289804,-1739.4678546419948,-1739.4678994149215,-1739.4679504831424,-1739.4680070572815,-1739.4680605763194,-1739.4681143962673,-1739.4681680845158,-1739.4682208254035,-1739.4682730635875,-1739.4683239754665,-1739.468371450014,-1739.4684183799661,-1739.468464644575,-1739.4685106414042,-1739.468555698539,-1739.4685968356264,-1739.468630389173,-1739.4686546665246,-1739.4686034561996];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [1.1659481411130433e-05,1.1659544652267365e-05,0.002416167354663628,0.0036265681180942594,0.004366950611936196,0.004799462259182114,0.00506066760439891,0.005234417979579509,0.005370765456123848,0.005301431615578372,0.00483831311235192,0.004811784593867762,0.00634891337737181,0.00864094473009606,0.01100675553795457,0.01592391919127507,0.02115895733248228,0.009271970783860328,0.005119499882178424,0.005046935466904163,0.0060920100861944215,0.006486012289777719,0.006368382016448094,0.006111423718704949,0.005846071688542658,0.0054918035506283285,0.005365167194301218,0.0056475931382631295,0.0061604072947786,0.005624904986942557,0.005650127450529423,0.006047759089189507,0.005765588961102531,0.005588327917395019,0.005582590800826121,0.005697982165563182,0.0058646539663684645,0.005842201356749947,0.005680720096924212,0.005630821733765315,0.005656489727793541,0.005724414565187456,0.005870389882763875,0.005797216387466182,0.005669382643985875,0.0056519353165322235,0.005714038862601044,0.005752265543136317,0.005799139050874761,0.005794243735169565,0.005694839785671665,0.0056434568312767296,0.005706586345491888,0.005680329493708021,0.005728399174111589,0.005736872040955685,0.00573094877195141,0.00570230715312108,0.005728028227478867,0.005740336327270075,0.005697567778404468,0.005702931794865328,0.005703244543319737,0.005694965353827767,0.005707576461220838,0.00571362284759936,0.005763918527983381,0.005819719128425349,0.005822582973131455,0.005780967217763148,0.005775854152638282,0.00582565539809614,0.005834811025884366,0.005828644166888072,0.005757608361002445,0.005770522866207096,0.005776806139141072,0.005789168869545255,0.005810897524434603,0.005840546870068389,0.005765648412196604,0.005717207342065457,0.0056892180354604655,0.005711134589080078,0.0057343919537151036,0.005823332951042008,0.005696999650432458,0.005613727988786717,0.005605207415802709,0.0057105588294604,0.005747946269216415,0.00576503420759044,0.0057203781002861985,0.005664910321458143,0.005878054317696065,0.005722171835669878,0.0056409846525562945,0.005668315866180349,0.0057617758074678905,0.00580286252439743,0.005823243129857357,0.005689528193002411,0.005696187714499698,0.005710637984155815,0.0057213319835590385,0.005733504084740596,0.005911905103337678,0.005787455311268923,0.005730097448546697,0.005700057582409494,0.005727139349758568,0.005872690597401145,0.0057441370940546875,0.005674964533497441,0.005690544995487191,0.0057110520444613785,0.005699878519213396,0.005715772395833734,0.005711640320861315,0.005713955069127344,0.0057057208651437,0.005719737549209524,0.005733435782304264,0.005714388300575984,0.00571378147226734,0.00572649638127747,0.005739682861669742,0.005722027522619469,0.005710322459586524,0.0057074587354011145,0.005708991811151443,0.005717580050948153,0.005727012753339332,0.005730706135493372,0.005726881268173236,0.005715687319857866,0.005699608603356306,0.005687167263021948,0.0056904500275590355,0.005746598882268615,0.005715177951887241];

export const dataset1_grad_itr5 = [0.00042206602691841945,0.0011262821723435708,0.002108147763545507,0.0027872328104095513,0.0032875356676294156,0.003682540144148454,0.004048848979364685,0.004403923911768639,0.004679091720870594,0.0048509061826698865,0.004590307250671485,0.0034793085523998238,0.0025673215157046257,0.0032807002471406657,0.005658164287624282,0.005913534985125607,0.00565467967330198,0.002878449433017535,0.00239909803633698,0.002428200877612785,0.0025862130456127,0.0028265093617433753,0.0029216394972050035,0.002932561246119555,0.0027076407447400954,0.0023714176526023326,0.0022148443091495195,0.0020875020895243374,0.0019371225448177004,0.0015585915199589735,0.0013434951814803322,0.001272003522866842,0.0011468048874683499,0.0011972911495036899,0.0014255419832279962,0.0015920041461422478,0.001443798534782961,0.0012792721969102304,0.0012508361678861173,0.0010382776909566096,0.0011227140088830782,0.0012511072178009058,0.0012872497871661865,0.0011863646539709578,0.0011803797376850058,0.0010926359830838123,0.0009991696479648426,0.0010776022031345422,0.001141027626362656,0.001249005006014423,0.001178618520638601,0.0012365144168751284,0.0012728575006959303,0.0011089486396715774,0.001123038323941058,0.000972382316310721,0.0009341555370474598,0.0010028373487815797,0.001034263204032901,0.001138536948916713,0.0011383777377586028,0.0011300662428220247,0.0011607537533961066,0.001139966496925225,0.0010230001267982438,0.0010932679758689015,0.0010597113699225237,0.0011226495139020445,0.0011310947050738281,0.0012202502779324095,0.0014646611686740237,0.0014803727644604819,0.0013861417795170091,0.0014292240882581829,0.001555499338019272,0.0016070545999155369,0.0016217592789007894,0.0014931650790720881,0.0013801716065683612,0.0013689526023130476,0.001497627969550582,0.001825128492895516,0.0018580104088776752,0.0018736662968653224,0.001912329077595858,0.0019370582161621565,0.0018483274470024603,0.0018086095209563164,0.0018270504183920417,0.001806051797102081,0.0017886099016035122,0.0017250925563008237,0.0016355049086984826,0.0015592241737341066,0.001513314548873996,0.0016940143923334094,0.0018333713962617058,0.0016060985713318345,0.00128769439205332,0.001313891051249437,0.0014405795561313684,0.0015675927789114102,0.001619058878407523,0.0015587343281225846,0.0015948145837700902,0.0015518280178024888,0.0015437219194096704,0.001556947817869646,0.0016176734730416107,0.0016885651889351828,0.0015691728492646456,0.0014979369206090866,0.0016006477462526842,0.0016692728817472502,0.001594137748597923,0.001525162152652775,0.001488779770474652,0.0014375452397419497,0.001367461815714999,0.0011968137943695945,0.0008578849812622365,0.0006805317148023067,0.0008418177328593779,0.0008414414188111212,0.0007708897006415527,0.0007115698187728453,0.0007338634235369615,0.0006387783720464455,0.000599355229078267,0.0007060558337627785,0.0007982663103011683,0.000812748235720117,0.0008184894419813745,0.0008495505774148678,0.0008393316010734562,0.0008314352164968101,0.0008115460098684627,0.000743723154383057,0.0005882672188490602,0.0006077597308211954,0.0006315037580146948];

export const dataset1_grad_itr10 = [0.00030418788550068946,0.0006395551118971429,0.0012572713720399415,0.0018058466243695242,0.0022795221339218415,0.0027249336063534507,0.0031831093827436297,0.0035742643362187947,0.003876681571347481,0.004105863394523994,0.004220927719813241,0.0031683553308301683,0.0018652941657652518,0.0028518911527325133,0.005355656834970157,0.003850959020577864,0.0035532259649982325,0.0017933066318207781,0.001686058711344238,0.0018224448293364171,0.001949232514136291,0.0021053104721185786,0.002147317262198858,0.002117113855985461,0.0019213583762707049,0.001661160636476663,0.0014682136006704059,0.0012693415310678744,0.0010261429827589097,0.0008369023351181174,0.000712644633900739,0.0006233427950237882,0.0006293522878197701,0.0006878019096747467,0.0007612730524900232,0.0008066453162197945,0.0007314609329333641,0.0006723938128775456,0.0006208408556584194,0.000611041715092319,0.0006431052313784392,0.0006390718703660371,0.0005814603414255436,0.000500958315779394,0.00043017191771154074,0.0003995375180025493,0.00042518952313644174,0.00048656475187832223,0.0005450189007550688,0.0005732615180807538,0.0005954422486472471,0.0005507421070514404,0.0004934610201885064,0.0004419277927780695,0.00036950112786849064,0.0003729981216301865,0.0004066997074422508,0.000407834340477745,0.00039298995501414605,0.0003716962306708914,0.00038210509044277825,0.00039300772955185866,0.0003800808956951636,0.0003958126933198378,0.0004208794697813727,0.00048132398320385603,0.0005430711836710774,0.0005669985603776339,0.0006284681916224176,0.0007099151362646333,0.0007394659302448636,0.0007602574690341115,0.0008189113263417511,0.000896091230473084,0.000926698177785823,0.0008854885950002077,0.0008133725364282554,0.0007847118610677905,0.0008497393870623647,0.0009883733440819826,0.0010962578874638392,0.0011228559712230365,0.0011471981045191345,0.0011588363180087752,0.001139690393166113,0.001111841015350556,0.0011082213954751712,0.0011012929065807695,0.0010866505469043393,0.00107020816664153,0.0010301554321579377,0.000972884201609052,0.0009217942678486493,0.0009484109444669723,0.0010447907393462555,0.001003868047117201,0.0008017049713044853,0.0007201809507292362,0.0007707652916244599,0.0008582409710828371,0.000928332863464994,0.0009428794387930055,0.0009437469732735751,0.0009293805156729003,0.0009028450484646598,0.0008966790495170019,0.000919841435479301,0.000970532628395846,0.0009426619697141204,0.0008855067359339278,0.0008904393480088191,0.0009177471612250961,0.0008854981602670397,0.0008176605962344993,0.000757642924114361,0.0006891350182656675,0.000594348968114058,0.00046178159456025506,0.00030167928197004124,0.0001762828706031724,0.0001735935136672559,0.0001882715363170822,0.00019424799565311468,0.00018811379352422978,0.00018869665729635146,0.0001866311923289626,0.00017167609061213745,0.00017692571279019658,0.0002030620500714001,0.00022044307674803153,0.00021665517560845728,0.00020816221966606305,0.00021758115686386112,0.0002235573695153466,0.00022306820428191082,0.00021945233150003144,0.00021043134899842477,0.00019304393517916157,0.00017397953192282693,0.00016280862680242788,0.00041584167440183176];

export const dataset2_grad = [0.00037026176029517104,0.00032997712462004455,0.0006687706813264607,0.0010107359314467342,0.0013638483629095444,0.001745976800141843,0.0021260987244257606,0.002490279231681172,0.002865846795598881,0.003233351202261505,0.0036638193130500802,0.0034112206940880704,0.001368124373967528,0.0023218464930145222,0.00452388889214425,0.004839960291225189,0.0023956012302324098,0.0014447809552789396,0.0011471135974490505,0.0011820883825956797,0.0012862535807470698,0.001362620884769386,0.0014008990288096792,0.0014014603937711548,0.0012929319050000246,0.0011175219174226626,0.0009548265150068928,0.0007924157181300069,0.0006130828220819426,0.00047821498010025765,0.00036928056198937023,0.0003294814110596388,0.0003244685503506604,0.0003312552581583562,0.00035526064891047926,0.00037237151679170245,0.0003452585730146172,0.0003071860455116951,0.0002740981209976647,0.00025158802932928674,0.0002411596421902572,0.00022011898663324046,0.00016880561877288046,0.00011839005618564469,9.32213609826434e-05,8.902161397679086e-05,9.868328267905982e-05,0.00011668431016114744,0.00014290202666865674,0.00016301313824779523,0.00016558687886604974,0.00014423022994755147,0.00012356265496306517,9.757132524530182e-05,8.257574285193409e-05,8.540286332315563e-05,9.355154233272651e-05,8.097220702401705e-05,7.859396979523289e-05,7.576420707212295e-05,8.313053503455152e-05,9.618541470714866e-05,0.00010669915532801154,0.00012055884292208742,0.0001430591649657662,0.00018508152412934363,0.00023745130902349255,0.00026952284655712205,0.00030037148444366456,0.0003486245236521353,0.0003742057211692915,0.000386342564837154,0.00041304374434878073,0.0004620178222345252,0.0004958805903818601,0.0004936410076089898,0.0004704831574554417,0.000461424912935763,0.0004895676073435292,0.0005553206281758004,0.0006144957453837461,0.0006418639692204683,0.0006579807718269947,0.0006617267206551853,0.0006504661435384388,0.0006340275476352922,0.0006243727535770144,0.0006196957361603654,0.0006158351460533581,0.0006140021751734867,0.0005976858799062834,0.0005660745398392738,0.0005341180191311319,0.0005292905734178632,0.0005595833747859856,0.0005539200595645122,0.00046831005184490407,0.00039782758307166117,0.000405024898367394,0.0004479245171192413,0.0004932698926617726,0.000518520602658984,0.0005287279198590448,0.0005262409862872767,0.0005156307479797566,0.0005073024707445273,0.0004994581131122172,0.0005134058895406134,0.0005080329868098015,0.0004804319073167795,0.00046319222836435983,0.00045421581387077974,0.0004303823775807812,0.0003873234382936913,0.0003378561195080225,0.0002832302017942048,0.00021795536990407383,0.00014530835150534146,0.00010328551347078412,7.926691211994381e-05,7.213607097935114e-05,6.371362455720197e-05,7.134705925643526e-05,7.05034303507566e-05,6.897966660108189e-05,4.762708720905675e-05,6.086093913048044e-05,5.6064948276262734e-05,5.435985298786475e-05,6.633112101184596e-05,7.007485266812898e-05,6.245391414989072e-05,7.552869082423432e-05,7.984385205148169e-05,8.200604316175932e-05,8.328420869260752e-05,8.412856491556947e-05,8.436329661630123e-05,8.326402644051672e-05,6.737819189440434e-05,0.00030728520336187305];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`Ru_porphyrin_cycloaddition_step3_TS_Opt_Inputs`内に保存された`Ru_porphyrin_cycloaddition_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`Ru_porphyrin_cycloaddition_ts_guess_1.xyz`
```
70
2 1
N      -2.930850322112      0.430121874591      0.759720406232
C      -3.246789461508     -0.821471635908      1.312968866025
C      -3.930813220187      0.775121646609     -0.022530229134
C      -4.544672776623     -1.233678355609      0.789464807612
C      -2.467857459876     -1.510785589807      2.172106115892
C      -4.962524787541     -0.257006127402     -0.033726474492
C      -4.004684168538      2.006017040302     -0.768481488070
H      -5.044902581642     -2.155552722229      1.041896174431
C      -1.170853556592     -1.133534151105      2.669519467223
H      -2.848647903321     -2.457763360426      2.532972032293
H      -5.879068457214     -0.206544097242     -0.598973157766
C      -3.090996198002      2.996746460265     -0.803810568594
H      -4.893975930130      2.132292910476     -1.371913518130
N      -0.519671016505     -0.047149284299      2.307629112976
C      -0.411439513205     -1.898262623732      3.652640848806
N      -1.873290152200      2.994486649605     -0.104212672996
C      -3.148671695015      4.212690833955     -1.609696431822
C       0.677406367825     -0.022158641865      3.048813893577
C       0.720423309039     -1.212572308088      3.888586753732
H      -0.733628088044     -2.827914272270      4.093933443006
C      -1.217508783944      4.074033098360     -0.462369171402
C      -1.996903625514      4.871993370268     -1.403824171838
H      -3.974141522551      4.491051230310     -2.245235252178
C       1.609362664388      0.948912078180      2.985851202979
H       1.525220815980     -1.461091812943      4.563208791168
C       0.110979669866      4.418807596040     -0.015314899763
H      -1.675885838166      5.807068891263     -1.833950740424
C       1.573254513155      2.138164028473      2.171202695889
H       2.486398610506      0.834826707778      3.610883861972
C       0.907396356860      3.709050489034      0.806496760866
H       0.503070449743      5.351362790335     -0.400346007283
N       0.560494665156      2.488560445898      1.410984814443
C       2.656619357885      3.111351230156      2.091597720623
C       2.247727792009      4.075461289017      1.250132154154
H       3.592523024953      3.040456900092      2.622944860844
H       2.776233962854      4.965300554886      0.945784518453
Ru     -1.228409409568      1.497669520664      1.139599926427
C      -1.967614297449      2.280466624444      2.642763850770
O      -2.432756050055      2.757654614507      3.560172651727
O      -0.356072512482      0.789004595946     -0.710988463564
C      -0.098917331816     -0.251622050278     -1.336157661542
C      -0.822225646386     -1.540138108388     -1.078438667279
C       0.961725257716     -0.243914409228     -2.316580442258
C      -0.273406065691     -2.727493490873     -1.875765737677
H      -1.878862066779     -1.353108225831     -1.303409459210
H      -0.769485960888     -1.724619680349     -0.001939295802
C       1.072051755807     -1.229518040513     -3.292188758900
H       1.376777279765      0.739076794382     -2.507760501519
C       0.070808069544     -2.342827152090     -3.305571410023
H      -0.988288525541     -3.546685319219     -1.844775782243
H       0.644773865885     -3.083771924504     -1.413619311132
H       1.527989663281     -0.952227426193     -4.232763389692
H       0.439144256743     -3.193591519523     -3.874559615530
H      -0.814141027058     -1.982549357984     -3.844760320960
C       2.666113298934     -1.739315987854     -0.464614585310
C       3.287506179667     -2.494219494722     -1.495226273714
C       3.189456240278     -2.040765820513     -2.798089029467
H       3.209113779035     -0.988821611137     -3.001779932742
C       2.406747046411     -0.412982076671     -0.683109147209
H       3.093670522671      0.139170000845     -1.306561213931
H       3.548070907132     -2.684314303961     -3.594763700208
H       1.883462244670      0.169261046311      0.065725276080
C       4.032961614436     -3.748668259213     -1.106706033375
H       4.750023702229     -3.450889313836     -0.333533243091
H       3.415960213532     -4.532322108015     -0.667277763837
H       4.610631168867     -4.163357544060     -1.929214554999
C       2.119968305530     -2.489931253759      0.729008777017
H       1.550203313845     -3.373977952322      0.430690139654
H       2.926510719052     -2.851300178240      1.369161802139
H       1.467174986894     -1.857763720792      1.328077352096
```

<MoleculeViewer 
  xyzData={`70
2 1
N      -2.930850322112      0.430121874591      0.759720406232
C      -3.246789461508     -0.821471635908      1.312968866025
C      -3.930813220187      0.775121646609     -0.022530229134
C      -4.544672776623     -1.233678355609      0.789464807612
C      -2.467857459876     -1.510785589807      2.172106115892
C      -4.962524787541     -0.257006127402     -0.033726474492
C      -4.004684168538      2.006017040302     -0.768481488070
H      -5.044902581642     -2.155552722229      1.041896174431
C      -1.170853556592     -1.133534151105      2.669519467223
H      -2.848647903321     -2.457763360426      2.532972032293
H      -5.879068457214     -0.206544097242     -0.598973157766
C      -3.090996198002      2.996746460265     -0.803810568594
H      -4.893975930130      2.132292910476     -1.371913518130
N      -0.519671016505     -0.047149284299      2.307629112976
C      -0.411439513205     -1.898262623732      3.652640848806
N      -1.873290152200      2.994486649605     -0.104212672996
C      -3.148671695015      4.212690833955     -1.609696431822
C       0.677406367825     -0.022158641865      3.048813893577
C       0.720423309039     -1.212572308088      3.888586753732
H      -0.733628088044     -2.827914272270      4.093933443006
C      -1.217508783944      4.074033098360     -0.462369171402
C      -1.996903625514      4.871993370268     -1.403824171838
H      -3.974141522551      4.491051230310     -2.245235252178
C       1.609362664388      0.948912078180      2.985851202979
H       1.525220815980     -1.461091812943      4.563208791168
C       0.110979669866      4.418807596040     -0.015314899763
H      -1.675885838166      5.807068891263     -1.833950740424
C       1.573254513155      2.138164028473      2.171202695889
H       2.486398610506      0.834826707778      3.610883861972
C       0.907396356860      3.709050489034      0.806496760866
H       0.503070449743      5.351362790335     -0.400346007283
N       0.560494665156      2.488560445898      1.410984814443
C       2.656619357885      3.111351230156      2.091597720623
C       2.247727792009      4.075461289017      1.250132154154
H       3.592523024953      3.040456900092      2.622944860844
H       2.776233962854      4.965300554886      0.945784518453
Ru     -1.228409409568      1.497669520664      1.139599926427
C      -1.967614297449      2.280466624444      2.642763850770
O      -2.432756050055      2.757654614507      3.560172651727
O      -0.356072512482      0.789004595946     -0.710988463564
C      -0.098917331816     -0.251622050278     -1.336157661542
C      -0.822225646386     -1.540138108388     -1.078438667279
C       0.961725257716     -0.243914409228     -2.316580442258
C      -0.273406065691     -2.727493490873     -1.875765737677
H      -1.878862066779     -1.353108225831     -1.303409459210
H      -0.769485960888     -1.724619680349     -0.001939295802
C       1.072051755807     -1.229518040513     -3.292188758900
H       1.376777279765      0.739076794382     -2.507760501519
C       0.070808069544     -2.342827152090     -3.305571410023
H      -0.988288525541     -3.546685319219     -1.844775782243
H       0.644773865885     -3.083771924504     -1.413619311132
H       1.527989663281     -0.952227426193     -4.232763389692
H       0.439144256743     -3.193591519523     -3.874559615530
H      -0.814141027058     -1.982549357984     -3.844760320960
C       2.666113298934     -1.739315987854     -0.464614585310
C       3.287506179667     -2.494219494722     -1.495226273714
C       3.189456240278     -2.040765820513     -2.798089029467
H       3.209113779035     -0.988821611137     -3.001779932742
C       2.406747046411     -0.412982076671     -0.683109147209
H       3.093670522671      0.139170000845     -1.306561213931
H       3.548070907132     -2.684314303961     -3.594763700208
H       1.883462244670      0.169261046311      0.065725276080
C       4.032961614436     -3.748668259213     -1.106706033375
H       4.750023702229     -3.450889313836     -0.333533243091
H       3.415960213532     -4.532322108015     -0.667277763837
H       4.610631168867     -4.163357544060     -1.929214554999
C       2.119968305530     -2.489931253759      0.729008777017
H       1.550203313845     -3.373977952322      0.430690139654
H       2.926510719052     -2.851300178240      1.369161802139
H       1.467174986894     -1.857763720792      1.328077352096`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-1.20.0/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`Ru_porphyrin_cycloaddition_ts_final_X.xyz`として保存されている。)

`Ru_porphyrin_cycloaddition_ts_final_1.xyz`
```
70
OptimizedStructure
N     -2.965475991435      0.431687774259      0.642206712597
C     -3.302397440123     -0.772513580449      1.273835286336
C     -3.950146959627      0.719850526597     -0.191188126541
C     -4.581123950280     -1.226892437849      0.746302736294
C     -2.546939785225     -1.400725160488      2.205611633037
C     -4.976285461241     -0.315362268377     -0.161207304488
C     -4.018910735257      1.907006749660     -0.992402425443
H     -5.087591664545     -2.128219002810      1.053262437694
C     -1.261625575821     -0.998488036142      2.693812289364
H     -2.938614652266     -2.322804859773      2.615850789811
H     -5.875980927336     -0.312285077849     -0.755584390835
C     -3.145409545401      2.939060980466     -1.003519915355
H     -4.877458182956      1.982227779150     -1.647291311094
N     -0.633937516978      0.108059292880      2.330030793161
C     -0.458789632556     -1.762563386230      3.639809866047
N     -1.985438993213      3.019874055701     -0.223437459386
C     -3.234817484334      4.144211728605     -1.819044735051
C      0.580165755671      0.138272295539      3.024489043374
C      0.677145301786     -1.066618678273      3.834177924595
H     -0.753398436613     -2.698450583551      4.087117347865
C     -1.394745560469      4.159664318853     -0.524354292326
C     -2.160128973202      4.896210834707     -1.524917732406
H     -4.031102196124      4.357189933127     -2.514338397687
C      1.471640857839      1.156162772008      2.987967413080
H      1.506926523459     -1.309205311687      4.479319887544
C     -0.156860743521      4.612100568810      0.043893215935
H     -1.886946477090      5.857774885740     -1.929085055006
C      1.362491479954      2.382784071778      2.255532465444
H      2.363691307150      1.049098925039      3.592481247552
C      0.622080715296      3.962701452082      0.937759210972
H      0.191702380963      5.576888119019     -0.301499481526
N      0.342871302548      2.705239204296      1.483340179447
C      2.364322798830      3.443565648284      2.266183816431
C      1.904640503287      4.416593989949      1.459735565210
H      3.285238440518      3.420644570148      2.826615774907
H      2.368379427932      5.359214873955      1.216201106888
Ru    -1.333197653468      1.589866992020      1.092252465510
C     -2.263323400600      2.366412485403      2.500133276574
O     -2.829141310744      2.841965789032      3.358758825099
O     -0.155866352809      0.937148119936     -0.531652786181
C      0.055455706244     -0.120284973297     -1.184231875029
C     -0.741244811092     -1.364372741025     -0.910733824497
C      1.006618804453     -0.115164101942     -2.230901709533
C     -0.117825999145     -2.623797547151     -1.504722182205
H     -1.744576844002     -1.195070729813     -1.320491103499
H     -0.855659085417     -1.457137950998      0.167771433872
C      1.203930812439     -1.201268839585     -3.071767770073
H      1.504652305585      0.828321725213     -2.422266937950
C      0.305603220843     -2.400330002312     -2.949995954448
H     -0.817598993001     -3.456717091024     -1.433846212525
H      0.756813053719     -2.888112191906     -0.907999108554
H      1.527104710107     -0.970326746246     -4.080964490880
H      0.780309062427     -3.286428304972     -3.369347718781
H     -0.571938292677     -2.203551919216     -3.576323094576
C      3.249478238822     -2.097943923097     -0.393270110394
C      3.172878930434     -2.647543845067     -1.749532957085
C      3.140233886105     -1.855231417440     -2.866406466070
H      3.516054655575     -0.843338774448     -2.842092049544
C      3.329285989949     -0.778582760902     -0.178219086776
H      3.420401713815     -0.052285015630     -0.971150674672
H      3.227290096934     -2.344473333656     -3.828927641715
H      3.372061810233     -0.387260459619      0.831078988633
C      3.065062619892     -4.133641319317     -1.909514371316
H      3.960525945881     -4.614321740966     -1.507286320740
H      2.222334348251     -4.550155109359     -1.352936897483
H      2.974362951340     -4.418785032880     -2.954417943856
C      3.209685621085     -3.057751535070      0.769917612094
H      2.315268170318     -3.684426462989      0.755366239347
H      4.068086610296     -3.731290002831      0.752580441499
H      3.229703568587     -2.516078206020      1.713473889311

```

<MoleculeViewer 
  xyzData={`70
OptimizedStructure
N     -2.965475991435      0.431687774259      0.642206712597
C     -3.302397440123     -0.772513580449      1.273835286336
C     -3.950146959627      0.719850526597     -0.191188126541
C     -4.581123950280     -1.226892437849      0.746302736294
C     -2.546939785225     -1.400725160488      2.205611633037
C     -4.976285461241     -0.315362268377     -0.161207304488
C     -4.018910735257      1.907006749660     -0.992402425443
H     -5.087591664545     -2.128219002810      1.053262437694
C     -1.261625575821     -0.998488036142      2.693812289364
H     -2.938614652266     -2.322804859773      2.615850789811
H     -5.875980927336     -0.312285077849     -0.755584390835
C     -3.145409545401      2.939060980466     -1.003519915355
H     -4.877458182956      1.982227779150     -1.647291311094
N     -0.633937516978      0.108059292880      2.330030793161
C     -0.458789632556     -1.762563386230      3.639809866047
N     -1.985438993213      3.019874055701     -0.223437459386
C     -3.234817484334      4.144211728605     -1.819044735051
C      0.580165755671      0.138272295539      3.024489043374
C      0.677145301786     -1.066618678273      3.834177924595
H     -0.753398436613     -2.698450583551      4.087117347865
C     -1.394745560469      4.159664318853     -0.524354292326
C     -2.160128973202      4.896210834707     -1.524917732406
H     -4.031102196124      4.357189933127     -2.514338397687
C      1.471640857839      1.156162772008      2.987967413080
H      1.506926523459     -1.309205311687      4.479319887544
C     -0.156860743521      4.612100568810      0.043893215935
H     -1.886946477090      5.857774885740     -1.929085055006
C      1.362491479954      2.382784071778      2.255532465444
H      2.363691307150      1.049098925039      3.592481247552
C      0.622080715296      3.962701452082      0.937759210972
H      0.191702380963      5.576888119019     -0.301499481526
N      0.342871302548      2.705239204296      1.483340179447
C      2.364322798830      3.443565648284      2.266183816431
C      1.904640503287      4.416593989949      1.459735565210
H      3.285238440518      3.420644570148      2.826615774907
H      2.368379427932      5.359214873955      1.216201106888
Ru    -1.333197653468      1.589866992020      1.092252465510
C     -2.263323400600      2.366412485403      2.500133276574
O     -2.829141310744      2.841965789032      3.358758825099
O     -0.155866352809      0.937148119936     -0.531652786181
C      0.055455706244     -0.120284973297     -1.184231875029
C     -0.741244811092     -1.364372741025     -0.910733824497
C      1.006618804453     -0.115164101942     -2.230901709533
C     -0.117825999145     -2.623797547151     -1.504722182205
H     -1.744576844002     -1.195070729813     -1.320491103499
H     -0.855659085417     -1.457137950998      0.167771433872
C      1.203930812439     -1.201268839585     -3.071767770073
H      1.504652305585      0.828321725213     -2.422266937950
C      0.305603220843     -2.400330002312     -2.949995954448
H     -0.817598993001     -3.456717091024     -1.433846212525
H      0.756813053719     -2.888112191906     -0.907999108554
H      1.527104710107     -0.970326746246     -4.080964490880
H      0.780309062427     -3.286428304972     -3.369347718781
H     -0.571938292677     -2.203551919216     -3.576323094576
C      3.249478238822     -2.097943923097     -0.393270110394
C      3.172878930434     -2.647543845067     -1.749532957085
C      3.140233886105     -1.855231417440     -2.866406466070
H      3.516054655575     -0.843338774448     -2.842092049544
C      3.329285989949     -0.778582760902     -0.178219086776
H      3.420401713815     -0.052285015630     -0.971150674672
H      3.227290096934     -2.344473333656     -3.828927641715
H      3.372061810233     -0.387260459619      0.831078988633
C      3.065062619892     -4.133641319317     -1.909514371316
H      3.960525945881     -4.614321740966     -1.507286320740
H      2.222334348251     -4.550155109359     -1.352936897483
H      2.974362951340     -4.418785032880     -2.954417943856
C      3.209685621085     -3.057751535070      0.769917612094
H      2.315268170318     -3.684426462989      0.755366239347
H      4.068086610296     -3.731290002831      0.752580441499
H      3.229703568587     -2.516078206020      1.713473889311
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`"frequency_analysis": true`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`"frequency_analysis": true`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -707.5894             12.8714             17.6746
Reduced mass [au]                   9.4337              4.3997              5.2635
Force const [Dyne/A]               -2.7829              0.0004              0.0010
Char temp [K]                       0.0000             18.5191             25.4298
Normal mode                   x         y         z            x         y         z            x         y         z     
       N                 0.00185   -0.00433    0.00335    0.01235   -0.00793    0.00117    0.00721   -0.00364    0.00087
       C                -0.00173    0.00342   -0.00232    0.02279   -0.01074    0.00145    0.00466   -0.00105    0.00406
       C                -0.00500    0.00366   -0.00585    0.00868   -0.01541    0.00298    0.01641   -0.01312   -0.01351
       C                 0.00409    0.00190    0.00182    0.02508   -0.02028    0.00414    0.01352   -0.01008   -0.00928
       C                 0.00635   -0.00046    0.00399    0.03086   -0.00650   -0.00225   -0.00432    0.00802    0.01749
       C                 0.00130    0.00389   -0.00193    0.01646   -0.02323    0.00497    0.02085   -0.01742   -0.02004
       C                -0.00226   -0.00590    0.00311   -0.00121   -0.01661    0.00227    0.02168   -0.01900   -0.02249
       H                 0.00341    0.00243    0.00228    0.03250   -0.02415    0.00504    0.01362   -0.01036   -0.00996
       C                -0.00659   -0.00611    0.00019    0.02949    0.00280   -0.00601   -0.01253    0.01673    0.03162
       H                 0.00140    0.00050    0.00226    0.03952   -0.01031   -0.00252   -0.00573    0.00912    0.01860
       H                 0.00034    0.00064   -0.00060    0.01527   -0.02998    0.00675    0.02827   -0.02511   -0.03131
       C                 0.00291    0.00303    0.00084   -0.00882   -0.01008    0.00044    0.01915   -0.01676   -0.02067
       H                -0.00206   -0.00089    0.00304   -0.00271   -0.02331    0.00346    0.02868   -0.02618   -0.03250
       N                 0.00580    0.00158   -0.00026    0.01806    0.00992   -0.00361   -0.01133    0.01564    0.03044
       C                -0.00381    0.00066   -0.00218    0.03887    0.00751   -0.01007   -0.02324    0.02811    0.04998
       N                -0.00366   -0.00318   -0.00166   -0.00889   -0.00045   -0.00046    0.01062   -0.00828   -0.00898
       C                -0.00018   -0.00373    0.00290   -0.01983   -0.01053    0.00103    0.02540   -0.02356   -0.03127
       C                -0.00397   -0.00274   -0.00128    0.01905    0.01974   -0.00579   -0.02090    0.02578    0.04703
       C                -0.00040    0.00449   -0.00268    0.03235    0.01808   -0.00980   -0.02844    0.03376    0.05977
       H                -0.00130    0.00095    0.00033    0.04872    0.00331   -0.01236   -0.02618    0.03102    0.05409
       C                 0.00538    0.00629    0.00042   -0.01962    0.00548    0.00052    0.01187   -0.00977   -0.01217
       C                 0.00329   -0.00018    0.00270   -0.02653   -0.00097    0.00116    0.02098   -0.01920   -0.02607
       H                -0.00010   -0.00366    0.00291   -0.02213   -0.01716    0.00163    0.03231   -0.03065   -0.04135
       C                 0.00173    0.00783   -0.00290    0.00870    0.02887   -0.00344   -0.02264    0.02727    0.04821
       H                -0.00219    0.00660    0.00061    0.03574    0.02438   -0.01176   -0.03636    0.04221    0.07307
       C                -0.00617    0.00024   -0.00324   -0.02462    0.01740    0.00197    0.00534   -0.00320   -0.00330
       H                 0.00132   -0.00049    0.00070   -0.03554    0.00187    0.00183    0.02353   -0.02201   -0.03103
       C                 0.00502   -0.00498    0.00561   -0.00390    0.02985   -0.00007   -0.01597    0.01961    0.03442
       H                -0.00052    0.00498    0.00064    0.01038    0.03600   -0.00464   -0.03001    0.03513    0.06035
       C                 0.00098   -0.00342    0.00403   -0.01930    0.02464    0.00252   -0.00311    0.00564    0.01046
       H                -0.00241    0.00002   -0.00062   -0.03382    0.02106    0.00291    0.00751   -0.00563   -0.00787
       N                -0.00090    0.00389   -0.00419   -0.00704    0.02109    0.00057   -0.00723    0.01020    0.01895
       C                -0.00165   -0.00397    0.00149   -0.01453    0.03991    0.00226   -0.01780    0.02127    0.03582
       C                -0.00480   -0.00122   -0.00139   -0.02404    0.03672    0.00391   -0.00984    0.01261    0.02087
       H                -0.00157   -0.00062    0.00160   -0.01430    0.04788    0.00218   -0.02439    0.02808    0.04690
       H                -0.00544   -0.00090   -0.00091   -0.03337    0.04175    0.00562   -0.00858    0.01106    0.01728
      Ru                 0.00085   -0.00021   -0.00156    0.00369    0.00525   -0.00049   -0.00058    0.00352    0.00999
       C                 0.00029    0.00109    0.00059   -0.00342   -0.00293   -0.00070   -0.01842    0.01425   -0.00758
       O                -0.00043    0.00030    0.00108   -0.00756   -0.00807   -0.00058   -0.02996    0.02148   -0.01917
       O                -0.00259   -0.00218   -0.00101    0.01810    0.01127    0.00741    0.01514   -0.00679    0.02587
       C                 0.00290   -0.00459    0.00114    0.01590    0.01652   -0.00185    0.00672   -0.00462    0.01968
       C                -0.00106   -0.00050    0.00021   -0.00729    0.02443   -0.03336    0.01131   -0.00632    0.02617
       C                 0.02550   -0.00870    0.01021    0.03679    0.01664    0.01719   -0.00716   -0.00010    0.00707
       C                 0.00015    0.00031   -0.00415   -0.02025    0.02368   -0.04541    0.00257   -0.00261    0.00905
       H                -0.00186   -0.00258    0.00352    0.00073    0.04738   -0.04333    0.00453   -0.00565    0.04330
       H                 0.00364   -0.00453    0.00069   -0.02295    0.00848   -0.03629    0.02925   -0.01162    0.02793
       C                 0.17585   -0.07196    0.03434    0.03401    0.02687    0.00331   -0.02358    0.00610   -0.00511
       H                -0.02546    0.01453   -0.01196    0.05626    0.01136    0.04177   -0.00914    0.00058    0.00517
       C                 0.01972   -0.00189    0.00024    0.00946    0.04149   -0.03400   -0.02282    0.00634    0.00286
       H                -0.00066    0.00024   -0.00679   -0.03712    0.03552   -0.07268    0.00436   -0.00350    0.01624
       H                -0.00780   -0.00330    0.00918   -0.03578   -0.00355   -0.03482    0.01302   -0.00519   -0.00742
       H                -0.06674    0.03872   -0.02698    0.05747    0.03801    0.01337   -0.04338    0.01394   -0.00963
       H                -0.04574   -0.03204   -0.01297    0.00034    0.04009   -0.04132   -0.03148    0.00865   -0.01175
       H                 0.03450    0.07401    0.00978    0.02432    0.06905   -0.04614   -0.03397    0.01152    0.02007
       C                 0.00094   -0.00727   -0.00360   -0.03601   -0.06881    0.02678    0.02399   -0.03150   -0.05545
       C                -0.02208    0.00764    0.01040   -0.01965   -0.03679    0.01265   -0.00038   -0.01064   -0.06245
       C                -0.19017    0.06402   -0.01853    0.01798   -0.01132    0.02963   -0.01864    0.00573   -0.05038
       H                 0.00903   -0.00612   -0.01082    0.03632   -0.01885    0.05980   -0.01759    0.00516   -0.04205
       C                -0.00216   -0.00065   -0.01167   -0.01981   -0.07492    0.05830    0.02042   -0.03426   -0.03656
       H                 0.02642   -0.01051   -0.01678    0.00458   -0.05821    0.07636    0.00063   -0.02171   -0.02729
       H                -0.03290    0.02338    0.01012    0.02898    0.00827    0.02068   -0.03553    0.01957   -0.05888
       H                -0.03357    0.01287   -0.01529   -0.03189   -0.09881    0.06806    0.03664   -0.04931   -0.03136
       C                -0.00090    0.01412   -0.00438   -0.04485   -0.03111   -0.02273   -0.00744   -0.00787   -0.08276
       H                 0.01000    0.03454    0.00038   -0.06300   -0.05752   -0.01396   -0.00608   -0.01770   -0.09779
       H                 0.00992    0.01332    0.01090   -0.06507   -0.02695   -0.05016   -0.00417   -0.01162   -0.08040
       H                -0.00105    0.01115   -0.00160   -0.02784   -0.00617   -0.03100   -0.01913    0.00739   -0.08589
       C                 0.00066   -0.00233    0.00148   -0.07175   -0.09495    0.00393    0.05206   -0.05005   -0.07000
       H                 0.00336   -0.00510    0.00334   -0.08071   -0.08143   -0.02725    0.05877   -0.05954   -0.06608
       H                 0.00354    0.00059    0.00902   -0.08139   -0.10724    0.00422    0.05901   -0.04060   -0.09443
       H                -0.00520    0.00583   -0.00400   -0.08136   -0.11715    0.01687    0.06153   -0.06507   -0.06166

(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在することを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、Ruポルフィリン錯体を触媒とする環化付加反応の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- T. Terada, T. Kurahashi, S. Matsubara, _Org. Lett._ 16, 2594, 2014