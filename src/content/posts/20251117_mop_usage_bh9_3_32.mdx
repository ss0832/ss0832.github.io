---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(BH9データセットの3. Halogen atom transfer, No. 32の化学反応, NNP(UMA)使用)
published: 2025-11-17
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-11-17

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、BH9データセットの3. Halogen atom transfer, No. 32の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

BH9のデータセットについて:

- _J. Chem. Theory Comput._ 2022, 18, 1, 151–166 

https://doi.org/10.1021/acs.jctc.1c00694


この文献のSupporting Informationから、データセットの詳細を確認できる。

有機金属錯体が関わる反応を除いたさまざまなカテゴリの反応がまとめられたデータセットである。DFTの汎関数の電子エネルギーの精度の比較などのベンチマークに主に使われる。

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.19.6
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.19.6.zip
unzip v1.19.6.zip
cd MultiOptPy-v1.19.6
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.19.6 にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.19.6`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.19.6`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`bh9_3_32.xyz`とした。
初期構造は以下のものを使用した。

```
37
OptimizedStructure
N     -2.062077784857      0.901608228101      0.291912122393
C     -1.395489748039      2.085084867529     -0.058494995879
C     -3.242137488580      0.607233776844     -0.432541941324
O     -4.266242170990      1.157624421084     -0.121865124962
O     -1.112723914218      2.299141190003     -1.216573781672
C     -3.086470957390     -0.437281936756     -1.493921986127
C     -1.014837397593      2.950511040058      1.102255913240
F     -1.296555235111     -2.673624526571      0.433162450405
C      0.052329902316     -3.084432408035      0.473053189933
H      0.030180372584     -4.173591136383      0.547479293893
C      0.698315235584     -2.472735028481      1.700644597490
C      0.719320339156     -2.641736467073     -0.813767829833
C      0.796397929172     -0.952158845983      1.593189530533
C      1.517693928924     -0.558826736410      0.318039481916
C      0.816411906286     -1.120916083736     -0.907331777899
O      1.523360029497      0.884563788977      0.267566160168
C      2.436429330545      1.451322849444     -0.548876158301
C      2.274076804179      2.941989884227     -0.588767884145
O      3.257098892749      0.821146317780     -1.162599024768
H      1.696260825813     -2.910504314486      1.803715618518
H      0.129703478412     -2.758277707269      2.586687471149
H      0.167597782587     -3.046169622236     -1.663770473265
H      1.720429754873     -3.083312690130     -0.843488787685
H      1.322526511139     -0.543935212623      2.458080851259
H     -0.207198173466     -0.520346755593      1.577194327484
H      2.556347875400     -0.900218330578      0.340302232868
H     -0.184980324098     -0.686161624353     -0.955788282970
H      1.354460367064     -0.828863739529     -1.808557249805
H      1.327708245242      3.177108777110     -1.078385531546
H      3.098408125454      3.380051278885     -1.142698715818
H      2.238978497101      3.345687705407      0.422522005188
H     -2.679674856567     -1.348344278600     -1.053446087436
H     -4.054229426990     -0.626044423570     -1.950862194849
H     -2.376345454874     -0.075941351278     -2.239863963445
H     -1.882177529909      3.130515665141      1.737371861296
H     -0.265068554361      2.419964056108      1.690682729941
H     -0.607827117034      3.889869372977      0.737741954056
```

<MoleculeViewer 
  xyzData={`37
OptimizedStructure
N     -2.062077784857      0.901608228101      0.291912122393
C     -1.395489748039      2.085084867529     -0.058494995879
C     -3.242137488580      0.607233776844     -0.432541941324
O     -4.266242170990      1.157624421084     -0.121865124962
O     -1.112723914218      2.299141190003     -1.216573781672
C     -3.086470957390     -0.437281936756     -1.493921986127
C     -1.014837397593      2.950511040058      1.102255913240
F     -1.296555235111     -2.673624526571      0.433162450405
C      0.052329902316     -3.084432408035      0.473053189933
H      0.030180372584     -4.173591136383      0.547479293893
C      0.698315235584     -2.472735028481      1.700644597490
C      0.719320339156     -2.641736467073     -0.813767829833
C      0.796397929172     -0.952158845983      1.593189530533
C      1.517693928924     -0.558826736410      0.318039481916
C      0.816411906286     -1.120916083736     -0.907331777899
O      1.523360029497      0.884563788977      0.267566160168
C      2.436429330545      1.451322849444     -0.548876158301
C      2.274076804179      2.941989884227     -0.588767884145
O      3.257098892749      0.821146317780     -1.162599024768
H      1.696260825813     -2.910504314486      1.803715618518
H      0.129703478412     -2.758277707269      2.586687471149
H      0.167597782587     -3.046169622236     -1.663770473265
H      1.720429754873     -3.083312690130     -0.843488787685
H      1.322526511139     -0.543935212623      2.458080851259
H     -0.207198173466     -0.520346755593      1.577194327484
H      2.556347875400     -0.900218330578      0.340302232868
H     -0.184980324098     -0.686161624353     -0.955788282970
H      1.354460367064     -0.828863739529     -1.808557249805
H      1.327708245242      3.177108777110     -1.078385531546
H      3.098408125454      3.380051278885     -1.142698715818
H      2.238978497101      3.345687705407      0.422522005188
H     -2.679674856567     -1.348344278600     -1.053446087436
H     -4.054229426990     -0.626044423570     -1.950862194849
H     -2.376345454874     -0.075941351278     -2.239863963445
H     -1.882177529909      3.130515665141      1.737371861296
H     -0.265068554361      2.419964056108      1.690682729941
H     -0.607827117034      3.889869372977      0.737741954056`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`bh9_3_32.xyz`として保存する。その後、同じディレクトリ内で、`config_bh9_3_32.json`を作成し、以下のように記述する。

`config_bh9_3_32.json`
```json
{
  "work_dir": "bh9_3_32",
  "top_n_candidates": 3,
  "multioptpy_version": "v1.19.6b",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 2,
    "electronic_charge": 0,
	"manual_AFIR": ["900", "1", "8"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 15,
    "ANEB": [3, 5],
    "QSM": true,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance_bernstein": 0.50,
    "align_distances": 9999,
    "spin_multiplicity": 2,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 2,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 2,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py bh9_3_32.xyz -cfg config_bh9_3_32.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.19.6/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。


Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`bh9_3_32_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`bh9_3_32_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`bh9_3_32_step1_traj.xyz`はStep2のNEB計算に使用している。

※`bh9_3_32_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`bh9_3_32_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。
- `"align_distances": X`は線形補間で、各ノード間の距離を全て等しくするための処理である。X回の反復計算ごとに本処理を行う。Xを`"NSTEP": n`よりも大きな数値を指定することで、初期経路に対してのみ処理を行うことが出来る。
- `"node_distance_bernstein": N`はノード間の距離をN Åとして初期経路を作成することを示す。経路作成時に元のノードをベルンシュタイン多項式を用いてがたついた経路を滑らかにする。

→プログラムの仕様上`"align_distances": X`の処理を行った後に、`"node_distance_bernstein": N`の処理を行うようになっている。

- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"ANEB": [A, B]`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


`MultiOptPy-v1.19.6/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-924.2239720011902,-924.2239720011902,-924.20714189747,-924.1687813371761,-924.1348105202615,-924.1217116554811,-924.1199988578965,-924.1207599795769,-924.1217252317632,-924.1218148334723,-924.1218989634884,-924.1221160657177,-924.1227922688274,-924.1237220141516,-924.1240513408458,-924.1241446093338,-924.124404096374,-924.1245879873112,-924.1246481846947,-924.1248198092268,-924.1246887558299,-924.1219822085711,-924.1124387306696,-924.0979580159167,-924.1061144788127,-924.1147353127626,-924.1156937308089,-924.1163899106355,-924.1183429326232,-924.1208949626043,-924.1235807095445,-924.1260473215369,-924.1280532883961,-924.1295417881905,-924.1306385252883,-924.131497837352,-924.1320957895582,-924.1325624101829,-924.1332918713954,-924.1340509340721,-924.1343829900416,-924.1344438182687,-924.134444880627,-924.1344358604383,-924.134413953953,-924.1343737705238,-924.1343286257718,-924.134302025196,-924.1342913994225,-924.1342805589869,-924.1342861007736,-924.1343283147309,-924.1343658280264,-924.1343244486228,-924.1341810959642,-924.1340417736959,-924.1340844695477,-924.1343336549979,-924.1346368936769,-924.1348682030319,-924.1350770363899,-924.1353893543991,-924.1358395446122,-924.1362785154454,-924.1365637969833,-924.1367304448596,-924.1369042773446,-924.1371202076941,-924.1373090424307,-924.1374378068289,-924.1375779001282,-924.1378099651815,-924.1380928262948,-924.1383843483663,-924.1388296539217,-924.13947504645,-924.1401681947223,-924.1405948421991,-924.1408448424891,-924.1410302842504,-924.1411341609885,-924.1412681867982,-924.1414156377504,-924.1415189055491,-924.1415778259121];

export const dataset1_itr5 = [-924.2239720274754,-924.2239720975691,-924.2146135006791,-924.1822040503865,-924.1564058266908,-924.1678737272373,-924.1693528317321,-924.1665478178223,-924.1620268770255,-924.1605134137275,-924.160398220683,-924.1613863954401,-924.1648431864326,-924.1691735094831,-924.1720147506326,-924.1744997271859,-924.1754001897532,-924.1757191502398,-924.1758672035601,-924.1741018696191,-924.1721438468808,-924.167566031582,-924.1579113390036,-924.1315172401764,-924.1123057584565,-924.1215543081686,-924.1283966163157,-924.1322695059504,-924.1345467224561,-924.1384024785513,-924.1415323065968,-924.1440015755801,-924.1457073594095,-924.146879982842,-924.147694457909,-924.1482919829815,-924.1488869386802,-924.1494646677461,-924.1498352708938,-924.1501215304585,-924.1504129123425,-924.1506336090666,-924.1506513011657,-924.1506488402182,-924.1506744649577,-924.1506470648751,-924.150664542312,-924.1506684872755,-924.1506662782274,-924.150653006415,-924.1506614538064,-924.1504710835787,-924.1505949447003,-924.1507363259723,-924.1507374814239,-924.1507603779835,-924.150821402254,-924.1509586764707,-924.1511318715408,-924.1512105605301,-924.1515286108933,-924.1518213661766,-924.1522171165502,-924.1524843675677,-924.1526756687279,-924.1528014607131,-924.1529512433775,-924.1531141795709,-924.1534366222929,-924.1538752136343,-924.1541462048101,-924.154584383803,-924.1548421026189,-924.1550403737258,-924.1553460344721,-924.1558260446449,-924.1562468863884,-924.1566079551441,-924.1570139687751,-924.1571840545305,-924.1573002967907,-924.1573905402956,-924.1574436018074,-924.157289715921,-924.1571154393264];

export const dataset1_itr10 = [-924.2239720011902,-924.2239721720438,-924.2195918781774,-924.1960720297246,-924.1954995587847,-924.1921235461774,-924.1880067763128,-924.1829535211725,-924.1888909979407,-924.1899289461012,-924.1920016422046,-924.1922211122882,-924.1881032647323,-924.1820270724448,-924.1806345791753,-924.1804166347258,-924.1801189586425,-924.1798688367838,-924.1794355621624,-924.179587707205,-924.1795397302277,-924.1798663177899,-924.1799164720541,-924.181264842407,-924.184707647781,-924.1859874697379,-924.1875659348528,-924.1879313357305,-924.189290367999,-924.1897103237137,-924.1890301581171,-924.1893356573192,-924.1895425192907,-924.187200991775,-924.1801895277098,-924.1509348829303,-924.1421081464172,-924.1287361087932,-924.115949332027,-924.1161502776483,-924.1190446016662,-924.1209031810959,-924.1226145636631,-924.1238166144207,-924.1296433540256,-924.133537392257,-924.1364789506966,-924.1395277218986,-924.1424152073956,-924.1446468421587,-924.1461828753685,-924.1472626256855,-924.1480510247845,-924.1486522111599,-924.1491948714495,-924.1496942411858,-924.1501911116419,-924.150475818192,-924.1506498762913,-924.1507031913453,-924.1507197466115,-924.1507295893064,-924.1507294173576,-924.1507506557621,-924.1506378902611,-924.1507509547557,-924.1507478169655,-924.1507529086189,-924.1507368735797,-924.1507556488461,-924.1507552249981,-924.150759575191,-924.1507635924387,-924.150770351009,-924.1506696613458,-924.1507796964764,-924.1507825998907,-924.1507875973556,-924.1507522712038,-924.1507909771883,-924.1507880102515,-924.1507998363804,-924.1507902893934,-924.1508035842053,-924.1508001967061,-924.1508188613558,-924.1508043267609,-924.1508437873483,-924.1508418740082,-924.1508865368656,-924.1509494449056,-924.1510309737868,-924.151145030546,-924.1513203130953,-924.1514453285732,-924.15167287258,-924.1519042038394,-924.1521367518823,-924.1524085973257,-924.1526673976662,-924.1529194722929,-924.1531390431362,-924.1533575806444,-924.1536112909744,-924.1538664322023,-924.1541959122267,-924.1544992330466,-924.1548694632738,-924.1552054056127,-924.1555027865355,-924.1558508501638,-924.1562632215164,-924.1566030261301,-924.1568770625506,-924.1571066392759,-924.157260740372,-924.1573910112379,-924.1575032192746,-924.1575680039651,-924.1575954445707,-924.1576108022194,-924.1576178291173,-924.1576015547737,-924.1576271466568,-924.1574882038805,-924.1576221448111,-924.1575776971632];

export const dataset2 = [-924.2239720274754,-924.2239721764246,-924.2216651109361,-924.2196498457037,-924.2166175158656,-924.2124470081941,-924.20659166158,-924.2057378934934,-924.2057564770973,-924.2058302200968,-924.2061920527648,-924.2054831421619,-924.1998936786421,-924.199416953566,-924.1990188933845,-924.1989315828647,-924.1996551189653,-924.1988902823165,-924.1994229597236,-924.200056607169,-924.2017352778621,-924.2039347932622,-924.2040242328795,-924.2030110891427,-924.196923333578,-924.1909576024597,-924.190951611635,-924.1906026762159,-924.1903749460226,-924.1890007976001,-924.1878185154687,-924.187772025793,-924.1877053053105,-924.1877078177331,-924.1876511075134,-924.1876658710082,-924.1876899350667,-924.188895508035,-924.1896785690573,-924.1884567255787,-924.1879424543506,-924.1879331800722,-924.1879253251919,-924.1888723770995,-924.1895517738553,-924.1908495595246,-924.1911527456333,-924.1913306523171,-924.1930828316338,-924.193940056218,-924.194555958994,-924.1947879276684,-924.1948173385653,-924.1948340646849,-924.1947829356795,-924.1952185157279,-924.1955895306763,-924.1958645675755,-924.1958265636237,-924.1966189295905,-924.1969000580741,-924.1968101584666,-924.1967373814465,-924.196605585494,-924.1967199587702,-924.1967904993619,-924.196877582077,-924.1968921418619,-924.1977675032024,-924.1966097210249,-924.1885485067651,-924.1698387379934,-924.1576370528742,-924.140706648292,-924.1217952773177,-924.1197489868418,-924.1181665373358,-924.1173756652419,-924.1173848650458,-924.1181685919586,-924.1190109698117,-924.1200679440428,-924.1210264716105,-924.1236853595043,-924.1249431698352,-924.1259537135322,-924.1304738487986,-924.1338872892748,-924.1369993726508,-924.1400873810163,-924.1428607298035,-924.1449429696082,-924.1463784796275,-924.1474216377245,-924.1481873604022,-924.1487975231577,-924.149360251067,-924.1497876016718,-924.1502744651508,-924.1505565694707,-924.150674696048,-924.1507149156192,-924.1507360050744,-924.1507471324562,-924.1507444064667,-924.1507501048691,-924.1507497686382,-924.1507486088058,-924.1507475157814,-924.1507467677498,-924.1507498934926,-924.1507518659744,-924.1507521353973,-924.1507536150324,-924.1507542009723,-924.1507543345884,-924.1507539928814,-924.1507528801433,-924.1507544736808,-924.1507557813671,-924.1507566849193,-924.1507570496258,-924.1507565534936,-924.1507557014164,-924.1507542929703,-924.1507525099606,-924.1507548110069,-924.1507563968778,-924.1507576541843,-924.1507583496457,-924.1507637424832,-924.1507675790205,-924.1507654532086,-924.1507760603635,-924.1507770033434,-924.1507768379659,-924.150776705445,-924.1507761359333,-924.1507776637578,-924.1507787009261,-924.1507792901517,-924.1507800097078,-924.1507967391132,-924.1507959615107,-924.1507934304693,-924.1507940229806,-924.1507936385601,-924.1507920614509,-924.1507953394287,-924.1507975539529,-924.150802771556,-924.1508009863559,-924.1507999645205,-924.1507994793404,-924.15079603489,-924.150792709818,-924.1507967851121,-924.1508015569628,-924.1508035809196,-924.1508069158485,-924.1508077712112,-924.150807157891,-924.1508085531946,-924.1508083724842,-924.1508100448771,-924.1508115770825,-924.1508124663969,-924.1508139416512,-924.1508243210013,-924.1508341275543,-924.1508316227981,-924.1508318955066,-924.1508310291917,-924.1508288869517,-924.1508365852161,-924.1508417425824,-924.1508467060956,-924.1508501165944,-924.1508705182547,-924.150900747277,-924.1509613301761,-924.1510635137122,-924.1511990761082,-924.1513540665187,-924.1515200211239,-924.1517497676076,-924.1519818983737,-924.1522129043542,-924.152458017796,-924.1527475914805,-924.1530213141219,-924.1532932488253,-924.1535563900494,-924.1538290371899,-924.1540682622096,-924.1543769408202,-924.1545669069136,-924.1549120391995,-924.1552674511711,-924.1556106350699,-924.155985271346,-924.1563648514215,-924.1566520364426,-924.1569034435358,-924.1571148353155,-924.1572631104167,-924.1573955541887,-924.157508960938,-924.1575888174262,-924.1576072526285,-924.1576228112492,-924.1576257891381,-924.1576356050003,-924.1576343301704,-924.1576365665989,-924.1576389333579,-924.1576404781583,-924.1576427353959,-924.1576431636249,-924.1576450665605,-924.1576448655886,-924.1576465719331,-924.1576147488258];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [1.022662560785991e-05,1.022657228821241e-05,0.007232058165240424,0.012260435317391575,0.016878988707688496,0.01933304085254309,0.019301570974696213,0.01944490070552419,0.01946373386853671,0.019470689980011596,0.019550752923765236,0.01963578765148381,0.0196252624021585,0.01957076896284245,0.01960416104003009,0.019629952140604045,0.01960480347625504,0.019602171491888774,0.01962988782920473,0.019638221499896233,0.019690522488897272,0.019924955345644778,0.018478754839144407,0.01269360857086492,0.007390771688074346,0.010996317228965545,0.0166538113252784,0.019060054856707677,0.019632549559257594,0.019720110438560347,0.019762752362372887,0.01981967405149625,0.01983868153805565,0.019783673952686324,0.019669610379094322,0.01955470191564218,0.019538849654205066,0.01961480599769931,0.01962338540265192,0.01954869142850531,0.01949324801419994,0.019465573862070488,0.019452160167351327,0.019451146215507295,0.01946260098053782,0.01948756151916388,0.019520645962401408,0.019551658384034096,0.019579237939089673,0.019605554322428016,0.01962019454934198,0.01961816665756274,0.01963029515481396,0.01970457517721908,0.019858024514763782,0.020031529455061245,0.020112881241632175,0.020070030320216824,0.0199928211337283,0.019963622160749463,0.019962383763149006,0.01990270475891848,0.019757654522386016,0.019613809025194637,0.019556067238233592,0.019571135204354426,0.019594451419621278,0.019615896136894323,0.01968557592133643,0.0198186070877473,0.019942061171143992,0.019995968008844636,0.020032564843581218,0.02008110613621865,0.020072712410162293,0.01993547623542734,0.0197045107098475,0.019611247268900636,0.01960705262915983,0.019596478349716243,0.01962758815765662,0.019630417457675024,0.019592243018067036,0.019560527655000864,0.01952912911251092];

export const dataset1_grad_itr5 = [4.946707582565822e-06,5.724918186727944e-06,0.004586015335101931,0.009878239194267993,0.013499928837049981,0.011461607033757886,0.00990694308371527,0.009230959179046087,0.010543836091355995,0.010754138417160426,0.011079902759954886,0.011098317289643849,0.010252406186166041,0.008924655969024012,0.008017447791131688,0.007159657461703152,0.006282894086965386,0.0060144479976484795,0.006343765372304899,0.007495910947513995,0.008508530557318511,0.010357945982742665,0.01222090941516625,0.01290671675089436,0.0044107421509863316,0.003885970417916968,0.003282777941388357,0.0029876324437108502,0.004049518455009652,0.002777223653587689,0.0021595417320028182,0.0015593696767014693,0.0015135464978429335,0.0016100519980209503,0.0016414128850223094,0.001598893817177777,0.0008142695529799497,0.0007751982063715585,0.0017392316432223707,0.0016654396482678826,0.001478117806370624,0.0005631673505272389,0.0005469569391409256,0.0005892732636198716,0.0005222467720206887,0.0006135060099065749,0.0005590452938641979,0.0005621129142134971,0.0006199970048905442,0.0007774187306871178,0.0007178101904909982,0.0020278827266008615,0.0015924831674510003,0.001088481132161692,0.001356171813973099,0.0016811839256615135,0.0019757888035988524,0.0019225360856097947,0.0018440441400388856,0.002066919434289404,0.001743161988084326,0.0017221711011838803,0.000881220866085522,0.0007898242662848593,0.000973739941111056,0.0013872813906282279,0.0016172712702383952,0.002057048884298387,0.001965535088346273,0.0014320824883004475,0.0018240794923341885,0.0011304337932540208,0.0014441144431625733,0.0020177971591342435,0.0022615170392968676,0.0020447375810644292,0.001815373173896471,0.0017483725248956842,0.0007409772324862089,0.0007268966038383257,0.0006693030799946868,0.0007584508428554084,0.0013557150339454918,0.001558053769959935,0.0023492224648686806];

export const dataset1_grad_itr10 = [3.1921956799694557e-06,4.887377832462674e-06,0.0026905886802966496,0.007368254871608151,0.007338769583864937,0.007462011623153771,0.00818424826204156,0.008544598900607311,0.007329120023024945,0.007447796961183716,0.006737561864191855,0.006286219532306472,0.005085987769177705,0.005691443494727482,0.006753153643403447,0.006813040198144479,0.006834974971597378,0.006806252450377526,0.006744847895064894,0.006797736105698931,0.0069096035608848675,0.006871729119217339,0.006924652861761165,0.00659123189876834,0.004964421562984777,0.00464761798219838,0.0041629631460641525,0.004106065938123052,0.003410522846930446,0.0034292162924439915,0.003655670615994127,0.0037223970970492416,0.003737032004443258,0.006148442569294916,0.009005722019565498,0.0115181585529292,0.011461502751443756,0.009916129625734271,0.0038129730383114416,0.0026292030553765598,0.00269220037101714,0.00257544300447657,0.002341254527219425,0.002234007169078576,0.002271974998973747,0.0011353715990051433,0.0013625924878327297,0.0013673573329858054,0.001044563519091563,0.0005125262911119646,0.0004196811415244929,0.0003346004301336708,0.0002209950658831376,0.00019073046181157993,0.0002865554164402462,0.000531432032327066,0.00022978230369725088,0.00021180185615196704,8.725004577414136e-05,7.354406957628863e-05,0.00029608180000334093,0.0003289363034753428,0.0004366982799738438,5.402971243520886e-05,0.0011227544121852348,9.428216584999647e-05,0.0001591010265212936,9.042364030625856e-05,0.0004182170316177811,5.8132772713695925e-05,5.81529591605337e-05,0.00010004874837460582,0.00010981457610113369,8.734253487729934e-05,0.001146098391164872,9.057852337839576e-05,9.326608414373717e-05,0.00010384023400835731,0.0008095587175109373,0.00021189606644645025,0.00023444990554855703,0.00020428516728051202,0.0003536266716732042,0.0001788450611636562,0.0002491576877967163,0.00016844617696722022,0.0005365736490346709,0.00010680442111661734,0.0003041163527484524,9.170463893670716e-05,0.00018907096775877666,0.0003629096761572796,0.0006362181466059794,0.0004242587720292591,0.0007292698736016947,0.0006255356176240362,0.00044178827663419426,0.0004090219984599791,0.0003107036328411626,0.0002260493671693621,0.00048287050408965125,0.0006363238447512892,0.0007767710471382761,0.0006952288204414831,0.0007218334489472255,0.0004006294694442707,0.0004890229753563094,0.00034526499067464244,0.00048100260776892683,0.0007818035812677978,0.0007726544535668545,0.0006833842205335922,0.00034919902817952226,0.0003252441512647406,0.00017371771723626551,7.375994681457269e-05,9.619210217149791e-05,0.000139271090139582,0.0003963577864325653,0.0003269653427956608,0.00031671307409587943,0.0002814778752190824,0.00036439527994204643,0.00016911616338150583,0.0016096785661686031,0.0005391259261704127,0.0007483866736914722];

export const dataset2_grad = [3.098623324601877e-06,4.686162224522365e-06,0.001625511461994207,0.002305529908794768,0.0030970424068619117,0.0038729389544163583,0.004843565288161146,0.005056733837941519,0.0049953699714574374,0.004898379440271724,0.00464714548234688,0.004437643374179397,0.005476940975220846,0.005402278231110441,0.00531128911772316,0.005084701434319003,0.004870612202694894,0.005035202430583799,0.005038219198681855,0.004958348744745259,0.004738051764380612,0.0041272243311559695,0.004190333417533296,0.004238942916357751,0.0036886590554381657,0.0041985023692049095,0.004417941582012448,0.004670000211231011,0.004549095116852282,0.004470795937379464,0.004747788488849243,0.004744348807514352,0.0047480375783131535,0.004766477093710309,0.004809963601258237,0.004837701058619912,0.00486333599868181,0.004620727778214913,0.004494384602004284,0.0045143824133405,0.0048976750931909,0.004931122431876444,0.004962504720413595,0.004842285687920226,0.004230977666418291,0.004218781749622749,0.004133820663846002,0.004068691103063069,0.0035564498943852557,0.0034225764328905377,0.0034200029870707217,0.003301637833091811,0.003454720369582949,0.0034433637776214595,0.00351368754482592,0.0033500913157592,0.0032411409312357226,0.0030412296430647116,0.002977006440165248,0.0027385377083239556,0.0027315162008472813,0.002837497254492113,0.0027961212566745405,0.002842696380508699,0.0028658038785391695,0.0029240255606005714,0.002894772701865741,0.002925654435482463,0.0025060810327527027,0.0038541526192764374,0.007624181085125849,0.010608978659194883,0.01074501941380684,0.009810930021516647,0.007728788908130929,0.006073839470077011,0.0036918310602266297,0.0018190758556859662,0.0014455188261466012,0.002065085590605026,0.00229950507378904,0.002355328878610187,0.0021435085646166383,0.0018116761860570746,0.001811352365450275,0.0014855697140935802,0.0014126028744957757,0.0007621125367172921,0.0008167531276328024,0.0008883670348535245,0.0007024281112773652,0.0003903043706055343,0.0003324350427087309,0.00020083918149790256,0.0001488608720451253,0.00016990064588390155,0.00018927462653224044,0.0002111473003466708,0.0001736205090718669,0.00013586772822615778,7.975318467604845e-05,5.8081457390298164e-05,0.00011874350866094889,5.5421970760476714e-05,0.0001998784126675108,0.00020891666668876755,0.0002325192188951136,0.00027897964405356336,0.00025452461813572946,0.00022430130070226817,0.0002164452878912001,0.0001454818314616202,0.00010683564585296412,5.9064603871624386e-05,3.806501292449563e-05,3.051395559147455e-05,4.711412828284509e-05,7.27293495861578e-05,6.349358378055819e-05,4.547993081627498e-05,2.1641414974303057e-05,2.7640310274936538e-05,4.717238555425924e-05,7.038685159377344e-05,9.014649694090355e-05,0.0001268144549424132,0.00011362431819013207,6.103495872263931e-05,2.949215398346303e-05,5.161681785221233e-05,2.5031030738155224e-05,9.40745641521766e-05,3.528602636971139e-05,4.8688514139349576e-05,4.210993377689847e-05,8.290927718753542e-05,8.572315860397371e-05,9.496178456171352e-05,0.0001427965213390056,0.0001717581910036323,0.000131836541597497,0.0001273463489636159,3.294197556257806e-05,0.0001228510528940295,8.648887951018564e-05,7.584809901918391e-05,8.20829668976154e-05,0.00010303317050009693,9.961652596018677e-05,8.89375173732872e-05,7.308300261712987e-05,8.517778454923976e-05,8.305277558805635e-05,6.128248768058849e-05,8.342159092744108e-05,8.568282297854031e-05,9.027700975438272e-05,8.765583561455414e-05,9.525411142215082e-05,9.020507004747124e-05,9.649854903512248e-05,0.00014619548141052503,0.0001002223458273742,0.0001105751842700147,0.00011870338584129334,0.00011454463096895847,0.0001236588517927567,0.0001283216625965907,4.061902742115131e-05,6.570453347003951e-05,9.141209018300966e-05,9.224730379340859e-05,9.171519810282937e-05,8.531723555060835e-05,6.0277615798376815e-05,4.624820929387137e-05,4.211349844082134e-05,5.0643458203680886e-05,5.151183459459587e-05,3.898409346081738e-05,9.2832651158878e-05,6.77034920957613e-05,0.0001651602128492564,0.00026782730224316143,0.00028625188093594486,0.0003018376716414778,0.00017324593932038554,0.00015288567974516167,0.0001817349263082549,0.00017460141130576303,0.0002687159482858853,0.00037430427754541433,0.0004255542841070405,0.0004546196900321384,0.0004938632139178664,0.00026435010277773213,0.0001478992150381223,0.00016679299288269273,0.0002765364396997737,0.00032614858687971595,0.00035921521165182516,0.00023854289171243995,8.076203963799994e-05,5.368082453281208e-05,5.6164395268919036e-05,5.598084214119489e-05,2.7935220457100443e-05,2.4898695047049735e-05,7.734387887675303e-05,6.198225121323351e-05,8.233639045853082e-05,8.457459688041997e-05,5.118425389553663e-05,0.00010202883302548952,0.00010471259342224118,9.646836823366326e-05,0.00011789965356289142,0.00011278126079270719,0.00012745392684797768,8.637099629780157e-05,9.947493961235421e-05,7.708164521317423e-05,0.0006221168523728598];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`bh9_3_32_step3_TS_Opt_Inputs`内に保存された`bh9_3_32_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`bh9_3_32_ts_guess_1.xyz`
```
37
0 2
N      -2.761832251977      0.153248105760      0.374185832376
C      -2.030894996989      1.407978714456      0.311986638189
C      -3.674313483134     -0.139276908847     -0.626318967196
O      -4.343647051001      0.755321948336     -1.089781683185
O      -1.300680776251      1.656449227168     -0.603056985206
C      -3.810422460805     -1.592922904048     -0.993242597688
C      -2.221054866262      2.238955339215      1.534111911189
F      -1.657251750957     -0.929514062558      0.376360521561
C      -0.103053271853     -2.240852152963      0.190819889808
H      -0.734588938255     -3.122065770822      0.212275447335
C       0.594886996362     -1.864801130071      1.448044807421
C       0.502662612399     -1.864882492466     -1.111527826139
C       1.193155758462     -0.457483725142      1.394873641640
C       2.008710711300     -0.270296899819      0.130927452237
C       1.167929815227     -0.485368526784     -1.116434111847
O       2.497823943165      1.087837089579      0.164061754648
C       3.548989175046      1.373974184803     -0.623020057766
C       3.881187692648      2.837588956825     -0.561668890428
O       4.127823334091      0.555932690480     -1.290018884654
H       1.400182174343     -2.596043689542      1.605063734398
H      -0.078301606407     -1.958117318735      2.302210056486
H      -0.240005564621     -1.919372781173     -1.913053741741
H       1.251529631831     -2.634745862227     -1.342371635603
H       1.821105132668     -0.280308087022      2.269516071585
H       0.399572909880      0.294541039717      1.407327139897
H       2.870031558876     -0.943808454694      0.129699384091
H       0.408727886537      0.296600416764     -1.152767439016
H       1.796295759442     -0.385295604197     -2.000884220019
H       3.075116184835      3.402243242184     -1.031334710476
H       4.812466862295      3.021837149903     -1.087825439030
H       3.953711034733      3.166746496747      0.473558928117
H      -3.752881190037     -2.235836320624     -0.117288797686
H      -4.758775181343     -1.722621379160     -1.505033678191
H      -2.998111032115     -1.878763781507     -1.664563380946
H      -3.264707236360      2.548743640889      1.591139761233
H      -2.018672677801      1.622843340970      2.411596291830
H      -1.562714837972      3.101536268606      1.502433782775
```

<MoleculeViewer 
  xyzData={`37
0 2
N      -2.761832251977      0.153248105760      0.374185832376
C      -2.030894996989      1.407978714456      0.311986638189
C      -3.674313483134     -0.139276908847     -0.626318967196
O      -4.343647051001      0.755321948336     -1.089781683185
O      -1.300680776251      1.656449227168     -0.603056985206
C      -3.810422460805     -1.592922904048     -0.993242597688
C      -2.221054866262      2.238955339215      1.534111911189
F      -1.657251750957     -0.929514062558      0.376360521561
C      -0.103053271853     -2.240852152963      0.190819889808
H      -0.734588938255     -3.122065770822      0.212275447335
C       0.594886996362     -1.864801130071      1.448044807421
C       0.502662612399     -1.864882492466     -1.111527826139
C       1.193155758462     -0.457483725142      1.394873641640
C       2.008710711300     -0.270296899819      0.130927452237
C       1.167929815227     -0.485368526784     -1.116434111847
O       2.497823943165      1.087837089579      0.164061754648
C       3.548989175046      1.373974184803     -0.623020057766
C       3.881187692648      2.837588956825     -0.561668890428
O       4.127823334091      0.555932690480     -1.290018884654
H       1.400182174343     -2.596043689542      1.605063734398
H      -0.078301606407     -1.958117318735      2.302210056486
H      -0.240005564621     -1.919372781173     -1.913053741741
H       1.251529631831     -2.634745862227     -1.342371635603
H       1.821105132668     -0.280308087022      2.269516071585
H       0.399572909880      0.294541039717      1.407327139897
H       2.870031558876     -0.943808454694      0.129699384091
H       0.408727886537      0.296600416764     -1.152767439016
H       1.796295759442     -0.385295604197     -2.000884220019
H       3.075116184835      3.402243242184     -1.031334710476
H       4.812466862295      3.021837149903     -1.087825439030
H       3.953711034733      3.166746496747      0.473558928117
H      -3.752881190037     -2.235836320624     -0.117288797686
H      -4.758775181343     -1.722621379160     -1.505033678191
H      -2.998111032115     -1.878763781507     -1.664563380946
H      -3.264707236360      2.548743640889      1.591139761233
H      -2.018672677801      1.622843340970      2.411596291830
H      -1.562714837972      3.101536268606      1.502433782775`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`bh9_3_32_ts_guess_2.xyz`
```
37
0 2
N      -2.716114062200      0.492598892437      0.144605391417
C      -2.120511388534      1.771136412663      0.140198304776
C      -4.038017681605      0.054508644001      0.266380095376
O      -4.929560983090      0.849960564762      0.427303520788
O      -0.933267275759      1.859389814541     -0.016123996239
C      -4.221681154267     -1.432619386629      0.179779713308
C      -3.046146517201      2.933395034466      0.338790136862
F      -1.805827470636     -0.516136648934     -0.041427533000
C       0.414873058793     -2.671468427646     -0.337092741952
H      -0.321817580574     -3.451673756565     -0.475503505004
C       1.014371578440     -2.447542580184      1.006644816008
C       1.069468157031     -2.047327827569     -1.518295633788
C       1.424939691402     -0.985500778952      1.218839290546
C       2.255081764322     -0.496293160005      0.048022523532
C       1.480264833422     -0.592897595859     -1.255158584038
O       2.592572352363      0.878329166106      0.330573971053
C       3.642960121134      1.394014715075     -0.324547519642
C       3.836432109606      2.840407977747      0.033969961490
O       4.330659393308      0.770989607848     -1.093046065534
H       1.915288641762     -3.075848070893      1.114521910905
H       0.333772210837     -2.766602176585      1.798352945835
H       0.424427722961     -2.103153913277     -2.396922389130
H       1.978344397335     -2.617293522518     -1.776629755448
H       1.994870072756     -0.878868826505      2.143830600755
H       0.537781575478     -0.352325933679      1.295999260132
H       3.186270539128     -1.065577311498     -0.027803424672
H       0.595266626945      0.041416712771     -1.168036477225
H       2.093838128249     -0.220520886541     -2.075756526547
H       2.936833343566      3.400109328129     -0.220885664757
H       4.692041078859      3.236764087714     -0.503562375233
H       3.988875417903      2.936646133078      1.108542649804
H      -3.647836994773     -1.936387788359      0.956857529908
H      -5.280975549557     -1.637290761343      0.296949079256
H      -3.866005804915     -1.807650573244     -0.779374656674
H      -3.802149943893      2.964848819996     -0.443390923090
H      -3.577467612171      2.849393568537      1.284793606740
H      -2.431852796427      3.829070446911      0.318602463480
```

<MoleculeViewer 
  xyzData={`37
0 2
N      -2.716114062200      0.492598892437      0.144605391417
C      -2.120511388534      1.771136412663      0.140198304776
C      -4.038017681605      0.054508644001      0.266380095376
O      -4.929560983090      0.849960564762      0.427303520788
O      -0.933267275759      1.859389814541     -0.016123996239
C      -4.221681154267     -1.432619386629      0.179779713308
C      -3.046146517201      2.933395034466      0.338790136862
F      -1.805827470636     -0.516136648934     -0.041427533000
C       0.414873058793     -2.671468427646     -0.337092741952
H      -0.321817580574     -3.451673756565     -0.475503505004
C       1.014371578440     -2.447542580184      1.006644816008
C       1.069468157031     -2.047327827569     -1.518295633788
C       1.424939691402     -0.985500778952      1.218839290546
C       2.255081764322     -0.496293160005      0.048022523532
C       1.480264833422     -0.592897595859     -1.255158584038
O       2.592572352363      0.878329166106      0.330573971053
C       3.642960121134      1.394014715075     -0.324547519642
C       3.836432109606      2.840407977747      0.033969961490
O       4.330659393308      0.770989607848     -1.093046065534
H       1.915288641762     -3.075848070893      1.114521910905
H       0.333772210837     -2.766602176585      1.798352945835
H       0.424427722961     -2.103153913277     -2.396922389130
H       1.978344397335     -2.617293522518     -1.776629755448
H       1.994870072756     -0.878868826505      2.143830600755
H       0.537781575478     -0.352325933679      1.295999260132
H       3.186270539128     -1.065577311498     -0.027803424672
H       0.595266626945      0.041416712771     -1.168036477225
H       2.093838128249     -0.220520886541     -2.075756526547
H       2.936833343566      3.400109328129     -0.220885664757
H       4.692041078859      3.236764087714     -0.503562375233
H       3.988875417903      2.936646133078      1.108542649804
H      -3.647836994773     -1.936387788359      0.956857529908
H      -5.280975549557     -1.637290761343      0.296949079256
H      -3.866005804915     -1.807650573244     -0.779374656674
H      -3.802149943893      2.964848819996     -0.443390923090
H      -3.577467612171      2.849393568537      1.284793606740
H      -2.431852796427      3.829070446911      0.318602463480`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`bh9_3_32_ts_guess_3.xyz`
```
37
0 2
N      -2.714208568844      0.498630305862      0.134936607614
C      -2.125712699228      1.780127934310      0.094496728393
C      -4.030392955000      0.054402041261      0.296367144847
O      -4.923410498277      0.847024763941      0.461768389288
O      -0.943493834014      1.873175201367     -0.087934689746
C      -4.206740972881     -1.435853337534      0.244585278810
C      -3.055736317974      2.940292762970      0.290915601412
F      -1.801770059822     -0.508391694796     -0.052095288940
C       0.411557126249     -2.669286654012     -0.363971498893
H      -0.326600826988     -3.446305284724     -0.512295763924
C       1.006265671113     -2.458749848602      0.984110082067
C       1.073010373514     -2.036504782633     -1.536818878321
C       1.418067489646     -0.999257497689      1.211163669551
C       2.253779008306     -0.500393453850      0.048297432317
C       1.485222706210     -0.585042060226     -1.259449339639
O       2.590479998019      0.871614356781      0.344261033660
C       3.643894641669      1.392544618600     -0.302075190587
C       3.836004810134      2.836028375080      0.069053946545
O       4.334706683385      0.775747684810     -1.072627989985
H       1.906034008785     -3.089119625292      1.089485167197
H       0.322410935489     -2.784203483100      1.770405907763
H       0.432080936956     -2.083607037118     -2.418940850829
H       1.982010993639     -2.606134426960     -1.795511738594
H       1.984046285151     -0.901462585746      2.139553279526
H       0.531154378689     -0.365837692893      1.290329834493
H       3.185068099937     -1.069433416735     -0.027948076816
H       0.601024908780      0.050278443128     -1.171936334124
H       2.103697859937     -0.207062448272     -2.073850066390
H       2.940088656868      3.398669171405     -0.192533500033
H       4.698095254539      3.234619104821     -0.456370795794
H       3.976034207324      2.924796884166      1.145886125459
H      -3.611851889897     -1.919348788285      1.018890473502
H      -5.261787570327     -1.644678235440      0.390444684883
H      -3.871109553987     -1.827858798053     -0.715281758255
H      -3.828395866963      2.951470713855     -0.475686821233
H      -3.565890339208      2.870139268321      1.249940852552
H      -2.447633080931      3.838969521280      0.240436342221
```

<MoleculeViewer 
  xyzData={`37
0 2
N      -2.714208568844      0.498630305862      0.134936607614
C      -2.125712699228      1.780127934310      0.094496728393
C      -4.030392955000      0.054402041261      0.296367144847
O      -4.923410498277      0.847024763941      0.461768389288
O      -0.943493834014      1.873175201367     -0.087934689746
C      -4.206740972881     -1.435853337534      0.244585278810
C      -3.055736317974      2.940292762970      0.290915601412
F      -1.801770059822     -0.508391694796     -0.052095288940
C       0.411557126249     -2.669286654012     -0.363971498893
H      -0.326600826988     -3.446305284724     -0.512295763924
C       1.006265671113     -2.458749848602      0.984110082067
C       1.073010373514     -2.036504782633     -1.536818878321
C       1.418067489646     -0.999257497689      1.211163669551
C       2.253779008306     -0.500393453850      0.048297432317
C       1.485222706210     -0.585042060226     -1.259449339639
O       2.590479998019      0.871614356781      0.344261033660
C       3.643894641669      1.392544618600     -0.302075190587
C       3.836004810134      2.836028375080      0.069053946545
O       4.334706683385      0.775747684810     -1.072627989985
H       1.906034008785     -3.089119625292      1.089485167197
H       0.322410935489     -2.784203483100      1.770405907763
H       0.432080936956     -2.083607037118     -2.418940850829
H       1.982010993639     -2.606134426960     -1.795511738594
H       1.984046285151     -0.901462585746      2.139553279526
H       0.531154378689     -0.365837692893      1.290329834493
H       3.185068099937     -1.069433416735     -0.027948076816
H       0.601024908780      0.050278443128     -1.171936334124
H       2.103697859937     -0.207062448272     -2.073850066390
H       2.940088656868      3.398669171405     -0.192533500033
H       4.698095254539      3.234619104821     -0.456370795794
H       3.976034207324      2.924796884166      1.145886125459
H      -3.611851889897     -1.919348788285      1.018890473502
H      -5.261787570327     -1.644678235440      0.390444684883
H      -3.871109553987     -1.827858798053     -0.715281758255
H      -3.828395866963      2.951470713855     -0.475686821233
H      -3.565890339208      2.870139268321      1.249940852552
H      -2.447633080931      3.838969521280      0.240436342221`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-v1.19.6/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`bh9_3_32_ts_final_X.xyz`として保存されている。)

`bh9_3_32_ts_final_1.xyz`
```
37
OptimizedStructure
N     -2.671461562433      0.246283201840      0.364560110314
C     -2.190615314383      1.535554220441      0.532795444807
C     -3.926127619338     -0.267634153743      0.091360990789
O     -4.912157055395      0.434576964926      0.090099120773
O     -1.001424099657      1.744900908313      0.567171536064
C     -3.959743339636     -1.744082713016     -0.189153288130
C     -3.223228790064      2.619863919281      0.687738537080
F     -1.514523446020     -0.799456804546      0.156987571962
C      0.021856826664     -2.181472598971     -0.153396600628
H     -0.677991775468     -3.003960461958     -0.237137641838
C      0.768918629645     -2.036012373289      1.121864075300
C      0.608997559098     -1.639503613208     -1.404222430584
C      1.439404017902     -0.668357931526      1.260626163382
C      2.210318297136     -0.335144919341     -0.001347777621
C      1.283078109076     -0.281847885753     -1.203602512658
O      2.827355033531      0.950384726241      0.214070826300
C      3.880027891934      1.251166402555     -0.563228582890
C      4.405291945122      2.622280346522     -0.246552873081
O      4.332347974488      0.509135458323     -1.397621154906
H      1.544043460947     -2.820323581187      1.145056111878
H      0.115558129853     -2.237027613782      1.972329590459
H     -0.150228714519     -1.586973011044     -2.186675398155
H      1.360944372772     -2.362012280085     -1.762970190226
H      2.114272311899     -0.666091483789      2.117915010192
H      0.681716342102      0.101380686653      1.415631715920
H      3.006281308145     -1.065730981863     -0.174552312505
H      0.526966026830      0.482302224934     -1.013721761941
H      1.847044062454     -0.011344139562     -2.095689231845
H      3.620881131596      3.359863698504     -0.413641911937
H      5.262450768554      2.836499203528     -0.876902625513
H      4.686768423894      2.676090739303      0.804482636059
H     -3.495531386351     -2.301936628082      0.622774700031
H     -4.998709302690     -2.035079552576     -0.308525610840
H     -3.400162418471     -1.964684341919     -1.097949515750
H     -3.814408741617      2.709954971499     -0.221809179596
H     -3.919967614849      2.385231579598      1.489787604347
H     -2.688241442752      3.543207816779      0.893448854987
```

<MoleculeViewer 
  xyzData={`37
OptimizedStructure
N     -2.671461562433      0.246283201840      0.364560110314
C     -2.190615314383      1.535554220441      0.532795444807
C     -3.926127619338     -0.267634153743      0.091360990789
O     -4.912157055395      0.434576964926      0.090099120773
O     -1.001424099657      1.744900908313      0.567171536064
C     -3.959743339636     -1.744082713016     -0.189153288130
C     -3.223228790064      2.619863919281      0.687738537080
F     -1.514523446020     -0.799456804546      0.156987571962
C      0.021856826664     -2.181472598971     -0.153396600628
H     -0.677991775468     -3.003960461958     -0.237137641838
C      0.768918629645     -2.036012373289      1.121864075300
C      0.608997559098     -1.639503613208     -1.404222430584
C      1.439404017902     -0.668357931526      1.260626163382
C      2.210318297136     -0.335144919341     -0.001347777621
C      1.283078109076     -0.281847885753     -1.203602512658
O      2.827355033531      0.950384726241      0.214070826300
C      3.880027891934      1.251166402555     -0.563228582890
C      4.405291945122      2.622280346522     -0.246552873081
O      4.332347974488      0.509135458323     -1.397621154906
H      1.544043460947     -2.820323581187      1.145056111878
H      0.115558129853     -2.237027613782      1.972329590459
H     -0.150228714519     -1.586973011044     -2.186675398155
H      1.360944372772     -2.362012280085     -1.762970190226
H      2.114272311899     -0.666091483789      2.117915010192
H      0.681716342102      0.101380686653      1.415631715920
H      3.006281308145     -1.065730981863     -0.174552312505
H      0.526966026830      0.482302224934     -1.013721761941
H      1.847044062454     -0.011344139562     -2.095689231845
H      3.620881131596      3.359863698504     -0.413641911937
H      5.262450768554      2.836499203528     -0.876902625513
H      4.686768423894      2.676090739303      0.804482636059
H     -3.495531386351     -2.301936628082      0.622774700031
H     -4.998709302690     -2.035079552576     -0.308525610840
H     -3.400162418471     -1.964684341919     -1.097949515750
H     -3.814408741617      2.709954971499     -0.221809179596
H     -3.919967614849      2.385231579598      1.489787604347
H     -2.688241442752      3.543207816779      0.893448854987`}
  caption="遷移状態構造 (No.1)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -752.0362             12.6240             29.1929
Reduced mass [au]                  13.0825              6.3668              5.3117
Force const [Dyne/A]               -4.3593              0.0006              0.0027
Char temp [K]                       0.0000             18.1632             42.0021
Normal mode                   x         y         z            x         y         z            x         y         z     
       N                -0.06584    0.06232    0.01765   -0.00045   -0.00751    0.03364   -0.03386   -0.00536   -0.00409
       C                -0.02215   -0.00205    0.00025    0.00308   -0.01140    0.05955   -0.05729   -0.00032    0.02177
       C                -0.00071    0.02517    0.00859    0.01144    0.01374   -0.06466   -0.02417   -0.02653   -0.00731
       O                -0.02805   -0.00033   -0.00642    0.01994    0.02535   -0.11418   -0.03810   -0.04596    0.00262
       O                -0.00341   -0.00137   -0.00087    0.00320   -0.01978    0.10141   -0.06104    0.02013    0.02758
       C                 0.00140    0.00971    0.00247    0.01273    0.02056   -0.10027    0.00443   -0.02375   -0.02599
       C                 0.00020    0.01674    0.00221    0.00531   -0.00625    0.03808   -0.07778   -0.02251    0.04063
       F                 0.14652   -0.12904   -0.02690    0.00156   -0.00898    0.04918   -0.01442    0.01775   -0.00583
       C                -0.05491    0.06060    0.01245    0.00330   -0.00784    0.04773    0.00435    0.04063    0.00361
       H                -0.00519    0.01552    0.00164    0.00441   -0.01043    0.06413    0.01374    0.03246    0.00481
       C                -0.01461    0.01202   -0.00242    0.02245    0.00274    0.03533   -0.00384    0.05234    0.00733
       C                -0.01259    0.01010    0.00781   -0.01758   -0.01412    0.03527    0.00032    0.03994    0.00116
       C                -0.00079    0.00244   -0.00148    0.02239    0.00472    0.01643    0.00526    0.04901   -0.00302
       C                 0.00325    0.00121   -0.00023   -0.00042    0.00040    0.00134    0.01229    0.02436   -0.00485
       C                -0.00013    0.00151    0.00174   -0.02117   -0.00965    0.01688    0.00933    0.03575   -0.00170
       O                -0.00137   -0.00155    0.00067   -0.00118    0.00380   -0.01656    0.04764    0.00929   -0.01795
       C                 0.00172    0.00140   -0.00079   -0.01746    0.00419   -0.03843    0.06591   -0.03733   -0.01206
       C                -0.00019   -0.00016    0.00019   -0.01615    0.00746   -0.05474    0.11605   -0.05461   -0.02080
       O                -0.00139   -0.00112    0.00005   -0.03112    0.00218   -0.04407    0.04558   -0.06281   -0.00036
       H                -0.04213   -0.01095   -0.08153    0.02388    0.00389    0.02857   -0.00942    0.04734    0.02360
       H                -0.00257   -0.00914   -0.00308    0.03581    0.00735    0.04663   -0.01243    0.06631    0.00417
       H                -0.00299   -0.01036    0.00245   -0.02924   -0.02284    0.04593   -0.00457    0.04408    0.00605
       H                -0.03318   -0.03916    0.07603   -0.01914   -0.01245    0.02875   -0.00558    0.03686   -0.00486
       H                -0.00485   -0.01173    0.00028    0.03757    0.01010    0.00447    0.00196    0.05213   -0.00047
       H                -0.00658   -0.00326   -0.00224    0.02352    0.00373    0.02618    0.01055    0.05672   -0.01404
       H                 0.00467    0.00193   -0.00106   -0.00084    0.00233   -0.00880   -0.00714    0.00254   -0.00170
       H                -0.00613   -0.00548    0.00207   -0.02178   -0.01246    0.02633    0.01520    0.04140    0.00108
       H                -0.00312   -0.01141   -0.00287   -0.03794   -0.01093    0.00592    0.00821    0.03180   -0.00369
       H                -0.00126   -0.00124    0.00125   -0.02247    0.00386   -0.04092    0.14264   -0.02638   -0.02051
       H                -0.00040    0.00015   -0.00006   -0.03019    0.00834   -0.07354    0.12177   -0.08899   -0.02468
       H                -0.00003   -0.00060    0.00013    0.00578    0.01247   -0.06087    0.12256   -0.06078   -0.02216
       H                 0.00015    0.00779    0.00223   -0.03528   -0.00285   -0.08901    0.01191   -0.02516   -0.03119
       H                 0.00156    0.00474    0.00224    0.01650    0.03292   -0.16320    0.01026   -0.04172   -0.03287
       H                -0.00195    0.01335   -0.00065    0.05889    0.03719   -0.07597    0.01165   -0.00219   -0.02676
       H                -0.00329    0.00841    0.00288    0.05077    0.02109    0.01117   -0.07955   -0.01751    0.04228
       H                -0.00336    0.01347   -0.00128   -0.03598   -0.01928   -0.00170   -0.07330   -0.05030    0.03644
       H                -0.00835    0.02262    0.00108    0.00361   -0.01586    0.08568   -0.09557   -0.01591    0.05729
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_3_32_ts_final_2.xyz`
```
37
OptimizedStructure
N     -2.587715800860      0.620404810014      0.719635297927
C     -2.128412411081      1.526491477139      1.706164468538
C     -2.315455158107      0.497551018896     -0.646968296804
O     -1.773606008696      1.394597870073     -1.243675573841
O     -2.343295059824      1.284077423624      2.860655191398
C     -2.749191903604     -0.800578210393     -1.263373152104
C     -1.395893088492      2.730027619375      1.198907311382
F     -3.180422339877     -0.489100041582      1.267799488918
C      0.503224133147     -3.127614946286      0.201082723225
H     -0.006990715334     -4.080483240038      0.230571206143
C      0.828592153473     -2.411820672976      1.464320666683
C      1.177176728464     -2.673016476070     -1.044373584745
C      0.768481288386     -0.891146789973      1.280034558542
C      1.582324525391     -0.458786576113      0.075150246246
C      1.124202162220     -1.147778514960     -1.200084371324
O      1.398652706100      0.969506188424     -0.045734604935
C      2.298432001804      1.640035398974     -0.789697683670
C      1.920452811699      3.088676446913     -0.906694917144
O      3.265798683920      1.127842679916     -1.288323637531
H      1.848842593886     -2.680533271935      1.785821765443
H      0.165499396429     -2.715297581005      2.275035718329
H      0.749760211201     -3.154592079257     -1.924939946946
H      2.237274549164     -2.975877274065     -1.018918281205
H      1.128561827229     -0.377597997113      2.173235113780
H     -0.271128638296     -0.588812164011      1.127330989703
H      2.645275625815     -0.653850039346      0.241337656921
H      0.100203502231     -0.826931174735     -1.409824135836
H      1.748582797806     -0.827757623170     -2.033935969146
H      0.936971266535      3.166857363748     -1.371539160628
H      2.661511550825      3.609444494435     -1.504542841676
H      1.857699988069      3.537615619225      0.084656940404
H     -3.818180226590     -0.956371107193     -1.124588249094
H     -2.506206688207     -0.758825732918     -2.320681010077
H     -2.230704386668     -1.635155214756     -0.788586640591
H     -0.474356740230      2.414192881474      0.710668855883
H     -1.985465355954      3.270914340430      0.461916741866
H     -1.180495981972      3.353691095235      2.062157115966
```

<MoleculeViewer 
  xyzData={`37
OptimizedStructure
N     -2.587715800860      0.620404810014      0.719635297927
C     -2.128412411081      1.526491477139      1.706164468538
C     -2.315455158107      0.497551018896     -0.646968296804
O     -1.773606008696      1.394597870073     -1.243675573841
O     -2.343295059824      1.284077423624      2.860655191398
C     -2.749191903604     -0.800578210393     -1.263373152104
C     -1.395893088492      2.730027619375      1.198907311382
F     -3.180422339877     -0.489100041582      1.267799488918
C      0.503224133147     -3.127614946286      0.201082723225
H     -0.006990715334     -4.080483240038      0.230571206143
C      0.828592153473     -2.411820672976      1.464320666683
C      1.177176728464     -2.673016476070     -1.044373584745
C      0.768481288386     -0.891146789973      1.280034558542
C      1.582324525391     -0.458786576113      0.075150246246
C      1.124202162220     -1.147778514960     -1.200084371324
O      1.398652706100      0.969506188424     -0.045734604935
C      2.298432001804      1.640035398974     -0.789697683670
C      1.920452811699      3.088676446913     -0.906694917144
O      3.265798683920      1.127842679916     -1.288323637531
H      1.848842593886     -2.680533271935      1.785821765443
H      0.165499396429     -2.715297581005      2.275035718329
H      0.749760211201     -3.154592079257     -1.924939946946
H      2.237274549164     -2.975877274065     -1.018918281205
H      1.128561827229     -0.377597997113      2.173235113780
H     -0.271128638296     -0.588812164011      1.127330989703
H      2.645275625815     -0.653850039346      0.241337656921
H      0.100203502231     -0.826931174735     -1.409824135836
H      1.748582797806     -0.827757623170     -2.033935969146
H      0.936971266535      3.166857363748     -1.371539160628
H      2.661511550825      3.609444494435     -1.504542841676
H      1.857699988069      3.537615619225      0.084656940404
H     -3.818180226590     -0.956371107193     -1.124588249094
H     -2.506206688207     -0.758825732918     -2.320681010077
H     -2.230704386668     -1.635155214756     -0.788586640591
H     -0.474356740230      2.414192881474      0.710668855883
H     -1.985465355954      3.270914340430      0.461916741866
H     -1.180495981972      3.353691095235      2.062157115966`}
  caption="遷移状態構造 (No.2)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -18.0954             21.4959             35.9075
Reduced mass [au]                   4.8482              6.8126              6.2022
Force const [Dyne/A]               -0.0009              0.0019              0.0047
Char temp [K]                       0.0000             30.9277             51.6629
Normal mode                   x         y         z            x         y         z            x         y         z     
       N                -0.01755   -0.01984    0.01282   -0.02651   -0.01252    0.00617   -0.00568    0.03031    0.01635
       C                -0.01170    0.00900   -0.01590   -0.03884   -0.02910    0.02694   -0.02455    0.05070    0.00614
       C                -0.01840   -0.06051    0.01607    0.01324   -0.01180    0.01466    0.03875   -0.01273    0.02903
       O                -0.02918   -0.07295   -0.01249    0.06070   -0.02462    0.03818    0.06689   -0.03547    0.02040
       O                -0.00159    0.04031   -0.00747   -0.10760   -0.01767    0.01661   -0.06717    0.08682    0.00570
       C                -0.00064   -0.08599    0.05786   -0.00258    0.00411   -0.00754    0.04877   -0.02758    0.05336
       C                -0.01875   -0.00301   -0.05504    0.04093   -0.06274    0.06153    0.01093    0.02500   -0.00344
       F                -0.00296   -0.00978    0.04906   -0.09570    0.01048   -0.02278   -0.04000    0.05442    0.02808
       C                -0.05608    0.03794   -0.04443   -0.01179    0.03084    0.02047    0.03851   -0.03810   -0.05550
       H                -0.07719    0.04877   -0.05619   -0.02785    0.03983    0.03303    0.05181   -0.04580   -0.07354
       C                -0.03666    0.01291   -0.03517    0.01804    0.03262    0.01172    0.00543   -0.04511   -0.04316
       C                -0.04533    0.03781   -0.03879   -0.02194    0.01307    0.00853    0.05697   -0.01778   -0.03805
       C                -0.00023    0.01680   -0.01454    0.04031    0.03240    0.00364   -0.01421   -0.04429   -0.03021
       C                 0.00739    0.01436   -0.01027    0.02906    0.01384   -0.01091    0.00016   -0.02024   -0.01217
       C                -0.00792    0.04118   -0.01928   -0.00051    0.01297    0.00005    0.03542   -0.01740   -0.02663
       O                 0.03736    0.01999    0.00841    0.04539    0.01523   -0.01298   -0.02342   -0.02267   -0.00206
       C                 0.05568    0.01183    0.02356    0.03140    0.00216   -0.04128   -0.03134   -0.00091    0.00814
       C                 0.08733    0.02179    0.04343    0.03963    0.00446   -0.03847   -0.06216   -0.00892    0.00854
       O                 0.04683   -0.00121    0.01987    0.01313   -0.00981   -0.06445   -0.01537    0.02164    0.01593
       H                -0.04257   -0.01619   -0.04078    0.01835    0.01805   -0.00147    0.00404   -0.03232   -0.02815
       H                -0.04245    0.01795   -0.03799    0.02488    0.04793    0.02307   -0.00360   -0.06303   -0.05720
       H                -0.05724    0.05970   -0.04503   -0.04165    0.01459    0.01724    0.08260   -0.01737   -0.05062
       H                -0.05290    0.01099   -0.04269   -0.02638   -0.00353   -0.00438    0.06120   -0.00125   -0.01830
       H                 0.01383   -0.00392   -0.00834    0.06186    0.03173   -0.00458   -0.03675   -0.04738   -0.01928
       H                 0.00697    0.04437   -0.00799    0.04296    0.04912    0.01594   -0.01609   -0.05691   -0.04470
       H                 0.00342   -0.00984   -0.01350    0.02902    0.00019   -0.02585    0.00058   -0.00316    0.00576
       H                 0.00092    0.06992   -0.01764    0.00158    0.02805    0.01366    0.03437   -0.03219   -0.04367
       H                 0.00162    0.03627   -0.01411   -0.00800   -0.00192   -0.01118    0.04644   -0.00076   -0.01187
       H                 0.10684    0.05005    0.00676    0.02690    0.00859   -0.01074   -0.06852   -0.02994    0.01861
       H                 0.11823    0.02166    0.08164    0.02669   -0.00378   -0.06168   -0.07781    0.00501    0.00125
       H                 0.05630    0.00077    0.05074    0.06990    0.00960   -0.03890   -0.06055   -0.00826    0.00848
       H                 0.00556   -0.10826    0.07934   -0.01029    0.02900   -0.03990    0.04540   -0.02207    0.03256
       H                -0.01773   -0.10926    0.05295    0.02958    0.00540   -0.00011    0.07387   -0.05658    0.05793
       H                 0.02861   -0.06040    0.07198   -0.03593   -0.01141    0.00181    0.03697   -0.01618    0.08670
       H                -0.02133   -0.01323   -0.05377    0.04349   -0.10214    0.09076    0.01877   -0.00339    0.03008
       H                -0.02604   -0.02480   -0.06516    0.09289   -0.02848    0.04491    0.04088    0.01627   -0.03392
       H                -0.01365    0.02117   -0.07377    0.03938   -0.07919    0.07382   -0.00325    0.04353   -0.01329
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在することを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、BH9データセットの3. Halogen atom transfer, No. 32の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- _J. Phys. Chem. A_ 2019, 123, 3761−3781 http://dx.doi.org/10.1021/acs.jpca.9b01546 (MOBH35のデータセットについて)

