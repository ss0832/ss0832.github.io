---
title:  【計算化学】自作pythonモジュールで遷移状態構造を求めてみる(DPPEが配位したPd触媒によるiodobenzenの還元的脱離, NNP使用）
published: 2025-08-11
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-08-11

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作モジュール(MultiOptPy)で、DPPE(1,2-Bis(diphenylphosphino)ethane)が配位したPd触媒によるiodobenzenの還元的脱離の遷移状態構造を算出してみる。以前の記事で反応を扱ったため、モデル系中の配位子の種類を変えた。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonモジュールである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

還元的脱離について：
- https://en.wikipedia.org/wiki/Reductive_elimination

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)

:::note

今回は反応に関わる系中のDPPE配位子のフェニル基の最安定な立体配座の探索は行わずに算出した。本来は、適当に１つ遷移状態構造を求めた後に、その構造のフェニル基を回転させることで立体配座探索を行うことで最安定な遷移状態構造を探す必要がある。

:::

## 使用した自作モジュールMultiOptPyのバージョン
```
v1.10c
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.10c.zip
unzip v1.10c.zip
cd MultiOptPy-v1.10c
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作モジュールへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.10c`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.10c`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。

:::important

モデルをダウンロードした時点(2025/8/9)で、`uma-s-1`のモデルが存在していたが、https://huggingface.co/facebook/UMA より、

” *Note uma-s-1 is now deprecated and will be removed by the next release. uma-s-1p1 should be used instead for a replacement.

とあり、今後のアップデートで削除されるため、使用しなかった。

:::

- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。



※自作モジュールでの具体的な使用の仕方に関しては、https://github.com/ss0832/MultiOptPy/blob/main/multioptpy/ase_calculation_tools.py を参照



## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`reductive_elimination_dppe_PhI.xyz`とした。
初期構造は以下のものを使用した。

```
65

Pd     1.181987662758     -0.609376649821     -0.084565896094
C      0.965640038859     -2.636699598086     -0.133162837703
C      0.856892690957     -3.304800980273     -1.352245171428
C      0.858373845704     -3.386452757697      1.036180683674
C      0.640853761885     -4.675435392396     -1.402100016218
H      0.936556682851     -2.752459147559     -2.282360387344
C      0.637315436323     -4.759388516863      0.991049807137
H      0.955103569639     -2.906578254711      2.003769986927
C      0.522107771601     -5.408936294628     -0.229185716498
H      0.559978141077     -5.172152732716     -2.361847895739
H      0.560509185309     -5.321849125308      1.914223585601
H      0.351149086318     -6.477580195054     -0.266409566583
P     -1.045122672076     -0.507475938325     -0.037107749391
P      1.121274514565      1.728277010634     -0.072658003633
C     -1.537053521793      1.202706482719     -0.508263170857
H     -1.375808066278      1.317573646190     -1.583044465468
H     -2.595711273815      1.371590969897     -0.302083511203
C     -0.639944278254      2.179236895194      0.255398209066
H     -0.844047171804      3.214255062724     -0.021292901328
H     -0.813917659038      2.084740879804      1.330118298342
C     -2.053107630778     -1.620312981781     -1.045324754568
C     -2.328626850277     -2.899260126821     -0.562955920773
C     -2.455407550189     -1.272962308377     -2.331931379253
C     -3.016731945763     -3.807014749651     -1.349439496211
H     -1.980889288548     -3.193541064630      0.419922992658
C     -3.143250989037     -2.186417256320     -3.118471155639
H     -2.229136108670     -0.295129023285     -2.737354835631
C     -3.427223662459     -3.451517553970     -2.627221274687
H     -3.216048468218     -4.800360634316     -0.969347701200
H     -3.452859932569     -1.908459274611     -4.117387736012
H     -3.960658332832     -4.164015354028     -3.243004780658
C     -1.717537183331     -0.657372124816      1.642944182030
C     -3.092710828269     -0.708660375371      1.868468742310
C     -0.844808551206     -0.658200329303      2.726587462561
C     -3.584762235921     -0.756382224988      3.162234394044
H     -3.778577682751     -0.726007592531      1.029200182257
C     -1.339352171689     -0.704101036170      4.023488992617
H      0.224900659365     -0.632681310178      2.546630085661
C     -2.707689252406     -0.752727987016      4.240424162900
H     -4.652578489541     -0.800833512056      3.332558186216
H     -0.653764859351     -0.711282311710      4.860749583970
H     -3.094790626006     -0.793143516511      5.250439593216
C      1.441422667648      2.505946470864     -1.681553336774
C      1.963935065680      1.733313647000     -2.713626693187
C      1.158919939555      3.854339865567     -1.906945888242
C      2.193639454324      2.300458229426     -3.961431067615
H      2.210432552742      0.694402283707     -2.527467070580
C      1.388136682456      4.417350151265     -3.150452128526
H      0.774399103693      4.471632409953     -1.102777387462
C      1.904059536439      3.637502506361     -4.179960171515
H      2.605731876525      1.694740239342     -4.757743589460
H      1.171017908118      5.464436228978     -3.317752773026
H      2.085291661590      4.079116043057     -5.151445546050
C      2.067202050650      2.703025166819      1.128599377096
C      3.188903983959      3.433375940076      0.747858895057
C      1.723677707588      2.634416603887      2.478401845349
C      3.938713694476      4.106966654096      1.701305155093
H      3.485113841212      3.469850102091     -0.292591292547
C      2.472094714554      3.310300132252      3.428029186075
H      0.875312124743      2.039104236836      2.797722644584
C      3.579900820196      4.051374941288      3.039270793142
H      4.809816299521      4.671640259685      1.395403316718
H      2.195267303171      3.251660338206      4.472748461330
H      4.168085346320      4.575809581329      3.780921549107
I      3.808399900496     -0.779574747370     -0.122137085640

```

<MoleculeViewer 
  xyzData={`65

Pd     1.181987662758     -0.609376649821     -0.084565896094
C      0.965640038859     -2.636699598086     -0.133162837703
C      0.856892690957     -3.304800980273     -1.352245171428
C      0.858373845704     -3.386452757697      1.036180683674
C      0.640853761885     -4.675435392396     -1.402100016218
H      0.936556682851     -2.752459147559     -2.282360387344
C      0.637315436323     -4.759388516863      0.991049807137
H      0.955103569639     -2.906578254711      2.003769986927
C      0.522107771601     -5.408936294628     -0.229185716498
H      0.559978141077     -5.172152732716     -2.361847895739
H      0.560509185309     -5.321849125308      1.914223585601
H      0.351149086318     -6.477580195054     -0.266409566583
P     -1.045122672076     -0.507475938325     -0.037107749391
P      1.121274514565      1.728277010634     -0.072658003633
C     -1.537053521793      1.202706482719     -0.508263170857
H     -1.375808066278      1.317573646190     -1.583044465468
H     -2.595711273815      1.371590969897     -0.302083511203
C     -0.639944278254      2.179236895194      0.255398209066
H     -0.844047171804      3.214255062724     -0.021292901328
H     -0.813917659038      2.084740879804      1.330118298342
C     -2.053107630778     -1.620312981781     -1.045324754568
C     -2.328626850277     -2.899260126821     -0.562955920773
C     -2.455407550189     -1.272962308377     -2.331931379253
C     -3.016731945763     -3.807014749651     -1.349439496211
H     -1.980889288548     -3.193541064630      0.419922992658
C     -3.143250989037     -2.186417256320     -3.118471155639
H     -2.229136108670     -0.295129023285     -2.737354835631
C     -3.427223662459     -3.451517553970     -2.627221274687
H     -3.216048468218     -4.800360634316     -0.969347701200
H     -3.452859932569     -1.908459274611     -4.117387736012
H     -3.960658332832     -4.164015354028     -3.243004780658
C     -1.717537183331     -0.657372124816      1.642944182030
C     -3.092710828269     -0.708660375371      1.868468742310
C     -0.844808551206     -0.658200329303      2.726587462561
C     -3.584762235921     -0.756382224988      3.162234394044
H     -3.778577682751     -0.726007592531      1.029200182257
C     -1.339352171689     -0.704101036170      4.023488992617
H      0.224900659365     -0.632681310178      2.546630085661
C     -2.707689252406     -0.752727987016      4.240424162900
H     -4.652578489541     -0.800833512056      3.332558186216
H     -0.653764859351     -0.711282311710      4.860749583970
H     -3.094790626006     -0.793143516511      5.250439593216
C      1.441422667648      2.505946470864     -1.681553336774
C      1.963935065680      1.733313647000     -2.713626693187
C      1.158919939555      3.854339865567     -1.906945888242
C      2.193639454324      2.300458229426     -3.961431067615
H      2.210432552742      0.694402283707     -2.527467070580
C      1.388136682456      4.417350151265     -3.150452128526
H      0.774399103693      4.471632409953     -1.102777387462
C      1.904059536439      3.637502506361     -4.179960171515
H      2.605731876525      1.694740239342     -4.757743589460
H      1.171017908118      5.464436228978     -3.317752773026
H      2.085291661590      4.079116043057     -5.151445546050
C      2.067202050650      2.703025166819      1.128599377096
C      3.188903983959      3.433375940076      0.747858895057
C      1.723677707588      2.634416603887      2.478401845349
C      3.938713694476      4.106966654096      1.701305155093
H      3.485113841212      3.469850102091     -0.292591292547
C      2.472094714554      3.310300132252      3.428029186075
H      0.875312124743      2.039104236836      2.797722644584
C      3.579900820196      4.051374941288      3.039270793142
H      4.809816299521      4.671640259685      1.395403316718
H      2.195267303171      3.251660338206      4.472748461330
H      4.168085346320      4.575809581329      3.780921549107
I      3.808399900496     -0.779574747370     -0.122137085640
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`reductive_elimination_dppe_PhI.xyz`として保存し、以下を実行する。
```
python .\optmain.py .\reductive_elimination_dppe_PhI.xyz -os uma-s-1p1 -opt rsirfo_fsb -ma 400 2 65
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。今回の系はiodobenzeneが還元的脱離の逆反応である酸化的付加が進行しやすいため、厳しい条件で反応をさせる場合の遷移状態構造を求める際に加える力(300kJ/mol)よりも大幅に大きな力をかけている。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。

これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`reductive_elimination_dppe_PhI_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.10c`ディレクトリに置く。

`reductive_elimination_dppe_PhI_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`reductive_elimination_dppe_PhI_traj.xyz`は次のNEB計算に使用する。

※`reductive_elimination_dppe_PhI_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`reductive_elimination_dppe_PhI_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）

```
65
OptimizedStructure
Pd     1.489006737329     -0.365996353507     -0.171250548577
C      1.731984693055     -3.907823755222      0.138988286046
C      1.681228071828     -4.822495768217     -0.910500001687
C      0.803899201084     -4.017495296643      1.174915723162
C      0.717256196418     -5.821428192579     -0.925481113381
H      2.390831532519     -4.746806345157     -1.724403897023
C     -0.155244549057     -5.017122419681      1.156870586626
H      0.819459178327     -3.300727574790      1.986173496665
C     -0.203891590730     -5.922536516139      0.105620397720
H      0.689728321609     -6.520327747576     -1.751659279356
H     -0.874011572601     -5.076782617320      1.963978751802
H     -0.957175909949     -6.699382518804      0.089636469865
P     -0.813175398423     -0.498308624163     -0.198482512284
P      1.367414899103      1.911123680249     -0.107869302868
C     -1.326590964251      1.248564621645     -0.533084325353
H     -1.212577252680      1.415280269428     -1.609103675223
H     -2.374012278352      1.417937057526     -0.272055204365
C     -0.430991287273      2.210653401437      0.250959567785
H     -0.702303071750      3.249061325031      0.050665465707
H     -0.568121530982      2.045801883429      1.323232271859
C     -1.971405585871     -1.476024488358     -1.221677830595
C     -1.649604356033     -2.818362369927     -1.419410291737
C     -3.132392267520     -0.972758554802     -1.803991694444
C     -2.483523612570     -3.647124828960     -2.153068984416
H     -0.731431009937     -3.210518856156     -0.996787636679
C     -3.961569856614     -1.798584196387     -2.551986092952
H     -3.399913707858      0.069244416832     -1.681885936753
C     -3.642988440616     -3.137671835808     -2.721858199665
H     -2.219664828214     -4.688644198871     -2.288239490874
H     -4.859561776317     -1.393887168822     -3.001181048046
H     -4.292136810686     -3.779459003838     -3.303766632794
C     -1.517057095732     -0.721343225326      1.483718641732
C     -2.887144011039     -0.791257606372      1.728395926862
C     -0.638698173438     -0.786405413986      2.562803916882
C     -3.367582386992     -0.919311569228      3.022804240152
H     -3.585190009715     -0.758674556222      0.899892636025
C     -1.116666045242     -0.913829727998      3.860756430923
H      0.430025486138     -0.740040563188      2.371424127036
C     -2.482630558204     -0.980257947379      4.092017047347
H     -4.434615338009     -0.974109569533      3.198201991488
H     -0.420952186619     -0.966308209845      4.688806388564
H     -2.858794466430     -1.083431396799      5.102004590539
C      1.558627227390      2.782010583742     -1.705448124504
C      2.189758917447      2.107009460700     -2.745445072651
C      1.079679978896      4.072808951454     -1.932826182395
C      2.343810711366      2.705563751009     -3.989829571744
H      2.556412534054      1.101805377313     -2.568224385458
C      1.228509089412      4.671245599229     -3.173537053206
H      0.598839058153      4.621879399025     -1.131309904765
C      1.861926601918      3.986780839584     -4.204551978870
H      2.836756363947      2.168230227441     -4.789793188584
H      0.852537329001      5.672824153418     -3.338706732199
H      1.978057445778      4.455047587737     -5.173666019474
C      2.123851693063      3.059949115201      1.100086934667
C      3.010691388689      4.073399800234      0.748350161385
C      1.857805418125      2.844379170709      2.453799260987
C      3.597218523407      4.868262053994      1.724976775420
H      3.249528685139      4.246423966094     -0.293319157553
C      2.433240960251      3.644232185660      3.427060145059
H      1.201872521616      2.033291595162      2.752325290144
C      3.304421542730      4.663199967091      3.064109763292
H      4.284479890706      5.652668386290      1.434441843905
H      2.206855131009      3.467757196440      4.471143226505
H      3.757834124350      5.287759702612      3.822959208746
I      3.038068475853     -2.478956708113      0.143281505577

```

<MoleculeViewer 
  xyzData={`65
OptimizedStructure
Pd     1.489006737329     -0.365996353507     -0.171250548577
C      1.731984693055     -3.907823755222      0.138988286046
C      1.681228071828     -4.822495768217     -0.910500001687
C      0.803899201084     -4.017495296643      1.174915723162
C      0.717256196418     -5.821428192579     -0.925481113381
H      2.390831532519     -4.746806345157     -1.724403897023
C     -0.155244549057     -5.017122419681      1.156870586626
H      0.819459178327     -3.300727574790      1.986173496665
C     -0.203891590730     -5.922536516139      0.105620397720
H      0.689728321609     -6.520327747576     -1.751659279356
H     -0.874011572601     -5.076782617320      1.963978751802
H     -0.957175909949     -6.699382518804      0.089636469865
P     -0.813175398423     -0.498308624163     -0.198482512284
P      1.367414899103      1.911123680249     -0.107869302868
C     -1.326590964251      1.248564621645     -0.533084325353
H     -1.212577252680      1.415280269428     -1.609103675223
H     -2.374012278352      1.417937057526     -0.272055204365
C     -0.430991287273      2.210653401437      0.250959567785
H     -0.702303071750      3.249061325031      0.050665465707
H     -0.568121530982      2.045801883429      1.323232271859
C     -1.971405585871     -1.476024488358     -1.221677830595
C     -1.649604356033     -2.818362369927     -1.419410291737
C     -3.132392267520     -0.972758554802     -1.803991694444
C     -2.483523612570     -3.647124828960     -2.153068984416
H     -0.731431009937     -3.210518856156     -0.996787636679
C     -3.961569856614     -1.798584196387     -2.551986092952
H     -3.399913707858      0.069244416832     -1.681885936753
C     -3.642988440616     -3.137671835808     -2.721858199665
H     -2.219664828214     -4.688644198871     -2.288239490874
H     -4.859561776317     -1.393887168822     -3.001181048046
H     -4.292136810686     -3.779459003838     -3.303766632794
C     -1.517057095732     -0.721343225326      1.483718641732
C     -2.887144011039     -0.791257606372      1.728395926862
C     -0.638698173438     -0.786405413986      2.562803916882
C     -3.367582386992     -0.919311569228      3.022804240152
H     -3.585190009715     -0.758674556222      0.899892636025
C     -1.116666045242     -0.913829727998      3.860756430923
H      0.430025486138     -0.740040563188      2.371424127036
C     -2.482630558204     -0.980257947379      4.092017047347
H     -4.434615338009     -0.974109569533      3.198201991488
H     -0.420952186619     -0.966308209845      4.688806388564
H     -2.858794466430     -1.083431396799      5.102004590539
C      1.558627227390      2.782010583742     -1.705448124504
C      2.189758917447      2.107009460700     -2.745445072651
C      1.079679978896      4.072808951454     -1.932826182395
C      2.343810711366      2.705563751009     -3.989829571744
H      2.556412534054      1.101805377313     -2.568224385458
C      1.228509089412      4.671245599229     -3.173537053206
H      0.598839058153      4.621879399025     -1.131309904765
C      1.861926601918      3.986780839584     -4.204551978870
H      2.836756363947      2.168230227441     -4.789793188584
H      0.852537329001      5.672824153418     -3.338706732199
H      1.978057445778      4.455047587737     -5.173666019474
C      2.123851693063      3.059949115201      1.100086934667
C      3.010691388689      4.073399800234      0.748350161385
C      1.857805418125      2.844379170709      2.453799260987
C      3.597218523407      4.868262053994      1.724976775420
H      3.249528685139      4.246423966094     -0.293319157553
C      2.433240960251      3.644232185660      3.427060145059
H      1.201872521616      2.033291595162      2.752325290144
C      3.304421542730      4.663199967091      3.064109763292
H      4.284479890706      5.652668386290      1.434441843905
H      2.206855131009      3.467757196440      4.471143226505
H      3.757834124350      5.287759702612      3.822959208746
I      3.038068475853     -2.478956708113      0.143281505577
`}
  caption="初期パスを求めるための構造最適化の結果（安定構造ではない）"
  backgroundColor="#333333"
/>



#### b. `reductive_elimination_dppe_PhI_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`reductive_elimination_dppe_PhI_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py reductive_elimination_dppe_PhI_traj.xyz -ns 20 -modelhess -spng -nd 0.3 -os uma-s-1p1
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.10c`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-2345.17482481815,-2345.17482481815,-2345.1573869666227,-2345.1286039519805,-2345.121884450263,-2345.114448800764,-2345.1084046172227,-2345.1011233842414,-2345.0939063220826,-2345.086612296993,-2345.081739450007,-2345.0836468760144,-2345.074294618227,-2345.081318852496,-2345.0887860091334,-2345.0924885008767,-2345.0915717097528,-2345.09379834267,-2345.0967720347103,-2345.0989552095066,-2345.101039902592,-2345.1024447564555,-2345.1040224614912,-2345.1051519520815,-2345.1061286032627,-2345.1073612718437,-2345.1082034131305,-2345.1090951106944,-2345.109729809546,-2345.1103416578367,-2345.1109925833903,-2345.1116937661577,-2345.1122123196756,-2345.1126316905456,-2345.112896119195,-2345.1131362954084,-2345.1133171372676,-2345.113410046525,-2345.1134497195844,-2345.1136407250365,-2345.1137571156987,-2345.113866496986,-2345.113928109387,-2345.1139618945713,-2345.114022560707,-2345.114056451032,-2345.114134991072,-2345.1141688113034,-2345.114233823251,-2345.1143368610547,-2345.114364127521,-2345.1144302259218,-2345.114521487976,-2345.1145948410795,-2345.1146745376664,-2345.114727703771,-2345.1147932764684,-2345.114849316417];

export const dataset2 = [-2345.17504554335,-2345.1749453443426,-2345.1745353660344,-2345.1739755273015,-2345.1727830925292,-2345.16888213035,-2345.163834084051,-2345.1575070021595,-2345.150572347695,-2345.1382738395682,-2345.127128268389,-2345.108587702082,-2345.0992243344363,-2345.10287741009,-2345.106670497997,-2345.108060982643,-2345.107521190721,-2345.109983618993,-2345.111239453556,-2345.1129101729903,-2345.113966135243,-2345.114856851494,-2345.115946213416,-2345.117089126958,-2345.1181996922373,-2345.1190381185556,-2345.119855096188,-2345.1199965103165,-2345.120657459275,-2345.1217200804335,-2345.122129533039,-2345.122527034661,-2345.1228608561164,-2345.1229495247026,-2345.1234187672712,-2345.123580158117,-2345.1237450886965,-2345.1238419582505,-2345.123969388677,-2345.124064611028,-2345.1241313402725,-2345.1241895881735,-2345.1242460136377,-2345.124306925101,-2345.1243677664706,-2345.124412240951,-2345.124516049786,-2345.1245873351236,-2345.1246596017736,-2345.124711541238,-2345.124810057995,-2345.124876051255,-2345.1249360865468,-2345.124998505026,-2345.12503453321,-2345.1251195919685,-2345.1251553748248,-2345.125538191807
];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [4.988259358528349e-05,4.9882617158168104e-05,0.007136199945694972,0.009666853465365369,0.007912105454598578,0.007792814013356812,0.007369137205373194,0.007426952160461162,0.007457752198669368,0.007537281454254542,0.007761785136214266,0.006754615356862658,0.009911376161552946,0.008791470875364494,0.007131685608919553,0.006670732610634343,0.0071539187040599445,0.00740445085431999,0.007574085892295951,0.0074239628684609855,0.007383421137075318,0.007487162872134709,0.007353053521746661,0.007466195872649633,0.0074435192964369306,0.007425025654114281,0.0074149198287014285,0.0074144039015466975,0.007393231926568241,0.0074471091124027845,0.0074608904076831585,0.0073763993365040725,0.00738322437149111,0.007391810776473466,0.007401981146326155,0.007388227135954246,0.0073894573742332515,0.0074173473665127415,0.007445195614014205,0.0074151699795455914,0.007408747448081278,0.0074076680172714396,0.007403477623332323,0.007416244190439876,0.007411382657152712,0.007421441961960825,0.007419608567606068,0.007425143923427266,0.00741998952684985,0.007415260116792936,0.007443750291325068,0.0074195620847236545,0.007412303545531358,0.007417935974714438,0.007404829417709176,0.007408984319957443,0.0074078047030931805,0.007409483914419177];

export const dataset2_grad = [6.572816737119612e-05,4.0632111925672086e-05,0.0003592901337001003,0.0005873807837731331,0.0009278779676138745,0.0018063898067668357,0.002012566130927929,0.002917195168255493,0.0035109519042440447,0.004502418727664975,0.004639239448151082,0.003593102941289159,0.0006462672320901009,0.0011315588473549184,0.000917182175704602,0.0007701068364852806,0.0008376941272809591,0.0007374737505326851,0.0006793333910470947,0.0004947640464308102,0.0008862288546452089,0.0013254144085517946,0.0019001073218893518,0.0012855338320782424,0.0015652501122945537,0.0012582631198685432,0.0014468507006671237,0.002107542498433443,0.0018973155192451008,0.0011050162726135085,0.0012543755349276565,0.0011416810661787063,0.0009693119843244952,0.001067849166400684,0.0005650832745530747,0.0004674823434671965,0.0002792429469428633,0.000187427249723541,0.00010995909187304728,8.808674688179165e-05,9.679164872703294e-05,0.00010211246134195501,0.00010211434985966558,0.00020155155772314456,9.918667942836444e-05,0.000238842387612449,9.700427927209305e-05,0.0001312615084383841,0.00011050227092208202,0.0001799494704364569,9.822556661495246e-05,0.00010101092368739762,0.00010019985416639886,0.0001384674547102424,0.0002507475969553226,0.00010319477867062978,0.0001323928348272047,0.00011566237082320856];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

私が実行した環境では、12番のノード(グラフでは13番)がエネルギー極大値を示していた。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`reductive_elimination_dppe_PhI_traj_12.xyz`
```
65
0 1
Pd      1.225341428951     -0.566768260638     -0.104039967828
C       1.836530357885     -3.029654574390     -0.177671739818
C       1.410795014191     -3.552662674259     -1.397509075790
C       1.462350935286     -3.629001376699      1.022255941156
C       0.590683795119     -4.667797759178     -1.403535141310
H       1.721134810197     -3.091957679102     -2.326287289497
C       0.640211259543     -4.744824046117      0.993171591401
H       1.812325339322     -3.223093770953      1.962902419966
C       0.213983231191     -5.284206098716     -0.214783310087
H       0.258668287426     -5.067971847792     -2.352870564745
H       0.356080487122     -5.206726092929      1.930108628613
H      -0.392283958126     -6.181846107939     -0.232866677309
P      -1.081248781201     -0.565190988342     -0.033552725158
P       1.175874902349      1.786424652013     -0.065898079382
C      -1.523311940964      1.169440728717     -0.494539948139
H      -1.369126018409      1.268694177855     -1.572416830742
H      -2.575352529942      1.377556240534     -0.284986788661
C      -0.611213867246      2.153891791834      0.249774218094
H      -0.840552802816      3.183410850287     -0.032212601338
H      -0.771349426890      2.069602167715      1.327776285449
C      -2.164507666573     -1.619066536925     -1.044160913944
C      -2.392155196797     -2.918388478146     -0.588204504389
C      -2.606677949609     -1.268295657860     -2.318242594823
C      -3.047572935346     -3.843128070295     -1.381809829404
H      -2.028760935062     -3.208723774302      0.391278319402
C      -3.255689626574     -2.201080267671     -3.118493153583
H      -2.440845067580     -0.269865500794     -2.703780848193
C      -3.476041422474     -3.489395873229     -2.655210290583
H      -3.211787364294     -4.846384904089     -1.009151127116
H      -3.591412023905     -1.918287460237     -4.108437989252
H      -3.973403605962     -4.217010745393     -3.284039862714
C      -1.817098219268     -0.664376475837      1.638182262056
C      -3.188738416538     -0.699055153278      1.888904259334
C      -0.934303036882     -0.667015478847      2.715049159906
C      -3.661061556628     -0.743900910159      3.192572420221
H      -3.892053616287     -0.703369655822      1.063264655654
C      -1.404987068280     -0.697728493818      4.021179675776
H       0.131541716238     -0.651543256965      2.508726017045
C      -2.770117162858     -0.743056257161      4.260178510392
H      -4.727147069045     -0.781395671455      3.382639269141
H      -0.702253677412     -0.699685550244      4.845407613692
H      -3.140686405114     -0.785178075833      5.276662963643
C       1.447536659451      2.609135139008     -1.674480078180
C       1.954386179796      1.821353309267     -2.703815104411
C       1.160747135832      3.950898390844     -1.929037538420
C       2.178965141633      2.356697959110     -3.965773915337
H       2.171483082751      0.779067768329     -2.497226815900
C       1.384387782813      4.487633334160     -3.187345661616
H       0.774157780263      4.589894030850     -1.142190179087
C       1.896081570300      3.691225289639     -4.206427029638
H       2.576897571319      1.729158914473     -4.753514596192
H       1.163794946918      5.530607097579     -3.379617754834
H       2.075368411396      4.115338308898     -5.186300543748
C       2.036403811585      2.859082523612      1.135626331296
C       3.157827502257      3.606587150970      0.778351095463
C       1.701876514006      2.764760915607      2.488329720922
C       3.924903420618      4.238516914639      1.747419497356
H       3.443793096111      3.688417110499     -0.263097090320
C       2.462595474511      3.405186273684      3.453980208606
H       0.851724620058      2.168352175090      2.800659940038
C       3.582981162058      4.138732439703      3.087748868672
H       4.799013034251      4.805671608905      1.452714094477
H       2.187474258921      3.320310183749      4.497766357961
H       4.191048398824      4.620472802350      3.843784159385
I       3.632770227591     -1.838486724506     -0.162886323628


```


<MoleculeViewer 
  xyzData={`65
0 1
Pd      1.225341428951     -0.566768260638     -0.104039967828
C       1.836530357885     -3.029654574390     -0.177671739818
C       1.410795014191     -3.552662674259     -1.397509075790
C       1.462350935286     -3.629001376699      1.022255941156
C       0.590683795119     -4.667797759178     -1.403535141310
H       1.721134810197     -3.091957679102     -2.326287289497
C       0.640211259543     -4.744824046117      0.993171591401
H       1.812325339322     -3.223093770953      1.962902419966
C       0.213983231191     -5.284206098716     -0.214783310087
H       0.258668287426     -5.067971847792     -2.352870564745
H       0.356080487122     -5.206726092929      1.930108628613
H      -0.392283958126     -6.181846107939     -0.232866677309
P      -1.081248781201     -0.565190988342     -0.033552725158
P       1.175874902349      1.786424652013     -0.065898079382
C      -1.523311940964      1.169440728717     -0.494539948139
H      -1.369126018409      1.268694177855     -1.572416830742
H      -2.575352529942      1.377556240534     -0.284986788661
C      -0.611213867246      2.153891791834      0.249774218094
H      -0.840552802816      3.183410850287     -0.032212601338
H      -0.771349426890      2.069602167715      1.327776285449
C      -2.164507666573     -1.619066536925     -1.044160913944
C      -2.392155196797     -2.918388478146     -0.588204504389
C      -2.606677949609     -1.268295657860     -2.318242594823
C      -3.047572935346     -3.843128070295     -1.381809829404
H      -2.028760935062     -3.208723774302      0.391278319402
C      -3.255689626574     -2.201080267671     -3.118493153583
H      -2.440845067580     -0.269865500794     -2.703780848193
C      -3.476041422474     -3.489395873229     -2.655210290583
H      -3.211787364294     -4.846384904089     -1.009151127116
H      -3.591412023905     -1.918287460237     -4.108437989252
H      -3.973403605962     -4.217010745393     -3.284039862714
C      -1.817098219268     -0.664376475837      1.638182262056
C      -3.188738416538     -0.699055153278      1.888904259334
C      -0.934303036882     -0.667015478847      2.715049159906
C      -3.661061556628     -0.743900910159      3.192572420221
H      -3.892053616287     -0.703369655822      1.063264655654
C      -1.404987068280     -0.697728493818      4.021179675776
H       0.131541716238     -0.651543256965      2.508726017045
C      -2.770117162858     -0.743056257161      4.260178510392
H      -4.727147069045     -0.781395671455      3.382639269141
H      -0.702253677412     -0.699685550244      4.845407613692
H      -3.140686405114     -0.785178075833      5.276662963643
C       1.447536659451      2.609135139008     -1.674480078180
C       1.954386179796      1.821353309267     -2.703815104411
C       1.160747135832      3.950898390844     -1.929037538420
C       2.178965141633      2.356697959110     -3.965773915337
H       2.171483082751      0.779067768329     -2.497226815900
C       1.384387782813      4.487633334160     -3.187345661616
H       0.774157780263      4.589894030850     -1.142190179087
C       1.896081570300      3.691225289639     -4.206427029638
H       2.576897571319      1.729158914473     -4.753514596192
H       1.163794946918      5.530607097579     -3.379617754834
H       2.075368411396      4.115338308898     -5.186300543748
C       2.036403811585      2.859082523612      1.135626331296
C       3.157827502257      3.606587150970      0.778351095463
C       1.701876514006      2.764760915607      2.488329720922
C       3.924903420618      4.238516914639      1.747419497356
H       3.443793096111      3.688417110499     -0.263097090320
C       2.462595474511      3.405186273684      3.453980208606
H       0.851724620058      2.168352175090      2.800659940038
C       3.582981162058      4.138732439703      3.087748868672
H       4.799013034251      4.805671608905      1.452714094477
H       2.187474258921      3.320310183749      4.497766357961
H       4.191048398824      4.620472802350      3.843784159385
I       3.632770227591     -1.838486724506     -0.162886323628
`}
  caption="NEB法により緩和したパスのエネルギー極大値を示す構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`reductive_elimination_dppe_PhI_traj_12.xyz`を`MultiOptPy-v1.10c`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py reductive_elimination_dppe_PhI_traj_12.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1 
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造を以下に示す。


(実行して得られた正確な遷移状態構造は`reductive_elimination_dppe_PhI_traj_12_optimized.xyz`として保存されている。)

```
65
OptimizedStructure
Pd     1.178675493746     -0.798118518469     -0.553111803570
C      1.686139549617     -2.807581212503     -0.345937916523
C      0.698639702931     -3.807790426724     -0.314626573163
C      2.538725376394     -2.600839379134      0.742482957104
C      0.516668401665     -4.520102465500      0.846945626403
H      0.071688526594     -3.980791452807     -1.179380628925
C      2.306351639461     -3.324588291377      1.920330647496
H      3.397167209201     -1.950501898633      0.656296436498
C      1.310016842569     -4.274739090191      1.977670282688
H     -0.260655245279     -5.273364507022      0.888471917779
H      2.950177712687     -3.155818739104      2.775003617554
H      1.153349609169     -4.847614822038      2.882214125857
P     -1.170150967021     -0.714808817953     -0.391942924534
P      1.151357417211      1.541725286808     -0.302864502972
C     -1.562643053263      1.057127531386     -0.731784526809
H     -1.411949915452      1.225281124277     -1.801960528951
H     -2.606477774988      1.286236824456     -0.507638556962
C     -0.616666073908      1.939080220870      0.086533406395
H     -0.824228736000      2.998383835796     -0.073607145310
H     -0.757663029819      1.741109462522      1.152885653079
C     -2.332599011404     -1.607735261197     -1.474613262937
C     -3.258278130654     -2.538339129002     -1.009534536667
C     -2.192877767830     -1.427896863114     -2.852725124838
C     -4.047373006014     -3.251817791736     -1.902725282937
H     -3.364255584412     -2.711935883471      0.053771830334
C     -2.988332146895     -2.131097996704     -3.741600381488
H     -1.439337162873     -0.746094892626     -3.233069360158
C     -3.921145414282     -3.044952880050     -3.267480420405
H     -4.763713016658     -3.971463260559     -1.527087027669
H     -2.872000413483     -1.976012429733     -4.806547451304
H     -4.538871194324     -3.600131045402     -3.961402411225
C     -1.860473452533     -0.918297944855      1.284423117615
C     -3.153385229575     -0.521306240580      1.628968300051
C     -1.035050025441     -1.460135686744      2.265015464155
C     -3.608159820611     -0.661240519164      2.929896948407
H     -3.813148414609     -0.109840887254      0.873382313331
C     -1.491433998402     -1.605534966351      3.569718470952
H     -0.029688526124     -1.766706271652      1.997470964122
C     -2.775486086244     -1.204383541381      3.902475413840
H     -4.612333559954     -0.349839522118      3.187986587678
H     -0.840551766532     -2.032387361909      4.322262556929
H     -3.132508248914     -1.313796919503      4.918643405033
C      1.455830713826      2.589619505779     -1.765675623622
C      2.040574004961      2.000127412348     -2.881910253094
C      1.106255890180      3.940126888155     -1.817232620994
C      2.273439521089      2.744504442684     -4.032283900133
H      2.307841439402      0.949912433669     -2.842761772331
C      1.337185897261      4.683168306927     -2.962784478048
H      0.663032927491      4.419120376772     -0.951695760354
C      1.921080765387      4.083748162841     -4.073342781013
H      2.728318555581      2.274684151082     -4.894743816903
H      1.064300629258      5.730330747548     -2.991797798586
H      2.099940376482      4.664775156972     -4.969061059858
C      2.013756566800      2.392426935048      1.063121047621
C      2.957665923566      3.397627626401      0.877638890919
C      1.760309448337      1.935522242420      2.358387433896
C      3.617937891594      3.951178836074      1.967553453612
H      3.185486872817      3.750699521419     -0.119821486374
C      2.411298332876      2.495447550747      3.444756380982
H      1.057458159158      1.123087026381      2.515546551749
C      3.342211713385      3.508451270093      3.251422452702
H      4.350739201794      4.732015410423      1.808605811385
H      2.199090098421      2.134967994537      4.443238248200
H      3.855884856785      3.943435994503      4.098961554232
I      2.572839505802     -2.226315362382     -2.409330149942
```

<MoleculeViewer 
  xyzData={`65
OptimizedStructure
Pd     1.178675493746     -0.798118518469     -0.553111803570
C      1.686139549617     -2.807581212503     -0.345937916523
C      0.698639702931     -3.807790426724     -0.314626573163
C      2.538725376394     -2.600839379134      0.742482957104
C      0.516668401665     -4.520102465500      0.846945626403
H      0.071688526594     -3.980791452807     -1.179380628925
C      2.306351639461     -3.324588291377      1.920330647496
H      3.397167209201     -1.950501898633      0.656296436498
C      1.310016842569     -4.274739090191      1.977670282688
H     -0.260655245279     -5.273364507022      0.888471917779
H      2.950177712687     -3.155818739104      2.775003617554
H      1.153349609169     -4.847614822038      2.882214125857
P     -1.170150967021     -0.714808817953     -0.391942924534
P      1.151357417211      1.541725286808     -0.302864502972
C     -1.562643053263      1.057127531386     -0.731784526809
H     -1.411949915452      1.225281124277     -1.801960528951
H     -2.606477774988      1.286236824456     -0.507638556962
C     -0.616666073908      1.939080220870      0.086533406395
H     -0.824228736000      2.998383835796     -0.073607145310
H     -0.757663029819      1.741109462522      1.152885653079
C     -2.332599011404     -1.607735261197     -1.474613262937
C     -3.258278130654     -2.538339129002     -1.009534536667
C     -2.192877767830     -1.427896863114     -2.852725124838
C     -4.047373006014     -3.251817791736     -1.902725282937
H     -3.364255584412     -2.711935883471      0.053771830334
C     -2.988332146895     -2.131097996704     -3.741600381488
H     -1.439337162873     -0.746094892626     -3.233069360158
C     -3.921145414282     -3.044952880050     -3.267480420405
H     -4.763713016658     -3.971463260559     -1.527087027669
H     -2.872000413483     -1.976012429733     -4.806547451304
H     -4.538871194324     -3.600131045402     -3.961402411225
C     -1.860473452533     -0.918297944855      1.284423117615
C     -3.153385229575     -0.521306240580      1.628968300051
C     -1.035050025441     -1.460135686744      2.265015464155
C     -3.608159820611     -0.661240519164      2.929896948407
H     -3.813148414609     -0.109840887254      0.873382313331
C     -1.491433998402     -1.605534966351      3.569718470952
H     -0.029688526124     -1.766706271652      1.997470964122
C     -2.775486086244     -1.204383541381      3.902475413840
H     -4.612333559954     -0.349839522118      3.187986587678
H     -0.840551766532     -2.032387361909      4.322262556929
H     -3.132508248914     -1.313796919503      4.918643405033
C      1.455830713826      2.589619505779     -1.765675623622
C      2.040574004961      2.000127412348     -2.881910253094
C      1.106255890180      3.940126888155     -1.817232620994
C      2.273439521089      2.744504442684     -4.032283900133
H      2.307841439402      0.949912433669     -2.842761772331
C      1.337185897261      4.683168306927     -2.962784478048
H      0.663032927491      4.419120376772     -0.951695760354
C      1.921080765387      4.083748162841     -4.073342781013
H      2.728318555581      2.274684151082     -4.894743816903
H      1.064300629258      5.730330747548     -2.991797798586
H      2.099940376482      4.664775156972     -4.969061059858
C      2.013756566800      2.392426935048      1.063121047621
C      2.957665923566      3.397627626401      0.877638890919
C      1.760309448337      1.935522242420      2.358387433896
C      3.617937891594      3.951178836074      1.967553453612
H      3.185486872817      3.750699521419     -0.119821486374
C      2.411298332876      2.495447550747      3.444756380982
H      1.057458159158      1.123087026381      2.515546551749
C      3.342211713385      3.508451270093      3.251422452702
H      4.350739201794      4.732015410423      1.808605811385
H      2.199090098421      2.134967994537      4.443238248200
H      3.855884856785      3.943435994503      4.098961554232
I      2.572839505802     -2.226315362382     -2.409330149942
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>



260回程度の反復計算で遷移状態構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -197.5993             14.6693             21.1927
Reduced mass [au]                   8.0735              4.3127              7.5121
Force const [Dyne/A]               -0.1857              0.0005              0.0020
Char temp [K]                       0.0000             21.1059             30.4916
Normal mode                   x         y         z            x         y         z            x         y         z   
      Pd                 0.01129   -0.01148   -0.01926   -0.00037    0.00197   -0.01199    0.00787    0.00718    0.01171
       C                -0.12014    0.04873    0.11459   -0.00662    0.00086   -0.00195   -0.01871    0.00188   -0.00332
       C                -0.06874    0.01386    0.06831   -0.01281    0.00675   -0.01169   -0.03144    0.01455    0.01005
       C                -0.05241   -0.00777    0.06634   -0.01737   -0.00333    0.00721    0.00155   -0.01137   -0.01665
       C                -0.00600   -0.04888    0.04323   -0.02997    0.00915   -0.01282   -0.02336    0.01598    0.01197
       H                -0.09913    0.04911    0.08326   -0.00451    0.00971   -0.01830   -0.04723    0.02423    0.01948
       C                 0.00311   -0.05361    0.03934   -0.03328   -0.00195    0.00483    0.00880   -0.00910   -0.01360
       H                -0.08108    0.03088    0.05895   -0.01393   -0.00665    0.01634    0.01021   -0.02453   -0.02957
       C                 0.01043   -0.06804    0.03057   -0.04011    0.00461   -0.00483   -0.00349    0.00479    0.00066
       H                 0.01876   -0.07525    0.03433   -0.03522    0.01412   -0.02048   -0.03269    0.02614    0.02291
       H                 0.02744   -0.08237    0.02683   -0.04106   -0.00542    0.01140    0.02412   -0.01902   -0.02317
       H                 0.04228   -0.10202    0.01438   -0.05331    0.00628   -0.00607    0.00206    0.00640    0.00263
       P                 0.00298    0.00180    0.00963   -0.00093    0.00313   -0.01521    0.01022    0.00889    0.01220
       P                -0.00727    0.00956   -0.01070   -0.00072    0.00031   -0.00445    0.01180    0.00784    0.00825
       C                 0.00221   -0.00231   -0.00153   -0.00176    0.00426   -0.00910    0.00844    0.00799    0.01247
       H                 0.00510   -0.00685   -0.00178   -0.00306    0.01192   -0.00788    0.00538    0.00896    0.01227
       H                 0.00025   -0.00717   -0.00646   -0.00149    0.00183   -0.00507    0.00932    0.00828    0.01647
       C                -0.00360    0.00250   -0.00172   -0.00111    0.00078   -0.00589    0.01168    0.00737    0.00986
       H                -0.00683    0.00174   -0.00152    0.00057    0.00142   -0.00403    0.01064    0.00742    0.01185
       H                -0.00034    0.00147   -0.00160   -0.00313   -0.00146   -0.00665    0.01519    0.00682    0.01033
       C                 0.01507   -0.00638    0.00201   -0.01291   -0.00001    0.00071    0.02737   -0.00167    0.00375
       C                 0.01017   -0.00136    0.00323    0.06210   -0.06727    0.01682    0.06275   -0.03991   -0.00180
       C                 0.01178   -0.00317    0.00226   -0.09439    0.05369   -0.00033    0.01319    0.01908    0.00504
       C                 0.00427    0.00417    0.00394    0.05571   -0.08127    0.03412    0.08340   -0.05801   -0.00540
       H                 0.01161   -0.00260    0.00307    0.12558   -0.10703    0.01682    0.07487   -0.05546   -0.00304
       C                 0.00580    0.00167    0.00320   -0.10080    0.03831    0.01734    0.03319    0.00074    0.00159
       H                 0.01422   -0.00698    0.00075   -0.15442    0.10923   -0.01872   -0.01305    0.04933    0.00770
       C                 0.00289    0.00528    0.00395   -0.02563   -0.02936    0.03434    0.06870   -0.03822   -0.00381
       H                 0.00184    0.00711    0.00467    0.11443   -0.13282    0.04731    0.11116   -0.08778   -0.00953
       H                 0.00466    0.00242    0.00331   -0.16454    0.08095    0.01658    0.02177    0.01705    0.00271
       H                -0.00068    0.00870    0.00440   -0.03069   -0.04017    0.04753    0.08493   -0.05258   -0.00675
       C                 0.00216   -0.00164    0.00517    0.00690    0.00577   -0.01150   -0.00135   -0.00036    0.00587
       C                 0.00181    0.00014    0.00221   -0.00451   -0.02457   -0.01938   -0.01232   -0.02370   -0.00855
       C                 0.00099   -0.00482    0.00425    0.02029    0.04205   -0.00310   -0.00263    0.01262    0.01409
       C                 0.00057    0.00049    0.00147   -0.00196   -0.01685   -0.01784   -0.02461   -0.03360   -0.01399
       H                 0.00337    0.00094    0.00135   -0.01477   -0.05560   -0.02743   -0.01095   -0.03533   -0.01615
       C                -0.00103   -0.00350    0.00351    0.02319    0.05056   -0.00095   -0.01480    0.00329    0.00886
       H                -0.00002   -0.01040    0.00604    0.02771    0.06234    0.00131    0.00513    0.02870    0.02408
       C                -0.00042   -0.00059    0.00186    0.01223    0.02133   -0.00841   -0.02575   -0.02000   -0.00533
       H                 0.00078    0.00151    0.00078   -0.01091   -0.04088   -0.02368   -0.03321   -0.05232   -0.02493
       H                -0.00315   -0.00618    0.00357    0.03354    0.07876    0.00611   -0.01611    0.01350    0.01575
       H                -0.00142   -0.00011    0.00151    0.01412    0.02721   -0.00711   -0.03540   -0.02804   -0.00959
       C                -0.00158    0.00573   -0.00569    0.00278    0.00634    0.00073    0.01445    0.00215    0.00465
       C                -0.00070    0.00150   -0.00312   -0.00477    0.00856   -0.00437    0.04102    0.00247    0.01827
       C                -0.00048    0.00580   -0.00450    0.01163    0.00898    0.00958   -0.00249   -0.00285   -0.01038
       C                 0.00091    0.00169   -0.00267   -0.00352    0.01353   -0.00095    0.05128   -0.00205    0.01753
       H                -0.00250    0.00062   -0.00430   -0.01151    0.00655   -0.01094    0.05331    0.00602    0.02927
       C                 0.00094    0.00423   -0.00456    0.01318    0.01394    0.01314    0.00685   -0.00752   -0.01163
       H                -0.00089    0.00597   -0.00473    0.01749    0.00681    0.01381   -0.02283   -0.00231   -0.02118
       C                 0.00154    0.00177   -0.00317    0.00559    0.01620    0.00789    0.03408   -0.00700    0.00250
       H                 0.00114    0.00070   -0.00185   -0.00948    0.01540   -0.00510    0.07226   -0.00185    0.02850
       H                 0.00182    0.00435   -0.00633    0.02035    0.01600    0.01995   -0.00677   -0.01139   -0.02329
       H                 0.00253    0.00089   -0.00353    0.00685    0.02010    0.01068    0.04166   -0.01059    0.00168
       C                 0.00190   -0.00853   -0.00449   -0.00178   -0.00696    0.00071    0.00957    0.01477    0.00568
       C                -0.00000   -0.00615   -0.00417    0.00814   -0.01541    0.00518   -0.00797    0.03100    0.00471
       C                 0.00011   -0.00698   -0.00434   -0.01097   -0.00552   -0.00057    0.02159    0.00754    0.00545
       C                -0.00293   -0.00340   -0.00383    0.00889   -0.02216    0.00811   -0.01342    0.03943    0.00380
       H                 0.00014   -0.00623   -0.00408    0.01526   -0.01679    0.00630   -0.01733    0.03730    0.00484
       C                -0.00161   -0.00455   -0.00400   -0.01004   -0.01223    0.00235    0.01592    0.01581    0.00457
       H                -0.00097   -0.00568   -0.00280   -0.01903    0.00092   -0.00346    0.03518   -0.00425    0.00545
       C                -0.00344   -0.00308   -0.00376   -0.00008   -0.02057    0.00675   -0.00163    0.03181    0.00367
       H                -0.00456   -0.00201   -0.00391    0.01656   -0.02866    0.01149   -0.02699    0.05202    0.00313
       H                -0.00242   -0.00383   -0.00400   -0.01732   -0.01096    0.00127    0.02543    0.00996    0.00447
       H                -0.00541   -0.00132   -0.00351    0.00053   -0.02580    0.00905   -0.00593    0.03834    0.00292
       I                 0.00983    0.02139   -0.01813    0.01964   -0.00229    0.00894   -0.04579   -0.00762   -0.02096

(...snip...)
```
その結果、虚振動が１つであることが確認できた。

次に、`vibration_animation`内の`mode_1_198i_wave_number.xyz`をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。



## 終わりに
　
　自作モジュールで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、DPPEが配位したPd触媒によるiodobenzenの還元的脱離のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作モジュールMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
