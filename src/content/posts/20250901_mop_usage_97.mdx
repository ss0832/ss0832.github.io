---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応1, NNP使用）
published: 2025-09-01
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-09-01

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

移動挿入反応について：
- https://en.wikipedia.org/wiki/Migratory_insertion
- https://chem.libretexts.org/Bookshelves/Inorganic_Chemistry/Organometallic_Chemistry_(Evans)/04%3A_Fundamentals_of_Organometallic_Chemistry/4.05%3A_Migratory_Insertion-_12-Insertions

今回参考にした論文
- _Org. Lett._ 2025, 27, 2005-2010 (論文中の計算に使用している系の基質の置換基を変えて計算を行った。)

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)

:::note

今回は反応に関わる系中のDPPBZ配位子のフェニル基の最安定な立体配座の探索は行わずに算出した。本来は、適当に１つ遷移状態構造を求めた後に、その構造のフェニル基を回転させることで立体配座探索を行うことで最安定な遷移状態構造を探す必要がある。

:::

## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.15.1b
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.15.1b.zip
unzip v1.15.1b.zip
cd MultiOptPy-v1.15.1b
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.15.1b`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.15.1b`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`migratory_insertion_CuH_Cy_dppbz.xyz`とした。
初期構造は以下のものを使用した。

```
84

Cu     1.256574226331      0.069264373106     -0.659343278198
H      2.068658955955      1.368589396284     -0.292644281536
P      1.560277492229     -1.281374476167      1.145355405814
P     -0.612723160875      0.824395329071      0.732303185988
C      0.252967034596      0.832725514541      2.346098057329
C     -0.010769488742      1.744747982634      3.362761395653
C      1.241729380314     -0.142094670051      2.536048342200
C      0.692120250415      1.687372420816      4.557509342452
H     -0.755341409511      2.517440244816      3.212788263475
C      1.942777525074     -0.193307099817      3.735715067273
C      1.668123876563      0.719168681177      4.744092995645
H      0.483711018983      2.406099720111      5.339712821129
H      2.715266554969     -0.939297244288      3.876961034819
H      2.223574058108      0.679511250927      5.672277191114
C      0.794382462423     -0.981555585799     -2.368549230311
H     -0.200857733223     -1.403553572528     -2.282982669079
C      0.999636203367      0.336353104438     -2.706793347261
H      1.978584961034      0.635717787212     -3.065753868518
Se     2.218820055631     -2.248447527122     -2.552397700285
C      1.838712044100     -2.683622928535     -4.420447081239
F      2.698794245085     -3.623077018602     -4.841532182429
F      0.594939838728     -3.161221712158     -4.597802411700
F      1.959214122623     -1.625577975283     -5.235874023469
C     -1.220902768089      2.535005368667      0.582230568712
C     -2.565405473645      2.840370122560      0.390761176206
C     -0.278107508911      3.565770211718      0.569736137618
C     -2.964464556646      4.158367887730      0.202923999459
H     -3.307065786960      2.051414223814      0.391712781568
C     -0.680893186703      4.878420306924      0.389086310019
H      0.772618048636      3.326825111320      0.693485571436
C     -2.025754831000      5.177900219154      0.205939789825
H     -4.012868806806      4.384696482474      0.055880470136
H      0.057551844088      5.670077790061      0.384284874955
H     -2.338158136801      6.204098667497      0.060841703430
C     -2.121185823405     -0.137882528234      1.118573158732
C     -2.515247821514     -1.104349095662      0.198499070553
C     -2.857316461866      0.018267687241      2.292322520579
C     -3.627859060355     -1.899802608553      0.438570149224
H     -1.932943172294     -1.245140649990     -0.704935468506
C     -3.967622180282     -0.774159151317      2.534801350760
H     -2.557514093058      0.759257204888      3.023590993789
C     -4.354068653932     -1.734548136424      1.607084376524
H     -3.917588321965     -2.653854553370     -0.281903223678
H     -4.532758786500     -0.645729052788      3.449202554587
H     -5.219527538472     -2.355989886545      1.799639152406
C      3.181644486932     -2.010995692066      1.517910108016
C      3.343189612681     -3.206731691870      2.212413732619
C      4.303317689176     -1.316087535129      1.066197418257
C      4.617234110378     -3.698536905552      2.459498025228
H      2.474716993309     -3.756540364833      2.554395798039
C      5.574200699757     -1.806379388495      1.323578060813
H      4.167015345659     -0.393678125228      0.511386349325
C      5.731258224592     -2.998030442811      2.018666979844
H      4.739068947104     -4.630816172631      2.995747286361
H      6.442194548032     -1.263617189191      0.972306643136
H      6.723660945032     -3.385237297350      2.210813282497
C      0.368131005226     -2.630511669167      1.454457600038
C      0.197854909548     -3.588861711109      0.455200656013
C     -0.417298642969     -2.703703172973      2.602055675023
C     -0.729505121532     -4.607574819162      0.607013904781
H      0.792495531553     -3.538273443544     -0.449909192552
C     -1.357206807396     -3.715363530787      2.745636319552
H     -0.309818073228     -1.961770617241      3.383455628766
C     -1.512784026910     -4.669502136452      1.751876234655
H     -0.846880921604     -5.347293462410     -0.174730526319
H     -1.970962334350     -3.753163223282      3.636559217346
H     -2.246789729691     -5.457084483194      1.865869526393
C     -0.135438412048      1.283673571600     -3.004275245392
C      0.294956631475      2.742481315487     -2.860110619798
C     -0.682035093799      1.034091083408     -4.417086937313
H     -0.952600043047      1.087500728070     -2.297262988075
C     -0.861739239093      3.690163203353     -3.156372262974
H      1.115025860296      2.929680654433     -3.565126638870
H      0.697500829418      2.908459873615     -1.860627319179
C     -1.843836645737      1.977506951247     -4.720895670717
H      0.123400856116      1.191185758214     -5.144150392356
H     -0.995674761006     -0.008356194979     -4.515569336831
C     -1.435787621378      3.438866190311     -4.548627737033
H     -0.531779257904      4.727472641444     -3.061449537992
H     -1.645177630747      3.543227186538     -2.403702704795
H     -2.214506742633      1.801090241192     -5.733169006400
H     -2.671417325830      1.752981780411     -4.037800033573
H     -2.290272639463      4.093875506913     -4.734539172824
H     -0.677445593615      3.688580967273     -5.299464170909

```

<MoleculeViewer 
  xyzData={`84

Cu     1.256574226331      0.069264373106     -0.659343278198
H      2.068658955955      1.368589396284     -0.292644281536
P      1.560277492229     -1.281374476167      1.145355405814
P     -0.612723160875      0.824395329071      0.732303185988
C      0.252967034596      0.832725514541      2.346098057329
C     -0.010769488742      1.744747982634      3.362761395653
C      1.241729380314     -0.142094670051      2.536048342200
C      0.692120250415      1.687372420816      4.557509342452
H     -0.755341409511      2.517440244816      3.212788263475
C      1.942777525074     -0.193307099817      3.735715067273
C      1.668123876563      0.719168681177      4.744092995645
H      0.483711018983      2.406099720111      5.339712821129
H      2.715266554969     -0.939297244288      3.876961034819
H      2.223574058108      0.679511250927      5.672277191114
C      0.794382462423     -0.981555585799     -2.368549230311
H     -0.200857733223     -1.403553572528     -2.282982669079
C      0.999636203367      0.336353104438     -2.706793347261
H      1.978584961034      0.635717787212     -3.065753868518
Se     2.218820055631     -2.248447527122     -2.552397700285
C      1.838712044100     -2.683622928535     -4.420447081239
F      2.698794245085     -3.623077018602     -4.841532182429
F      0.594939838728     -3.161221712158     -4.597802411700
F      1.959214122623     -1.625577975283     -5.235874023469
C     -1.220902768089      2.535005368667      0.582230568712
C     -2.565405473645      2.840370122560      0.390761176206
C     -0.278107508911      3.565770211718      0.569736137618
C     -2.964464556646      4.158367887730      0.202923999459
H     -3.307065786960      2.051414223814      0.391712781568
C     -0.680893186703      4.878420306924      0.389086310019
H      0.772618048636      3.326825111320      0.693485571436
C     -2.025754831000      5.177900219154      0.205939789825
H     -4.012868806806      4.384696482474      0.055880470136
H      0.057551844088      5.670077790061      0.384284874955
H     -2.338158136801      6.204098667497      0.060841703430
C     -2.121185823405     -0.137882528234      1.118573158732
C     -2.515247821514     -1.104349095662      0.198499070553
C     -2.857316461866      0.018267687241      2.292322520579
C     -3.627859060355     -1.899802608553      0.438570149224
H     -1.932943172294     -1.245140649990     -0.704935468506
C     -3.967622180282     -0.774159151317      2.534801350760
H     -2.557514093058      0.759257204888      3.023590993789
C     -4.354068653932     -1.734548136424      1.607084376524
H     -3.917588321965     -2.653854553370     -0.281903223678
H     -4.532758786500     -0.645729052788      3.449202554587
H     -5.219527538472     -2.355989886545      1.799639152406
C      3.181644486932     -2.010995692066      1.517910108016
C      3.343189612681     -3.206731691870      2.212413732619
C      4.303317689176     -1.316087535129      1.066197418257
C      4.617234110378     -3.698536905552      2.459498025228
H      2.474716993309     -3.756540364833      2.554395798039
C      5.574200699757     -1.806379388495      1.323578060813
H      4.167015345659     -0.393678125228      0.511386349325
C      5.731258224592     -2.998030442811      2.018666979844
H      4.739068947104     -4.630816172631      2.995747286361
H      6.442194548032     -1.263617189191      0.972306643136
H      6.723660945032     -3.385237297350      2.210813282497
C      0.368131005226     -2.630511669167      1.454457600038
C      0.197854909548     -3.588861711109      0.455200656013
C     -0.417298642969     -2.703703172973      2.602055675023
C     -0.729505121532     -4.607574819162      0.607013904781
H      0.792495531553     -3.538273443544     -0.449909192552
C     -1.357206807396     -3.715363530787      2.745636319552
H     -0.309818073228     -1.961770617241      3.383455628766
C     -1.512784026910     -4.669502136452      1.751876234655
H     -0.846880921604     -5.347293462410     -0.174730526319
H     -1.970962334350     -3.753163223282      3.636559217346
H     -2.246789729691     -5.457084483194      1.865869526393
C     -0.135438412048      1.283673571600     -3.004275245392
C      0.294956631475      2.742481315487     -2.860110619798
C     -0.682035093799      1.034091083408     -4.417086937313
H     -0.952600043047      1.087500728070     -2.297262988075
C     -0.861739239093      3.690163203353     -3.156372262974
H      1.115025860296      2.929680654433     -3.565126638870
H      0.697500829418      2.908459873615     -1.860627319179
C     -1.843836645737      1.977506951247     -4.720895670717
H      0.123400856116      1.191185758214     -5.144150392356
H     -0.995674761006     -0.008356194979     -4.515569336831
C     -1.435787621378      3.438866190311     -4.548627737033
H     -0.531779257904      4.727472641444     -3.061449537992
H     -1.645177630747      3.543227186538     -2.403702704795
H     -2.214506742633      1.801090241192     -5.733169006400
H     -2.671417325830      1.752981780411     -4.037800033573
H     -2.290272639463      4.093875506913     -4.734539172824
H     -0.677445593615      3.688580967273     -5.299464170909
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`migratory_insertion_CuH_Cy_dppbz.xyz`として保存し、以下を実行する。
```
python .\optmain.py .\migratory_insertion_CuH_Cy_dppbz.xyz -opt rsirfo_fsb -os uma-s-1p1 -modelhess -ma 200 1 15 200 2 17 -ns 50
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `-ns 50`は連続最適化における最大反復計算回数を50回とするオプションである。原子数が多く、収束に時間がかかるので設定した。

これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`migratory_insertion_CuH_Cy_dppbz_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.15.1b`ディレクトリに置く。

`migratory_insertion_CuH_Cy_dppbz_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`migratory_insertion_CuH_Cy_dppbz_traj.xyz`は次のNEB計算に使用する。

※`migratory_insertion_CuH_Cy_dppbz_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`migratory_insertion_CuH_Cy_dppbz_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `migratory_insertion_CuH_Cy_dppbz_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`migratory_insertion_CuH_Cy_dppbz_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py migratory_insertion_CuH_Cy_dppbz_traj.xyz -os uma-s-1p1 -modelhess -ns 20 -spng -nd 0.2
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.15.1b`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-6533.16227572076,-6533.155899012497,-6533.147347172696,-6533.142244716128,-6533.139678443974,-6533.13701246347,-6533.135513964365,-6533.138711938862,-6533.146918093842,-6533.139763047123,-6533.152154184132,-6533.15949578535,-6533.1661667997205,-6533.17027441578,-6533.174099466435,-6533.1762668701385,-6533.178400225806,-6533.180427967725,-6533.182046432273,-6533.182861079289,-6533.182434331052,-6533.182850057047,-6533.183802175418,-6533.1849768939965,-6533.185398297585,-6533.185986909801,-6533.186473991227,-6533.1864415728705,-6533.187029273867,-6533.1873750463055,-6533.1876063907075,-6533.187781274599,-6533.187789931176,-6533.187913138455,-6533.187934096484,-6533.187998530158,-6533.188115306335,-6533.188236077856,-6533.188325254622,-6533.188476639585,-6533.188618071237,-6533.188764865061,-6533.188934754772,-6533.189100526477,-6533.1891236223655,-6533.18930255417,-6533.189410954145,-6533.189602187403,-6533.189684056895,-6533.189722310556,-6533.1897802956055,-6533.189793490753,-6533.189900015721,-6533.190084099416,-6533.190228492528,-6533.190313183294,-6533.190181249344,-6533.190357850533];

export const dataset1_itr5 = [-6533.162328869341,-6533.1596583152195,-6533.1560343635165,-6533.153422197484,-6533.149672392464,-6533.145035919106,-6533.142043844981,-6533.147168170797,-6533.15550811721,-6533.159521649943,-6533.164273848071,-6533.1694002767,-6533.173881054328,-6533.177901421201,-6533.180762875633,-6533.183306384844,-6533.1855157747,-6533.186664663734,-6533.187627173503,-6533.188585319936,-6533.188740980618,-6533.189296298304,-6533.190253743799,-6533.1910745240175,-6533.191723749797,-6533.192364932321,-6533.19277399941,-6533.193068077713,-6533.193355076548,-6533.193272260789,-6533.193490462614,-6533.193818834281,-6533.193988951797,-6533.194134483933,-6533.193997047625,-6533.193958373402,-6533.194085523453,-6533.194446769086,-6533.194584240441,-6533.1946731368325,-6533.194736781952,-6533.195059125557,-6533.194858937824,-6533.19487809094,-6533.195368011163,-6533.195578502676,-6533.195227665964,-6533.195452036039,-6533.195906611491,-6533.196228166542,-6533.196305637653,-6533.196323318799,-6533.196177243437,-6533.196157301767,-6533.196384931201,-6533.196594616636,-6533.196521210962,-6533.197366488944];

export const dataset1_itr10 = [-6533.162354453558,-6533.1613632404005,-6533.159327963404,-6533.157240641804,-6533.153764202384,-6533.148708673578,-6533.145262549703,-6533.154183450591,-6533.160996106893,-6533.165317631536,-6533.169135234731,-6533.173553681498,-6533.177129776697,-6533.180516881639,-6533.183239182467,-6533.185338805521,-6533.187052071857,-6533.188199120929,-6533.1891197847335,-6533.189886277347,-6533.190053853965,-6533.191122643373,-6533.191751752248,-6533.192268728657,-6533.1926825796445,-6533.1931970151545,-6533.193576853153,-6533.193828296937,-6533.194088747766,-6533.194078146087,-6533.194278771905,-6533.194518913072,-6533.194595069925,-6533.194817617562,-6533.194818598874,-6533.19500059728,-6533.195173728828,-6533.195391317333,-6533.195505097003,-6533.195648263475,-6533.195771996457,-6533.1959441466915,-6533.195862505003,-6533.195977265986,-6533.19622830673,-6533.1963842653095,-6533.196200234185,-6533.196441234,-6533.196668758293,-6533.196830762458,-6533.1969349217625,-6533.196986458188,-6533.1969205350215,-6533.197024957176,-6533.197208620309,-6533.197297341465,-6533.19730042559,-6533.197904756327];

export const dataset1_itr15 = [-6533.162359763159,-6533.161987477761,-6533.1607111407775,-6533.158954188515,-6533.15583747019,-6533.1504290193825,-6533.1472057235205,-6533.158998925846,-6533.164565140148,-6533.168603836534,-6533.172187659568,-6533.176155350992,-6533.179254510834,-6533.182184148956,-6533.184704492184,-6533.186577572257,-6533.188000177361,-6533.189050479544,-6533.189894688596,-6533.190569516116,-6533.190910749985,-6533.191714882939,-6533.192247910815,-6533.192697492089,-6533.193121138677,-6533.193561152155,-6533.19390175518,-6533.194128999098,-6533.194374940522,-6533.194357346993,-6533.194539415492,-6533.194758178067,-6533.194858885254,-6533.195052414081,-6533.195126801066,-6533.1953171406285,-6533.195467772084,-6533.195627130211,-6533.195744326951,-6533.195893556532,-6533.196021425044,-6533.196159947805,-6533.196104012998,-6533.196304814051,-6533.196471619638,-6533.196598016182,-6533.196419452369,-6533.196708378781,-6533.196881282524,-6533.197001230444,-6533.197090827773,-6533.197155927337,-6533.1970733218595,-6533.197257388031,-6533.1974012904875,-6533.197492955581,-6533.197525969735,-6533.198085317811];

export const dataset2 = [-6533.162367280713,-6533.162216211171,-6533.161489479234,-6533.160156366317,-6533.157392973032,-6533.151688568915,-6533.150422553235,-6533.162722918846,-6533.167429328237,-6533.171217965191,-6533.174753441066,-6533.17830298826,-6533.181029389571,-6533.18360486153,-6533.185860162787,-6533.1875372257055,-6533.188774941036,-6533.189722696072,-6533.190488505272,-6533.191092625727,-6533.191526155533,-6533.192127419669,-6533.192596802425,-6533.193015998061,-6533.19344300915,-6533.193833974529,-6533.1941439816355,-6533.194352019867,-6533.194584310535,-6533.194528270587,-6533.194722412734,-6533.194924440428,-6533.195042986472,-6533.195204026849,-6533.195302701317,-6533.195472328178,-6533.195613724783,-6533.195761289637,-6533.1958786616115,-6533.196026804739,-6533.196152780721,-6533.19627844128,-6533.196171951359,-6533.196458196686,-6533.1966035185405,-6533.19671086711,-6533.196500796159,-6533.196852806941,-6533.196997270147,-6533.197104355865,-6533.197190834021,-6533.197249765337,-6533.197131797566,-6533.19738860352,-6533.197513685806,-6533.197608347407,-6533.197652699224,-6533.198123904417];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.00037865110570133487,0.0035228778196402153,0.005558537250390859,0.005860551711913512,0.005220299926280361,0.004799760468226865,0.004378270374885679,0.004426010776826166,0.004943310826796424,0.010391410739580918,0.007238725552829934,0.0062409260856966745,0.0050802121627196,0.005036320538062715,0.004834765558585289,0.005074761905987858,0.005273191621454944,0.005022605514705408,0.004790729097556941,0.005218106984851966,0.005524226784464748,0.005531029295655276,0.005327880576528095,0.005021439087685618,0.00512703301483905,0.005094093051784986,0.0050861749292563305,0.005365807833036694,0.00524154100677682,0.005104617190319241,0.005019532185401644,0.005050540323247677,0.0051000567588940044,0.005191473934631343,0.0052471050555448215,0.005266525327524381,0.005266534858754322,0.005263566465706366,0.0052720723136627555,0.005263057193527812,0.005285931746106747,0.0052966141837293874,0.005282005630373717,0.005257292085445539,0.005272606239602106,0.005274245605750287,0.005272691920298074,0.005202986224014042,0.00517117982535189,0.005179709620972476,0.005205759209489284,0.00526896885010209,0.005261231932044147,0.005206154754853669,0.005159750448113851,0.005152417018239331,0.005255251300648634,0.005193801907864054];

export const dataset1_grad_itr5 = [0.00030990583443097784,0.0017480622922890596,0.00258112761356143,0.0027627618879937353,0.0026077095938322743,0.002656731119571379,0.002396550437193084,0.0030719543655502394,0.002860376356479939,0.003403023907881217,0.0031171619307772034,0.002570748685608054,0.0019459277546253573,0.0016241623788744292,0.0017693409100509306,0.0017108568789930899,0.0015056585506031288,0.001695459203312449,0.001770002623583979,0.0017201662908104467,0.0018981632805108125,0.001986670830790691,0.0017655525932889942,0.0014917211462033293,0.0013068635513094158,0.0011137533940789174,0.001070122999443598,0.001065551203417749,0.0010415501163942582,0.001220873990342069,0.0011258429503723472,0.0010780020195831348,0.001026458457495631,0.0010972166436350281,0.0013537201920670416,0.001503813449303651,0.0015270035654325513,0.0013675990954878396,0.0013274662661993991,0.0014409286523585452,0.001599392350431069,0.0013416635107064933,0.0016587645395824665,0.0017160595044391409,0.0013776758688807096,0.001322617284632013,0.0016711653364929167,0.001566038032428655,0.001239390072731288,0.0009568151594510305,0.0009696921574206961,0.0010692610340855152,0.0013043238001121365,0.0013773732435457997,0.0012642396175000716,0.0010956141539289173,0.0011928716800587412,0.0009442677873858611];

export const dataset1_grad_itr10 = [0.0002563202078246226,0.0008867594946195686,0.0014148162084761202,0.0015676912376446207,0.0016504640110317677,0.001670321902529181,0.0012479319136444967,0.0025146372624190194,0.001817119195298146,0.0017927510692896977,0.0017383104082963933,0.001316899942103891,0.0010474481538827612,0.0008781505741195254,0.0009074791735829936,0.001006261612021313,0.0009829804125354549,0.0010509499558520705,0.0010722341847667549,0.0010246618576636732,0.001345808900045651,0.0008806830349321067,0.000783718745143942,0.0006616937114251487,0.0006494382026562584,0.00046492305454583525,0.00038839243766746004,0.00038628325844773664,0.0003707304781051888,0.0005406997122821455,0.00037447940338553487,0.0003851071075181027,0.0004809896525102902,0.000417755221268333,0.000639368193842475,0.0006295416607099949,0.0006217469652115233,0.0005255600509436966,0.0005394654321306567,0.0005611759892569994,0.0006465063201478214,0.0004730240257138868,0.0007156393105051909,0.0008040887812677047,0.0006053648113630941,0.0005019094345285919,0.0008354603928410956,0.0007348505997147803,0.000548404816712349,0.00035799044491781714,0.0002946020759577801,0.00037423912930568005,0.0006013999958139298,0.0006194705429096077,0.00048577648122758506,0.0004348507847473383,0.0004932706091117351,0.0005317542170945589];

export const dataset1_grad_itr15 = [0.00028759277485050936,0.0004710552859512841,0.0008707770551901556,0.0010766994770471067,0.0012334321748144364,0.0013046408848280781,0.001093408086959029,0.0020676333755250196,0.0015240360936897791,0.0014608680502093253,0.0014032718822454464,0.0010143380746625962,0.0008675679232595122,0.0007758996119516279,0.0007034779567802776,0.0007563736969717777,0.0008190915643825784,0.0008226441346789942,0.0008107187677422813,0.0007699869415086783,0.0009842153728744838,0.000582039538893812,0.0005127179467924298,0.000454496229092045,0.0004293762029729915,0.00029120584858640443,0.00022995420406427035,0.00023745108730972476,0.00021853686609021734,0.00033386327161769356,0.00021660764783716898,0.00019284857936578204,0.0003042390508863736,0.00020821199175529746,0.00035299931932824023,0.00028732467105921095,0.00030345298502807696,0.0002766273286633579,0.0002988466848305356,0.0003072251865647044,0.00034976911342899286,0.0002413010508403724,0.0003526085031407845,0.0004521503217928752,0.0003445923841145019,0.0002382723722365239,0.0005415783623543684,0.0004446746156417062,0.00029902878903952204,0.00017939268185211793,0.00015373868514219384,0.00020706194878700374,0.00039846523141735644,0.0003718478837875655,0.0002646333631608908,0.00023567107068757755,0.00027941581523714155,0.0003670115627290828];

export const dataset2_grad = [0.000245570983127989,0.00028480693253090446,0.0005419651758353894,0.000758177362106267,0.0009725644527719158,0.001119915910980444,0.0019802354752478496,0.0017734158033820596,0.0014315582553064833,0.0012820037711734618,0.001241308103615617,0.0009065605113808684,0.000794902136960921,0.0007277355097843095,0.0006513543068932286,0.0006713091540658356,0.0007058010022926488,0.0006865385585644752,0.000662253936455371,0.0006329954519354019,0.0007107977067115817,0.00044850831337288637,0.0004059887718311227,0.00036773589861926434,0.0003146559401949139,0.00022140039849852648,0.0001802117165804164,0.0001948772551646448,0.0001679421780945987,0.00021665231022177702,0.00017055997605025075,0.00013694279985713244,0.00022167730654902798,0.00015558834576236168,0.0002232633203834969,0.00017752193511517646,0.00020106102978518795,0.0001895670495841663,0.00021155143574935113,0.00020533101485762653,0.00022962311611884965,0.00015587444695586532,0.00021636987086458525,0.0002879127083095012,0.00021407820007242158,0.00015639143630797285,0.000406039543660056,0.0003015982102343065,0.0001915970653427833,0.00012311996432250974,0.00012198852133512608,0.00015363476930081398,0.0003033303750248866,0.00026204220244235935,0.000180744869281816,0.00016338900497532376,0.0001973234238025977,0.00034452816826937004];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、ITR. 5の経路の6番(グラフ上では7番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`migratory_insertion_CuH_Cy_dppbz_traj_6_itr5.xyz`
```
84
0 1
Cu      1.100090777352     -0.141832668687     -0.610269901765
H       1.660815117074      1.216144921367     -1.198283100780
P       1.569222626095     -1.293143023291      1.199116289837
P      -0.629614853427      0.809519035232      0.760038453330
C       0.250422764021      0.832105280758      2.364484002512
C      -0.012231387435      1.750665063915      3.374457558136
C       1.240580631411     -0.141607943486      2.564438320167
C       0.691678321168      1.697921906320      4.568710466646
H      -0.757919850011      2.521297261339      3.219491104937
C       1.944153971891     -0.186083371539      3.760398546744
C       1.668842714388      0.732060188065      4.761457758340
H       0.481325630732      2.418757044235      5.347461117083
H       2.716318941743     -0.932828801132      3.900027702357
H       2.223366336671      0.695287162826      5.689655958100
C       0.800977486116     -0.969931141043     -2.361377036619
H      -0.212793212129     -1.359770331037     -2.429166266593
C       1.092943038066      0.437922585598     -2.537487297632
H       2.036822260062      0.683073870978     -3.007212845755
Se      2.173797961785     -2.262029133232     -2.575658534256
C       1.831938342498     -2.668767502395     -4.447587983827
F       2.693185012865     -3.608271414531     -4.875597255773
F       0.587267101853     -3.143575932491     -4.646802927654
F       1.959400932682     -1.601510077804     -5.253384277553
C      -1.219102032337      2.524882582144      0.582444609043
C      -2.562596645231      2.833845210025      0.388957135012
C      -0.276353883947      3.555182498025      0.567884168743
C      -2.959709649874      4.152293056630      0.201371316049
H      -3.305526749468      2.046410034760      0.389399061741
C      -0.675625123772      4.868945776366      0.387094326777
H       0.774890302530      3.321397948653      0.697256402728
C      -2.020058619037      5.170678687369      0.205430890757
H      -4.007771714734      4.380222317132      0.054949515584
H       0.063154072193      5.660135363071      0.383094425825
H      -2.331029072552      6.197489249157      0.061875797676
C      -2.133200619450     -0.147174767651      1.133900467675
C      -2.521808198856     -1.109446637257      0.207173555037
C      -2.870547609595      0.012820782536      2.305213027448
C      -3.635670533828     -1.902864659756      0.444030775194
H      -1.934739958476     -1.247872542524     -0.694091032389
C      -3.981389654832     -0.779304651497      2.543259962447
H      -2.570293330848      0.754847049688      3.035468487725
C      -4.363657193501     -1.738306372953      1.612165666039
H      -3.924276960384     -2.655306317136     -0.278403664904
H      -4.547840315499     -0.651810405105      3.456705651941
H      -5.228387036244     -2.360600039046      1.803745203834
C       3.191494592917     -2.010518080127      1.537583188146
C       3.353554628626     -3.208293196246      2.225728999793
C       4.309217708130     -1.318002845127      1.074695307212
C       4.627811952483     -3.701277043458      2.465134709053
H       2.484247996456     -3.757777837308      2.565658593331
C       5.580789237368     -1.807418660966      1.325846457870
H       4.172850305358     -0.400915244712      0.511218884236
C       5.739228026755     -2.998992286279      2.021665597934
H       4.750611133614     -4.634860168350      2.998182843170
H       6.447338008786     -1.266718809506      0.968508064299
H       6.732027755037     -3.386147648588      2.210143787750
C       0.369693721518     -2.637055700479      1.476466581234
C       0.204507756018     -3.587278282018      0.467891306210
C      -0.418522337307     -2.711218132347      2.620474457697
C      -0.726222692623     -4.603651089888      0.613056490544
H       0.798334841185     -3.528835532515     -0.437632013177
C      -1.362231021987     -3.720482136523      2.755308764313
H      -0.311141468991     -1.970437086418      3.402850590305
C      -1.514061196915     -4.668726767035      1.755528029899
H      -0.844615353975     -5.338684877419     -0.173139701254
H      -1.980870134037     -3.759044981325      3.642384880152
H      -2.250551949369     -5.454969117762      1.863125205196
C      -0.075746346880      1.334532469706     -2.939963554813
C       0.311572712308      2.804252793570     -2.846990791753
C      -0.613982789274      1.031014181370     -4.349103699906
H      -0.911221647932      1.145646850237     -2.249439597622
C      -0.862560483994      3.719565263238     -3.159205768071
H       1.126109891862      2.979859815642     -3.560941191711
H       0.711736882734      3.002806806233     -1.852874045364
C      -1.796025875030      1.950044360811     -4.683211983015
H       0.179960031157      1.182752931809     -5.089028033925
H      -0.921787481796     -0.014075571231     -4.432976539522
C      -1.426145133802      3.425724407623     -4.546054152569
H      -0.554974935973      4.764611322470     -3.080063304734
H      -1.643761695295      3.562694849848     -2.406135482893
H      -2.156720143314      1.746793748900     -5.695177615995
H      -2.631462505731      1.727587379479     -4.008109795163
H      -2.295010074816      4.057814052595     -4.746582863899
H      -0.672522051003      3.677812719496     -5.300658202923

```


<MoleculeViewer 
  xyzData={`84
0 1
Cu      1.100090777352     -0.141832668687     -0.610269901765
H       1.660815117074      1.216144921367     -1.198283100780
P       1.569222626095     -1.293143023291      1.199116289837
P      -0.629614853427      0.809519035232      0.760038453330
C       0.250422764021      0.832105280758      2.364484002512
C      -0.012231387435      1.750665063915      3.374457558136
C       1.240580631411     -0.141607943486      2.564438320167
C       0.691678321168      1.697921906320      4.568710466646
H      -0.757919850011      2.521297261339      3.219491104937
C       1.944153971891     -0.186083371539      3.760398546744
C       1.668842714388      0.732060188065      4.761457758340
H       0.481325630732      2.418757044235      5.347461117083
H       2.716318941743     -0.932828801132      3.900027702357
H       2.223366336671      0.695287162826      5.689655958100
C       0.800977486116     -0.969931141043     -2.361377036619
H      -0.212793212129     -1.359770331037     -2.429166266593
C       1.092943038066      0.437922585598     -2.537487297632
H       2.036822260062      0.683073870978     -3.007212845755
Se      2.173797961785     -2.262029133232     -2.575658534256
C       1.831938342498     -2.668767502395     -4.447587983827
F       2.693185012865     -3.608271414531     -4.875597255773
F       0.587267101853     -3.143575932491     -4.646802927654
F       1.959400932682     -1.601510077804     -5.253384277553
C      -1.219102032337      2.524882582144      0.582444609043
C      -2.562596645231      2.833845210025      0.388957135012
C      -0.276353883947      3.555182498025      0.567884168743
C      -2.959709649874      4.152293056630      0.201371316049
H      -3.305526749468      2.046410034760      0.389399061741
C      -0.675625123772      4.868945776366      0.387094326777
H       0.774890302530      3.321397948653      0.697256402728
C      -2.020058619037      5.170678687369      0.205430890757
H      -4.007771714734      4.380222317132      0.054949515584
H       0.063154072193      5.660135363071      0.383094425825
H      -2.331029072552      6.197489249157      0.061875797676
C      -2.133200619450     -0.147174767651      1.133900467675
C      -2.521808198856     -1.109446637257      0.207173555037
C      -2.870547609595      0.012820782536      2.305213027448
C      -3.635670533828     -1.902864659756      0.444030775194
H      -1.934739958476     -1.247872542524     -0.694091032389
C      -3.981389654832     -0.779304651497      2.543259962447
H      -2.570293330848      0.754847049688      3.035468487725
C      -4.363657193501     -1.738306372953      1.612165666039
H      -3.924276960384     -2.655306317136     -0.278403664904
H      -4.547840315499     -0.651810405105      3.456705651941
H      -5.228387036244     -2.360600039046      1.803745203834
C       3.191494592917     -2.010518080127      1.537583188146
C       3.353554628626     -3.208293196246      2.225728999793
C       4.309217708130     -1.318002845127      1.074695307212
C       4.627811952483     -3.701277043458      2.465134709053
H       2.484247996456     -3.757777837308      2.565658593331
C       5.580789237368     -1.807418660966      1.325846457870
H       4.172850305358     -0.400915244712      0.511218884236
C       5.739228026755     -2.998992286279      2.021665597934
H       4.750611133614     -4.634860168350      2.998182843170
H       6.447338008786     -1.266718809506      0.968508064299
H       6.732027755037     -3.386147648588      2.210143787750
C       0.369693721518     -2.637055700479      1.476466581234
C       0.204507756018     -3.587278282018      0.467891306210
C      -0.418522337307     -2.711218132347      2.620474457697
C      -0.726222692623     -4.603651089888      0.613056490544
H       0.798334841185     -3.528835532515     -0.437632013177
C      -1.362231021987     -3.720482136523      2.755308764313
H      -0.311141468991     -1.970437086418      3.402850590305
C      -1.514061196915     -4.668726767035      1.755528029899
H      -0.844615353975     -5.338684877419     -0.173139701254
H      -1.980870134037     -3.759044981325      3.642384880152
H      -2.250551949369     -5.454969117762      1.863125205196
C      -0.075746346880      1.334532469706     -2.939963554813
C       0.311572712308      2.804252793570     -2.846990791753
C      -0.613982789274      1.031014181370     -4.349103699906
H      -0.911221647932      1.145646850237     -2.249439597622
C      -0.862560483994      3.719565263238     -3.159205768071
H       1.126109891862      2.979859815642     -3.560941191711
H       0.711736882734      3.002806806233     -1.852874045364
C      -1.796025875030      1.950044360811     -4.683211983015
H       0.179960031157      1.182752931809     -5.089028033925
H      -0.921787481796     -0.014075571231     -4.432976539522
C      -1.426145133802      3.425724407623     -4.546054152569
H      -0.554974935973      4.764611322470     -3.080063304734
H      -1.643761695295      3.562694849848     -2.406135482893
H      -2.156720143314      1.746793748900     -5.695177615995
H      -2.631462505731      1.727587379479     -4.008109795163
H      -2.295010074816      4.057814052595     -4.746582863899
H      -0.672522051003      3.677812719496     -5.300658202923
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`migratory_insertion_CuH_Cy_dppbz_traj_6_itr5.xyz`を`MultiOptPy-v1.15.1b`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py .\migratory_insertion_CuH_Cy_dppbz_traj_6_itr5.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
84
OptimizedStructure
Cu     0.675973965320     -0.263759981894     -0.589520601080
H      1.560782549026      0.925731371652     -1.138635946405
P      1.393100472603     -1.364530859333      1.226597782893
P     -0.906177375878      0.633664965100      0.831061202873
C      0.047428615427      0.764698942314      2.386761075680
C     -0.206261761140      1.718088078113      3.367808753937
C      1.088539092846     -0.157849949520      2.569372210665
C      0.559646929901      1.755330213608      4.523662761630
H     -0.994306720620      2.446774399434      3.218466880028
C      1.850496212593     -0.112183910033      3.732497238388
C      1.586910615417      0.840378188820      4.706088971517
H      0.359922306154      2.505208317729      5.278334339439
H      2.663636171349     -0.814089057147      3.871126254923
H      2.190837515040      0.873826847399      5.603692298112
C     -0.000522068031     -0.865844464312     -2.455303313003
H     -1.075790358374     -0.755052927591     -2.534564169751
C      0.822455908479      0.287397847253     -2.615326778735
H      1.819962130425      0.131389877589     -3.012435527712
Se     0.666862055863     -2.594859034032     -2.821421602555
C      0.585378385374     -2.522727931727     -4.775856465939
F      0.979097932663     -3.699010689416     -5.294184373571
F     -0.652138476912     -2.271787834657     -5.238592656870
F      1.380029391612     -1.569371174990     -5.296015580735
C     -1.613506258095      2.291678153726      0.607382895769
C     -2.980644341150      2.533757701750      0.526293379305
C     -0.717579341400      3.342953725478      0.401628497125
C     -3.446615914224      3.814544014520      0.253807944066
H     -3.684773137498      1.724136660137      0.671236851800
C     -1.185253311204      4.619433693014      0.141208226478
H      0.349436364727      3.151564396600      0.440923314313
C     -2.553027669908      4.856951154624      0.065483250390
H     -4.511983487442      3.994516361813      0.189438200189
H     -0.483215672645      5.428636816346     -0.014389094517
H     -2.918662667368      5.853489106439     -0.145809653176
C     -2.294629020731     -0.442452796221      1.315298377384
C     -2.589104453709     -1.524722214403      0.490995751881
C     -3.009841003263     -0.269475471373      2.499707149329
C     -3.588636488273     -2.422120565196      0.842310981983
H     -2.014117759354     -1.674516399736     -0.416316430738
C     -4.008556833393     -1.163599163566      2.849189034120
H     -2.777964625883      0.561089049922      3.156469763453
C     -4.297049759177     -2.241543787774      2.019828022303
H     -3.802052555260     -3.267073768295      0.200581570425
H     -4.559273946235     -1.024842040562      3.770889131042
H     -5.072276499072     -2.944078898238      2.298500338799
C      3.112636449632     -1.887608519418      1.486061015926
C      3.466257563586     -2.973390991935      2.282938257016
C      4.106462116298     -1.141236916670      0.855538128126
C      4.803554057004     -3.300930084538      2.456097705559
H      2.696866742739     -3.566747629178      2.762159732439
C      5.441765115972     -1.465565152110      1.038301229448
H      3.822907507569     -0.311334748029      0.217036173429
C      5.790277037560     -2.545557211778      1.838142928635
H      5.074666893940     -4.148139539533      3.072813528333
H      6.210143395321     -0.882902402395      0.547053776174
H      6.832624641676     -2.804257012996      1.973060270792
C      0.393124243750     -2.804894026825      1.723692554240
C      0.314315860839     -3.866257224919      0.821974198976
C     -0.346211620793     -2.856110194464      2.901269580768
C     -0.480715777129     -4.965808648843      1.099181713710
H      0.873858247966     -3.827739144028     -0.106327848244
C     -1.153732993490     -3.953437788321      3.171717008974
H     -0.308135170226     -2.034366214050      3.605540980770
C     -1.220114335091     -5.008344528275      2.274856100151
H     -0.533014791653     -5.783274948780      0.391625657222
H     -1.734965490295     -3.978327826554      4.084671833335
H     -1.851594348390     -5.861654521258      2.487127978890
C      0.164210079769      1.580928909442     -3.061439272325
C      1.068588585760      2.802906943155     -2.921954167631
C     -0.293240758541      1.437029720617     -4.520651066808
H     -0.729046404449      1.741891262961     -2.441872253417
C      0.380046260775      4.070716634786     -3.420037410327
H      1.984809860246      2.627847085013     -3.500152254111
H      1.374271340500      2.919406906876     -1.880121826240
C     -0.989368948572      2.702054640057     -5.014918182731
H      0.584162489326      1.232870854930     -5.145576308068
H     -0.951808346225      0.572347735741     -4.620052965895
C     -0.086704543931      3.922558087349     -4.864894759347
H      1.053257387927      4.925961134916     -3.321127821442
H     -0.487428729607      4.276161670262     -2.781597146423
H     -1.294810337933      2.576290063757     -6.056092655481
H     -1.905293145309      2.858543675855     -4.433024516802
H     -0.606179328218      4.825798037220     -5.193407827459
H      0.787024083113      3.804824948597     -5.515882325609

```

<MoleculeViewer 
  xyzData={`84
OptimizedStructure
Cu     0.675973965320     -0.263759981894     -0.589520601080
H      1.560782549026      0.925731371652     -1.138635946405
P      1.393100472603     -1.364530859333      1.226597782893
P     -0.906177375878      0.633664965100      0.831061202873
C      0.047428615427      0.764698942314      2.386761075680
C     -0.206261761140      1.718088078113      3.367808753937
C      1.088539092846     -0.157849949520      2.569372210665
C      0.559646929901      1.755330213608      4.523662761630
H     -0.994306720620      2.446774399434      3.218466880028
C      1.850496212593     -0.112183910033      3.732497238388
C      1.586910615417      0.840378188820      4.706088971517
H      0.359922306154      2.505208317729      5.278334339439
H      2.663636171349     -0.814089057147      3.871126254923
H      2.190837515040      0.873826847399      5.603692298112
C     -0.000522068031     -0.865844464312     -2.455303313003
H     -1.075790358374     -0.755052927591     -2.534564169751
C      0.822455908479      0.287397847253     -2.615326778735
H      1.819962130425      0.131389877589     -3.012435527712
Se     0.666862055863     -2.594859034032     -2.821421602555
C      0.585378385374     -2.522727931727     -4.775856465939
F      0.979097932663     -3.699010689416     -5.294184373571
F     -0.652138476912     -2.271787834657     -5.238592656870
F      1.380029391612     -1.569371174990     -5.296015580735
C     -1.613506258095      2.291678153726      0.607382895769
C     -2.980644341150      2.533757701750      0.526293379305
C     -0.717579341400      3.342953725478      0.401628497125
C     -3.446615914224      3.814544014520      0.253807944066
H     -3.684773137498      1.724136660137      0.671236851800
C     -1.185253311204      4.619433693014      0.141208226478
H      0.349436364727      3.151564396600      0.440923314313
C     -2.553027669908      4.856951154624      0.065483250390
H     -4.511983487442      3.994516361813      0.189438200189
H     -0.483215672645      5.428636816346     -0.014389094517
H     -2.918662667368      5.853489106439     -0.145809653176
C     -2.294629020731     -0.442452796221      1.315298377384
C     -2.589104453709     -1.524722214403      0.490995751881
C     -3.009841003263     -0.269475471373      2.499707149329
C     -3.588636488273     -2.422120565196      0.842310981983
H     -2.014117759354     -1.674516399736     -0.416316430738
C     -4.008556833393     -1.163599163566      2.849189034120
H     -2.777964625883      0.561089049922      3.156469763453
C     -4.297049759177     -2.241543787774      2.019828022303
H     -3.802052555260     -3.267073768295      0.200581570425
H     -4.559273946235     -1.024842040562      3.770889131042
H     -5.072276499072     -2.944078898238      2.298500338799
C      3.112636449632     -1.887608519418      1.486061015926
C      3.466257563586     -2.973390991935      2.282938257016
C      4.106462116298     -1.141236916670      0.855538128126
C      4.803554057004     -3.300930084538      2.456097705559
H      2.696866742739     -3.566747629178      2.762159732439
C      5.441765115972     -1.465565152110      1.038301229448
H      3.822907507569     -0.311334748029      0.217036173429
C      5.790277037560     -2.545557211778      1.838142928635
H      5.074666893940     -4.148139539533      3.072813528333
H      6.210143395321     -0.882902402395      0.547053776174
H      6.832624641676     -2.804257012996      1.973060270792
C      0.393124243750     -2.804894026825      1.723692554240
C      0.314315860839     -3.866257224919      0.821974198976
C     -0.346211620793     -2.856110194464      2.901269580768
C     -0.480715777129     -4.965808648843      1.099181713710
H      0.873858247966     -3.827739144028     -0.106327848244
C     -1.153732993490     -3.953437788321      3.171717008974
H     -0.308135170226     -2.034366214050      3.605540980770
C     -1.220114335091     -5.008344528275      2.274856100151
H     -0.533014791653     -5.783274948780      0.391625657222
H     -1.734965490295     -3.978327826554      4.084671833335
H     -1.851594348390     -5.861654521258      2.487127978890
C      0.164210079769      1.580928909442     -3.061439272325
C      1.068588585760      2.802906943155     -2.921954167631
C     -0.293240758541      1.437029720617     -4.520651066808
H     -0.729046404449      1.741891262961     -2.441872253417
C      0.380046260775      4.070716634786     -3.420037410327
H      1.984809860246      2.627847085013     -3.500152254111
H      1.374271340500      2.919406906876     -1.880121826240
C     -0.989368948572      2.702054640057     -5.014918182731
H      0.584162489326      1.232870854930     -5.145576308068
H     -0.951808346225      0.572347735741     -4.620052965895
C     -0.086704543931      3.922558087349     -4.864894759347
H      1.053257387927      4.925961134916     -3.321127821442
H     -0.487428729607      4.276161670262     -2.781597146423
H     -1.294810337933      2.576290063757     -6.056092655481
H     -1.905293145309      2.858543675855     -4.433024516802
H     -0.606179328218      4.825798037220     -5.193407827459
H      0.787024083113      3.804824948597     -5.515882325609
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -545.7236              9.4440             14.4006
Reduced mass [au]                   1.2071              5.5961              7.4499
Force const [Dyne/A]               -0.2118              0.0003              0.0009
Char temp [K]                       0.0000             13.5878             20.7193
Normal mode                   x         y         z            x         y         z            x         y         z   
      Cu                -0.01529   -0.01735    0.00925   -0.00394    0.00411    0.00067   -0.02476    0.00271   -0.00325
       H                -0.19757   -0.23218   -0.82292    0.00957   -0.00467    0.00437   -0.02025    0.00432    0.00696
       P                 0.00737    0.00401    0.00362   -0.00327    0.00338    0.00091   -0.01718   -0.00234   -0.00806
       P                 0.00067    0.00534    0.00291   -0.00654   -0.00048   -0.00135   -0.01502    0.00173    0.00641
       C                -0.00112    0.00027    0.00348   -0.00768    0.00217   -0.00108   -0.00005    0.00424   -0.00262
       C                -0.00027    0.00056    0.00219   -0.00844    0.00382   -0.00298    0.01260    0.00934   -0.00441
       C                -0.00027   -0.00101    0.00403   -0.00771    0.00249    0.00087   -0.00130    0.00157   -0.00844
       C                 0.00076    0.00116    0.00126   -0.00949    0.00534   -0.00228    0.02398    0.01181   -0.01191
       H                -0.00154   -0.00077    0.00259   -0.00842    0.00350   -0.00489    0.01359    0.01133    0.00003
       C                 0.00018   -0.00005    0.00266   -0.00902    0.00398    0.00163    0.01002    0.00397   -0.01608
       C                 0.00073    0.00126    0.00123   -0.01006    0.00522    0.00019    0.02262    0.00920   -0.01770
       H                 0.00081    0.00092    0.00139   -0.00993    0.00659   -0.00363    0.03388    0.01592   -0.01338
       H                -0.00134   -0.00159    0.00367   -0.00891    0.00442    0.00325    0.00913    0.00191   -0.02109
       H                 0.00040    0.00148    0.00137   -0.01099    0.00632    0.00078    0.03144    0.01125   -0.02371
       C                 0.00634   -0.01439    0.03787   -0.00674    0.01317   -0.00165   -0.00137   -0.00067   -0.01039
       H                 0.01771    0.00987   -0.07139   -0.00451    0.03219   -0.00561   -0.00077   -0.00572   -0.02464
       C                 0.06211    0.04629    0.04914    0.01396   -0.00147    0.00037   -0.00274    0.00134   -0.00197
       H                -0.03928   -0.01342   -0.19443    0.01435   -0.02045    0.00863    0.00253    0.00299    0.01065
      Se                -0.00165    0.00493   -0.00104   -0.03748    0.00004    0.00528    0.01316    0.00177    0.00287
       C                 0.00101   -0.00569    0.00263   -0.02971   -0.00359    0.00473    0.05643    0.00141    0.00110
       F                 0.00095   -0.00282   -0.00761   -0.05182   -0.01298    0.00923    0.07585    0.00387    0.01026
       F                 0.00051   -0.00073   -0.00118   -0.02319    0.02012    0.00016    0.06567   -0.00628   -0.02745
       F                 0.00041    0.00038   -0.00122   -0.00880   -0.02108    0.00463    0.06261    0.00635    0.01932
       C                -0.00165    0.00160    0.00193   -0.01804   -0.00479    0.00274   -0.01874    0.00129    0.01366
       C                -0.00071    0.00068    0.00058   -0.02036   -0.00513    0.04218   -0.02029    0.00572    0.05357
       C                -0.00196    0.00081    0.00008   -0.02391   -0.00609   -0.02959   -0.02117   -0.00255   -0.01638
       C                -0.00014    0.00076   -0.00036   -0.02817   -0.00637    0.04959   -0.02389    0.00649    0.06337
       H                -0.00008    0.00007   -0.00047   -0.01620   -0.00433    0.06650   -0.01886    0.00870    0.07692
       C                 0.00029    0.00075    0.00013   -0.03131   -0.00728   -0.02217   -0.02439   -0.00177   -0.00692
       H                -0.00060    0.00518    0.00256   -0.02278   -0.00681   -0.06118   -0.02074   -0.00656   -0.04709
       C                -0.00012    0.00031    0.00004   -0.03358   -0.00751    0.01765   -0.02583    0.00271    0.03322
       H                 0.00008    0.00083   -0.00180   -0.03003   -0.00648    0.08008   -0.02517    0.01005    0.09449
       H                 0.00025    0.00053   -0.00029   -0.03579   -0.00822   -0.04731   -0.02616   -0.00476   -0.03049
       H                 0.00032    0.00013   -0.00086   -0.03975   -0.00857    0.02335   -0.02867    0.00328    0.04080
       C                 0.00400   -0.00278   -0.00430    0.00277   -0.01278   -0.00186   -0.00920    0.00136    0.02230
       C                 0.00200   -0.00188   -0.00393    0.00441   -0.00829   -0.00845   -0.02445    0.00706    0.02031
       C                 0.00380    0.00051   -0.00259    0.00980   -0.02733    0.00455    0.01011   -0.00468    0.03483
       C                 0.00076   -0.00005   -0.00051    0.01281   -0.01774   -0.00880   -0.02062    0.00690    0.03065
       H                 0.00059    0.00063   -0.00574   -0.00059    0.00235   -0.01338   -0.03894    0.01167    0.01028
       C                 0.00222    0.00178   -0.00161    0.01788   -0.03662    0.00404    0.01373   -0.00475    0.04512
       H                 0.00403    0.00037   -0.00248    0.00950   -0.03171    0.01023    0.02272   -0.00960    0.03660
       C                 0.00119    0.00089   -0.00058    0.01943   -0.03183   -0.00263   -0.00162    0.00105    0.04303
       H                -0.00026    0.00045   -0.00073    0.01438   -0.01424   -0.01392   -0.03243    0.01112    0.02902
       H                 0.00242    0.00410   -0.00191    0.02339   -0.04775    0.00901    0.02879   -0.00944    0.05483
       H                 0.00050    0.00186    0.00005    0.02615   -0.03938   -0.00294    0.00155    0.00073    0.05103
       C                 0.00169   -0.00020    0.00252    0.00058    0.01460   -0.00125   -0.01694   -0.00944   -0.02458
       C                 0.00120   -0.00055    0.00108    0.00865    0.01548   -0.00367   -0.01360   -0.00849   -0.02472
       C                 0.00155   -0.00233    0.00124   -0.00498    0.02314    0.00006   -0.02027   -0.01782   -0.03974
       C                 0.00092   -0.00047    0.00020    0.01108    0.02468   -0.00487   -0.01345   -0.01587   -0.04005
       H                 0.00043   -0.00046   -0.00022    0.01312    0.00897   -0.00457   -0.01122   -0.00224   -0.01316
       C                 0.00137    0.00012    0.00042   -0.00260    0.03230   -0.00112   -0.01996   -0.02526   -0.05518
       H                 0.00787   -0.00531   -0.00517   -0.01123    0.02259    0.00211   -0.02328   -0.01863   -0.03944
       C                 0.00064   -0.00007    0.00037    0.00545    0.03305   -0.00360   -0.01657   -0.02432   -0.05542
       H                 0.00145   -0.00089   -0.00081    0.01735    0.02532   -0.00675   -0.01088   -0.01515   -0.04020
       H                 0.00101   -0.00153   -0.00179   -0.00696    0.03893   -0.00008   -0.02255   -0.03191   -0.06713
       H                 0.00054   -0.00052   -0.00075    0.00736    0.04024   -0.00451   -0.01647   -0.03026   -0.06758
       C                -0.00378    0.00458   -0.00753    0.00723   -0.00350    0.00122   -0.01769    0.00179    0.00294
       C                -0.00043    0.00181   -0.00412    0.01861   -0.00596    0.00308   -0.02971    0.00069    0.00530
       C                 0.00017    0.00299   -0.00329    0.00434   -0.00709   -0.00082   -0.00603    0.00554    0.01042
       C                 0.00059    0.00089   -0.00060    0.02687   -0.01191    0.00302   -0.02992    0.00326    0.01498
       H                -0.00524    0.00178   -0.00678    0.02143   -0.00324    0.00485   -0.03880   -0.00238   -0.00030
       C                 0.00272    0.00174   -0.00022    0.01260   -0.01321   -0.00097   -0.00636    0.00820    0.02017
       H                -0.00163    0.00447   -0.00490   -0.00419   -0.00534   -0.00239    0.00353    0.00643    0.00888
       C                 0.00170    0.00130   -0.00045    0.02387   -0.01560    0.00100   -0.01819    0.00698    0.02247
       H                 0.00027    0.00145   -0.00093    0.03562   -0.01383    0.00459   -0.03912    0.00225    0.01681
       H                 0.00459    0.00201    0.00086    0.01024   -0.01620   -0.00255    0.00281    0.01113    0.02609
       H                 0.00169    0.00145    0.00030    0.03036   -0.02040    0.00097   -0.01830    0.00897    0.03016
       C                 0.00475    0.00161   -0.01514    0.04065    0.00887   -0.00891    0.00135   -0.00002   -0.01159
       C                -0.00393    0.00553   -0.00652    0.06355   -0.00796   -0.00940    0.00131   -0.00051   -0.00684
       C                -0.00019   -0.00054   -0.00487    0.04599    0.01156   -0.01081    0.01532   -0.00343   -0.01565
       H                 0.01246   -0.00380   -0.00098    0.04042    0.02838   -0.01434   -0.00427    0.00220   -0.02033
       C                -0.00072    0.00512   -0.00171    0.09098    0.00341   -0.01837    0.00679   -0.00106   -0.01572
       H                 0.00194    0.00860    0.00144    0.06301   -0.02816   -0.00413    0.00578   -0.00282    0.00094
       H                -0.01530    0.01693   -0.00105    0.06106   -0.00955   -0.00847   -0.00670    0.00153   -0.00475
       C                -0.00130    0.00013   -0.00061    0.07334    0.02298   -0.02013    0.02104   -0.00416   -0.02562
       H                -0.00171    0.00374   -0.00875    0.04549   -0.00823   -0.00506    0.02127   -0.00575   -0.00654
       H                 0.00282   -0.00163   -0.00964    0.02973    0.02395   -0.01076    0.01564   -0.00318   -0.01988
       C                -0.00097    0.00071   -0.00115    0.09606    0.00620   -0.02031    0.02014   -0.00419   -0.01974
       H                -0.00216    0.00657   -0.00324    0.10712   -0.00933   -0.01839    0.00653   -0.00133   -0.01159
       H                -0.00076    0.00281   -0.00137    0.09126    0.02291   -0.02418    0.00106    0.00104   -0.02413
       H                -0.00312    0.00399   -0.00027    0.07680    0.02448   -0.02132    0.03128   -0.00648   -0.02834
       H                -0.00096    0.00077    0.00002    0.07306    0.04318   -0.02601    0.01535   -0.00224   -0.03512
       H                 0.00007    0.00103   -0.00147    0.11539    0.01483   -0.02712    0.02362   -0.00474   -0.02672
       H                -0.00073   -0.00008   -0.00058    0.09750   -0.01346   -0.01481    0.02628   -0.00600   -0.01116

(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.

