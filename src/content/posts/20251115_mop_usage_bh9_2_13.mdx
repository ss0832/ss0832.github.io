---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(BH9データセットの2. Pericyclic, No. 13の化学反応, NNP(UMA)使用, 失敗例)
published: 2025-11-15
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-11-15

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、BH9データセットの2. Pericyclic, No. 13の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

BH9のデータセットについて:

- _J. Chem. Theory Comput._ 2022, 18, 1, 151–166 

https://doi.org/10.1021/acs.jctc.1c00694


この文献のSupporting Informationから、データセットの詳細を確認できる。

有機金属錯体が関わる反応を除いたさまざまなカテゴリの反応がまとめられたデータセットである。DFTの汎関数の電子エネルギーの精度の比較などのベンチマークに主に使われる。

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.19.6
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.19.6.zip
unzip v1.19.6.zip
cd MultiOptPy-v1.19.6
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.19.6 にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.19.6`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.19.6`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`bh9_2_13.xyz`とした。
初期構造は以下のものを使用した。

```
52
OptimizedStructure
C      4.944829241726     -2.046028391004      0.025861741516
C      3.752831615777     -2.764446268033     -0.629376907786
H      4.037393036668     -3.806263425353     -0.812542237984
H      3.536971991112     -2.322749205389     -1.605006720609
H      5.788294194014     -2.040683762991     -0.673639187218
H      5.267254192098     -2.622289293618      0.898995277051
C      2.522189708638     -2.710032853717      0.224089746025
C      1.418694872406     -2.044486238147     -0.094115613529
C      3.698175176683      1.624128520125     -0.161373906757
C      2.412748582317      1.970159596222     -0.201007474939
C      1.868057836512      3.197840140975      0.368774050580
C      0.564204721842      3.466223192753      0.395747830091
C     -0.039131150837      4.693811633527      1.000949509707
H      0.727203060183      5.352960397354      1.412285002223
H     -0.732622542809      4.430927382670      1.804096179055
H     -0.614788368716      5.256969419136      0.261105477031
C      0.261923769540     -1.961100579233      0.868064579824
C     -0.769426113142     -0.992823862416      0.580262102183
O      0.251080052080     -2.696395841832      1.852159861507
C     -0.816713080202     -0.079419757159     -0.544000372563
C     -1.952083266158     -0.798768442846      1.364949992345
O     -2.373468687263     -1.345386420251      2.376219369858
O     -0.081028689502      0.057778512891     -1.526037982487
C     -2.788267545017      0.304709344667      0.683938478951
H     -2.956305350652      1.099084389771      1.420793285363
C     -4.152721781631     -0.230434112628      0.234954029835
C     -4.010592134691     -1.391328966423     -0.751273372008
H     -3.540380701570     -1.031447922922     -1.672597704871
H     -3.324004947709     -2.125946070034     -0.325564072362
C     -5.331693997481     -2.076586757676     -1.084249963948
H     -5.830627841062     -2.417464006690     -0.173608057224
H     -5.168711013384     -2.949240701022     -1.719156001268
H     -6.018641883767     -1.412241397344     -1.612434142928
N     -1.923629293940      0.756644702395     -0.382619253353
H     -2.291728623684      1.156647364139     -1.230746056808
C     -5.022571278290      0.896370529114     -0.319728997225
H     -6.043546876847      0.564602034547     -0.514777144183
H     -4.618987494798      1.278130621797     -1.263229640119
H     -5.071753121809      1.730397617182      0.383770979780
H     -4.616854934001     -0.617701951928      1.148809653168
C      4.202331870938      0.307372163111     -0.669161585328
H      3.400532088745     -0.162118369654     -1.241125702069
H      5.048679131834      0.449483841046     -1.352789438390
C      4.627274217565     -0.620262040993      0.473027056906
H      3.816563387605     -0.649010645714      1.204927022436
H      5.497591773960     -0.194787852285      0.984178738682
H     -0.123714903107      2.739978620530     -0.031174354290
H      2.573390632901      3.902553470271      0.807735854376
H      4.418190163410      2.287103022164      0.317999911395
H      1.693842458487      1.296915994510     -0.664974123275
H      2.553818200501     -3.203866334355      1.193635729484
H      1.329929644527     -1.507481039241     -1.031021445850
```

<MoleculeViewer 
  xyzData={`52
OptimizedStructure
C      4.944829241726     -2.046028391004      0.025861741516
C      3.752831615777     -2.764446268033     -0.629376907786
H      4.037393036668     -3.806263425353     -0.812542237984
H      3.536971991112     -2.322749205389     -1.605006720609
H      5.788294194014     -2.040683762991     -0.673639187218
H      5.267254192098     -2.622289293618      0.898995277051
C      2.522189708638     -2.710032853717      0.224089746025
C      1.418694872406     -2.044486238147     -0.094115613529
C      3.698175176683      1.624128520125     -0.161373906757
C      2.412748582317      1.970159596222     -0.201007474939
C      1.868057836512      3.197840140975      0.368774050580
C      0.564204721842      3.466223192753      0.395747830091
C     -0.039131150837      4.693811633527      1.000949509707
H      0.727203060183      5.352960397354      1.412285002223
H     -0.732622542809      4.430927382670      1.804096179055
H     -0.614788368716      5.256969419136      0.261105477031
C      0.261923769540     -1.961100579233      0.868064579824
C     -0.769426113142     -0.992823862416      0.580262102183
O      0.251080052080     -2.696395841832      1.852159861507
C     -0.816713080202     -0.079419757159     -0.544000372563
C     -1.952083266158     -0.798768442846      1.364949992345
O     -2.373468687263     -1.345386420251      2.376219369858
O     -0.081028689502      0.057778512891     -1.526037982487
C     -2.788267545017      0.304709344667      0.683938478951
H     -2.956305350652      1.099084389771      1.420793285363
C     -4.152721781631     -0.230434112628      0.234954029835
C     -4.010592134691     -1.391328966423     -0.751273372008
H     -3.540380701570     -1.031447922922     -1.672597704871
H     -3.324004947709     -2.125946070034     -0.325564072362
C     -5.331693997481     -2.076586757676     -1.084249963948
H     -5.830627841062     -2.417464006690     -0.173608057224
H     -5.168711013384     -2.949240701022     -1.719156001268
H     -6.018641883767     -1.412241397344     -1.612434142928
N     -1.923629293940      0.756644702395     -0.382619253353
H     -2.291728623684      1.156647364139     -1.230746056808
C     -5.022571278290      0.896370529114     -0.319728997225
H     -6.043546876847      0.564602034547     -0.514777144183
H     -4.618987494798      1.278130621797     -1.263229640119
H     -5.071753121809      1.730397617182      0.383770979780
H     -4.616854934001     -0.617701951928      1.148809653168
C      4.202331870938      0.307372163111     -0.669161585328
H      3.400532088745     -0.162118369654     -1.241125702069
H      5.048679131834      0.449483841046     -1.352789438390
C      4.627274217565     -0.620262040993      0.473027056906
H      3.816563387605     -0.649010645714      1.204927022436
H      5.497591773960     -0.194787852285      0.984178738682
H     -0.123714903107      2.739978620530     -0.031174354290
H      2.573390632901      3.902553470271      0.807735854376
H      4.418190163410      2.287103022164      0.317999911395
H      1.693842458487      1.296915994510     -0.664974123275
H      2.553818200501     -3.203866334355      1.193635729484
H      1.329929644527     -1.507481039241     -1.031021445850`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`bh9_2_13.xyz`として保存する。その後、同じディレクトリ内で、`config_bh9_2_13.json`を作成し、以下のように記述する。

`config_bh9_2_13.json`
```json
{
  "work_dir": "bh9_2_13",
  "top_n_candidates": 3,
  "multioptpy_version": "v1.19.6b",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"manual_AFIR": ["200", "3", "4", "200", "10", "13"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 15,
    "ANEB": [3, 5],
    "QSM": true,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance_bernstein": 0.80,
    "align_distances": 9999,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py bh9_2_13.xyz -cfg config_bh9_2_13.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.19.6/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。


Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`bh9_2_13_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`bh9_2_13_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`bh9_2_13_step1_traj.xyz`はStep2のNEB計算に使用している。

※`bh9_2_13_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`bh9_2_13_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。
- `"align_distances": X`は線形補間で、各ノード間の距離を全て等しくするための処理である。X回の反復計算ごとに本処理を行う。Xを`"NSTEP": n`よりも大きな数値を指定することで、初期経路に対してのみ処理を行うことが出来る。
- `"node_distance_bernstein": N`はノード間の距離をN Åとして初期経路を作成することを示す。経路作成時に元のノードをベルンシュタイン多項式を用いてがたついた経路を滑らかにする。

→プログラムの仕様上`"align_distances": X`の処理を行った後に、`"node_distance_bernstein": N`の処理を行うようになっている。

- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"ANEB": [A, B]`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


`MultiOptPy-v1.19.6/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-1059.2932613190965,-1059.2932613190965,-1059.2755182618848,-1059.2754830551114,-1059.2755515564131];

export const dataset1_itr5 = [-1059.2933975243836,-1059.2934637585909,-1059.2850052398478,-1059.2873732299422,-1059.2867641985436];

export const dataset1_itr10 = [-1059.2934580809977,-1059.2935268867689,-1059.293567330859,-1059.2931775570726,-1059.2921873777987,-1059.2908173254793,-1059.29138245629,-1059.2914698982354,-1059.2918190395549,-1059.2915979069353,-1059.290291175552];

export const dataset2 = [-1059.2934799327222,-1059.2935659859354,-1059.2937006009709,-1059.2937083813763,-1059.2931674591925,-1059.2930943514175,-1059.2929545012557,-1059.2929943407876,-1059.2927845896397,-1059.2928376593654,-1059.292874024876,-1059.293063023895,-1059.2929773430546,-1059.2929760419395,-1059.2929322464922,-1059.2929666493778,-1059.2929725109673,-1059.2930173884868,-1059.293024897279,-1059.2930334793818,-1059.2931346158925,-1059.2929331401874,-1059.2915198225046];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.0013306993508434778,0.0013306994227335145,0.00668596299598332,0.006623614940783279,0.006631723540968656];

export const dataset1_grad_itr5 = [0.0008345225314894166,0.00039197513470624385,0.0036065843571759203,0.003118424149235073,0.0029361721002216803];

export const dataset1_grad_itr10 = [0.0004088385656782977,0.0002514158612511298,0.00041016644126541207,0.0009427508833182674,0.0014548386993323197,0.0019381069811650097,0.001751860212909657,0.0017888533505200223,0.0016181915729673682,0.0018215660561621053,0.0015704721739605292];

export const dataset2_grad = [0.000432836962608266,0.0001465147722485247,0.0001786028116171075,0.0003683238005661803,0.0008136070106398901,0.0008575588094106361,0.000937641640059762,0.0009247158428099567,0.0010088177963685659,0.0010072937239127323,0.0010150776957108792,0.0009497329488340714,0.0009937307642850972,0.0010335210655529024,0.001069478424822986,0.001071619314282289,0.0010616548031346271,0.0009547331552622854,0.0009268210585716885,0.0009030329469890818,0.0009025375070503549,0.0011903086655916755,0.0010966594266194059];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`bh9_2_13_step3_TS_Opt_Inputs`内に保存された`bh9_2_13_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`bh9_2_13_ts_guess_1.xyz`
```
52
0 1
C       4.968519013359     -2.032736718768      0.027693077009
C       3.754176336422     -2.716319522101     -0.625061723532
H       3.992770459809     -3.760058886625     -0.850733578237
H       3.567826908165     -2.295602793493     -1.614265517924
H       5.798584762281     -2.037979136175     -0.685234642182
H       5.290724039274     -2.619980573517      0.891878391097
C       2.525577251091     -2.648624131912      0.230412504114
C       1.414274685362     -1.994884048577     -0.088331400589
C       3.785401904183      1.649305880161     -0.138606854894
C       2.504174751705      2.009045874335     -0.168808844602
C       1.972551021383      3.230345860559      0.401519291945
C       0.663425524353      3.471741648068      0.415396595738
C       0.061660492354      4.693339221366      1.020258799689
H       0.836364386285      5.351306860833      1.414412739867
H      -0.622628850959      4.430207352483      1.829927439540
H      -0.524637098545      5.247633165743      0.284450162350
C       0.247000708432     -1.936508739290      0.863124665541
C      -0.806419329780     -0.998029774628      0.544954014462
O       0.240798272061     -2.653589831996      1.857805043741
C      -0.877921422004     -0.096302742170     -0.592347259526
C      -1.993877917573     -0.812634501380      1.333192094668
O      -2.387320534897     -1.347945059112      2.357200038357
O      -0.138675941810      0.048671481477     -1.565777468298
C      -2.850584937546      0.271887242830      0.645537955972
H      -3.010190365752      1.078896356778      1.371046436929
C      -4.223231544202     -0.266442497408      0.222756351431
C      -4.098196716362     -1.447720735625     -0.741174097928
H      -3.622789266863     -1.112171485023     -1.668817791262
H      -3.424313929279     -2.186510303399     -0.302277634799
C      -5.430555381324     -2.116855737330     -1.065898867548
H      -5.937645291455     -2.437404760252     -0.152781927296
H      -5.281037560234     -3.000239295054     -1.688309849269
H      -6.104196754776     -1.448944206883     -1.605145312259
N      -2.001636720377      0.708433045833     -0.438636630180
H      -2.367882279722      1.137812214162     -1.271976057762
C      -5.091154895367      0.856270399395     -0.343708146572
H      -6.115268512143      0.526387483705     -0.520967520865
H      -4.697422551243      1.217556216840     -1.299129828908
H      -5.129954714281      1.705076860214      0.342539411431
H      -4.682100880259     -0.630972396800      1.148585683822
C       4.263304949836      0.330594577788     -0.648539387549
H       3.452471335231     -0.130774547384     -1.214191880211
H       5.106677522080      0.463820236430     -1.335628626394
C       4.686334686784     -0.603444641237      0.488821029134
H       3.887720256959     -0.619128995093      1.234712299098
H       5.572108473175     -0.198537268204      0.988250448000
H      -0.005037239804      2.730749247621     -0.019421083549
H       2.664558001567      3.947226216924      0.842089422829
H       4.515707941399      2.302875085453      0.335889975157
H       1.771918774629      1.344615746457     -0.621025942055
H       2.560014887397     -3.143159729532      1.199769085949
H       1.320033290981     -1.460295216487     -1.025425083681
```

<MoleculeViewer 
  xyzData={`52
0 1
C       4.968519013359     -2.032736718768      0.027693077009
C       3.754176336422     -2.716319522101     -0.625061723532
H       3.992770459809     -3.760058886625     -0.850733578237
H       3.567826908165     -2.295602793493     -1.614265517924
H       5.798584762281     -2.037979136175     -0.685234642182
H       5.290724039274     -2.619980573517      0.891878391097
C       2.525577251091     -2.648624131912      0.230412504114
C       1.414274685362     -1.994884048577     -0.088331400589
C       3.785401904183      1.649305880161     -0.138606854894
C       2.504174751705      2.009045874335     -0.168808844602
C       1.972551021383      3.230345860559      0.401519291945
C       0.663425524353      3.471741648068      0.415396595738
C       0.061660492354      4.693339221366      1.020258799689
H       0.836364386285      5.351306860833      1.414412739867
H      -0.622628850959      4.430207352483      1.829927439540
H      -0.524637098545      5.247633165743      0.284450162350
C       0.247000708432     -1.936508739290      0.863124665541
C      -0.806419329780     -0.998029774628      0.544954014462
O       0.240798272061     -2.653589831996      1.857805043741
C      -0.877921422004     -0.096302742170     -0.592347259526
C      -1.993877917573     -0.812634501380      1.333192094668
O      -2.387320534897     -1.347945059112      2.357200038357
O      -0.138675941810      0.048671481477     -1.565777468298
C      -2.850584937546      0.271887242830      0.645537955972
H      -3.010190365752      1.078896356778      1.371046436929
C      -4.223231544202     -0.266442497408      0.222756351431
C      -4.098196716362     -1.447720735625     -0.741174097928
H      -3.622789266863     -1.112171485023     -1.668817791262
H      -3.424313929279     -2.186510303399     -0.302277634799
C      -5.430555381324     -2.116855737330     -1.065898867548
H      -5.937645291455     -2.437404760252     -0.152781927296
H      -5.281037560234     -3.000239295054     -1.688309849269
H      -6.104196754776     -1.448944206883     -1.605145312259
N      -2.001636720377      0.708433045833     -0.438636630180
H      -2.367882279722      1.137812214162     -1.271976057762
C      -5.091154895367      0.856270399395     -0.343708146572
H      -6.115268512143      0.526387483705     -0.520967520865
H      -4.697422551243      1.217556216840     -1.299129828908
H      -5.129954714281      1.705076860214      0.342539411431
H      -4.682100880259     -0.630972396800      1.148585683822
C       4.263304949836      0.330594577788     -0.648539387549
H       3.452471335231     -0.130774547384     -1.214191880211
H       5.106677522080      0.463820236430     -1.335628626394
C       4.686334686784     -0.603444641237      0.488821029134
H       3.887720256959     -0.619128995093      1.234712299098
H       5.572108473175     -0.198537268204      0.988250448000
H      -0.005037239804      2.730749247621     -0.019421083549
H       2.664558001567      3.947226216924      0.842089422829
H       4.515707941399      2.302875085453      0.335889975157
H       1.771918774629      1.344615746457     -0.621025942055
H       2.560014887397     -3.143159729532      1.199769085949
H       1.320033290981     -1.460295216487     -1.025425083681`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`bh9_2_13_ts_guess_2.xyz`
```
52
0 1
C       4.952161994813     -2.052840428276     -0.002181863336
C       3.722560715100     -2.717738808647     -0.648353355672
H       3.941283055892     -3.762756194604     -0.881363590920
H       3.533150119983     -2.286435280413     -1.630799773287
H       5.773313758680     -2.059559763134     -0.725631813593
H       5.277666219730     -2.653574563542      0.851124453639
C       2.504069706394     -2.632358754540      0.220479777730
C       1.398258040507     -1.964327654486     -0.086078948485
C       3.794403754532      1.639565439094     -0.117783752971
C       2.515513717159      2.007962174461     -0.150297310963
C       1.990225951056      3.227397018034      0.429575219640
C       0.681688482732      3.483076206841      0.427045515972
C       0.087884080396      4.705909277441      1.033644700597
H       0.864395193366      5.352907690236      1.440400260694
H      -0.610328073755      4.445683317993      1.833205821667
H      -0.483977311824      5.271947720323      0.293859779900
C       0.244211332634     -1.886967834175      0.879351799963
C      -0.811484250107     -0.952450546986      0.559138756963
O       0.247956439480     -2.589583547801      1.885444992927
C      -0.887926017128     -0.057648548984     -0.583430078596
C      -2.000898163661     -0.770964557276      1.344806543682
O      -2.389482262224     -1.300239915125      2.374194040675
O      -0.142581231187      0.094663357307     -1.551880041423
C      -2.871244309557      0.292562478469      0.641917698382
H      -3.048762471394      1.104972671353      1.357203076108
C      -4.231721435041     -0.274710024409      0.216971794592
C      -4.078529491786     -1.473387466485     -0.721266006823
H      -3.587468989782     -1.151237060084     -1.645600194109
H      -3.406933104577     -2.197350053455     -0.254827459617
C      -5.397800219738     -2.160954994929     -1.058646927601
H      -5.922326004939     -2.465477858993     -0.149779375132
H      -5.227801769791     -3.057123262206     -1.657671165192
H      -6.065126261696     -1.511532669569     -1.627596574024
N      -2.023531096269      0.729784528127     -0.441645573031
H      -2.383094295551      1.168577776374     -1.272669473112
C      -5.109653543035      0.823350322445     -0.381454313011
H      -6.128503223504      0.476591798638     -0.556799263841
H      -4.714154587335      1.166042430976     -1.343053355822
H      -5.163605809817      1.687922758916      0.283780966222
H      -4.694863520807     -0.627167577180      1.145301567418
C       4.266534470383      0.325722800088     -0.645163734057
H       3.453446666138     -0.125463557067     -1.214968229187
H       5.109211441998      0.464633327677     -1.332401623010
C       4.690076718903     -0.626012490867      0.477829126025
H       3.899369271360     -0.642130215941      1.231536675960
H       5.585449577934     -0.236989916904      0.973351937117
H       0.013333647640      2.752569967894     -0.023672439670
H       2.682822259765      3.934221368812      0.883190293001
H       4.527600729858      2.282447430586      0.367947005810
H       1.781693155999      1.353746133864     -0.614078520199
H       2.543932211691     -3.124743936217      1.190810646583
H       1.299584730383     -1.430530513652     -1.023017694584
```

<MoleculeViewer 
  xyzData={`52
0 1
C       4.952161994813     -2.052840428276     -0.002181863336
C       3.722560715100     -2.717738808647     -0.648353355672
H       3.941283055892     -3.762756194604     -0.881363590920
H       3.533150119983     -2.286435280413     -1.630799773287
H       5.773313758680     -2.059559763134     -0.725631813593
H       5.277666219730     -2.653574563542      0.851124453639
C       2.504069706394     -2.632358754540      0.220479777730
C       1.398258040507     -1.964327654486     -0.086078948485
C       3.794403754532      1.639565439094     -0.117783752971
C       2.515513717159      2.007962174461     -0.150297310963
C       1.990225951056      3.227397018034      0.429575219640
C       0.681688482732      3.483076206841      0.427045515972
C       0.087884080396      4.705909277441      1.033644700597
H       0.864395193366      5.352907690236      1.440400260694
H      -0.610328073755      4.445683317993      1.833205821667
H      -0.483977311824      5.271947720323      0.293859779900
C       0.244211332634     -1.886967834175      0.879351799963
C      -0.811484250107     -0.952450546986      0.559138756963
O       0.247956439480     -2.589583547801      1.885444992927
C      -0.887926017128     -0.057648548984     -0.583430078596
C      -2.000898163661     -0.770964557276      1.344806543682
O      -2.389482262224     -1.300239915125      2.374194040675
O      -0.142581231187      0.094663357307     -1.551880041423
C      -2.871244309557      0.292562478469      0.641917698382
H      -3.048762471394      1.104972671353      1.357203076108
C      -4.231721435041     -0.274710024409      0.216971794592
C      -4.078529491786     -1.473387466485     -0.721266006823
H      -3.587468989782     -1.151237060084     -1.645600194109
H      -3.406933104577     -2.197350053455     -0.254827459617
C      -5.397800219738     -2.160954994929     -1.058646927601
H      -5.922326004939     -2.465477858993     -0.149779375132
H      -5.227801769791     -3.057123262206     -1.657671165192
H      -6.065126261696     -1.511532669569     -1.627596574024
N      -2.023531096269      0.729784528127     -0.441645573031
H      -2.383094295551      1.168577776374     -1.272669473112
C      -5.109653543035      0.823350322445     -0.381454313011
H      -6.128503223504      0.476591798638     -0.556799263841
H      -4.714154587335      1.166042430976     -1.343053355822
H      -5.163605809817      1.687922758916      0.283780966222
H      -4.694863520807     -0.627167577180      1.145301567418
C       4.266534470383      0.325722800088     -0.645163734057
H       3.453446666138     -0.125463557067     -1.214968229187
H       5.109211441998      0.464633327677     -1.332401623010
C       4.690076718903     -0.626012490867      0.477829126025
H       3.899369271360     -0.642130215941      1.231536675960
H       5.585449577934     -0.236989916904      0.973351937117
H       0.013333647640      2.752569967894     -0.023672439670
H       2.682822259765      3.934221368812      0.883190293001
H       4.527600729858      2.282447430586      0.367947005810
H       1.781693155999      1.353746133864     -0.614078520199
H       2.543932211691     -3.124743936217      1.190810646583
H       1.299584730383     -1.430530513652     -1.023017694584`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`bh9_2_13_ts_guess_3.xyz`
```
52
0 1
C       4.964713379926     -2.033890488693      0.024873896089
C       3.753158681750     -2.722618659399     -0.630378527278
H       4.000526934363     -3.764634052766     -0.853315031116
H       3.564236390048     -2.301423911822     -1.618503899851
H       5.796567800110     -2.033085017626     -0.686156230947
H       5.289174027188     -2.621011946790      0.888617284160
C       2.525294412824     -2.661377942151      0.225070797957
C       1.415033024951     -2.005735466646     -0.091956120337
C       3.767940949872      1.645015143980     -0.132557895222
C       2.486664354311      2.004637095257     -0.164382449044
C       1.958603223483      3.228129635635      0.403058280420
C       0.649277780420      3.475455427511      0.414676095536
C       0.050334114405      4.698571171982      1.013459276829
H       0.824665681028      5.356082899311      1.409986068725
H      -0.639470754406      4.441140827399      1.820377529192
H      -0.530860664367      5.254476643992      0.273181476286
C       0.249716926644     -1.944442250257      0.861466323853
C      -0.799923179886     -1.000713061118      0.546366644094
O       0.242914648394     -2.662124060049      1.855698141976
C      -0.870212310540     -0.099858766029     -0.591662396741
C      -1.984754241874     -0.809212660136      1.337377490684
O      -2.378073803635     -1.341763130631      2.363020976982
O      -0.133942150110      0.039133776825     -1.568626677213
C      -2.839113804614      0.276464686842      0.649210327407
H      -2.998106143494      1.083994476801      1.374330943617
C      -4.211651745625     -0.260876000373      0.225147513601
C      -4.085147981988     -1.440978044328     -0.740150143701
H      -3.610643490140     -1.103680422242     -1.667675624214
H      -3.409677065934     -2.179112546179     -0.302454167783
C      -5.416395239209     -2.112103419407     -1.065052072432
H      -5.922191709885     -2.434699212797     -0.151945603461
H      -5.265469515956     -2.994413352487     -1.688660847806
H      -6.091669293927     -1.444768493784     -1.603076525615
N      -1.989221899920      0.711200719633     -0.435274951166
H      -2.357597020601      1.136472889489     -1.270436815308
C      -5.078825214401      0.862567479081     -0.341010676695
H      -6.102577265037      0.532899452770     -0.520586166637
H      -4.683389826283      1.225429374836     -1.295168821389
H      -5.118749108756      1.710325941573      0.346508524619
H      -4.671119205328     -0.626502829422      1.150229694272
C       4.248261371943      0.328489892181     -0.645602607433
H       3.438599666199     -0.133110625649     -1.212407708703
H       5.091330197460      0.465198601130     -1.332740397417
C       4.674280547764     -0.607183327512      0.489355202243
H       3.874376911420     -0.628554386515      1.233953083899
H       5.557205732291     -0.198598450022      0.991522855775
H      -0.021117322683      2.735932887621     -0.020898299501
H       2.651750725469      3.942486484819      0.844683586197
H       4.497836927550      2.298924668197      0.342806620806
H       1.756188887523      1.340757461629     -0.619557129714
H       2.559598963551     -3.158534478664      1.193106243313
H       1.321647697708     -1.468780634998     -1.027847091805
```

<MoleculeViewer 
  xyzData={`52
0 1
C       4.964713379926     -2.033890488693      0.024873896089
C       3.753158681750     -2.722618659399     -0.630378527278
H       4.000526934363     -3.764634052766     -0.853315031116
H       3.564236390048     -2.301423911822     -1.618503899851
H       5.796567800110     -2.033085017626     -0.686156230947
H       5.289174027188     -2.621011946790      0.888617284160
C       2.525294412824     -2.661377942151      0.225070797957
C       1.415033024951     -2.005735466646     -0.091956120337
C       3.767940949872      1.645015143980     -0.132557895222
C       2.486664354311      2.004637095257     -0.164382449044
C       1.958603223483      3.228129635635      0.403058280420
C       0.649277780420      3.475455427511      0.414676095536
C       0.050334114405      4.698571171982      1.013459276829
H       0.824665681028      5.356082899311      1.409986068725
H      -0.639470754406      4.441140827399      1.820377529192
H      -0.530860664367      5.254476643992      0.273181476286
C       0.249716926644     -1.944442250257      0.861466323853
C      -0.799923179886     -1.000713061118      0.546366644094
O       0.242914648394     -2.662124060049      1.855698141976
C      -0.870212310540     -0.099858766029     -0.591662396741
C      -1.984754241874     -0.809212660136      1.337377490684
O      -2.378073803635     -1.341763130631      2.363020976982
O      -0.133942150110      0.039133776825     -1.568626677213
C      -2.839113804614      0.276464686842      0.649210327407
H      -2.998106143494      1.083994476801      1.374330943617
C      -4.211651745625     -0.260876000373      0.225147513601
C      -4.085147981988     -1.440978044328     -0.740150143701
H      -3.610643490140     -1.103680422242     -1.667675624214
H      -3.409677065934     -2.179112546179     -0.302454167783
C      -5.416395239209     -2.112103419407     -1.065052072432
H      -5.922191709885     -2.434699212797     -0.151945603461
H      -5.265469515956     -2.994413352487     -1.688660847806
H      -6.091669293927     -1.444768493784     -1.603076525615
N      -1.989221899920      0.711200719633     -0.435274951166
H      -2.357597020601      1.136472889489     -1.270436815308
C      -5.078825214401      0.862567479081     -0.341010676695
H      -6.102577265037      0.532899452770     -0.520586166637
H      -4.683389826283      1.225429374836     -1.295168821389
H      -5.118749108756      1.710325941573      0.346508524619
H      -4.671119205328     -0.626502829422      1.150229694272
C       4.248261371943      0.328489892181     -0.645602607433
H       3.438599666199     -0.133110625649     -1.212407708703
H       5.091330197460      0.465198601130     -1.332740397417
C       4.674280547764     -0.607183327512      0.489355202243
H       3.874376911420     -0.628554386515      1.233953083899
H       5.557205732291     -0.198598450022      0.991522855775
H      -0.021117322683      2.735932887621     -0.020898299501
H       2.651750725469      3.942486484819      0.844683586197
H       4.497836927550      2.298924668197      0.342806620806
H       1.756188887523      1.340757461629     -0.619557129714
H       2.559598963551     -3.158534478664      1.193106243313
H       1.321647697708     -1.468780634998     -1.027847091805`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-v1.19.6/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`bh9_2_13_ts_final_X.xyz`として保存されている。)

`bh9_2_13_ts_final_1.xyz`
```
52
OptimizedStructure
C      4.947262029909     -2.077372361459     -0.034995258752
C      3.716877279161     -2.746516990865     -0.677693175013
H      3.956889333411     -3.800372795142     -0.852257095877
H      3.514027199961     -2.306135090989     -1.656450440459
H      5.769454263182     -2.075934624300     -0.757492156209
H      5.277475645703     -2.685643899762      0.812081402113
C      2.501936085060     -2.632410816889      0.188723035133
C      1.415416764970     -1.939270287319     -0.130414859951
C      3.731860546013      1.599266898368     -0.066722924577
C      2.446455200831      1.952332777318     -0.088410644376
C      1.926210537679      3.158346097526      0.534177298160
C      0.628320757910      3.457728506784      0.566072962354
C      0.050911118126      4.674223555513      1.211279775016
H      0.826249994243      5.303633916934      1.649429394265
H     -0.653034516499      4.399032866254      2.000775611640
H     -0.511256828616      5.272503189211      0.489535694996
C      0.278334472344     -1.783905180306      0.844333917912
C     -0.772800853762     -0.865552302603      0.470008126960
O      0.295592874012     -2.407959630093      1.900262678270
C     -0.870878950557     -0.080680690964     -0.750660615146
C     -1.935397431800     -0.591527964669      1.268338656194
O     -2.294107704209     -1.007039730975      2.358826585528
O     -0.146223782697     -0.023193278205     -1.744152949752
C     -2.820874540167      0.400934665019      0.485766821474
H     -2.979283741259      1.283387931550      1.117657837209
C     -4.192458365267     -0.204207082341      0.158303469802
C     -4.062890592631     -1.509857261147     -0.628545977722
H     -3.564932755336     -1.310558937892     -1.583230418792
H     -3.406425518241     -2.184812585717     -0.075634403663
C     -5.395516903382     -2.207682868727     -0.884392621005
H     -5.931154221015     -2.380480528163      0.052258294986
H     -5.241426701568     -3.177293274230     -1.360130729736
H     -6.045618680447     -1.623810571774     -1.537969114467
N     -2.000857839009      0.719995138122     -0.657764015532
H     -2.366164728628      1.110107348219     -1.509932731596
C     -5.076792548909      0.818595931030     -0.552883779585
H     -6.103556597880      0.465301959279     -0.652799690568
H     -4.706672554400      1.027080446722     -1.561767230587
H     -5.102848731144      1.762998091575     -0.004492440635
H     -4.638499353834     -0.437801809223      1.131483683617
C      4.242997684319      0.314761412242     -0.634626899272
H      3.448338492985     -0.137454769118     -1.230038234678
H      5.088967378079      0.498527201673     -1.307117664133
C      4.680393921028     -0.659009257038      0.465642938918
H      3.893766528032     -0.693274685212      1.223120112140
H      5.575750245127     -0.273313591371      0.962975641024
H     -0.073179095176      2.768527317277      0.100444641741
H      2.646628264551      3.826098858563      1.003684661043
H      4.449668168376      2.240883390621      0.442800227845
H      1.723775695132      1.305910372595     -0.582012377414
H      2.535042600411     -3.103906212891      1.168553958245
H      1.324250455881     -1.433198793009     -1.083948977088
```

<MoleculeViewer 
  xyzData={`52
OptimizedStructure
C      4.947262029909     -2.077372361459     -0.034995258752
C      3.716877279161     -2.746516990865     -0.677693175013
H      3.956889333411     -3.800372795142     -0.852257095877
H      3.514027199961     -2.306135090989     -1.656450440459
H      5.769454263182     -2.075934624300     -0.757492156209
H      5.277475645703     -2.685643899762      0.812081402113
C      2.501936085060     -2.632410816889      0.188723035133
C      1.415416764970     -1.939270287319     -0.130414859951
C      3.731860546013      1.599266898368     -0.066722924577
C      2.446455200831      1.952332777318     -0.088410644376
C      1.926210537679      3.158346097526      0.534177298160
C      0.628320757910      3.457728506784      0.566072962354
C      0.050911118126      4.674223555513      1.211279775016
H      0.826249994243      5.303633916934      1.649429394265
H     -0.653034516499      4.399032866254      2.000775611640
H     -0.511256828616      5.272503189211      0.489535694996
C      0.278334472344     -1.783905180306      0.844333917912
C     -0.772800853762     -0.865552302603      0.470008126960
O      0.295592874012     -2.407959630093      1.900262678270
C     -0.870878950557     -0.080680690964     -0.750660615146
C     -1.935397431800     -0.591527964669      1.268338656194
O     -2.294107704209     -1.007039730975      2.358826585528
O     -0.146223782697     -0.023193278205     -1.744152949752
C     -2.820874540167      0.400934665019      0.485766821474
H     -2.979283741259      1.283387931550      1.117657837209
C     -4.192458365267     -0.204207082341      0.158303469802
C     -4.062890592631     -1.509857261147     -0.628545977722
H     -3.564932755336     -1.310558937892     -1.583230418792
H     -3.406425518241     -2.184812585717     -0.075634403663
C     -5.395516903382     -2.207682868727     -0.884392621005
H     -5.931154221015     -2.380480528163      0.052258294986
H     -5.241426701568     -3.177293274230     -1.360130729736
H     -6.045618680447     -1.623810571774     -1.537969114467
N     -2.000857839009      0.719995138122     -0.657764015532
H     -2.366164728628      1.110107348219     -1.509932731596
C     -5.076792548909      0.818595931030     -0.552883779585
H     -6.103556597880      0.465301959279     -0.652799690568
H     -4.706672554400      1.027080446722     -1.561767230587
H     -5.102848731144      1.762998091575     -0.004492440635
H     -4.638499353834     -0.437801809223      1.131483683617
C      4.242997684319      0.314761412242     -0.634626899272
H      3.448338492985     -0.137454769118     -1.230038234678
H      5.088967378079      0.498527201673     -1.307117664133
C      4.680393921028     -0.659009257038      0.465642938918
H      3.893766528032     -0.693274685212      1.223120112140
H      5.575750245127     -0.273313591371      0.962975641024
H     -0.073179095176      2.768527317277      0.100444641741
H      2.646628264551      3.826098858563      1.003684661043
H      4.449668168376      2.240883390621      0.442800227845
H      1.723775695132      1.305910372595     -0.582012377414
H      2.535042600411     -3.103906212891      1.168553958245
H      1.324250455881     -1.433198793009     -1.083948977088`}
  caption="遷移状態構造 (No.1)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -18.9786             15.8218             21.9530
Reduced mass [au]                   4.9901              5.6653              4.6720
Force const [Dyne/A]               -0.0011              0.0008              0.0013
Char temp [K]                       0.0000             22.7640             31.5855
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00868   -0.00733   -0.00648   -0.01177   -0.03053   -0.02723   -0.00906   -0.01325   -0.02427
       C                 0.00624   -0.00409   -0.00593   -0.03161   -0.00655   -0.01447   -0.02297   -0.00497   -0.00607
       H                 0.00227   -0.00524   -0.00424   -0.05341   -0.01084   -0.01851   -0.03626   -0.00900   -0.00014
       H                 0.00795   -0.00488   -0.00660   -0.03452   -0.00172   -0.01164   -0.02817   -0.01073   -0.00762
       H                 0.00628   -0.00362   -0.00917   -0.02018   -0.04360   -0.03681   -0.01869   -0.02157   -0.03523
       H                 0.01151   -0.01166   -0.01071   -0.01301   -0.03876   -0.03265   -0.00234   -0.01360   -0.02714
       C                 0.00668    0.00313   -0.00630   -0.01961    0.01467   -0.00058   -0.01359    0.01555    0.00465
       C                 0.01144    0.01020   -0.00722   -0.01122    0.03458    0.01386   -0.01252    0.01633    0.00290
       C                -0.02466   -0.02057    0.02162    0.02084   -0.02205   -0.00651    0.01692   -0.00496   -0.00842
       C                -0.03042   -0.04197    0.00482    0.02101   -0.02196   -0.02630    0.01810    0.00113    0.02376
       C                -0.06208   -0.06361    0.01958    0.00715   -0.03275   -0.01792    0.03895    0.00257    0.03865
       C                -0.06743   -0.08456    0.00251    0.00543   -0.03711   -0.03871    0.04085    0.00648    0.07555
       C                -0.09643   -0.10716    0.01927   -0.01142   -0.05085   -0.02823    0.06225    0.00662    0.09440
       H                -0.11320   -0.10590    0.04730   -0.02250   -0.05683    0.00012    0.07650    0.00445    0.07220
       H                -0.10653   -0.13504    0.00062   -0.02719   -0.06837   -0.04831    0.08524    0.00674    0.11489
       H                -0.09201   -0.09886    0.02258    0.00161   -0.03865   -0.02839    0.04192    0.00840    0.11179
       C                 0.01428    0.02334   -0.00636    0.00031    0.04444    0.02568   -0.00476    0.03913    0.00833
       C                 0.01994    0.02869   -0.01026   -0.00295    0.04365    0.03281   -0.01022    0.02553   -0.00886
       O                 0.01176    0.02924   -0.00284    0.00658    0.04421    0.02545    0.00510    0.06646    0.02450
       C                 0.01345    0.00734   -0.02296    0.00007    0.06390    0.04603   -0.01895   -0.00533   -0.02856
       C                 0.02705    0.04740   -0.00624   -0.01927    0.00829    0.02154   -0.00944    0.03824   -0.01234
       O                 0.03517    0.06969    0.00479   -0.02647   -0.01709    0.00942   -0.00174    0.06614    0.00094
       O                 0.00611   -0.01220   -0.02940    0.01885    0.10266    0.06154   -0.02150   -0.02387   -0.03132
       C                 0.02396    0.03548   -0.01766   -0.03026   -0.00027    0.02306   -0.02211    0.00646   -0.03808
       H                 0.02953    0.04699   -0.03227   -0.06078   -0.01336    0.03351   -0.03540    0.02082   -0.06159
       C                 0.02071    0.03154    0.00248   -0.01066   -0.02825   -0.00799   -0.01334   -0.02244   -0.02316
       C                 0.01370    0.01862    0.02268    0.03363   -0.01357   -0.02512    0.00607   -0.04518    0.01761
       H                 0.00614    0.00271    0.01541    0.04575    0.01252   -0.01335    0.00750   -0.06824    0.01352
       H                 0.01785    0.02729    0.02836    0.03974   -0.00646   -0.02369    0.01218   -0.02004    0.04096
       C                 0.01135    0.01506    0.04448    0.05453   -0.04100   -0.05921    0.01581   -0.06983    0.03395
       H                 0.01855    0.03054    0.05145    0.04191   -0.06773   -0.07136    0.01415   -0.04726    0.03719
       H                 0.00726    0.00725    0.05908    0.08577   -0.03021   -0.07109    0.02996   -0.08280    0.06497
       H                 0.00655    0.00466    0.03999    0.05244   -0.04645   -0.06199    0.01108   -0.09850    0.01300
       N                 0.01689    0.01366   -0.02876   -0.01956    0.03531    0.04110   -0.02554   -0.01267   -0.04575
       H                 0.01021   -0.00488   -0.03449   -0.00985    0.05250    0.04496   -0.02761   -0.03168   -0.05347
       C                 0.01602    0.02057   -0.00737   -0.02312   -0.03900   -0.00789   -0.02516   -0.05641   -0.05728
       H                 0.01553    0.01867    0.00451   -0.01327   -0.06156   -0.02926   -0.02060   -0.07249   -0.04738
       H                 0.00950    0.00549   -0.01287   -0.01169   -0.01655    0.00095   -0.02621   -0.08440   -0.06342
       H                 0.01898    0.02879   -0.02146   -0.05397   -0.04719    0.00476   -0.03770   -0.03905   -0.08770
       H                 0.02794    0.04772    0.00969   -0.02106   -0.05304   -0.01873   -0.01282    0.00166   -0.01712
       C                 0.00686   -0.00275    0.00960    0.02853   -0.01549   -0.01453   -0.00302   -0.00883   -0.01777
       H                 0.02302   -0.00847   -0.00758    0.03413   -0.00925   -0.02681   -0.01706   -0.00384   -0.00279
       H                 0.01242    0.02152    0.02333    0.03460   -0.00887   -0.00504   -0.01371   -0.01554   -0.03293
       C                 0.00943   -0.01029    0.00250    0.01860   -0.02719   -0.02052    0.00895   -0.01013   -0.02356
       H                 0.01075   -0.01615    0.00354    0.02340   -0.01600   -0.01510    0.02122   -0.00305   -0.01046
       H                 0.00980   -0.01319    0.00396    0.02901   -0.04542   -0.02527    0.01972   -0.01515   -0.03901
       H                -0.04926   -0.08431   -0.02505    0.01665   -0.03142   -0.06363    0.02603    0.00991    0.09265
       H                -0.08199   -0.06306    0.04855   -0.00414   -0.03938    0.00848    0.05411   -0.00035    0.01960
       H                -0.04498   -0.01831    0.04738    0.01190   -0.03062    0.01684    0.03226   -0.00782   -0.02650
       H                -0.01091   -0.04437   -0.02039    0.03026   -0.01454   -0.04928    0.00301    0.00402    0.04177
       H                 0.00407    0.00492   -0.00534   -0.01731    0.01142   -0.00222   -0.00695    0.03060    0.01170
       H                 0.01437    0.00760   -0.00889   -0.01305    0.03983    0.01688   -0.01765    0.00029   -0.00515
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_2_13_ts_final_2.xyz`
```
52
OptimizedStructure
C      4.947856035829     -2.075922528705     -0.038367616198
C      3.717304417601     -2.745298715209     -0.680504374052
H      3.957536656058     -3.799042554682     -0.855441986803
H      3.513754637134     -2.304760193634     -1.659045754057
H      5.769630217394     -2.074071811771     -0.761339452681
H      5.278744877438     -2.684283552447      0.808381102748
C      2.502830568305     -2.631752930818      0.186640080984
C      1.415922589565     -1.938860107296     -0.131711097950
C      3.731320568155      1.600354097250     -0.068560499377
C      2.445793469563      1.953026663013     -0.089409980628
C      1.925542912341      3.158738317435      0.533757577811
C      0.627580073363      3.457713720519      0.566486404998
C      0.050178287975      4.673886081685      1.212308803508
H      0.825583104890      5.303437916739      1.650138998177
H     -0.653213494224      4.398301973124      2.002160833897
H     -0.512602312685      5.272153722372      0.491032317811
C      0.279365190778     -1.784039047824      0.843735184094
C     -0.772242000341     -0.865891100672      0.470232646509
O      0.297415360787     -2.408327410973      1.899512238739
C     -0.871272262125     -0.080803365774     -0.750219979681
C     -1.934426860973     -0.592337392864      1.269323614622
O     -2.292362821946     -1.008161281957      2.359946665923
O     -0.147241546632     -0.022930103396     -1.744144695354
C     -2.820643218132      0.400045851627      0.487488900754
H     -2.978906960990      1.282328949213      1.119654184445
C     -4.192262400485     -0.205398567115      0.160734109655
C     -4.062819944596     -1.510852686090     -0.626461332405
H     -3.565494400328     -1.311225009776     -1.581406700349
H     -3.405838028650     -2.185744568701     -0.074086194854
C     -5.395412810724     -2.208984757300     -0.881643757511
H     -5.930436796320     -2.382118501705      0.055295859243
H     -5.241349814784     -3.178456161808     -1.357673894044
H     -6.046067409873     -1.625153936618     -1.534706569103
N     -2.001405585203      0.719558034016     -0.656474686126
H     -2.367342281706      1.109724673468     -1.508348509683
C     -5.077303921355      0.817311343934     -0.549706312944
H     -6.104032446232      0.463760085918     -0.649072195832
H     -4.707852772420      1.026103850007     -1.558771078770
H     -5.103283349667      1.761593526414     -0.001104833828
H     -4.637649565789     -0.439312979182      1.134136984230
C      4.242519240748      0.316133064539     -0.637052570967
H      3.447653075104     -0.136190042477     -1.232106623980
H      5.088043913416      0.500308013443     -1.309990771104
C      4.680846520015     -0.657753238206      0.462744431205
H      3.894667395313     -0.692427938088      1.220668181436
H      5.576372763683     -0.271897760395      0.959646808453
H     -0.073983167095      2.768403158482      0.101115419974
H      2.646031231628      3.826606283425      1.002992032604
H      4.449230593448      2.242078465992      0.440683184933
H      1.723023182371      1.306491905692     -0.582731472025
H      2.536645120878     -3.103459066590      1.166345358786
H      1.324054169494     -1.432602386235     -1.085078985234
```

<MoleculeViewer 
  xyzData={`52
OptimizedStructure
C      4.947856035829     -2.075922528705     -0.038367616198
C      3.717304417601     -2.745298715209     -0.680504374052
H      3.957536656058     -3.799042554682     -0.855441986803
H      3.513754637134     -2.304760193634     -1.659045754057
H      5.769630217394     -2.074071811771     -0.761339452681
H      5.278744877438     -2.684283552447      0.808381102748
C      2.502830568305     -2.631752930818      0.186640080984
C      1.415922589565     -1.938860107296     -0.131711097950
C      3.731320568155      1.600354097250     -0.068560499377
C      2.445793469563      1.953026663013     -0.089409980628
C      1.925542912341      3.158738317435      0.533757577811
C      0.627580073363      3.457713720519      0.566486404998
C      0.050178287975      4.673886081685      1.212308803508
H      0.825583104890      5.303437916739      1.650138998177
H     -0.653213494224      4.398301973124      2.002160833897
H     -0.512602312685      5.272153722372      0.491032317811
C      0.279365190778     -1.784039047824      0.843735184094
C     -0.772242000341     -0.865891100672      0.470232646509
O      0.297415360787     -2.408327410973      1.899512238739
C     -0.871272262125     -0.080803365774     -0.750219979681
C     -1.934426860973     -0.592337392864      1.269323614622
O     -2.292362821946     -1.008161281957      2.359946665923
O     -0.147241546632     -0.022930103396     -1.744144695354
C     -2.820643218132      0.400045851627      0.487488900754
H     -2.978906960990      1.282328949213      1.119654184445
C     -4.192262400485     -0.205398567115      0.160734109655
C     -4.062819944596     -1.510852686090     -0.626461332405
H     -3.565494400328     -1.311225009776     -1.581406700349
H     -3.405838028650     -2.185744568701     -0.074086194854
C     -5.395412810724     -2.208984757300     -0.881643757511
H     -5.930436796320     -2.382118501705      0.055295859243
H     -5.241349814784     -3.178456161808     -1.357673894044
H     -6.046067409873     -1.625153936618     -1.534706569103
N     -2.001405585203      0.719558034016     -0.656474686126
H     -2.367342281706      1.109724673468     -1.508348509683
C     -5.077303921355      0.817311343934     -0.549706312944
H     -6.104032446232      0.463760085918     -0.649072195832
H     -4.707852772420      1.026103850007     -1.558771078770
H     -5.103283349667      1.761593526414     -0.001104833828
H     -4.637649565789     -0.439312979182      1.134136984230
C      4.242519240748      0.316133064539     -0.637052570967
H      3.447653075104     -0.136190042477     -1.232106623980
H      5.088043913416      0.500308013443     -1.309990771104
C      4.680846520015     -0.657753238206      0.462744431205
H      3.894667395313     -0.692427938088      1.220668181436
H      5.576372763683     -0.271897760395      0.959646808453
H     -0.073983167095      2.768403158482      0.101115419974
H      2.646031231628      3.826606283425      1.002992032604
H      4.449230593448      2.242078465992      0.440683184933
H      1.723023182371      1.306491905692     -0.582731472025
H      2.536645120878     -3.103459066590      1.166345358786
H      1.324054169494     -1.432602386235     -1.085078985234`}
  caption="遷移状態構造 (No.2)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -19.5378             15.6550             21.9385
Reduced mass [au]                   4.9299              5.6780              4.6461
Force const [Dyne/A]               -0.0011              0.0008              0.0013
Char temp [K]                       0.0000             22.5240             31.5646
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00810   -0.00970   -0.00839   -0.01225   -0.03018   -0.02589   -0.00968   -0.01362   -0.02508
       C                 0.00435   -0.00440   -0.00751   -0.03135   -0.00632   -0.01438   -0.02392   -0.00564   -0.00592
       H                -0.00126   -0.00582   -0.00641   -0.05262   -0.01041   -0.01887   -0.03734   -0.00977    0.00041
       H                 0.00618   -0.00447   -0.00789   -0.03379   -0.00098   -0.01142   -0.02959   -0.01184   -0.00757
       H                 0.00520   -0.00643   -0.01163   -0.01995   -0.04302   -0.03466   -0.01969   -0.02233   -0.03646
       H                 0.01075   -0.01511   -0.01333   -0.01423   -0.03846   -0.03107   -0.00254   -0.01356   -0.02782
       C                 0.00544    0.00422   -0.00715   -0.01985    0.01389   -0.00111   -0.01407    0.01539    0.00538
       C                 0.01091    0.01287   -0.00709   -0.01149    0.03382    0.01349   -0.01298    0.01633    0.00386
       C                -0.02356   -0.02277    0.02375    0.02154   -0.02128   -0.00605    0.01667   -0.00520   -0.01018
       C                -0.02901   -0.04319    0.00381    0.02218   -0.01953   -0.02683    0.01789    0.00103    0.02269
       C                -0.06133   -0.06621    0.02055    0.00967   -0.02945   -0.01902    0.03928    0.00270    0.03760
       C                -0.06623   -0.08473   -0.00114    0.00848   -0.03130   -0.04169    0.04120    0.00653    0.07553
       C                -0.09560   -0.10846    0.01743   -0.00700   -0.04384   -0.03229    0.06305    0.00674    0.09461
       H                -0.11297   -0.11030    0.05099   -0.01755   -0.05143   -0.00256    0.07763    0.00493    0.07130
       H                -0.10960   -0.13781   -0.00520   -0.02480   -0.05987   -0.05364    0.08704    0.00694    0.11600
       H                -0.08692   -0.09651    0.02047    0.00859   -0.03051   -0.03350    0.04172    0.00812    0.11247
       C                 0.01451    0.02668   -0.00545   -0.00023    0.04239    0.02520   -0.00477    0.03974    0.00968
       C                 0.01980    0.03176   -0.00897   -0.00368    0.04165    0.03312   -0.01025    0.02609   -0.00756
       O                 0.01253    0.03271   -0.00185    0.00603    0.04115    0.02438    0.00536    0.06745    0.02607
       C                 0.01313    0.01131   -0.02105   -0.00038    0.06379    0.04752   -0.01859   -0.00421   -0.02690
       C                 0.02589    0.04812   -0.00558   -0.02027    0.00488    0.02193   -0.01007    0.03789   -0.01159
       O                 0.03374    0.06892    0.00480   -0.02783   -0.02240    0.00897   -0.00295    0.06489    0.00116
       O                 0.00701   -0.00570   -0.02649    0.01874    0.10420    0.06337   -0.02058   -0.02194   -0.02923
       C                 0.02177    0.03527   -0.01701   -0.03106   -0.00244    0.02483   -0.02267    0.00616   -0.03733
       H                 0.02565    0.04626   -0.03131   -0.06152   -0.01647    0.03661   -0.03683    0.02007   -0.06041
       C                 0.01963    0.02939    0.00212   -0.01148   -0.02977   -0.00722   -0.01334   -0.02322   -0.02375
       C                 0.01500    0.01679    0.02218    0.03273   -0.01384   -0.02643    0.00738   -0.04509    0.01575
       H                 0.00751    0.00181    0.01514    0.04480    0.01374   -0.01436    0.00891   -0.06680    0.01200
       H                 0.01997    0.02639    0.02803    0.03887   -0.00760   -0.02609    0.01392   -0.01995    0.03861
       C                 0.01383    0.01119    0.04340    0.05360   -0.04085   -0.06152    0.01781   -0.07061    0.03100
       H                 0.02101    0.02563    0.05015    0.04108   -0.06910   -0.07389    0.01613   -0.04963    0.03394
       H                 0.01142    0.00371    0.05784    0.08479   -0.02927   -0.07502    0.03293   -0.08288    0.06088
       H                 0.00832   -0.00010    0.03882    0.05143   -0.04523   -0.06328    0.01269   -0.09907    0.01063
       N                 0.01490    0.01519   -0.02743   -0.02018    0.03476    0.04345   -0.02546   -0.01190   -0.04426
       H                 0.00874   -0.00227   -0.03286   -0.01022    0.05341    0.04786   -0.02717   -0.03057   -0.05197
       C                 0.01394    0.01727   -0.00813   -0.02386   -0.03932   -0.00549   -0.02540   -0.05702   -0.05734
       H                 0.01398    0.01400    0.00319   -0.01403   -0.06165   -0.02750   -0.02052   -0.07370   -0.04855
       H                 0.00769    0.00272   -0.01342   -0.01236   -0.01523    0.00370   -0.02588   -0.08361   -0.06299
       H                 0.01534    0.02545   -0.02219   -0.05468   -0.04842    0.00873   -0.03899   -0.04029   -0.08670
       H                 0.02660    0.04475    0.00900   -0.02190   -0.05607   -0.01833   -0.01321   -0.00038   -0.01819
       C                 0.00898   -0.00373    0.01003    0.02819   -0.01527   -0.01367   -0.00383   -0.00940   -0.01932
       H                 0.02586   -0.00870   -0.00871    0.03351   -0.00857   -0.02592   -0.01828   -0.00454   -0.00366
       H                 0.01515    0.02188    0.02490    0.03451   -0.00947   -0.00412   -0.01487   -0.01654   -0.03504
       C                 0.01082   -0.01277    0.00190    0.01743   -0.02693   -0.01934    0.00864   -0.01026   -0.02492
       H                 0.01242   -0.01839    0.00322    0.02158   -0.01586   -0.01460    0.02130   -0.00279   -0.01141
       H                 0.01184   -0.01716    0.00333    0.02735   -0.04503   -0.02332    0.01966   -0.01509   -0.04099
       H                -0.04739   -0.08154   -0.03402    0.01907   -0.02440   -0.06749    0.02604    0.00976    0.09342
       H                -0.08199   -0.06899    0.05535   -0.00095   -0.03750    0.00840    0.05480   -0.00004    0.01771
       H                -0.04510   -0.02247    0.05371    0.01304   -0.03067    0.01775    0.03242   -0.00797   -0.02896
       H                -0.00857   -0.04349   -0.02552    0.03089   -0.01118   -0.05027    0.00244    0.00387    0.04135
       H                 0.00278    0.00560   -0.00639   -0.01792    0.00983   -0.00313   -0.00705    0.03081    0.01258
       H                 0.01385    0.01081   -0.00848   -0.01316    0.03996    0.01698   -0.01834   -0.00003   -0.00433
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_2_13_ts_final_3.xyz`
```
52
OptimizedStructure
C      4.947666355084     -2.076355836265     -0.037148263630
C      3.717117139237     -2.745848299881     -0.679168526499
H      3.957274833031     -3.799673445107     -0.853718313490
H      3.513697107096     -2.305631294216     -1.657881674661
H      5.769511211859     -2.074835138020     -0.760040102388
H      5.278416426185     -2.684447048136      0.809848179993
C      2.502572688391     -2.631897338489      0.187823457209
C      1.415754629205     -1.939019259684     -0.130866189066
C      3.731487260207      1.600028094264     -0.068769558977
C      2.445999041605      1.952828072971     -0.089872232891
C      1.925814548115      3.158819499086      0.532808236728
C      0.627879600303      3.457941619785      0.565301897427
C      0.050539468018      4.674406617758      1.210627421534
H      0.825965755454      5.304036431641      1.648307245287
H     -0.652959269136      4.399180495367      2.000509175192
H     -0.512108083315      5.272472164486      0.489079474953
C      0.279118316336     -1.783772366716      0.844420266634
C     -0.772383502469     -0.865672459180      0.470503857938
O      0.297018396706     -2.407702546578      1.900411587461
C     -0.871218713888     -0.080963667144     -0.750208429323
C     -1.934644100811     -0.591789838010      1.269372199783
O     -2.292736376556     -1.007248039141      2.360083600260
O     -0.147062505556     -0.023446571216     -1.744062856290
C     -2.820704109107      0.400404248325      0.487119854448
H     -2.978978409951      1.282899836545      1.118985679638
C     -4.192328107917     -0.205048867053      0.160401730635
C     -4.062887488807     -1.510764061157     -0.626360760027
H     -3.565441150062     -1.311476788901     -1.581314128108
H     -3.406015118824     -2.185524735938     -0.073695422544
C     -5.395500891159     -2.208885085898     -0.881469224186
H     -5.930641843155     -2.381681398885      0.055465877174
H     -5.241451940553     -3.178519944197     -1.357171237622
H     -6.046041560873     -1.625218319521     -1.534792183646
N     -2.001313480435      0.719495053500     -0.656851326047
H     -2.367117818334      1.109432585782     -1.508886635565
C     -5.077216290864      0.817495760076     -0.550467777159
H     -6.103958409368      0.463985509504     -0.649837613359
H     -4.707634643249      1.025937968958     -1.559557173278
H     -5.103191391878      1.761955952841     -0.002172356028
H     -4.637843135252     -0.438620154475      1.133828457888
C      4.242607060791      0.315550296429     -0.636751698779
H      3.447749292657     -0.136905892496     -1.231715845089
H      5.088212480811      0.499397312866     -1.309678757594
C      4.680735498498     -0.657985138537      0.463434699165
H      3.894477828739     -0.692318870781      1.221292507666
H      5.576247722812     -0.272035036279      0.960289019309
H     -0.073708781652      2.768533979018      0.100112847296
H      2.646326849035      3.826783099761      1.001870185912
H      4.449414997037      2.241860201353      0.440312984143
H      1.723209276083      1.306191094665     -0.583030971613
H      2.536254428561     -3.103270284817      1.167693755100
H      1.324018911317     -1.433078168260     -1.084414940913
```

<MoleculeViewer 
  xyzData={`52
OptimizedStructure
C      4.947666355084     -2.076355836265     -0.037148263630
C      3.717117139237     -2.745848299881     -0.679168526499
H      3.957274833031     -3.799673445107     -0.853718313490
H      3.513697107096     -2.305631294216     -1.657881674661
H      5.769511211859     -2.074835138020     -0.760040102388
H      5.278416426185     -2.684447048136      0.809848179993
C      2.502572688391     -2.631897338489      0.187823457209
C      1.415754629205     -1.939019259684     -0.130866189066
C      3.731487260207      1.600028094264     -0.068769558977
C      2.445999041605      1.952828072971     -0.089872232891
C      1.925814548115      3.158819499086      0.532808236728
C      0.627879600303      3.457941619785      0.565301897427
C      0.050539468018      4.674406617758      1.210627421534
H      0.825965755454      5.304036431641      1.648307245287
H     -0.652959269136      4.399180495367      2.000509175192
H     -0.512108083315      5.272472164486      0.489079474953
C      0.279118316336     -1.783772366716      0.844420266634
C     -0.772383502469     -0.865672459180      0.470503857938
O      0.297018396706     -2.407702546578      1.900411587461
C     -0.871218713888     -0.080963667144     -0.750208429323
C     -1.934644100811     -0.591789838010      1.269372199783
O     -2.292736376556     -1.007248039141      2.360083600260
O     -0.147062505556     -0.023446571216     -1.744062856290
C     -2.820704109107      0.400404248325      0.487119854448
H     -2.978978409951      1.282899836545      1.118985679638
C     -4.192328107917     -0.205048867053      0.160401730635
C     -4.062887488807     -1.510764061157     -0.626360760027
H     -3.565441150062     -1.311476788901     -1.581314128108
H     -3.406015118824     -2.185524735938     -0.073695422544
C     -5.395500891159     -2.208885085898     -0.881469224186
H     -5.930641843155     -2.381681398885      0.055465877174
H     -5.241451940553     -3.178519944197     -1.357171237622
H     -6.046041560873     -1.625218319521     -1.534792183646
N     -2.001313480435      0.719495053500     -0.656851326047
H     -2.367117818334      1.109432585782     -1.508886635565
C     -5.077216290864      0.817495760076     -0.550467777159
H     -6.103958409368      0.463985509504     -0.649837613359
H     -4.707634643249      1.025937968958     -1.559557173278
H     -5.103191391878      1.761955952841     -0.002172356028
H     -4.637843135252     -0.438620154475      1.133828457888
C      4.242607060791      0.315550296429     -0.636751698779
H      3.447749292657     -0.136905892496     -1.231715845089
H      5.088212480811      0.499397312866     -1.309678757594
C      4.680735498498     -0.657985138537      0.463434699165
H      3.894477828739     -0.692318870781      1.221292507666
H      5.576247722812     -0.272035036279      0.960289019309
H     -0.073708781652      2.768533979018      0.100112847296
H      2.646326849035      3.826783099761      1.001870185912
H      4.449414997037      2.241860201353      0.440312984143
H      1.723209276083      1.306191094665     -0.583030971613
H      2.536254428561     -3.103270284817      1.167693755100
H      1.324018911317     -1.433078168260     -1.084414940913`}
  caption="遷移状態構造 (No.3)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -19.9694             16.7570             21.7359
Reduced mass [au]                   4.9419              5.6533              4.6616
Force const [Dyne/A]               -0.0012              0.0009              0.0013
Char temp [K]                       0.0000             24.1096             31.2731
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00862   -0.00879   -0.00780   -0.01173   -0.03026   -0.02548   -0.00967   -0.01427   -0.02553
       C                 0.00541   -0.00438   -0.00703   -0.03074   -0.00586   -0.01472   -0.02438   -0.00554   -0.00626
       H                 0.00050   -0.00568   -0.00571   -0.05209   -0.00989   -0.01972   -0.03839   -0.00976   -0.00010
       H                 0.00714   -0.00473   -0.00752   -0.03286    0.00004   -0.01157   -0.03000   -0.01151   -0.00782
       H                 0.00583   -0.00507   -0.01093   -0.01921   -0.04281   -0.03399   -0.01978   -0.02336   -0.03703
       H                 0.01155   -0.01388   -0.01262   -0.01407   -0.03908   -0.03090   -0.00274   -0.01450   -0.02839
       C                 0.00626    0.00362   -0.00694   -0.01947    0.01402   -0.00173   -0.01433    0.01601    0.00525
       C                 0.01140    0.01158   -0.00723   -0.01101    0.03415    0.01295   -0.01301    0.01744    0.00400
       C                -0.02476   -0.02228    0.02370    0.02159   -0.02150   -0.00447    0.01729   -0.00573   -0.01014
       C                -0.03030   -0.04300    0.00427    0.02209   -0.02034   -0.02673    0.01835   -0.00009    0.02212
       C                -0.06260   -0.06560    0.02026    0.00807   -0.03077   -0.01922    0.03865    0.00095    0.03731
       C                -0.06755   -0.08438   -0.00097    0.00664   -0.03348   -0.04357    0.04031    0.00379    0.07479
       C                -0.09660   -0.10733    0.01640   -0.01045   -0.04650   -0.03469    0.06089    0.00318    0.09430
       H                -0.11369   -0.10840    0.04838   -0.02195   -0.05358   -0.00398    0.07474    0.00164    0.07189
       H                -0.10991   -0.13554   -0.00522   -0.02896   -0.06310   -0.05687    0.08460    0.00231    0.11508
       H                -0.08857   -0.09646    0.01901    0.00557   -0.03348   -0.03649    0.03954    0.00462    0.11222
       C                 0.01475    0.02508   -0.00583    0.00007    0.04223    0.02452   -0.00464    0.04100    0.00997
       C                 0.02014    0.03023   -0.00942   -0.00336    0.04165    0.03272   -0.01018    0.02734   -0.00712
       O                 0.01265    0.03107   -0.00226    0.00619    0.04055    0.02343    0.00553    0.06861    0.02629
       C                 0.01367    0.00991   -0.02141   -0.00017    0.06406    0.04731   -0.01855   -0.00278   -0.02633
       C                 0.02649    0.04715   -0.00584   -0.01969    0.00500    0.02189   -0.01012    0.03881   -0.01122
       O                 0.03419    0.06789    0.00446   -0.02706   -0.02241    0.00894   -0.00291    0.06579    0.00155
       O                 0.00724   -0.00767   -0.02710    0.01870    0.10450    0.06297   -0.02026   -0.01993   -0.02840
       C                 0.02299    0.03519   -0.01684   -0.03042   -0.00189    0.02525   -0.02303    0.00671   -0.03706
       H                 0.02780    0.04616   -0.03088   -0.06039   -0.01597    0.03725   -0.03767    0.02054   -0.06016
       C                 0.02025    0.03058    0.00255   -0.01113   -0.02872   -0.00650   -0.01340   -0.02324   -0.02374
       C                 0.01430    0.01806    0.02228    0.03243   -0.01266   -0.02604    0.00799   -0.04525    0.01614
       H                 0.00685    0.00286    0.01522    0.04396    0.01507   -0.01424    0.01031   -0.06713    0.01277
       H                 0.01874    0.02695    0.02788    0.03882   -0.00662   -0.02624    0.01408   -0.01998    0.03968
       C                 0.01246    0.01374    0.04354    0.05305   -0.03944   -0.06045    0.01863   -0.07084    0.03041
       H                 0.01959    0.02856    0.05033    0.04118   -0.06794   -0.07248    0.01604   -0.04946    0.03289
       H                 0.00911    0.00619    0.05785    0.08378   -0.02773   -0.07438    0.03420   -0.08332    0.06086
       H                 0.00742    0.00314    0.03912    0.05049   -0.04353   -0.06154    0.01415   -0.09959    0.00917
       N                 0.01609    0.01471   -0.02740   -0.01977    0.03530    0.04367   -0.02578   -0.01101   -0.04383
       H                 0.00985   -0.00276   -0.03280   -0.01002    0.05404    0.04821   -0.02734   -0.02939   -0.05147
       C                 0.01516    0.01935   -0.00715   -0.02339   -0.03784   -0.00430   -0.02556   -0.05751   -0.05788
       H                 0.01489    0.01693    0.00436   -0.01371   -0.05982   -0.02606   -0.02060   -0.07442   -0.04905
       H                 0.00878    0.00481   -0.01249   -0.01212   -0.01368    0.00482   -0.02596   -0.08449   -0.06357
       H                 0.01747    0.02738   -0.02093   -0.05373   -0.04703    0.01011   -0.03938   -0.04056   -0.08765
       H                 0.02732    0.04607    0.00951   -0.02133   -0.05509   -0.01752   -0.01352   -0.00029   -0.01827
       C                 0.00781   -0.00339    0.01028    0.02949   -0.01493   -0.01228   -0.00246   -0.00957   -0.01946
       H                 0.02455   -0.00876   -0.00796    0.03565   -0.00817   -0.02573   -0.01643   -0.00463   -0.00451
       H                 0.01366    0.02219    0.02471    0.03644   -0.00831   -0.00169   -0.01312   -0.01629   -0.03457
       C                 0.01038   -0.01196    0.00227    0.01797   -0.02725   -0.01820    0.00948   -0.01082   -0.02516
       H                 0.01207   -0.01797    0.00367    0.02171   -0.01651   -0.01391    0.02211   -0.00304   -0.01167
       H                 0.01119   -0.01567    0.00356    0.02770   -0.04580   -0.02148    0.02071   -0.01624   -0.04117
       H                -0.04887   -0.08184   -0.03270    0.01827   -0.02692   -0.07043    0.02589    0.00677    0.09197
       H                -0.08329   -0.06757    0.05396   -0.00365   -0.03841    0.00935    0.05348   -0.00152    0.01813
       H                -0.04615   -0.02148    0.05283    0.01215   -0.03084    0.02057    0.03247   -0.00847   -0.02818
       H                -0.00995   -0.04380   -0.02428    0.03174   -0.01213   -0.05137    0.00350    0.00260    0.04008
       H                 0.00367    0.00517   -0.00609   -0.01782    0.00950   -0.00396   -0.00737    0.03129    0.01238
       H                 0.01428    0.00932   -0.00872   -0.01248    0.04075    0.01666   -0.01833    0.00124   -0.00410
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在しないことが判明した。

結合の組み換えが伴わないTS構造が得られた。初期構造とワークフローの設定を変えて再度計算する予定である。



## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、BH9データセットの2. Pericyclic, No. 13の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- _J. Phys. Chem. A_ 2019, 123, 3761−3781 http://dx.doi.org/10.1021/acs.jpca.9b01546 (MOBH35のデータセットについて)

