---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(BH9データセットの3. Halogen atom transfer, No. 42の化学反応, NNP(UMA)使用)
published: 2025-11-20
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-11-20

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、BH9データセットの3. Halogen atom transfer, No. 42の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

BH9のデータセットについて:

- _J. Chem. Theory Comput._ 2022, 18, 1, 151–166 

https://doi.org/10.1021/acs.jctc.1c00694


この文献のSupporting Informationから、データセットの詳細を確認できる。

有機金属錯体が関わる反応を除いたさまざまなカテゴリの反応がまとめられたデータセットである。DFTの汎関数の電子エネルギーの精度の比較などのベンチマークに主に使われる。

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.20.0-rc.1
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.20.0-rc.1.zip
unzip v1.20.0-rc.1.zip
cd MultiOptPy-v1.20.0-rc.1
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.20.0-rc.1 にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.20.0-rc.1`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.20.0-rc.1`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`bh9_3_42.xyz`とした。
初期構造は以下のものを使用した。

```
46
OptimizedStructure
O      1.515105433985     -1.971867932126     -2.515278435820
C      1.921082100024     -2.607054477016     -1.609991262404
C      2.895237035324     -2.191528267191     -0.528467789225
C      3.236301684423     -0.701197976208     -0.546485915561
Cl    -0.710250892936     -2.374033306243      0.859637328216
C     -2.323033540279     -1.562564797924      0.529867692470
H      3.778108204994     -2.816360007490     -0.689119055965
H      2.472492955059     -2.516272484676      0.423830719855
H      4.133339544056     -0.538670927733      0.059961190565
C      2.113046110532      0.197096031552     -0.032008797108
H      3.490558018922     -0.418514015448     -1.571321220113
C     -2.084558680478     -0.400742471616     -0.421498874365
C     -2.874170966531     -1.153083881479      1.884901908959
C     -3.217728463108     -2.610653201845     -0.120570603821
C     -1.389786154924     -0.614056701178     -1.610346849153
C     -2.593795776038      0.867586977837     -0.166512563870
H     -3.876340106321     -0.736145806239      1.769465976080
H     -2.235030542262     -0.414585207180      2.367501111311
H     -2.941883482791     -2.028276163707      2.528825121405
H     -2.788978445510     -2.967237724557     -1.055236814264
H     -4.188981808488     -2.160676902830     -0.336347143496
H     -3.359513430850     -3.459018875703      0.548571933457
C     -1.203649871018      0.413214018661     -2.519029413954
C     -1.725934278900      1.674758226327     -2.261513731580
C     -2.420440018423      1.897415792631     -1.084426975286
H     -3.131825249607      1.070103629484      0.749171301528
H     -0.643218613826      0.225536370459     -3.425836805451
H     -1.582260823855      2.479861253477     -2.970524164466
H     -2.824743001483      2.878189937300     -0.868474910563
H     -0.966892225982     -1.588130332653     -1.818511611627
C      1.937139771345      0.088974316591      1.483438091888
H      1.172806211630     -0.116192080095     -0.504511468945
C      2.362680787633      1.653594752869     -0.422214034186
H      3.324455407238      1.973196846949      0.000153354054
C      1.252203311518      2.573093026008      0.078422600962
H      2.453500815718      1.730357144119     -1.509570772888
C      1.058759666920      2.445059653261      1.586911089350
H      0.317983323474      2.302857051036     -0.424041893041
H      1.469903559900      3.609360224032     -0.191923783307
C      0.810726971717      0.991122398684      1.978667252238
H      0.228683493759      3.075122899319      1.916281262080
H      1.955794805561      2.809015539872      2.101365750607
H     -0.130761597134      0.654449240985      1.530118094858
H      0.700524262846      0.898513609349      3.062098815397
H      2.878177778803      0.381979622333      1.967477301811
H      1.735166715364     -0.943595021998      1.777096993367
```

<MoleculeViewer 
  xyzData={`46
OptimizedStructure
O      1.515105433985     -1.971867932126     -2.515278435820
C      1.921082100024     -2.607054477016     -1.609991262404
C      2.895237035324     -2.191528267191     -0.528467789225
C      3.236301684423     -0.701197976208     -0.546485915561
Cl    -0.710250892936     -2.374033306243      0.859637328216
C     -2.323033540279     -1.562564797924      0.529867692470
H      3.778108204994     -2.816360007490     -0.689119055965
H      2.472492955059     -2.516272484676      0.423830719855
H      4.133339544056     -0.538670927733      0.059961190565
C      2.113046110532      0.197096031552     -0.032008797108
H      3.490558018922     -0.418514015448     -1.571321220113
C     -2.084558680478     -0.400742471616     -0.421498874365
C     -2.874170966531     -1.153083881479      1.884901908959
C     -3.217728463108     -2.610653201845     -0.120570603821
C     -1.389786154924     -0.614056701178     -1.610346849153
C     -2.593795776038      0.867586977837     -0.166512563870
H     -3.876340106321     -0.736145806239      1.769465976080
H     -2.235030542262     -0.414585207180      2.367501111311
H     -2.941883482791     -2.028276163707      2.528825121405
H     -2.788978445510     -2.967237724557     -1.055236814264
H     -4.188981808488     -2.160676902830     -0.336347143496
H     -3.359513430850     -3.459018875703      0.548571933457
C     -1.203649871018      0.413214018661     -2.519029413954
C     -1.725934278900      1.674758226327     -2.261513731580
C     -2.420440018423      1.897415792631     -1.084426975286
H     -3.131825249607      1.070103629484      0.749171301528
H     -0.643218613826      0.225536370459     -3.425836805451
H     -1.582260823855      2.479861253477     -2.970524164466
H     -2.824743001483      2.878189937300     -0.868474910563
H     -0.966892225982     -1.588130332653     -1.818511611627
C      1.937139771345      0.088974316591      1.483438091888
H      1.172806211630     -0.116192080095     -0.504511468945
C      2.362680787633      1.653594752869     -0.422214034186
H      3.324455407238      1.973196846949      0.000153354054
C      1.252203311518      2.573093026008      0.078422600962
H      2.453500815718      1.730357144119     -1.509570772888
C      1.058759666920      2.445059653261      1.586911089350
H      0.317983323474      2.302857051036     -0.424041893041
H      1.469903559900      3.609360224032     -0.191923783307
C      0.810726971717      0.991122398684      1.978667252238
H      0.228683493759      3.075122899319      1.916281262080
H      1.955794805561      2.809015539872      2.101365750607
H     -0.130761597134      0.654449240985      1.530118094858
H      0.700524262846      0.898513609349      3.062098815397
H      2.878177778803      0.381979622333      1.967477301811
H      1.735166715364     -0.943595021998      1.777096993367`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`bh9_3_42.xyz`として保存する。その後、同じディレクトリ内で、`config_bh9_3_42.json`を作成し、以下のように記述する。

`config_bh9_3_42.json`
```json
{
  "work_dir": "bh9_3_42",
  "top_n_candidates": 3,
  "multioptpy_version": "v1.20.0-rc.1",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 2,
    "electronic_charge": 0,
	"manual_AFIR": ["600", "2", "5"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 15,
    "ANEB": [3, 5],
    "QSM": true,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance_bernstein": 0.50,
    "align_distances": 9999,
    "spin_multiplicity": 2,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 2,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 2,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py bh9_3_42.xyz -cfg config_bh9_3_42.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.20.0-rc.1/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。


Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`bh9_3_42_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`bh9_3_42_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`bh9_3_42_step1_traj.xyz`はStep2のNEB計算に使用している。

※`bh9_3_42_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`bh9_3_42_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。
- `"align_distances": X`は線形補間で、各ノード間の距離を全て等しくするための処理である。X回の反復計算ごとに本処理を行う。Xを`"NSTEP": n`よりも大きな数値を指定することで、初期経路に対してのみ処理を行うことが出来る。
- `"node_distance_bernstein": N`はノード間の距離をN Åとして初期経路を作成することを示す。経路作成時に元のノードをベルンシュタイン多項式を用いてがたついた経路を滑らかにする。

→プログラムの仕様上`"align_distances": X`の処理を行った後に、`"node_distance_bernstein": N`の処理を行うようになっている。

- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"ANEB": [A, B]`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


`MultiOptPy-v1.20.0-rc.1/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-1236.8898827961393,-1236.8898827961393,-1236.8763689325863,-1236.8417003740688,-1236.8329044941358,-1236.8541421625698,-1236.8703736569548,-1236.8795949358198,-1236.8836064533566,-1236.8854544135838,-1236.8862241305096,-1236.8865718392883,-1236.8868888382453,-1236.8872446603748,-1236.88755879425,-1236.8877775480632,-1236.8879246222614,-1236.888051930024,-1236.8881742260837,-1236.8882832218555,-1236.8883865575574,-1236.8885031059303,-1236.888634601794,-1236.8887704434696,-1236.8889106309575,-1236.8890607629955,-1236.8892153372242,-1236.8893520112633,-1236.889466202734,-1236.889587955567,-1236.8897466916121,-1236.8899378985839,-1236.8901393742892,-1236.8903462559745,-1236.8905410640123,-1236.8907049782326,-1236.8908899994315,-1236.8910970738746,-1236.8912753222653,-1236.8914408574035,-1236.8915799146298,-1236.8918395593807,-1236.8919754974354,-1236.8920306962589];

export const dataset1_itr5 = [-1236.8898828049012,-1236.8898828049012,-1236.8818579298668,-1236.8530925087541,-1236.8489080524275,-1236.8695136680485,-1236.8858037345185,-1236.8956477612514,-1236.9002302449032,-1236.9019614727617,-1236.9018700880429,-1236.901460688008,-1236.9025500674531,-1236.903537793446,-1236.9034613737417,-1236.9035425598206,-1236.9031015299836,-1236.9028645780822,-1236.9030232177481,-1236.9029040583835,-1236.9026997000728,-1236.9026614989825,-1236.9027294548673,-1236.9027871420185,-1236.9030578440577,-1236.9037525606775,-1236.9041978837563,-1236.9044863195127,-1236.9048086631176,-1236.9052643600705,-1236.9058092513126,-1236.9062634062032,-1236.9066230922501,-1236.9069117207644,-1236.907131079136,-1236.907302335676,-1236.9074257707591,-1236.9074480079994,-1236.9073290764393,-1236.9073232586586,-1236.9085568735052,-1236.907765392472,-1236.9074657417166,-1236.9083658330062];

export const dataset1_itr10 = [-1236.8898828224246,-1236.8898827961393,-1236.885834882426,-1236.8596067584656,-1236.850173612498,-1236.8402446321475,-1236.8495083177272,-1236.857985516453,-1236.8664967456916,-1236.870341282407,-1236.8738203766263,-1236.8752445676012,-1236.8890494866644,-1236.8971756296353,-1236.9012509149557,-1236.9028489822242,-1236.903234252488,-1236.903289731686,-1236.9033437389157,-1236.903364451617,-1236.9033636280158,-1236.9035927819882,-1236.9037338281244,-1236.9038424909509,-1236.9039337179588,-1236.9044568626166,-1236.9045006186363,-1236.9045895325505,-1236.904618130798,-1236.9046689137156,-1236.9047976583997,-1236.9048754449323,-1236.9049588389641,-1236.9049760995485,-1236.9048030030478,-1236.9049717712599,-1236.9047568988876,-1236.9049016249455,-1236.904782518151,-1236.9049555620816,-1236.90489042747,-1236.9050000365621,-1236.9049735411268,-1236.9051011993581,-1236.90511120524,-1236.9049926591954,-1236.9051651073291,-1236.9051420464873,-1236.9052340445262,-1236.9053267785496,-1236.9052063925442,-1236.9053338054473,-1236.9053569188593,-1236.9052757853508,-1236.9052567373758,-1236.9053044712155,-1236.9053431279153,-1236.905477848091,-1236.9054107333313,-1236.905469524459,-1236.9056952964083,-1236.9060285921607,-1236.9062773373346,-1236.9064499607025,-1236.9066066377438,-1236.9067385015996,-1236.9069825855395,-1236.907209531559,-1236.907473399458,-1236.907731186725,-1236.9079885534293,-1236.9082324446113,-1236.9084457573977,-1236.9086093737194,-1236.9085855944168,-1236.908553368818,-1236.9085496888965,-1236.9085484797795,-1236.9087590939566,-1236.9087466172703,-1236.9088716294625,-1236.9089137032322,-1236.9090892880608,-1236.9090330027846,-1236.909016022575,-1236.9089658529779,-1236.90891277449,-1236.9089935224831,-1236.90905159515,-1236.9090749889372,-1236.9090617937898,-1236.909052593986];

export const dataset2 = [-1236.8898827786159,-1236.8898827961393,-1236.887484100604,-1236.86624128028,-1236.8543604958204,-1236.8507916290384,-1236.846874519013,-1236.8444462789646,-1236.8422000022756,-1236.843010583854,-1236.8457031912196,-1236.8497679537165,-1236.8534663537375,-1236.8652559462362,-1236.872054443603,-1236.8776943001437,-1236.8793006472358,-1236.8784515053362,-1236.8902685658209,-1236.8978098027837,-1236.901565828624,-1236.903116372334,-1236.903621275095,-1236.9036574259435,-1236.9037082263844,-1236.9037821402374,-1236.9037053875877,-1236.9036959599791,-1236.903697484518,-1236.903693787073,-1236.90375017749,-1236.9037872045103,-1236.9038448916617,-1236.9039174036398,-1236.9039128825932,-1236.904137217621,-1236.904207363935,-1236.904625963774,-1236.9046906602996,-1236.9047609117545,-1236.9048465663097,-1236.9049037803281,-1236.904989908016,-1236.905025638302,-1236.9051125194976,-1236.905142922659,-1236.9052494651498,-1236.9052423506348,-1236.9052136647701,-1236.90518632821,-1236.9051320581289,-1236.9050798382896,-1236.9051357730973,-1236.9051602708607,-1236.9052301192767,-1236.9052526544153,-1236.9053168427613,-1236.9053012994736,-1236.905292362521,-1236.9052940798178,-1236.905279693077,-1236.9052857386623,-1236.9052885073652,-1236.905283758514,-1236.9052697397653,-1236.9053097107228,-1236.905383957521,-1236.9055133680959,-1236.905485155364,-1236.9054566973039,-1236.90545091457,-1236.9054135370811,-1236.9053897227316,-1236.9054542615463,-1236.9054984381285,-1236.9055076554557,-1236.905572895208,-1236.9056304071248,-1236.9056633161376,-1236.9056694142935,-1236.9057050394388,-1236.9057014646578,-1236.9056846596827,-1236.9056895662447,-1236.9057151679847,-1236.9057544204813,-1236.9058014183368,-1236.905800752446,-1236.9058372187164,-1236.9058945729223,-1236.9058661674326,-1236.9058625926516,-1236.9058341521152,-1236.9058333986075,-1236.9058608578316,-1236.905875875416,-1236.9058828497436,-1236.9059153031471,-1236.9060583469552,-1236.9060536857212,-1236.9060014133115,-1236.9059873595158,-1236.9059460918243,-1236.9059222073809,-1236.9060099647484,-1236.9060316061918,-1236.9060966356628,-1236.9061644513602,-1236.9062418699002,-1236.9063827758491,-1236.9065817194178,-1236.9067103589614,-1236.9068380872864,-1236.9069375327856,-1236.9070955591312,-1236.9072918391378,-1236.9075198716102,-1236.9077719988072,-1236.908024353809,-1236.9082717146314,-1236.9084890227612,-1236.908708591414,-1236.9087593042377,-1236.9087493509262,-1236.9087419209893,-1236.9087285330843,-1236.9087055598595,-1236.908723784233,-1236.9087450927311,-1236.9087773884237,-1236.908812645577,-1236.9088822837116,-1236.908947856409,-1236.90894801412,-1236.909027798324,-1236.9090932658808,-1236.9091712276477,-1236.9091797440374,-1236.909152232243,-1236.9091606259688,-1236.909143067486,-1236.9091432076734,-1236.9091473782512,-1236.909144399267,-1236.9091459938998,-1236.9091379331192,-1236.909140176119,-1236.9091620278436,-1236.9092455445395,-1236.9092554277574,-1236.909250345961,-1236.9088202332248];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [2.0893238430587903e-06,2.089242168403996e-06,0.005486880638112998,0.008157784817394063,0.009302669272882228,0.010791312534761968,0.011943795269375133,0.012175574819998392,0.012421263916795933,0.012437163936192838,0.012394767823613402,0.012384978555599193,0.012390692847743094,0.012398168490227466,0.01240842951683928,0.012420444945924678,0.012425314097786687,0.012418315056830389,0.01240706842987853,0.012399698443485726,0.012394374229472304,0.012387106110905804,0.012381841204485005,0.012384176133166346,0.012392046726363796,0.012398728550200763,0.01240224280104582,0.012405629607062736,0.012407181579256717,0.01240003498336088,0.012383431158642742,0.012372389309186884,0.012382856279250443,0.012406346781986132,0.012426071383135935,0.012438810218356819,0.012437681171344283,0.012430056908022838,0.012424598065125211,0.0124235590740604,0.012452228701649627,0.012429241824833431,0.012408647443541209,0.0123902203011308];

export const dataset1_grad_itr5 = [8.239494297419946e-07,6.254187771127981e-07,0.0028458315758362065,0.006034793099750841,0.0066066286100423845,0.004982822275853898,0.003495722676203363,0.002140175852149149,0.0016860388544476198,0.0016967522751833884,0.0026223287629881203,0.00317316088757649,0.0024388504008636984,0.001631320380643475,0.0022630767676254035,0.0025680392396491584,0.003617789101678406,0.004085228469280471,0.0037612204842848544,0.0038448453105169402,0.004157242330562078,0.004358419279338398,0.0044423814788329685,0.004577759386283066,0.004559135651373589,0.004198930803711569,0.003953635448719214,0.0038251083542508936,0.003596511453575763,0.0030808685757463196,0.0024584059452809745,0.0020441371832973874,0.001834996594252265,0.0017618892278756996,0.0017772609905570265,0.0018282793896253714,0.0019151081828129453,0.0021304809592601016,0.0026358565839188688,0.002890035891204835,0.0017018385949978095,0.0026359157289083637,0.0030479026878755507,0.003072202411847765];

export const dataset1_grad_itr10 = [5.516786218325395e-07,2.646734693749103e-07,0.001701691847823925,0.005489475446343638,0.005557707973722207,0.0021737047980532023,0.005699199513576931,0.005726860230152795,0.004647543133087233,0.0042446608360545875,0.0037810251710446363,0.003499662714291298,0.001874239036281065,0.0010674620850103945,0.0007070034573262007,0.000626075417353946,0.001050373226210148,0.0009759577733588894,0.0009706931182014182,0.0009841788655864238,0.0010446618153493522,0.0008318763805118908,0.0008910262672533292,0.0007521571763256631,0.0007848582124636248,0.000332508435386906,0.0005034635338645688,0.0005738801716277971,0.0006789911697618928,0.0007080904939361949,0.0006400024570096847,0.0006842202625162475,0.0006468981791437426,0.000538490665201744,0.0014693049932803957,0.0011899143614311886,0.001720012777627862,0.001433652196811025,0.0016752325822776402,0.0014506572965137087,0.0015828022543099168,0.0014365075111220699,0.0015062213776214882,0.0013372955311986903,0.0013696491176179524,0.0016130849861574835,0.0013479675939412866,0.0014523750799157662,0.0014149192004931429,0.0012284750111646392,0.0014320038289446645,0.001316188520377652,0.001617259436499997,0.0018082478221459978,0.0019702669310883414,0.0018948547337477228,0.0019760008038377983,0.0017939141132696538,0.001916818653301166,0.0018070405189574855,0.0015768167400454672,0.0014221185391754948,0.0012598308099833818,0.0010946637540612334,0.0009754352522835032,0.0009380491611872047,0.0006164045134270641,0.00048817498281562307,0.00035021971652456405,0.00032781714214166063,0.000319725806803784,0.0003233535492777839,0.00033417504333420393,0.00045597118569680445,0.0007281031055293156,0.000958278924914931,0.0009890922548775503,0.0010069052082459578,0.0006523993534979707,0.00077958165285031,0.0005475292680906211,0.0005879264593668903,0.00043406534915119697,0.0007880838941736862,0.0009440842095860464,0.0010303971526035814,0.0010050839917784549,0.000906231026374499,0.0007318950598174547,0.0009904147536153598,0.000657946728349627,0.0010358533093880026];

export const dataset2_grad = [4.4302502938887683e-07,1.9254673490594605e-07,0.0012132155181572232,0.004678626716438906,0.005185317060322048,0.005243884976674329,0.004793985963937788,0.003460799434714462,0.0015169821662834977,0.0027077151551668953,0.004460775216804528,0.0052262037091655176,0.005424558183859522,0.005116577484233422,0.004054694033818104,0.0029717271382668164,0.0028818234816702457,0.0025803461345451123,0.0014812666972365532,0.0007998500212636513,0.000444739605909517,0.0003186792896896374,0.00047659799259480533,0.00044632268263633003,0.0006211488596911356,0.0004299494587137922,0.000498394966569392,0.0005397819869123369,0.0005788949646850503,0.0006081664670610802,0.000545141893952574,0.000493551603079154,0.00043038730762971197,0.00034722786711448143,0.00034885541635336164,0.00031173253996073563,0.0002698804068136002,0.0002114255719131639,0.0002758151252602447,0.0002408651301836148,0.00023434579309816755,0.00025698344040154457,0.00023692119776909542,0.00019892658064232747,0.00016234248642491638,0.0002040823831127014,0.00016546341848505794,0.00039084171645532764,0.0005437073015940129,0.0006806297928890888,0.0008594413312193194,0.0010381610164828829,0.0009345758691925438,0.0008717778902185745,0.0006927619097662495,0.0005845383950854878,0.0002207684285796598,0.0005389487783797979,0.0005957820326062102,0.0005946697107902322,0.0006504493377019352,0.0005647316219831089,0.0006112481377663505,0.0006522856770006875,0.0007114117835291719,0.0006479397174916236,0.0005917039484002013,0.00036293761783013907,0.0005739115495265786,0.0007015826733376032,0.0007102382524799484,0.0007529655017647168,0.0007167311488484227,0.0006164458415978013,0.0005467574511787511,0.0005496626857317855,0.0004127127133317252,0.0004077885161607997,0.0005837295328570627,0.00048337220999129327,0.0004162326132200003,0.0004949425518869367,0.0005451656212541238,0.0006011072601117796,0.0005079743164388626,0.0006245683269047272,0.0005932241401548558,0.0006788951476492631,0.0005836457170347784,0.0005359777510763398,0.0006333474971763626,0.0006413061832851261,0.0006786387806101471,0.0006254654279422531,0.0006063306704935655,0.0006100725541911492,0.0006267965109603407,0.0005890893470002369,0.0004312852293318757,0.00050766256328147,0.000645448564457322,0.0007043214769441251,0.0008181982040113378,0.000875720687621213,0.000766311771082405,0.0007404107754357135,0.0006280707329478581,0.0004930832557168294,0.00034995475348686305,0.000554623035879448,0.0004769170913615058,0.0004102567413779944,0.00032495654481914477,0.000334341601853313,0.0002805936487340277,0.0002543033184829011,0.00025217445353811383,0.0002539135747385796,0.00027161949581229336,0.0002621689210117969,0.00028049860921305523,0.00011368239312384275,0.00012342460834916473,0.0002046337242566327,0.0002829660414040934,0.00034749480247782557,0.00044508309779883276,0.0004368027167752756,0.0004011404190207706,0.00036820377797497334,0.0002952545482202589,0.00023560844785367122,0.000192512952405835,0.0002506529717324319,0.00026481012698561276,0.00015220932579897462,0.00018717208297122786,0.000223434122974841,0.0002844228834631193,0.00036405323755916925,0.0004301386586326498,0.000436340728027193,0.0004100972187283218,0.00048623368541660333,0.00047023063246725373,0.0004987634753446505,0.0004585108512125577,0.00035923156159928347,0.00023698218098738437,0.0002605633247141428,0.0003037786388659261,0.003077647904588776];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`bh9_3_42_step3_TS_Opt_Inputs`内に保存された`bh9_3_42_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`bh9_3_42_ts_guess_1.xyz`
```
46
0 2
O       1.232780920567     -2.176526034694     -2.237096699793
C       1.482335334951     -2.382080202872     -1.112682436954
C       2.795516478567     -2.198411217547     -0.391022695513
C       3.196100795308     -0.720539184606     -0.530625468293
Cl     -0.260970928552     -2.427131525898      0.296647437761
C      -2.286258773774     -1.551879159932      0.461468028591
H       3.565955569010     -2.849615746577     -0.813066055566
H       2.631143199234     -2.484590142717      0.639018380576
H       4.117466236964     -0.564609251350      0.038279679868
C       2.109928917828      0.218042263652     -0.021268881565
H       3.430240971055     -0.495064638977     -1.575617327670
C      -2.097441090376     -0.394767565703     -0.459185823859
C      -2.742023760291     -1.203470248019      1.853422253735
C      -3.153013518811     -2.632438100451     -0.139375021679
C      -1.430522327407     -0.585215204938     -1.674409972003
C      -2.588781265319      0.879803905253     -0.180428364099
H      -3.761670579891     -0.799606658704      1.761530893593
H      -2.146060547469     -0.442304305363      2.353000234180
H      -2.830355306944     -2.077940992091      2.497455097822
H      -2.773093776687     -2.995949305492     -1.091662334801
H      -4.140382589379     -2.188902405511     -0.325013742916
H      -3.294431026380     -3.473061037036      0.540967343594
C      -1.221171105384      0.452731510193     -2.557272268519
C      -1.728494502399      1.713780518940     -2.273712272745
C      -2.421621170510      1.917614993913     -1.091708779808
H      -3.126271528419      1.073042053253      0.739210815035
H      -0.650920148587      0.265866959540     -3.458845362760
H      -1.576840760500      2.527466300764     -2.969167420212
H      -2.829309568888      2.894630443635     -0.867183738641
H      -1.028552582318     -1.557509580861     -1.904637160009
C       1.938393323877      0.100307536464      1.491207284151
H       1.160199978124     -0.073313810722     -0.488328435973
C       2.368927897255      1.666710160460     -0.419376828887
H       3.331103615730      1.988656523589     -0.001684536040
C       1.251561735228      2.579025590303      0.081783055117
H       2.452988083492      1.737183782412     -1.508318184948
C       1.057938959869      2.448119266740      1.590695140287
H       0.319408658346      2.302112839717     -0.421475168108
H       1.462648501162      3.616626665759     -0.187913123744
C       0.809826113494      0.995036256040      1.984083478107
H       0.228042925927      3.077336909731      1.920613465017
H       1.956062222206      2.809714258163      2.104802784323
H      -0.128520625673      0.653600443028      1.531691593093
H       0.699005962769      0.900648738839      3.067056139208
H       2.881620057380      0.390520461093      1.972641088302
H       1.737511025614     -0.933652061421      1.775503912745
```

<MoleculeViewer 
  xyzData={`46
0 2
O       1.232780920567     -2.176526034694     -2.237096699793
C       1.482335334951     -2.382080202872     -1.112682436954
C       2.795516478567     -2.198411217547     -0.391022695513
C       3.196100795308     -0.720539184606     -0.530625468293
Cl     -0.260970928552     -2.427131525898      0.296647437761
C      -2.286258773774     -1.551879159932      0.461468028591
H       3.565955569010     -2.849615746577     -0.813066055566
H       2.631143199234     -2.484590142717      0.639018380576
H       4.117466236964     -0.564609251350      0.038279679868
C       2.109928917828      0.218042263652     -0.021268881565
H       3.430240971055     -0.495064638977     -1.575617327670
C      -2.097441090376     -0.394767565703     -0.459185823859
C      -2.742023760291     -1.203470248019      1.853422253735
C      -3.153013518811     -2.632438100451     -0.139375021679
C      -1.430522327407     -0.585215204938     -1.674409972003
C      -2.588781265319      0.879803905253     -0.180428364099
H      -3.761670579891     -0.799606658704      1.761530893593
H      -2.146060547469     -0.442304305363      2.353000234180
H      -2.830355306944     -2.077940992091      2.497455097822
H      -2.773093776687     -2.995949305492     -1.091662334801
H      -4.140382589379     -2.188902405511     -0.325013742916
H      -3.294431026380     -3.473061037036      0.540967343594
C      -1.221171105384      0.452731510193     -2.557272268519
C      -1.728494502399      1.713780518940     -2.273712272745
C      -2.421621170510      1.917614993913     -1.091708779808
H      -3.126271528419      1.073042053253      0.739210815035
H      -0.650920148587      0.265866959540     -3.458845362760
H      -1.576840760500      2.527466300764     -2.969167420212
H      -2.829309568888      2.894630443635     -0.867183738641
H      -1.028552582318     -1.557509580861     -1.904637160009
C       1.938393323877      0.100307536464      1.491207284151
H       1.160199978124     -0.073313810722     -0.488328435973
C       2.368927897255      1.666710160460     -0.419376828887
H       3.331103615730      1.988656523589     -0.001684536040
C       1.251561735228      2.579025590303      0.081783055117
H       2.452988083492      1.737183782412     -1.508318184948
C       1.057938959869      2.448119266740      1.590695140287
H       0.319408658346      2.302112839717     -0.421475168108
H       1.462648501162      3.616626665759     -0.187913123744
C       0.809826113494      0.995036256040      1.984083478107
H       0.228042925927      3.077336909731      1.920613465017
H       1.956062222206      2.809714258163      2.104802784323
H      -0.128520625673      0.653600443028      1.531691593093
H       0.699005962769      0.900648738839      3.067056139208
H       2.881620057380      0.390520461093      1.972641088302
H       1.737511025614     -0.933652061421      1.775503912745`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`bh9_3_42_ts_guess_2.xyz`
```
46
0 2
O       1.195231122758     -2.168681591711     -2.202412144225
C       1.430859911477     -2.329875948450     -1.051472749684
C       2.763657293346     -2.186526766793     -0.378066827223
C       3.204202492995     -0.721960063958     -0.513470871480
Cl      0.112037804757     -2.635928894066      0.117121895066
C      -2.359552941255     -1.521360787898      0.464193501630
H       3.497044560918     -2.846873706590     -0.849312511630
H       2.651906967867     -2.481648961190      0.660083691232
H       4.122490378032     -0.580436897267      0.062495616440
C       2.120413735418      0.225148900510     -0.014426313713
H       3.443814403813     -0.504882622701     -1.557344711405
C      -2.084498814317     -0.396459090955     -0.447561851581
C      -2.738085002865     -1.196565305240      1.868609917132
C      -3.180443324239     -2.609536914096     -0.139376606697
C      -1.413795497121     -0.584830423356     -1.663212088566
C      -2.587107714363      0.882464670184     -0.183022758428
H      -3.755382995321     -0.776725786277      1.805202640667
H      -2.117648197696     -0.449986062926      2.360678864451
H      -2.824936448249     -2.079762981378      2.501188757812
H      -2.805553810396     -2.979530946242     -1.092317306886
H      -4.163202646203     -2.150641591786     -0.335279673161
H      -3.344629496769     -3.448552155542      0.538011177267
C      -1.209582173261      0.454174756961     -2.551236255539
C      -1.739287087912      1.709499337125     -2.283190584203
C      -2.442299069146      1.909908388276     -1.104174585095
H      -3.141448264920      1.067274429103      0.728422501608
H      -0.633474744139      0.269103139178     -3.450263702036
H      -1.603548849257      2.520204357152     -2.985729194702
H      -2.882323955040      2.876205950751     -0.895429462519
H      -1.007095391109     -1.552632132754     -1.904373904752
C       1.942698074992      0.107741193744      1.497198681088
H       1.170695406154     -0.061250140357     -0.487086785877
C       2.370871066268      1.672810184950     -0.418493391563
H       3.330880804591      2.003793703306     -0.003606931583
C       1.243862047085      2.575561765341      0.078479732714
H       2.453301273807      1.737528338769     -1.507787658647
C       1.048969846521      2.447569108781      1.587825027015
H       0.315312704138      2.287625503961     -0.425210621108
H       1.444253501400      3.614363519500     -0.193688785638
C       0.807842358278      0.994671803873      1.986139762996
H       0.215543310393      3.073071844391      1.915127448037
H       1.945157267060      2.814144637440      2.102015550291
H      -0.126848578488      0.645709345355      1.532247278254
H       0.695619588799      0.902328415965      3.068912411254
H       2.883379275774      0.401893187506      1.980493186460
H       1.750699805425     -0.928146710589      1.783100636525
```

<MoleculeViewer 
  xyzData={`46
0 2
O       1.195231122758     -2.168681591711     -2.202412144225
C       1.430859911477     -2.329875948450     -1.051472749684
C       2.763657293346     -2.186526766793     -0.378066827223
C       3.204202492995     -0.721960063958     -0.513470871480
Cl      0.112037804757     -2.635928894066      0.117121895066
C      -2.359552941255     -1.521360787898      0.464193501630
H       3.497044560918     -2.846873706590     -0.849312511630
H       2.651906967867     -2.481648961190      0.660083691232
H       4.122490378032     -0.580436897267      0.062495616440
C       2.120413735418      0.225148900510     -0.014426313713
H       3.443814403813     -0.504882622701     -1.557344711405
C      -2.084498814317     -0.396459090955     -0.447561851581
C      -2.738085002865     -1.196565305240      1.868609917132
C      -3.180443324239     -2.609536914096     -0.139376606697
C      -1.413795497121     -0.584830423356     -1.663212088566
C      -2.587107714363      0.882464670184     -0.183022758428
H      -3.755382995321     -0.776725786277      1.805202640667
H      -2.117648197696     -0.449986062926      2.360678864451
H      -2.824936448249     -2.079762981378      2.501188757812
H      -2.805553810396     -2.979530946242     -1.092317306886
H      -4.163202646203     -2.150641591786     -0.335279673161
H      -3.344629496769     -3.448552155542      0.538011177267
C      -1.209582173261      0.454174756961     -2.551236255539
C      -1.739287087912      1.709499337125     -2.283190584203
C      -2.442299069146      1.909908388276     -1.104174585095
H      -3.141448264920      1.067274429103      0.728422501608
H      -0.633474744139      0.269103139178     -3.450263702036
H      -1.603548849257      2.520204357152     -2.985729194702
H      -2.882323955040      2.876205950751     -0.895429462519
H      -1.007095391109     -1.552632132754     -1.904373904752
C       1.942698074992      0.107741193744      1.497198681088
H       1.170695406154     -0.061250140357     -0.487086785877
C       2.370871066268      1.672810184950     -0.418493391563
H       3.330880804591      2.003793703306     -0.003606931583
C       1.243862047085      2.575561765341      0.078479732714
H       2.453301273807      1.737528338769     -1.507787658647
C       1.048969846521      2.447569108781      1.587825027015
H       0.315312704138      2.287625503961     -0.425210621108
H       1.444253501400      3.614363519500     -0.193688785638
C       0.807842358278      0.994671803873      1.986139762996
H       0.215543310393      3.073071844391      1.915127448037
H       1.945157267060      2.814144637440      2.102015550291
H      -0.126848578488      0.645709345355      1.532247278254
H       0.695619588799      0.902328415965      3.068912411254
H       2.883379275774      0.401893187506      1.980493186460
H       1.750699805425     -0.928146710589      1.783100636525`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`bh9_3_42_ts_guess_3.xyz`
```
46
0 2
O       1.295623881419     -2.563716376185     -2.103529391597
C       1.542172619759     -2.582364799369     -0.946122802292
C       2.844033657432     -2.166215103407     -0.315367149900
C       3.099875328720     -0.679778834328     -0.586208809393
Cl      0.300985037686     -3.121597106032      0.209925778955
C      -2.772125109504     -1.457469625844      0.334989348682
H       3.616401151792     -2.763877194249     -0.804767059009
H       2.856228379721     -2.393929069705      0.746904262977
H       4.070341648636     -0.421485387574     -0.152865125996
C       2.036369909372      0.269818285836     -0.038944164959
H       3.183723575102     -0.537281596464     -1.666081020247
C      -2.353227196473     -0.391007012810     -0.512093011138
C      -3.127275127567     -1.203616947765      1.763541048655
C      -3.054896381419     -2.829294938216     -0.178791514164
C      -1.791237700731     -0.611947961268     -1.792164988108
C      -2.498937349358      0.957609023328     -0.105639020759
H      -4.158013141757     -0.842405609298      1.875123308637
H      -2.475356604297     -0.461791487263      2.227872750683
H      -3.051843246549     -2.125607992293      2.341802174591
H      -2.577957103312     -3.050609533411     -1.129633257485
H      -4.136526976010     -2.958493083264     -0.320070331739
H      -2.743875537069     -3.591161271592      0.539585352473
C      -1.414837928126      0.441070043880     -2.602364267798
C      -1.597214425080      1.757776441335     -2.190112610792
C      -2.143429685830      2.002975356655     -0.934856732196
H      -2.931724814465      1.178998944218      0.860947714542
H      -0.975456143603      0.233294671190     -3.570002123169
H      -1.313127115768      2.579403996351     -2.834464101396
H      -2.291556640163      3.022301950940     -0.599486433729
H      -1.621766025981     -1.620868837150     -2.141571527171
C       1.855725836477      0.155977929341      1.475623115706
H       1.071799449999      0.032933292769     -0.513273510726
C       2.398529410090      1.707048105300     -0.416631995557
H       3.388651224295      1.935001179684     -0.001005579418
C       1.382206992708      2.716378957841      0.106477426252
H       2.487087066724      1.788758280441     -1.503775833223
C       1.190214107181      2.582117873660      1.614211426044
H       0.425018048120      2.542572067451     -0.391905946604
H       1.696092692911      3.731176110393     -0.149928512612
C       0.816870448338      1.150443959437      1.987980043257
H       0.421477977931      3.277448676692      1.960086231019
H       2.119379335713      2.857657011569      2.126408522677
H      -0.154512947933      0.905368566742      1.543328925699
H       0.706650373650      1.054598738837      3.070860418545
H       2.821082972120      0.351416412197      1.961338186014
H       1.558356075101     -0.857626108602      1.754650785769
```

<MoleculeViewer 
  xyzData={`46
0 2
O       1.295623881419     -2.563716376185     -2.103529391597
C       1.542172619759     -2.582364799369     -0.946122802292
C       2.844033657432     -2.166215103407     -0.315367149900
C       3.099875328720     -0.679778834328     -0.586208809393
Cl      0.300985037686     -3.121597106032      0.209925778955
C      -2.772125109504     -1.457469625844      0.334989348682
H       3.616401151792     -2.763877194249     -0.804767059009
H       2.856228379721     -2.393929069705      0.746904262977
H       4.070341648636     -0.421485387574     -0.152865125996
C       2.036369909372      0.269818285836     -0.038944164959
H       3.183723575102     -0.537281596464     -1.666081020247
C      -2.353227196473     -0.391007012810     -0.512093011138
C      -3.127275127567     -1.203616947765      1.763541048655
C      -3.054896381419     -2.829294938216     -0.178791514164
C      -1.791237700731     -0.611947961268     -1.792164988108
C      -2.498937349358      0.957609023328     -0.105639020759
H      -4.158013141757     -0.842405609298      1.875123308637
H      -2.475356604297     -0.461791487263      2.227872750683
H      -3.051843246549     -2.125607992293      2.341802174591
H      -2.577957103312     -3.050609533411     -1.129633257485
H      -4.136526976010     -2.958493083264     -0.320070331739
H      -2.743875537069     -3.591161271592      0.539585352473
C      -1.414837928126      0.441070043880     -2.602364267798
C      -1.597214425080      1.757776441335     -2.190112610792
C      -2.143429685830      2.002975356655     -0.934856732196
H      -2.931724814465      1.178998944218      0.860947714542
H      -0.975456143603      0.233294671190     -3.570002123169
H      -1.313127115768      2.579403996351     -2.834464101396
H      -2.291556640163      3.022301950940     -0.599486433729
H      -1.621766025981     -1.620868837150     -2.141571527171
C       1.855725836477      0.155977929341      1.475623115706
H       1.071799449999      0.032933292769     -0.513273510726
C       2.398529410090      1.707048105300     -0.416631995557
H       3.388651224295      1.935001179684     -0.001005579418
C       1.382206992708      2.716378957841      0.106477426252
H       2.487087066724      1.788758280441     -1.503775833223
C       1.190214107181      2.582117873660      1.614211426044
H       0.425018048120      2.542572067451     -0.391905946604
H       1.696092692911      3.731176110393     -0.149928512612
C       0.816870448338      1.150443959437      1.987980043257
H       0.421477977931      3.277448676692      1.960086231019
H       2.119379335713      2.857657011569      2.126408522677
H      -0.154512947933      0.905368566742      1.543328925699
H       0.706650373650      1.054598738837      3.070860418545
H       2.821082972120      0.351416412197      1.961338186014
H       1.558356075101     -0.857626108602      1.754650785769`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-v1.20.0-rc.1/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`bh9_3_42_ts_final_X.xyz`として保存されている。)

`bh9_3_42_ts_final_1.xyz`
```
46
OptimizedStructure
O      2.011991508402     -3.501270283163     -1.351732085481
C      1.769251883398     -2.900225241393     -0.377899353691
C      2.693200800110     -2.325851639189      0.663935624578
C      3.297419688392     -1.007748539898      0.158475459449
Cl    -0.311257129896     -2.344229742604     -0.036123749983
C     -2.360656794828     -1.797968977201      0.087289874829
H      3.482001215328     -3.065425477758      0.824258636947
H      2.141146301521     -2.184441090340      1.590385499302
H      4.056995904968     -0.691851052744      0.880121715367
C      2.291217453702      0.124024052174     -0.038119565591
H      3.818980095611     -1.205103637309     -0.781988457510
C     -2.379234972534     -0.352260899423     -0.246100800733
C     -2.717049718516     -2.176203661869      1.497477186566
C     -2.977355118990     -2.702613811569     -0.948082449776
C     -1.914222816759      0.096183595287     -1.488112485457
C     -2.866496724358      0.599597293580      0.650945069189
H     -3.781741414070     -1.994954506848      1.685523768339
H     -2.138149681499     -1.612679656195      2.228885867677
H     -2.527082904006     -3.237276738997      1.655100377158
H     -2.593026236033     -2.506427114784     -1.946956777331
H     -4.061658941388     -2.545037994094     -0.967825411579
H     -2.786459514732     -3.748400500956     -0.707702217985
C     -1.944336195041      1.438354070460     -1.820113364892
C     -2.449199005751      2.372778252794     -0.922030132003
C     -2.909418150159      1.945953652734      0.312461803481
H     -3.232881992275      0.291885209438      1.620882842632
H     -1.569398269474      1.760659900478     -2.783569802312
H     -2.476694004919      3.422667964388     -1.183623589407
H     -3.302623457669      2.662497817173      1.022579221273
H     -1.498170417954     -0.617518740352     -2.187807792652
C      1.651820608857      0.565719413110      1.278994632671
H      1.486758323648     -0.229429006207     -0.696428188358
C      2.957658087393      1.317447587980     -0.722095368840
H      3.786858601298      1.668940038233     -0.094381125910
C      1.971116432174      2.460688174433     -0.945771534524
H      3.394999195717      1.001300889803     -1.673516121613
C      1.325129095796      2.895329546908      0.366978306816
H      1.186731416868      2.124820806223     -1.633504188567
H      2.473578839237      3.304629378693     -1.424252976208
C      0.665973728679      1.709467512047      1.064172641361
H      0.587960058915      3.681146122488      0.184046708414
H      2.092585250918      3.324785893490      1.021655856107
H     -0.161893976932      1.346646703206      0.448420805622
H      0.233714616625      2.019606058301      2.018841840047
H      2.448072382861      0.884167167334      1.965285433003
H      1.133845947365     -0.272378787859      1.751018369576
```

<MoleculeViewer 
  xyzData={`46
OptimizedStructure
O      2.011991508402     -3.501270283163     -1.351732085481
C      1.769251883398     -2.900225241393     -0.377899353691
C      2.693200800110     -2.325851639189      0.663935624578
C      3.297419688392     -1.007748539898      0.158475459449
Cl    -0.311257129896     -2.344229742604     -0.036123749983
C     -2.360656794828     -1.797968977201      0.087289874829
H      3.482001215328     -3.065425477758      0.824258636947
H      2.141146301521     -2.184441090340      1.590385499302
H      4.056995904968     -0.691851052744      0.880121715367
C      2.291217453702      0.124024052174     -0.038119565591
H      3.818980095611     -1.205103637309     -0.781988457510
C     -2.379234972534     -0.352260899423     -0.246100800733
C     -2.717049718516     -2.176203661869      1.497477186566
C     -2.977355118990     -2.702613811569     -0.948082449776
C     -1.914222816759      0.096183595287     -1.488112485457
C     -2.866496724358      0.599597293580      0.650945069189
H     -3.781741414070     -1.994954506848      1.685523768339
H     -2.138149681499     -1.612679656195      2.228885867677
H     -2.527082904006     -3.237276738997      1.655100377158
H     -2.593026236033     -2.506427114784     -1.946956777331
H     -4.061658941388     -2.545037994094     -0.967825411579
H     -2.786459514732     -3.748400500956     -0.707702217985
C     -1.944336195041      1.438354070460     -1.820113364892
C     -2.449199005751      2.372778252794     -0.922030132003
C     -2.909418150159      1.945953652734      0.312461803481
H     -3.232881992275      0.291885209438      1.620882842632
H     -1.569398269474      1.760659900478     -2.783569802312
H     -2.476694004919      3.422667964388     -1.183623589407
H     -3.302623457669      2.662497817173      1.022579221273
H     -1.498170417954     -0.617518740352     -2.187807792652
C      1.651820608857      0.565719413110      1.278994632671
H      1.486758323648     -0.229429006207     -0.696428188358
C      2.957658087393      1.317447587980     -0.722095368840
H      3.786858601298      1.668940038233     -0.094381125910
C      1.971116432174      2.460688174433     -0.945771534524
H      3.394999195717      1.001300889803     -1.673516121613
C      1.325129095796      2.895329546908      0.366978306816
H      1.186731416868      2.124820806223     -1.633504188567
H      2.473578839237      3.304629378693     -1.424252976208
C      0.665973728679      1.709467512047      1.064172641361
H      0.587960058915      3.681146122488      0.184046708414
H      2.092585250918      3.324785893490      1.021655856107
H     -0.161893976932      1.346646703206      0.448420805622
H      0.233714616625      2.019606058301      2.018841840047
H      2.448072382861      0.884167167334      1.965285433003
H      1.133845947365     -0.272378787859      1.751018369576`}
  caption="遷移状態構造 (No.1)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -522.0830             21.4991             26.5109
Reduced mass [au]                  12.9458              4.4522              3.9591
Force const [Dyne/A]               -2.0790              0.0012              0.0016
Char temp [K]                       0.0000             30.9323             38.1433
Normal mode                   x         y         z            x         y         z            x         y         z     
       O                 0.03685   -0.01118   -0.02042   -0.01967    0.05064   -0.06990   -0.01961   -0.07975    0.04522
       C                 0.06955   -0.02785   -0.00075   -0.00803    0.01146   -0.04277    0.00080   -0.03105    0.02028
       C                 0.03613   -0.00360    0.00147    0.00577   -0.00904   -0.04373    0.02246    0.01304   -0.02360
       C                 0.00826    0.00425   -0.00002   -0.00317    0.00247   -0.02428   -0.02102    0.01643   -0.06779
      Cl                -0.12213    0.03332    0.01198   -0.00353   -0.01095    0.00927    0.00711   -0.00911    0.02380
       C                 0.14610   -0.04207   -0.00296    0.00252    0.00775    0.03880    0.00832    0.00537   -0.01338
       H                 0.05401    0.02103    0.03785    0.00916   -0.01143   -0.07141    0.04412    0.03376   -0.03441
       H                 0.00830   -0.00721   -0.01241    0.01949   -0.03023   -0.03238    0.05013    0.02043   -0.00812
       H                 0.00781    0.01689   -0.00495    0.00152   -0.00811   -0.02455    0.01573    0.02820   -0.11156
       C                 0.00027   -0.00195    0.00029   -0.00846    0.00284    0.00455   -0.03985    0.00827   -0.01875
       H                 0.00733    0.00948   -0.00175   -0.01038    0.02174   -0.03228   -0.06954    0.01534   -0.09456
       C                 0.02157    0.00173   -0.00173    0.00817   -0.00158   -0.00386    0.02378    0.00724   -0.00664
       C                 0.01482   -0.00363   -0.00524    0.02832    0.05322    0.05736   -0.02384    0.00012   -0.02300
       C                 0.00726    0.00422    0.00708   -0.02597   -0.01625    0.07691    0.02424    0.01559   -0.03182
       C                 0.00655    0.00187    0.00057    0.01792   -0.04010   -0.01395    0.06077    0.01150    0.00880
       C                 0.00047   -0.01292   -0.00535    0.00560    0.02595   -0.03484    0.00019    0.00444   -0.01648
       H                 0.01072    0.03339   -0.08936    0.03196    0.06005    0.07171   -0.02737    0.00297   -0.04555
       H                -0.01093   -0.00839    0.01823    0.04246    0.07682    0.02808   -0.03791   -0.00521   -0.00777
       H                -0.01889   -0.00498    0.02054    0.02975    0.05800    0.08815   -0.03134   -0.00133   -0.02377
       H                -0.01801   -0.00582   -0.00425   -0.04711   -0.04333    0.06333    0.04688    0.01953   -0.02238
       H                 0.02004    0.07012    0.06416   -0.02552   -0.01028    0.09708    0.02573    0.02293   -0.05389
       H                -0.03065   -0.00648   -0.00979   -0.02693   -0.01124    0.09969    0.01234    0.01285   -0.03431
       C                -0.00208    0.00102   -0.00200    0.02907   -0.04931   -0.05186    0.07403    0.01310    0.01404
       C                -0.00215   -0.00232    0.00134    0.02851   -0.02091   -0.08160    0.05109    0.01052    0.00374
       C                -0.00396   -0.00734   -0.00272    0.01529    0.01667   -0.07358    0.01393    0.00618   -0.01157
       H                 0.01440   -0.01031    0.00046   -0.00234    0.05525   -0.02847   -0.02890    0.00089   -0.02859
       H                -0.00492    0.00302   -0.00232    0.03816   -0.07874   -0.05816    0.10216    0.01637    0.02605
       H                -0.00070   -0.00105    0.00545    0.03766   -0.02800   -0.11106    0.06182    0.01181    0.00773
       H                -0.00133   -0.00992    0.00129    0.01365    0.03908   -0.09710   -0.00468    0.00405   -0.01973
       H                 0.01572    0.00530    0.00209    0.01831   -0.06317    0.00973    0.07828    0.01318    0.01740
       C                 0.00043   -0.00058    0.00002   -0.00621   -0.02847    0.01612    0.02537    0.00475    0.01417
       H                 0.00090   -0.00601    0.00147   -0.00939    0.01444   -0.00084   -0.07075    0.00291    0.02258
       C                -0.00133   -0.00077   -0.00024   -0.01402    0.02021    0.02917   -0.08123    0.01213   -0.05257
       H                -0.00139   -0.00102    0.00006   -0.01209    0.00690    0.03409   -0.05010    0.01567   -0.09560
       C                -0.00023   -0.00013   -0.00006   -0.01619    0.02425    0.05940   -0.09802    0.00772   -0.00066
       H                -0.00081   -0.00075    0.00018   -0.01712    0.04296    0.02018   -0.12922    0.01482   -0.07557
       C                -0.00008    0.00002   -0.00002   -0.01302   -0.00801    0.07159   -0.03159    0.00448    0.03306
       H                -0.00060    0.00013   -0.00013   -0.01796    0.03993    0.05381   -0.13256    0.00423    0.04071
       H                -0.00034    0.00007   -0.00003   -0.01843    0.03621    0.07813   -0.12669    0.01019   -0.02652
       C                 0.00062   -0.00029    0.00030   -0.00969   -0.02623    0.04359    0.00994    0.00128    0.06684
       H                 0.00018    0.00073    0.00069   -0.01439   -0.00447    0.09248   -0.04488    0.00097    0.07140
       H                 0.00015   -0.00049   -0.00004   -0.01193   -0.02322    0.08030    0.00038    0.00799   -0.00669
       H                 0.00097   -0.00003   -0.00027   -0.00858   -0.01363    0.03453   -0.02071   -0.00130    0.10988
       H                 0.00055    0.00048    0.00028   -0.01063   -0.05032    0.05104    0.05935   -0.00109    0.09005
       H                 0.00000   -0.00002    0.00016   -0.00550   -0.04130    0.02126    0.05908    0.00644   -0.02566
       H                 0.00191   -0.00127    0.00023   -0.00256   -0.04052   -0.00141    0.05224    0.00236    0.03951
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_3_42_ts_final_3.xyz`
```
46
OptimizedStructure
O      1.568424214170     -1.535094455024     -2.834184718922
C      1.593347876764     -2.316208412401     -1.950054576954
C      2.325203380332     -2.227504891211     -0.642529656670
C      2.971906206909     -0.866172183563     -0.421470524185
Cl     0.687983072355     -3.872386563004     -2.106400874770
C     -2.594104992206     -1.337412318271      0.704025537938
H      3.064405873711     -3.033478958053     -0.660129570300
H      1.622440577338     -2.494797859998      0.148697131312
H      3.695796580489     -0.956631184774      0.394230482164
C      1.985019529277      0.253010202908     -0.089299479723
H      3.537622081848     -0.598453209863     -1.317219393486
C     -2.324264372249     -0.351507367523     -0.284287518456
C     -3.420401926430     -0.998943128456      1.902015889874
C     -2.029366452319     -2.714133742134      0.569106262269
C     -1.514344004546     -0.636547635839     -1.408611898256
C     -2.830657452424      0.965982718392     -0.176604873047
H     -4.431796612147     -0.682360855900      1.625048519612
H     -2.983831313787     -0.172960026825      2.474658466316
H     -3.512280914909     -1.853426940498      2.570244105098
H     -2.320148468719     -3.187999136646     -0.374101312143
H     -2.360794059821     -3.357412825511      1.382482046955
H     -0.932410540603     -2.708718106653      0.575873375212
C     -1.209338356036      0.336035409822     -2.340955573204
C     -1.704027038263      1.628796429682     -2.200642376233
C     -2.521706849707      1.930343615004     -1.115086524275
H     -3.459635545219      1.230072897790      0.663182981178
H     -0.573243546788      0.083408451055     -3.179867868687
H     -1.460454277074      2.389960443513     -2.930159063991
H     -2.918053383696      2.931554962131     -0.999951446741
H     -1.124962201563     -1.636944924877     -1.545806942875
C      1.353348571313      0.072443027842      1.293189137151
H      1.179083451057      0.243271783594     -0.833020944379
C      2.678719087959      1.612079553385     -0.178444217566
H      3.528934300376      1.622795218606      0.516237210046
C      1.731593448540      2.758401801657      0.163204872556
H      3.090515085876      1.745176578039     -1.182700058372
C      1.126838843466      2.571091405095      1.551380458491
H      0.923828541418      2.786489048679     -0.576947541419
H      2.257029038530      3.713960390528      0.098823786503
C      0.416544636993      1.224695910811      1.647492752577
H      0.430419294508      3.382426075977      1.775777583990
H      1.923741445794      2.619804478548      2.302706731746
H     -0.430005229619      1.219830112476      0.954743767214
H      0.006906815585      1.077656629975      2.650378123378
H      2.156071042050      0.010419392847      2.039961668793
H      0.800104541464     -0.870611811331      1.345016064279
```

<MoleculeViewer 
  xyzData={`46
OptimizedStructure
O      1.568424214170     -1.535094455024     -2.834184718922
C      1.593347876764     -2.316208412401     -1.950054576954
C      2.325203380332     -2.227504891211     -0.642529656670
C      2.971906206909     -0.866172183563     -0.421470524185
Cl     0.687983072355     -3.872386563004     -2.106400874770
C     -2.594104992206     -1.337412318271      0.704025537938
H      3.064405873711     -3.033478958053     -0.660129570300
H      1.622440577338     -2.494797859998      0.148697131312
H      3.695796580489     -0.956631184774      0.394230482164
C      1.985019529277      0.253010202908     -0.089299479723
H      3.537622081848     -0.598453209863     -1.317219393486
C     -2.324264372249     -0.351507367523     -0.284287518456
C     -3.420401926430     -0.998943128456      1.902015889874
C     -2.029366452319     -2.714133742134      0.569106262269
C     -1.514344004546     -0.636547635839     -1.408611898256
C     -2.830657452424      0.965982718392     -0.176604873047
H     -4.431796612147     -0.682360855900      1.625048519612
H     -2.983831313787     -0.172960026825      2.474658466316
H     -3.512280914909     -1.853426940498      2.570244105098
H     -2.320148468719     -3.187999136646     -0.374101312143
H     -2.360794059821     -3.357412825511      1.382482046955
H     -0.932410540603     -2.708718106653      0.575873375212
C     -1.209338356036      0.336035409822     -2.340955573204
C     -1.704027038263      1.628796429682     -2.200642376233
C     -2.521706849707      1.930343615004     -1.115086524275
H     -3.459635545219      1.230072897790      0.663182981178
H     -0.573243546788      0.083408451055     -3.179867868687
H     -1.460454277074      2.389960443513     -2.930159063991
H     -2.918053383696      2.931554962131     -0.999951446741
H     -1.124962201563     -1.636944924877     -1.545806942875
C      1.353348571313      0.072443027842      1.293189137151
H      1.179083451057      0.243271783594     -0.833020944379
C      2.678719087959      1.612079553385     -0.178444217566
H      3.528934300376      1.622795218606      0.516237210046
C      1.731593448540      2.758401801657      0.163204872556
H      3.090515085876      1.745176578039     -1.182700058372
C      1.126838843466      2.571091405095      1.551380458491
H      0.923828541418      2.786489048679     -0.576947541419
H      2.257029038530      3.713960390528      0.098823786503
C      0.416544636993      1.224695910811      1.647492752577
H      0.430419294508      3.382426075977      1.775777583990
H      1.923741445794      2.619804478548      2.302706731746
H     -0.430005229619      1.219830112476      0.954743767214
H      0.006906815585      1.077656629975      2.650378123378
H      2.156071042050      0.010419392847      2.039961668793
H      0.800104541464     -0.870611811331      1.345016064279`}
  caption="遷移状態構造 (No.3)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -22.2734             18.1352             30.6267
Reduced mass [au]                   3.4302              4.6410              3.5961
Force const [Dyne/A]               -0.0010              0.0009              0.0020
Char temp [K]                       0.0000             26.0924             44.0650
Normal mode                   x         y         z            x         y         z            x         y         z     
       O                -0.02286   -0.00372   -0.00371    0.03863    0.02393   -0.01006    0.01523   -0.00359    0.02433
       C                -0.00774   -0.00201   -0.00269   -0.00539    0.01575   -0.01619   -0.01810   -0.00778    0.02152
       C                 0.00697    0.00575   -0.01119   -0.05808   -0.00401    0.01454   -0.06796   -0.01370    0.05006
       C                -0.01380    0.01665   -0.01757   -0.03384   -0.02031    0.04365   -0.03814   -0.02880    0.05605
      Cl                 0.00218   -0.00893    0.00939   -0.01464    0.02581   -0.06711   -0.01479   -0.00572   -0.01928
       C                 0.02944    0.02560   -0.00642    0.03767    0.01389    0.03733    0.02722   -0.03649   -0.03063
       H                 0.01970    0.01763   -0.02332   -0.07788   -0.02268    0.04558   -0.09350   -0.03767    0.09429
       H                 0.02156   -0.00726   -0.00265   -0.09902    0.01289   -0.01583   -0.11152    0.02114    0.02390
       H                 0.01128    0.02606   -0.03891   -0.05944   -0.04252    0.06387   -0.05513   -0.04015    0.06968
       C                -0.03092   -0.00924    0.01951   -0.01731    0.00021    0.02411   -0.02181   -0.00672    0.03025
       H                -0.04541    0.03583   -0.03168   -0.00171   -0.02688    0.06199   -0.01573   -0.04802    0.06451
       C                 0.02244    0.01417   -0.01972    0.01750   -0.01118    0.00679    0.02062   -0.01358   -0.00966
       C                 0.06821    0.04957    0.01352    0.06759    0.04618    0.04886    0.05341   -0.05854   -0.00634
       C                 0.00342    0.01528   -0.00991    0.02788    0.00789    0.05689    0.01000   -0.03903   -0.07556
       C                -0.01358   -0.00832   -0.03992    0.00157   -0.03731    0.00204    0.00444    0.00947   -0.02715
       C                 0.05357    0.02566   -0.01227    0.01276   -0.01081   -0.02072    0.02895   -0.01349    0.02868
       H                 0.06999    0.07664    0.03837    0.05547    0.02358    0.06654    0.04784   -0.05155    0.02155
       H                 0.10518    0.03873    0.00138    0.07364    0.07196    0.00674    0.06687   -0.07060    0.00060
       H                 0.06202    0.05316    0.01726    0.09696    0.06864    0.08166    0.06606   -0.07171   -0.02143
       H                -0.02856    0.01238    0.00140    0.01596   -0.00733    0.06839    0.01005   -0.00269   -0.09347
       H                 0.01370    0.02716    0.00368    0.03215    0.02493    0.07210   -0.00256   -0.06289   -0.09950
       H                 0.00364   -0.00241   -0.03839    0.02816    0.00088    0.04673    0.01013   -0.05364   -0.06841
       C                -0.01765   -0.01896   -0.05245   -0.01520   -0.06027   -0.02740   -0.00090    0.03085   -0.00657
       C                 0.01357   -0.00786   -0.04535   -0.01861   -0.05872   -0.05388    0.00759    0.03003    0.03098
       C                 0.04936    0.01483   -0.02466   -0.00524   -0.03418   -0.05063    0.02202    0.00762    0.04812
       H                 0.08203    0.04308    0.00361    0.02307    0.00824   -0.01896    0.04070   -0.03064    0.04290
       H                -0.04407   -0.03588   -0.06722   -0.02579   -0.07886   -0.02978   -0.01133    0.04813   -0.01977
       H                 0.01068   -0.01635   -0.05517   -0.03205   -0.07667   -0.07704    0.00309    0.04676    0.04693
       H                 0.07413    0.02393   -0.01845   -0.00874   -0.03315   -0.07168    0.02845    0.00682    0.07729
       H                -0.03701   -0.01672   -0.04530    0.00262   -0.03965    0.02252   -0.00295    0.01071   -0.05674
       C                 0.04155   -0.01897    0.05153   -0.04915    0.01005    0.01099    0.00304    0.04920    0.04890
       H                -0.06604   -0.03903    0.05744   -0.00205    0.01882    0.00700   -0.03562   -0.02942    0.04539
       C                -0.07772    0.01163   -0.02330    0.01498   -0.01506    0.04192   -0.01725   -0.01367   -0.03440
       H                -0.04516    0.04371   -0.06360    0.00243   -0.03721    0.05763   -0.00595    0.01104   -0.04859
       C                -0.09880   -0.01649    0.01252    0.03567    0.00572    0.02918   -0.00924    0.00224   -0.06545
       H                -0.12977    0.01697   -0.04392    0.03657   -0.02085    0.05006   -0.03354   -0.05523   -0.04656
       C                -0.02629   -0.02434    0.04312    0.00703    0.01452    0.01786    0.01117    0.05970   -0.04871
       H                -0.13477   -0.04930    0.05052    0.04942    0.02744    0.01491   -0.02023   -0.02602   -0.05451
       H                -0.13314    0.00020   -0.02017    0.05907   -0.00632    0.04182   -0.00835   -0.00135   -0.11165
       C                 0.02213   -0.04670    0.09064   -0.02740    0.03139   -0.00107    0.01069    0.06443    0.01922
       H                -0.04188   -0.04497    0.06946    0.02304    0.03053    0.00960    0.01570    0.06997   -0.07164
       H                 0.00815    0.00831    0.00447   -0.00470   -0.00837    0.03176    0.02254    0.08984   -0.06272
       H                -0.01371   -0.07956    0.13462   -0.01477    0.05516   -0.01654   -0.00219    0.03703    0.03520
       H                 0.08008   -0.05166    0.11357   -0.04936    0.03671   -0.00919    0.02954    0.10660    0.03309
       H                 0.08054    0.01304    0.01217   -0.06499   -0.01288    0.02610    0.01723    0.08003    0.03605
       H                 0.07622   -0.03746    0.08623   -0.07323    0.02330   -0.00403    0.00534    0.05023    0.09742
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在することを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、BH9データセットの3. Halogen atom transfer, No. 42の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- _J. Phys. Chem. A_ 2019, 123, 3761−3781 http://dx.doi.org/10.1021/acs.jpca.9b01546 (MOBH35のデータセットについて)

