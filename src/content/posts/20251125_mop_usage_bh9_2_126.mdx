---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(BH9データセットの2. Pericyclic, No. 126の化学反応, NNP(UMA)使用)
published: 2025-11-25
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-11-25

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、BH9データセットの2. Pericyclic, No. 126の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

BH9のデータセットについて:

- _J. Chem. Theory Comput._ 2022, 18, 1, 151–166 

https://doi.org/10.1021/acs.jctc.1c00694


この文献のSupporting Informationから、データセットの詳細を確認できる。

有機金属錯体が関わる反応を除いたさまざまなカテゴリの反応がまとめられたデータセットである。DFTの汎関数の電子エネルギーの精度の比較などのベンチマークに主に使われる。

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.19.6b
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.19.6b.zip
unzip v1.19.6b.zip
cd MultiOptPy-v1.19.6b
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.19.6b にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.19.6b`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.19.6b`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`bh9_2_126.xyz`とした。
初期構造は以下のものを使用した。

```
55
OptimizedStructure
C      5.781521193441      0.181832335298      1.314353403284
C      5.000578600817     -0.809737422635      0.462403013242
C      3.608393741869     -0.304771811173      0.118341787160
C      2.710541187123     -1.376489694641     -0.538221874999
C      1.318672709512     -0.840645838358     -0.755151732793
C      0.361187483030     -0.655169099326      0.154454254147
C     -0.827191909239      0.205836095867     -0.212394938137
C     -2.201080083756     -0.369195595644      0.194653625725
C     -3.047393327636      0.612774324462      1.037310487990
C     -3.013553977244      1.994425937538      0.439349693154
C     -1.837438944582      2.501377693658      0.093850766916
C     -0.598996659342      1.682176555530      0.315539720573
C      0.623539502792      2.181074453142     -0.381456165192
C      1.840087508435      1.946915929507      0.092725069019
C      3.007642843776      1.923434107843     -0.821816400080
C      3.294607565482     -1.901590103678     -1.847749028367
C     -2.941758542942     -0.879156816441     -1.054949011675
C     -4.314065272738     -1.440221040490     -0.692329993860
C     -5.172246856646     -0.439027637166      0.072088878821
C     -4.448614573704      0.062040404399      1.309634347601
C      0.517927910548     -1.053301672704      1.596658155589
O      3.241184715201      2.755266327406     -1.654293491007
O      3.816319703568      0.832528865806     -0.750023411787
O     -3.034002186507      0.091163146098     -2.088846952939
O     -5.487663591164      0.707729716360     -0.731829587215
H      5.896252352583      1.131359845786      0.791880052692
H      6.776795114621     -0.197340072090      1.545951946942
H      5.269890139317      0.374290196666      2.260392890769
H      5.541031222581     -1.011300211830     -0.464075320722
H      4.894814541189     -1.762846055669      0.988534464331
H      3.127431089954      0.019437241386      1.043277361495
H      2.676587945992     -2.197226225466      0.185880807971
H     -2.048002031496     -1.257438311639      0.816102389742
H     -2.545809476110      0.684590954770      2.012432415801
H     -3.936402294029      2.546469638057      0.310378095635
H     -1.744928872542      3.493013581034     -0.333952869028
H      3.447422892394     -1.081738014669     -2.551508216349
H      2.608709416349     -2.616656198599     -2.303160153100
H      4.250097195640     -2.402798759523     -1.697265504381
H     -2.335677029362     -1.681497765545     -1.485033966719
H     -4.189204405862     -2.330557741204     -0.068121763731
H     -4.822634878490     -1.757320649260     -1.607063682991
H     -6.105845345151     -0.921477655315      0.382328831787
H     -4.369262803624     -0.780945422949      2.002226265370
H     -5.060045558831      0.822765569902      1.800032071817
H     -0.404639845740     -1.464109249618      2.010311623920
H      0.774197603172     -0.186322926953      2.215658427026
H      1.301868739481     -1.796072402869      1.736050037105
H     -3.604509662868      0.803513152956     -1.771503732660
H     -5.953825909828      0.406173920216     -1.519154053855
H      1.954353120705      1.561071154798      1.097192825797
H      0.510881129297      2.521779885824     -1.407902293092
H      1.131663680614     -0.457921058658     -1.756562788026
H     -0.838566813189      0.305788337020     -1.299456433036
H     -0.400839996861      1.624046082785      1.393829654319
```

<MoleculeViewer 
  xyzData={`55
OptimizedStructure
C      5.781521193441      0.181832335298      1.314353403284
C      5.000578600817     -0.809737422635      0.462403013242
C      3.608393741869     -0.304771811173      0.118341787160
C      2.710541187123     -1.376489694641     -0.538221874999
C      1.318672709512     -0.840645838358     -0.755151732793
C      0.361187483030     -0.655169099326      0.154454254147
C     -0.827191909239      0.205836095867     -0.212394938137
C     -2.201080083756     -0.369195595644      0.194653625725
C     -3.047393327636      0.612774324462      1.037310487990
C     -3.013553977244      1.994425937538      0.439349693154
C     -1.837438944582      2.501377693658      0.093850766916
C     -0.598996659342      1.682176555530      0.315539720573
C      0.623539502792      2.181074453142     -0.381456165192
C      1.840087508435      1.946915929507      0.092725069019
C      3.007642843776      1.923434107843     -0.821816400080
C      3.294607565482     -1.901590103678     -1.847749028367
C     -2.941758542942     -0.879156816441     -1.054949011675
C     -4.314065272738     -1.440221040490     -0.692329993860
C     -5.172246856646     -0.439027637166      0.072088878821
C     -4.448614573704      0.062040404399      1.309634347601
C      0.517927910548     -1.053301672704      1.596658155589
O      3.241184715201      2.755266327406     -1.654293491007
O      3.816319703568      0.832528865806     -0.750023411787
O     -3.034002186507      0.091163146098     -2.088846952939
O     -5.487663591164      0.707729716360     -0.731829587215
H      5.896252352583      1.131359845786      0.791880052692
H      6.776795114621     -0.197340072090      1.545951946942
H      5.269890139317      0.374290196666      2.260392890769
H      5.541031222581     -1.011300211830     -0.464075320722
H      4.894814541189     -1.762846055669      0.988534464331
H      3.127431089954      0.019437241386      1.043277361495
H      2.676587945992     -2.197226225466      0.185880807971
H     -2.048002031496     -1.257438311639      0.816102389742
H     -2.545809476110      0.684590954770      2.012432415801
H     -3.936402294029      2.546469638057      0.310378095635
H     -1.744928872542      3.493013581034     -0.333952869028
H      3.447422892394     -1.081738014669     -2.551508216349
H      2.608709416349     -2.616656198599     -2.303160153100
H      4.250097195640     -2.402798759523     -1.697265504381
H     -2.335677029362     -1.681497765545     -1.485033966719
H     -4.189204405862     -2.330557741204     -0.068121763731
H     -4.822634878490     -1.757320649260     -1.607063682991
H     -6.105845345151     -0.921477655315      0.382328831787
H     -4.369262803624     -0.780945422949      2.002226265370
H     -5.060045558831      0.822765569902      1.800032071817
H     -0.404639845740     -1.464109249618      2.010311623920
H      0.774197603172     -0.186322926953      2.215658427026
H      1.301868739481     -1.796072402869      1.736050037105
H     -3.604509662868      0.803513152956     -1.771503732660
H     -5.953825909828      0.406173920216     -1.519154053855
H      1.954353120705      1.561071154798      1.097192825797
H      0.510881129297      2.521779885824     -1.407902293092
H      1.131663680614     -0.457921058658     -1.756562788026
H     -0.838566813189      0.305788337020     -1.299456433036
H     -0.400839996861      1.624046082785      1.393829654319`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`bh9_2_126.xyz`として保存する。その後、同じディレクトリ内で、`config_bh9_2_126.json`を作成し、以下のように記述する。

`config_bh9_2_126.json`
```json
{
  "work_dir": "bh9_2_126",
  "top_n_candidates": 3,
  "multioptpy_version": "v1.19.6b",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"manual_AFIR": ["300", "14", "5"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 15,
    "ANEB": [3, 5],
    "QSM": true,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance_bernstein": 0.50,
    "align_distances": 9999,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 1,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 1,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py bh9_2_126.xyz -cfg config_bh9_2_126.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.19.6b/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。


Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`bh9_2_126_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`bh9_2_126_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`bh9_2_126_step1_traj.xyz`はStep2のNEB計算に使用している。

※`bh9_2_126_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`bh9_2_126_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。
- `"align_distances": X`は線形補間で、各ノード間の距離を全て等しくするための処理である。X回の反復計算ごとに本処理を行う。Xを`"NSTEP": n`よりも大きな数値を指定することで、初期経路に対してのみ処理を行うことが出来る。
- `"node_distance_bernstein": N`はノード間の距離をN Åとして初期経路を作成することを示す。経路作成時に元のノードをベルンシュタイン多項式を用いてがたついた経路を滑らかにする。

→プログラムの仕様上`"align_distances": X`の処理を行った後に、`"node_distance_bernstein": N`の処理を行うようになっている。

- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"ANEB": [A, B]`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


`MultiOptPy-v1.19.6b/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-1119.1291521588612,-1119.1291521588612,-1119.1146722720905,-1119.0913260086043,-1119.068083825566,-1119.0655354054127,-1119.0654930030785,-1119.0663821027929,-1119.0668341723945,-1119.0669576775713,-1119.0670237672102,-1119.0669604769403,-1119.0669687217169,-1119.0670904307415,-1119.0672360811607,-1119.0673070554571,-1119.0672742340616];

export const dataset1_itr5 = [-1119.1291521062908,-1119.1291521150526,-1119.120136911795,-1119.1007210148134,-1119.0742876519898,-1119.069462771029,-1119.0709327419804,-1119.0727431757696,-1119.073046304927,-1119.0731373260344,-1119.07331554814,-1119.0732039413763,-1119.0731609651496,-1119.073520638054,-1119.073538971949,-1119.0728135717927,-1119.073203547099];

export const dataset1_itr10 = [-1119.1291521588612,-1119.1291521150526,-1119.124483503713,-1119.108421049153,-1119.0796701374454,-1119.0769906945613,-1119.0738104975896,-1119.072227474191,-1119.0712919855607,-1119.0716972807309,-1119.0719226364986,-1119.0721767701289,-1119.072366413134,-1119.0737217895758,-1119.0739568314227,-1119.073967761666,-1119.0739584435787,-1119.0738253793677,-1119.0737395495782,-1119.0736383561161,-1119.0737090237526,-1119.0737548562995,-1119.0738282050218,-1119.073601517473,-1119.0739303797961,-1119.0739877515255,-1119.0741169781043,-1119.0741165443992,-1119.0740284015162,-1119.0740608943472,-1119.0738593792144,-1119.0737616553927,-1119.0737686866714,-1119.0737490954698,-1119.0736624508406];

export const dataset2 = [-1119.129152132576,-1119.129152132576,-1119.126434098705,-1119.11174233607,-1119.0834774368593,-1119.0814192260661,-1119.0783226903586,-1119.0739448541542,-1119.0732242466577,-1119.0728690159442,-1119.072591050441,-1119.0724800964251,-1119.0724515332245,-1119.0724345749193,-1119.0724059109589,-1119.0722903658027,-1119.07258579341,-1119.0728441808546,-1119.0731446333073,-1119.0740196792258,-1119.0742431599858,-1119.074260459998,-1119.074177385769,-1119.074035581744,-1119.0739350541726,-1119.0738774020683,-1119.0738449618073,-1119.0738014423541,-1119.073760770459,-1119.073791344474,-1119.0738240563483,-1119.0738395602082,-1119.0738928051685,-1119.0740021689323,-1119.0739566912353,-1119.0739559421083,-1119.0739546979444,-1119.0739841197933,-1119.0739377703053,-1119.0739731194565,-1119.0740284891333,-1119.0740239505633,-1119.0740682848564,-1119.0742237615423,-1119.0743663278365,-1119.0742510586747,-1119.0742031627433,-1119.0741866644282,-1119.0741717432225,-1119.0741607122195,-1119.074173907367,-1119.0741703413476,-1119.0742120909338,-1119.0742416573512,-1119.07410415533,-1119.0740751146157,-1119.07405111627,-1119.0740169806168,-1119.0739899025273,-1119.073991589158,-1119.0739894074902,-1119.0739929034157,-1119.0740245989305,-1119.0740385432048,-1119.073831832373];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [3.5846621004950237e-06,3.584624467730646e-06,0.00458747201262275,0.005858497411582592,0.004455471437136926,0.004899272505810983,0.006122919782282507,0.006393581643395573,0.006349756390108695,0.006369672573591253,0.006360337005932185,0.006359187390897596,0.006352698420318033,0.006349401735874268,0.00634767496329869,0.006343862860628029,0.006347906348812324];

export const dataset1_grad_itr5 = [1.5144340974753176e-06,9.98623781808058e-07,0.0031577393831459153,0.005061218938242682,0.004088396095578318,0.0021499604674392624,0.0026482663745266036,0.001971414710962767,0.0018830960456802438,0.0018279637912699143,0.0014385091502240265,0.0013439750309697793,0.0013438344397279844,0.0008525496128608723,0.0011220453171382038,0.0020086901198064773,0.00100716206160765];

export const dataset1_grad_itr10 = [8.036794401625943e-07,7.820321375366071e-07,0.0018515422991776393,0.004298181761080732,0.0035385517579765518,0.003945808544185436,0.0030488802510688943,0.001565701486567691,0.0012277071610345288,0.0013307186986047921,0.0013633486343378935,0.0016012714501875758,0.0016354788177199984,0.000829418323648112,0.000801617429061353,0.0007702258043064395,0.0005741106029424205,0.0005286651268598848,0.0006379480623268611,0.000898286885506812,0.0006319386567181165,0.0005517356606300774,0.0005078184057592943,0.0012556609403741679,0.0004630972505627248,0.0004613385733499544,0.000503894065197232,0.0004911438674117922,0.0007548578688193659,0.00047204498050520385,0.0006290322734379431,0.0006806900750660256,0.0007241023355221433,0.0005186328292766389,0.0005165011286799593];

export const dataset2_grad = [9.662200654119591e-07,5.858871248583811e-07,0.0011876642268235122,0.0038714420694384052,0.003445668472176977,0.003390757596856348,0.0037617539097896486,0.0027938566033320887,0.0021066584789909185,0.0016864326352377416,0.0013575056985886042,0.0011737473493764479,0.0010716826162228757,0.000997334292119502,0.0009559333618737232,0.0010089326771612437,0.0010373179773978912,0.0010540184503111778,0.0009140787595003076,0.0006650921437882902,0.0006121812148615689,0.0004585117742943218,0.00038561533651888845,0.00036155065035957206,0.0003917825668983703,0.0004235355599146107,0.0004556683423187763,0.0005117751960625422,0.0005543991954097808,0.0004822624346628985,0.00042725790410695587,0.00039227811759189865,0.00037472339691166373,0.00035504478786810783,0.0004329578959267849,0.00042122300283654895,0.00042148360464847983,0.0004089917413409834,0.00043890362898559097,0.00037377377743647537,0.00037484293992374426,0.00036792431015968125,0.00036845193324310156,0.00038607834660231774,0.0003905139905155766,0.00040161914698990563,0.00040473344297277115,0.0003999206146339074,0.0003988614746633862,0.00038427180355812926,0.00036818068871268873,0.0004011756544838016,0.000365030627830722,0.00036403073857820407,0.0003721825435737917,0.00038362934404211004,0.00038970839361531396,0.00040626628910779073,0.0004264440419098961,0.0004233284390119394,0.000421451380706456,0.00042401876033323975,0.0003856812529907271,0.00034418832307078133,0.0003805518079469808];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`bh9_2_126_step3_TS_Opt_Inputs`内に保存された`bh9_2_126_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`bh9_2_126_ts_guess_1.xyz`
```
55
0 1
C       6.021763998754      0.093285454698      1.364603296397
C       5.192394089325     -0.839220107805      0.488309144830
C       3.841293759757     -0.217913801578      0.210213657543
C       2.775788605582     -1.089626394131     -0.448771775733
C       1.477585612476     -0.266251150335     -0.628991222450
C       0.282237458222     -0.670529591084      0.122306361859
C      -0.898058310046      0.093166464767     -0.276805603924
C      -2.270892232182     -0.412849478331      0.182804834273
C      -3.079259428318      0.606324663556      1.019584461222
C      -3.038428054811      1.978017249058      0.401157584805
C      -1.869055781829      2.477704096971      0.020152531712
C      -0.621561733228      1.684461194559      0.234606459318
C       0.572080997781      2.118400470587     -0.462047046709
C       1.746288697898      1.304960933210     -0.212879490138
C       3.013077953960      1.712975380671     -0.914151809740
C       3.234854691838     -1.692766003333     -1.773592380084
C      -3.035919029098     -0.926187523680     -1.049947515381
C      -4.410943853746     -1.455907074951     -0.661320955378
C      -5.235499118053     -0.426347900165      0.101541839445
C      -4.484594736978      0.079672866192      1.321567245555
C       0.435844289429     -1.096588983397      1.546195775284
O       3.116331023090      2.611386546797     -1.700226448444
O       4.081250255992      0.938806519585     -0.618930001282
O      -3.119528179942      0.030885266521     -2.095627514714
O      -5.538232096119      0.713973801579     -0.715210567356
H       6.159979522047      1.052832583515      0.867423513589
H       7.002351487407     -0.320330228688      1.591282551298
H       5.508813949417      0.280416260050      2.311105874246
H       5.707161845123     -1.046300728667     -0.450778227130
H       5.028319401093     -1.796364311152      0.991431458201
H       3.452853083552      0.123210582405      1.175456846035
H       2.575485399620     -1.913538048375      0.239024295883
H      -2.131213286631     -1.290838556518      0.821019932145
H      -2.559067102210      0.682888899762      1.984347902028
H      -3.959577839255      2.534847769789      0.282394646759
H      -1.789319346141      3.460374575833     -0.430718497387
H       3.465436937920     -0.919001445333     -2.507572882135
H       2.452680631584     -2.331457400218     -2.187496214475
H       4.125131877870     -2.307183136960     -1.638671742318
H      -2.446484078572     -1.744223773100     -1.472727815755
H      -4.290839148228     -2.339713262174     -0.027206153272
H      -4.938462131856     -1.775601981942     -1.564195379070
H      -6.173744434940     -0.885542176856      0.431826486903
H      -4.405023355123     -0.755652863541      2.023385658865
H      -5.078033104063      0.854328491998      1.811852552105
H      -0.483560984344     -1.502239655561      1.967387924840
H       0.713199609765     -0.237303991837      2.180523359085
H       1.215633959441     -1.845225954272      1.683944799713
H      -3.649521741433      0.772530625901     -1.775169859818
H      -5.994074152676      0.407099428154     -1.506439948354
H       1.932646162479      1.236935361785      0.861204743465
H       0.504170924482      2.692041698420     -1.378252214238
H       1.236416138333     -0.211638032180     -1.693350720465
H      -0.928192109206      0.207949707372     -1.358513953417
H      -0.441986995207      1.566866662430      1.312940201767
```

<MoleculeViewer 
  xyzData={`55
0 1
C       6.021763998754      0.093285454698      1.364603296397
C       5.192394089325     -0.839220107805      0.488309144830
C       3.841293759757     -0.217913801578      0.210213657543
C       2.775788605582     -1.089626394131     -0.448771775733
C       1.477585612476     -0.266251150335     -0.628991222450
C       0.282237458222     -0.670529591084      0.122306361859
C      -0.898058310046      0.093166464767     -0.276805603924
C      -2.270892232182     -0.412849478331      0.182804834273
C      -3.079259428318      0.606324663556      1.019584461222
C      -3.038428054811      1.978017249058      0.401157584805
C      -1.869055781829      2.477704096971      0.020152531712
C      -0.621561733228      1.684461194559      0.234606459318
C       0.572080997781      2.118400470587     -0.462047046709
C       1.746288697898      1.304960933210     -0.212879490138
C       3.013077953960      1.712975380671     -0.914151809740
C       3.234854691838     -1.692766003333     -1.773592380084
C      -3.035919029098     -0.926187523680     -1.049947515381
C      -4.410943853746     -1.455907074951     -0.661320955378
C      -5.235499118053     -0.426347900165      0.101541839445
C      -4.484594736978      0.079672866192      1.321567245555
C       0.435844289429     -1.096588983397      1.546195775284
O       3.116331023090      2.611386546797     -1.700226448444
O       4.081250255992      0.938806519585     -0.618930001282
O      -3.119528179942      0.030885266521     -2.095627514714
O      -5.538232096119      0.713973801579     -0.715210567356
H       6.159979522047      1.052832583515      0.867423513589
H       7.002351487407     -0.320330228688      1.591282551298
H       5.508813949417      0.280416260050      2.311105874246
H       5.707161845123     -1.046300728667     -0.450778227130
H       5.028319401093     -1.796364311152      0.991431458201
H       3.452853083552      0.123210582405      1.175456846035
H       2.575485399620     -1.913538048375      0.239024295883
H      -2.131213286631     -1.290838556518      0.821019932145
H      -2.559067102210      0.682888899762      1.984347902028
H      -3.959577839255      2.534847769789      0.282394646759
H      -1.789319346141      3.460374575833     -0.430718497387
H       3.465436937920     -0.919001445333     -2.507572882135
H       2.452680631584     -2.331457400218     -2.187496214475
H       4.125131877870     -2.307183136960     -1.638671742318
H      -2.446484078572     -1.744223773100     -1.472727815755
H      -4.290839148228     -2.339713262174     -0.027206153272
H      -4.938462131856     -1.775601981942     -1.564195379070
H      -6.173744434940     -0.885542176856      0.431826486903
H      -4.405023355123     -0.755652863541      2.023385658865
H      -5.078033104063      0.854328491998      1.811852552105
H      -0.483560984344     -1.502239655561      1.967387924840
H       0.713199609765     -0.237303991837      2.180523359085
H       1.215633959441     -1.845225954272      1.683944799713
H      -3.649521741433      0.772530625901     -1.775169859818
H      -5.994074152676      0.407099428154     -1.506439948354
H       1.932646162479      1.236935361785      0.861204743465
H       0.504170924482      2.692041698420     -1.378252214238
H       1.236416138333     -0.211638032180     -1.693350720465
H      -0.928192109206      0.207949707372     -1.358513953417
H      -0.441986995207      1.566866662430      1.312940201767`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`bh9_2_126_ts_guess_2.xyz`
```
55
0 1
C       6.353611743055     -0.078652714645      0.961690969936
C       5.281218569462     -0.875790431992      0.230186853669
C       3.930741549307     -0.186866173412      0.250012234761
C       2.768478630627     -1.019438363929     -0.293417241197
C       1.495369848104     -0.154773118081     -0.430151705622
C       0.265787261316     -0.614137253312      0.266524685513
C      -0.922385721470      0.143034457907     -0.180869661554
C      -2.308299750064     -0.390260165187      0.224744965739
C      -3.195609568272      0.668957564961      0.925569891741
C      -3.115811586052      1.994397639760      0.216608418665
C      -1.913838906265      2.481527294028     -0.067100381050
C      -0.705758682985      1.687118104050      0.321203102392
C       0.574548125340      2.178184687027     -0.192372086734
C       1.762419006177      1.354979377218      0.059952923872
C       3.014946249425      1.842708841295     -0.632565852233
C       3.086429703719     -1.683281505887     -1.631422172537
C      -2.989796350862     -1.021102032775     -1.004512677293
C      -4.380871079268     -1.545089322434     -0.658665141960
C      -5.273787831118     -0.472729234655     -0.045582957857
C      -4.613514927194      0.149009258734      1.172026198850
C       0.353324070704     -1.060831010596      1.687297439614
O       3.102789931696      2.851866397176     -1.273138906548
O       4.081585486568      1.021806955346     -0.523233515815
O      -3.028679085583     -0.155163169560     -2.129304241617
O      -5.541376868231      0.587839577580     -0.975166054736
H       6.472712809073      0.906993877856      0.513136218116
H       7.316009324856     -0.588442307246      0.920284174641
H       6.092502338029      0.057563389405      2.013302240276
H       5.577384791308     -1.036226766343     -0.807947486657
H       5.161874681220     -1.862888104086      0.686269986150
H       3.707917946821      0.101700679279      1.284132344966
H       2.591100216144     -1.807216540667      0.442194265663
H      -2.186402203129     -1.209783856957      0.939853379894
H      -2.746958484997      0.822865684138      1.916060374416
H      -4.025832678750      2.522268168952     -0.040797547435
H      -1.781563325359      3.426546266487     -0.581449440677
H       3.395737934658     -0.940033056037     -2.369460730587
H       2.196628006083     -2.186527032643     -2.012269468023
H       3.878218520694     -2.426377579566     -1.540844836528
H      -2.366770011625     -1.860905634602     -1.324047887568
H      -4.292275147875     -2.367000442467      0.058558545135
H      -4.842002396946     -1.954104308145     -1.561917404001
H      -6.224794967140     -0.922123244445      0.261059755548
H      -4.577437695772     -0.620468078686      1.948564970646
H      -5.244979729227      0.955515146426      1.550918820600
H      -0.513965848833     -1.639639642402      1.999548412122
H       0.404382939976     -0.197163345636      2.368629548307
H       1.234945293176     -1.666118197439      1.887429197319
H      -3.615864696805      0.581462947091     -1.913423342329
H      -5.968151737614      0.209727140230     -1.751593003050
H       1.975709034056      1.283726259900      1.134526502636
H       0.618783524291      2.941541234122     -0.956646183326
H       1.267919574068     -0.058733793122     -1.493824903650
H      -0.912330257696      0.230309381660     -1.267510004427
H      -0.674017570823      1.600216096325      1.418948413820
```

<MoleculeViewer 
  xyzData={`55
0 1
C       6.353611743055     -0.078652714645      0.961690969936
C       5.281218569462     -0.875790431992      0.230186853669
C       3.930741549307     -0.186866173412      0.250012234761
C       2.768478630627     -1.019438363929     -0.293417241197
C       1.495369848104     -0.154773118081     -0.430151705622
C       0.265787261316     -0.614137253312      0.266524685513
C      -0.922385721470      0.143034457907     -0.180869661554
C      -2.308299750064     -0.390260165187      0.224744965739
C      -3.195609568272      0.668957564961      0.925569891741
C      -3.115811586052      1.994397639760      0.216608418665
C      -1.913838906265      2.481527294028     -0.067100381050
C      -0.705758682985      1.687118104050      0.321203102392
C       0.574548125340      2.178184687027     -0.192372086734
C       1.762419006177      1.354979377218      0.059952923872
C       3.014946249425      1.842708841295     -0.632565852233
C       3.086429703719     -1.683281505887     -1.631422172537
C      -2.989796350862     -1.021102032775     -1.004512677293
C      -4.380871079268     -1.545089322434     -0.658665141960
C      -5.273787831118     -0.472729234655     -0.045582957857
C      -4.613514927194      0.149009258734      1.172026198850
C       0.353324070704     -1.060831010596      1.687297439614
O       3.102789931696      2.851866397176     -1.273138906548
O       4.081585486568      1.021806955346     -0.523233515815
O      -3.028679085583     -0.155163169560     -2.129304241617
O      -5.541376868231      0.587839577580     -0.975166054736
H       6.472712809073      0.906993877856      0.513136218116
H       7.316009324856     -0.588442307246      0.920284174641
H       6.092502338029      0.057563389405      2.013302240276
H       5.577384791308     -1.036226766343     -0.807947486657
H       5.161874681220     -1.862888104086      0.686269986150
H       3.707917946821      0.101700679279      1.284132344966
H       2.591100216144     -1.807216540667      0.442194265663
H      -2.186402203129     -1.209783856957      0.939853379894
H      -2.746958484997      0.822865684138      1.916060374416
H      -4.025832678750      2.522268168952     -0.040797547435
H      -1.781563325359      3.426546266487     -0.581449440677
H       3.395737934658     -0.940033056037     -2.369460730587
H       2.196628006083     -2.186527032643     -2.012269468023
H       3.878218520694     -2.426377579566     -1.540844836528
H      -2.366770011625     -1.860905634602     -1.324047887568
H      -4.292275147875     -2.367000442467      0.058558545135
H      -4.842002396946     -1.954104308145     -1.561917404001
H      -6.224794967140     -0.922123244445      0.261059755548
H      -4.577437695772     -0.620468078686      1.948564970646
H      -5.244979729227      0.955515146426      1.550918820600
H      -0.513965848833     -1.639639642402      1.999548412122
H       0.404382939976     -0.197163345636      2.368629548307
H       1.234945293176     -1.666118197439      1.887429197319
H      -3.615864696805      0.581462947091     -1.913423342329
H      -5.968151737614      0.209727140230     -1.751593003050
H       1.975709034056      1.283726259900      1.134526502636
H       0.618783524291      2.941541234122     -0.956646183326
H       1.267919574068     -0.058733793122     -1.493824903650
H      -0.912330257696      0.230309381660     -1.267510004427
H      -0.674017570823      1.600216096325      1.418948413820`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`bh9_2_126_ts_guess_3.xyz`
```
55
0 1
C       6.339759857310     -0.097253503272      0.988744013116
C       5.272062528099     -0.885242009666      0.240557726403
C       3.923667270046     -0.192219022251      0.251827455763
C       2.766050583847     -1.016410412289     -0.313495601113
C       1.493389015399     -0.150953948389     -0.442473352897
C       0.265915387107     -0.609105561125      0.250289106632
C      -0.921510498590      0.151831556071     -0.189388431356
C      -2.303297911827     -0.380868064526      0.231056989507
C      -3.190567900458      0.684561206261      0.922548715215
C      -3.111384452409      2.003962505082      0.202293288169
C      -1.908900347944      2.489817510743     -0.081929268830
C      -0.701096438883      1.696246207350      0.312819763413
C       0.579775411233      2.185109654837     -0.199633169103
C       1.763862415377      1.359861438566      0.060603330246
C       3.022482657364      1.847068032330     -0.623517824893
C       3.095551237082     -1.658543307253     -1.659467757914
C      -2.987437036639     -1.030512489045     -0.986740199167
C      -4.375210701620     -1.554488554413     -0.628718442538
C      -5.269121435743     -0.475445892149     -0.028712538985
C      -4.607189396722      0.165210054521      1.178213527480
C       0.346732978915     -1.074963409589      1.666284031521
O       3.117097703102      2.855754390875     -1.263909201174
O       4.086172048193      1.022969812613     -0.508511108482
O      -3.034142896788     -0.178959667151     -2.122313874370
O      -5.541645746831      0.571080492249     -0.972895307234
H       6.467930675932      0.890581658865      0.547382362551
H       7.300393907180     -0.610953244643      0.954528975238
H       6.067850222307      0.033651064320      2.038353273888
H       5.578277473923     -1.038927192480     -0.795706153269
H       5.144327656382     -1.875368848474      0.688011033828
H       3.689699210169      0.086566763679      1.286282820164
H       2.582674202373     -1.816818384724      0.406937933149
H      -2.174533069836     -1.188964662510      0.957914923433
H      -2.740347476055      0.848153343991      1.910720699148
H      -4.021388833751      2.528994057750     -0.060982113680
H      -1.776084014619      3.431072481082     -0.603262208524
H       3.409857801998     -0.903913826175     -2.383794024720
H       2.210140269956     -2.158232988303     -2.054996767678
H       3.888095034272     -2.401493691880     -1.573196468725
H      -2.362487519527     -1.872092440944     -1.297900109507
H      -4.281427247831     -2.365274892094      0.100484501124
H      -4.837753597392     -1.978353369814     -1.524398395749
H      -6.218250301356     -0.922644076742      0.286760424971
H      -4.567767697754     -0.593408226929      1.965262822927
H      -5.239517998945      0.975495049582      1.547506443599
H      -0.453093755248     -1.771788534556      1.924333470811
H       0.250740659820     -0.226002314461      2.365154251475
H       1.292432383129     -1.566000389553      1.894679349722
H      -3.627155551739      0.555498974071     -1.914887174313
H      -5.972492587219      0.181308177427     -1.741300248608
H       1.968477582243      1.279701082825      1.135950904553
H       0.625096460719      2.941643073759     -0.971391387920
H       1.267567207133     -0.040793242758     -1.506010486210
H      -0.921084019157      0.238965577416     -1.276026782036
H      -0.671191405727      1.610892001891      1.410056260946
```

<MoleculeViewer 
  xyzData={`55
0 1
C       6.339759857310     -0.097253503272      0.988744013116
C       5.272062528099     -0.885242009666      0.240557726403
C       3.923667270046     -0.192219022251      0.251827455763
C       2.766050583847     -1.016410412289     -0.313495601113
C       1.493389015399     -0.150953948389     -0.442473352897
C       0.265915387107     -0.609105561125      0.250289106632
C      -0.921510498590      0.151831556071     -0.189388431356
C      -2.303297911827     -0.380868064526      0.231056989507
C      -3.190567900458      0.684561206261      0.922548715215
C      -3.111384452409      2.003962505082      0.202293288169
C      -1.908900347944      2.489817510743     -0.081929268830
C      -0.701096438883      1.696246207350      0.312819763413
C       0.579775411233      2.185109654837     -0.199633169103
C       1.763862415377      1.359861438566      0.060603330246
C       3.022482657364      1.847068032330     -0.623517824893
C       3.095551237082     -1.658543307253     -1.659467757914
C      -2.987437036639     -1.030512489045     -0.986740199167
C      -4.375210701620     -1.554488554413     -0.628718442538
C      -5.269121435743     -0.475445892149     -0.028712538985
C      -4.607189396722      0.165210054521      1.178213527480
C       0.346732978915     -1.074963409589      1.666284031521
O       3.117097703102      2.855754390875     -1.263909201174
O       4.086172048193      1.022969812613     -0.508511108482
O      -3.034142896788     -0.178959667151     -2.122313874370
O      -5.541645746831      0.571080492249     -0.972895307234
H       6.467930675932      0.890581658865      0.547382362551
H       7.300393907180     -0.610953244643      0.954528975238
H       6.067850222307      0.033651064320      2.038353273888
H       5.578277473923     -1.038927192480     -0.795706153269
H       5.144327656382     -1.875368848474      0.688011033828
H       3.689699210169      0.086566763679      1.286282820164
H       2.582674202373     -1.816818384724      0.406937933149
H      -2.174533069836     -1.188964662510      0.957914923433
H      -2.740347476055      0.848153343991      1.910720699148
H      -4.021388833751      2.528994057750     -0.060982113680
H      -1.776084014619      3.431072481082     -0.603262208524
H       3.409857801998     -0.903913826175     -2.383794024720
H       2.210140269956     -2.158232988303     -2.054996767678
H       3.888095034272     -2.401493691880     -1.573196468725
H      -2.362487519527     -1.872092440944     -1.297900109507
H      -4.281427247831     -2.365274892094      0.100484501124
H      -4.837753597392     -1.978353369814     -1.524398395749
H      -6.218250301356     -0.922644076742      0.286760424971
H      -4.567767697754     -0.593408226929      1.965262822927
H      -5.239517998945      0.975495049582      1.547506443599
H      -0.453093755248     -1.771788534556      1.924333470811
H       0.250740659820     -0.226002314461      2.365154251475
H       1.292432383129     -1.566000389553      1.894679349722
H      -3.627155551739      0.555498974071     -1.914887174313
H      -5.972492587219      0.181308177427     -1.741300248608
H       1.968477582243      1.279701082825      1.135950904553
H       0.625096460719      2.941643073759     -0.971391387920
H       1.267567207133     -0.040793242758     -1.506010486210
H      -0.921084019157      0.238965577416     -1.276026782036
H      -0.671191405727      1.610892001891      1.410056260946`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-v1.19.6b/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`bh9_2_126_ts_final_X.xyz`として保存されている。)

`bh9_2_126_ts_final_1.xyz`
```
55
OptimizedStructure
C      6.042125794390     -0.025094991774      1.437613758868
C      5.153225003510     -0.837631675555      0.504999404365
C      3.801435879440     -0.184236095108      0.283199777336
C      2.788608461064     -1.062669252680     -0.467041330167
C      1.455792662172     -0.365425019139     -0.688837403279
C      0.292550069920     -0.638511429394      0.027036692110
C     -0.895576422754     -0.041992656002     -0.403899532095
C     -2.249206801674     -0.441187736699      0.145439825382
C     -3.019404283353      0.675576808826      0.913014046386
C     -3.022700540307      1.974247608801      0.159992345681
C     -1.868049047147      2.550003493005     -0.171146128665
C     -0.591676009543      1.957966876607      0.237202961941
C      0.611435393174      2.269166715092     -0.383605733782
C      1.777030478572      1.636852398736      0.005987062384
C      3.042300135314      1.875315824022     -0.726516610779
C      3.335384308967     -1.547846253558     -1.810264523005
C     -3.088258804148     -1.049746742453     -0.995874520407
C     -4.441418813584     -1.536823207675     -0.484126638422
C     -5.227920868235     -0.442130536691      0.226345844484
C     -4.405780118412      0.184872962380      1.339853448509
C      0.369613303676     -1.257470865322      1.402445656362
O      3.209135489271      2.735059911985     -1.549217118925
O      4.061151107007      1.023550188907     -0.449982796339
O     -3.229767594333     -0.174164827790     -2.103663185549
O     -5.602706728665      0.605518507607     -0.682207849561
H      6.215189088579      0.970963950582      1.031263691074
H      7.009689931321     -0.507449909097      1.575947329601
H      5.580629301029      0.086326054960      2.421360229508
H      5.645461995893     -0.965530101993     -0.460292580480
H      4.982159806805     -1.836941216924      0.915950006314
H      3.387484272914      0.072353123015      1.264503183329
H      2.622230182916     -1.934745919598      0.171880433853
H     -2.106438076208     -1.251453978830      0.868198372688
H     -2.451052938607      0.837696725826      1.837755963619
H     -3.968306834202      2.405989489154     -0.142377912607
H     -1.846293600078      3.446257501498     -0.781394330717
H      3.619742124588     -0.701505313032     -2.438487248930
H      2.572672087106     -2.121366593922     -2.337906622113
H      4.208075922880     -2.187643746473     -1.684228087429
H     -2.532739623866     -1.905858320859     -1.387555713598
H     -4.286085582090     -2.360735919533      0.219155335063
H     -5.018388521223     -1.934798434109     -1.323675620299
H     -6.136767668276     -0.870400315961      0.663232201096
H     -4.286053180263     -0.576252036773      2.116538471640
H     -4.970990160993      1.007248103092      1.783267712863
H     -0.283423265415     -0.734958113514      2.105535533457
H      1.379714113097     -1.218881811887      1.810139807526
H      0.062025042850     -2.306786999851      1.395884261320
H     -3.826707776672      0.538537944786     -1.839746349647
H     -6.170672718008      0.227351451287     -1.362122119041
H      1.860218503756      1.307596768473      1.033575636984
H      0.606564591717      2.785239787399     -1.338487985670
H      1.303354124692     -0.033086144954     -1.711163125744
H     -0.931491401337      0.254630775257     -1.444620842317
H     -0.537121797225      1.625003195851      1.271122915823
```

<MoleculeViewer 
  xyzData={`55
OptimizedStructure
C      6.042125794390     -0.025094991774      1.437613758868
C      5.153225003510     -0.837631675555      0.504999404365
C      3.801435879440     -0.184236095108      0.283199777336
C      2.788608461064     -1.062669252680     -0.467041330167
C      1.455792662172     -0.365425019139     -0.688837403279
C      0.292550069920     -0.638511429394      0.027036692110
C     -0.895576422754     -0.041992656002     -0.403899532095
C     -2.249206801674     -0.441187736699      0.145439825382
C     -3.019404283353      0.675576808826      0.913014046386
C     -3.022700540307      1.974247608801      0.159992345681
C     -1.868049047147      2.550003493005     -0.171146128665
C     -0.591676009543      1.957966876607      0.237202961941
C      0.611435393174      2.269166715092     -0.383605733782
C      1.777030478572      1.636852398736      0.005987062384
C      3.042300135314      1.875315824022     -0.726516610779
C      3.335384308967     -1.547846253558     -1.810264523005
C     -3.088258804148     -1.049746742453     -0.995874520407
C     -4.441418813584     -1.536823207675     -0.484126638422
C     -5.227920868235     -0.442130536691      0.226345844484
C     -4.405780118412      0.184872962380      1.339853448509
C      0.369613303676     -1.257470865322      1.402445656362
O      3.209135489271      2.735059911985     -1.549217118925
O      4.061151107007      1.023550188907     -0.449982796339
O     -3.229767594333     -0.174164827790     -2.103663185549
O     -5.602706728665      0.605518507607     -0.682207849561
H      6.215189088579      0.970963950582      1.031263691074
H      7.009689931321     -0.507449909097      1.575947329601
H      5.580629301029      0.086326054960      2.421360229508
H      5.645461995893     -0.965530101993     -0.460292580480
H      4.982159806805     -1.836941216924      0.915950006314
H      3.387484272914      0.072353123015      1.264503183329
H      2.622230182916     -1.934745919598      0.171880433853
H     -2.106438076208     -1.251453978830      0.868198372688
H     -2.451052938607      0.837696725826      1.837755963619
H     -3.968306834202      2.405989489154     -0.142377912607
H     -1.846293600078      3.446257501498     -0.781394330717
H      3.619742124588     -0.701505313032     -2.438487248930
H      2.572672087106     -2.121366593922     -2.337906622113
H      4.208075922880     -2.187643746473     -1.684228087429
H     -2.532739623866     -1.905858320859     -1.387555713598
H     -4.286085582090     -2.360735919533      0.219155335063
H     -5.018388521223     -1.934798434109     -1.323675620299
H     -6.136767668276     -0.870400315961      0.663232201096
H     -4.286053180263     -0.576252036773      2.116538471640
H     -4.970990160993      1.007248103092      1.783267712863
H     -0.283423265415     -0.734958113514      2.105535533457
H      1.379714113097     -1.218881811887      1.810139807526
H      0.062025042850     -2.306786999851      1.395884261320
H     -3.826707776672      0.538537944786     -1.839746349647
H     -6.170672718008      0.227351451287     -1.362122119041
H      1.860218503756      1.307596768473      1.033575636984
H      0.606564591717      2.785239787399     -1.338487985670
H      1.303354124692     -0.033086144954     -1.711163125744
H     -0.931491401337      0.254630775257     -1.444620842317
H     -0.537121797225      1.625003195851      1.271122915823`}
  caption="遷移状態構造 (No.1)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -531.6197             30.6806             42.9869
Reduced mass [au]                   9.9442              3.5766              4.5041
Force const [Dyne/A]               -1.6558              0.0020              0.0049
Char temp [K]                       0.0000             44.1425             61.8486
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                -0.00191    0.00065   -0.00055   -0.05742   -0.06413    0.08033   -0.04775    0.03311    0.08731
       C                -0.00414    0.00221   -0.00032   -0.02928   -0.02744    0.02158   -0.01160    0.01955    0.06432
       C                -0.00851    0.00140   -0.00128   -0.01901   -0.01383   -0.00064   -0.00835    0.01016    0.01830
       C                 0.00349   -0.02029    0.00082   -0.00004    0.01338   -0.05776    0.01228   -0.00175    0.00402
       C                -0.03610   -0.13646   -0.03064   -0.00495    0.01054   -0.03719    0.01101   -0.01114   -0.02229
       C                 0.03369   -0.00497   -0.00425    0.00285    0.00530   -0.02656    0.00540   -0.00758   -0.03009
       C                 0.00577    0.13347    0.03159   -0.00296    0.00435   -0.01254    0.00554   -0.01250   -0.03772
       C                 0.00711    0.02107   -0.00349    0.00571    0.00902    0.01173    0.00590   -0.01372   -0.03702
       C                -0.00868    0.00468    0.00198    0.00717    0.02478   -0.00890    0.02771   -0.03099    0.00943
       C                -0.01075    0.00403    0.00457    0.00185    0.00836   -0.03707    0.00507   -0.01642    0.03426
       C                -0.00267   -0.01764    0.00132    0.00139    0.00436   -0.04647   -0.00560   -0.01028    0.00741
       C                -0.03439   -0.12942   -0.03000    0.00018    0.01150   -0.03354    0.00483   -0.01071   -0.02887
       C                 0.02310   -0.00953   -0.00174    0.00512    0.00783   -0.02593   -0.00376   -0.00686   -0.04322
       C                 0.00781    0.12960    0.04535   -0.00130    0.00417   -0.01330   -0.00211   -0.00088   -0.03947
       C                 0.00101    0.01685    0.00308    0.01495    0.00680    0.01681    0.00215   -0.01343   -0.03376
       C                 0.00813   -0.00505   -0.00241    0.02412    0.08844   -0.07481    0.04320   -0.00350    0.01748
       C                 0.00867    0.00654    0.00065   -0.00277   -0.02511    0.03611   -0.01983    0.03214   -0.04182
       C                 0.00664    0.00142    0.00130    0.00422   -0.01763    0.06188   -0.01006    0.01840   -0.02827
       C                 0.00041   -0.00083   -0.00081    0.00534   -0.00110    0.03774    0.00963   -0.00799    0.03448
       C                -0.00373   -0.00082    0.00133    0.01167    0.03217    0.01391    0.04009   -0.04476    0.03304
       C                 0.00279   -0.00117   -0.00156    0.01577   -0.00010   -0.02996   -0.00222   -0.00263   -0.02711
       O                 0.00649    0.00189   -0.01007    0.03663    0.01167    0.02633    0.00654   -0.03771   -0.05820
       O                -0.00800    0.00163   -0.00129    0.00823    0.00598    0.04131    0.00395    0.00097    0.00704
       O                 0.00012    0.00015   -0.00206   -0.01803   -0.05435    0.01498   -0.03959    0.07198   -0.00775
       O                -0.00001   -0.00044    0.00000   -0.00519   -0.02701    0.01203   -0.01908    0.02354    0.08325
       H                -0.00074    0.00080    0.00017   -0.04022   -0.05007    0.12198   -0.04282    0.03183    0.08613
       H                -0.00235   -0.00098   -0.00259   -0.06374   -0.07241    0.09558   -0.04821    0.04221    0.12210
       H                -0.00008    0.00038    0.00034   -0.09016   -0.09789    0.06880   -0.08067    0.03604    0.07155
       H                -0.00473    0.00323   -0.00072    0.00256    0.00378    0.03368    0.01989    0.01490    0.08098
       H                -0.00326    0.00184   -0.00109   -0.04763   -0.04080   -0.01862   -0.01841    0.02191    0.06721
       H                -0.00796    0.00049   -0.00081   -0.04782   -0.04060   -0.00576   -0.03325    0.02113    0.00471
       H                 0.04019   -0.02511    0.00433    0.00068   -0.02104   -0.10439    0.00647    0.00013    0.00507
       H                 0.03132    0.02315   -0.00654    0.01796    0.02907    0.03159    0.00625   -0.03853   -0.06476
       H                -0.00524    0.00331    0.00045    0.01283    0.04646   -0.01637    0.05199   -0.05057   -0.00194
       H                -0.00984    0.02000    0.02544    0.00071   -0.00078   -0.04670   -0.00424   -0.01286    0.06874
       H                 0.02415   -0.00778    0.01679    0.00186   -0.00760   -0.06400   -0.02466   -0.00179    0.01929
       H                -0.00355    0.00242    0.00217    0.01469    0.12375   -0.03138    0.04389   -0.00416    0.01701
       H                 0.01185   -0.00853   -0.00338    0.04152    0.09818   -0.11052    0.06100   -0.01762    0.00709
       H                 0.01524    0.00380   -0.00991    0.03559    0.09998   -0.09571    0.04965    0.00936    0.03860
       H                 0.01039    0.00621    0.00249   -0.00269   -0.03278    0.05298   -0.03240    0.04363   -0.08478
       H                 0.00566    0.00178    0.00204    0.01439    0.00314    0.08396    0.00422   -0.01030   -0.06502
       H                 0.01089   -0.00051   -0.00069   -0.00118   -0.04422    0.07821   -0.03217    0.05359   -0.02980
       H                 0.00057   -0.00423   -0.00380    0.01013    0.00771    0.05627    0.02335   -0.02573    0.04578
       H                -0.00155   -0.00241   -0.00049    0.01974    0.05389    0.03395    0.06277   -0.07004    0.00481
       H                -0.00700   -0.00413    0.00311    0.01255    0.04261   -0.00433    0.05156   -0.05976    0.07546
       H                 0.00765    0.01855   -0.01118    0.07970    0.04630   -0.00402   -0.03178   -0.02252   -0.04025
       H                 0.00010   -0.02334    0.00658    0.03388   -0.07291   -0.06951   -0.01111    0.02978   -0.00785
       H                -0.02545    0.00683    0.00121   -0.06066    0.02233   -0.01807    0.03159   -0.01258   -0.03172
       H                 0.00335    0.00228   -0.00016   -0.02336   -0.05363    0.00120   -0.02525    0.06935    0.03110
       H                 0.00162   -0.00057   -0.00127   -0.01224   -0.04654    0.02877   -0.03183    0.04521    0.08189
       H                -0.03850   -0.04846   -0.01283   -0.01937   -0.00349   -0.01412   -0.00701    0.00960   -0.03594
       H                 0.00840   -0.01629   -0.00581    0.01506    0.00759   -0.02611   -0.01150   -0.01174   -0.04569
       H                 0.00219    0.01657    0.01527   -0.01685    0.02181   -0.03166    0.02169   -0.02110   -0.02713
       H                -0.00616   -0.02526   -0.01590   -0.01851   -0.00130   -0.01353    0.00826   -0.01103   -0.03761
       H                -0.00834    0.05554    0.03185   -0.00560    0.01867   -0.03101    0.02479   -0.01761   -0.03207
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_2_126_ts_final_2.xyz`
```
55
OptimizedStructure
C      6.042051723374     -0.024203704867      1.437942960676
C      5.153180372743     -0.837389003869      0.505866467811
C      3.801417581570     -0.184121809965      0.283529082250
C      2.788607409505     -1.063070092480     -0.466132016449
C      1.455820169445     -0.365953159443     -0.688497907056
C      0.292533574101     -0.638498910611      0.027510475198
C     -0.895556199503     -0.042260988127     -0.403915527204
C     -2.249224947565     -0.441031099907      0.145637992164
C     -3.019436025244      0.676300155574      0.912373351704
C     -3.022662293346      1.974432255058      0.158423426444
C     -1.867979964253      2.549924340518     -0.173066983224
C     -0.591642100947      1.958149719318      0.235771250741
C      0.611508440035      2.268876585510     -0.385198575204
C      1.777068688397      1.636814347660      0.004906765403
C      3.042381210297      1.874722647364     -0.727703569489
C      3.335440366057     -1.549226937420     -1.808977824673
C     -3.088231503567     -1.050385535028     -0.995285270034
C     -4.441429884392     -1.537063783159     -0.483260761373
C     -5.227942913408     -0.441845046589      0.226388323676
C     -4.405845806505      0.185934283147      1.339490800415
C      0.369509237266     -1.256473972203      1.403366942009
O      3.209278346640      2.733872561652     -1.551012127989
O      4.061198128393      1.023131571527     -0.450507707162
O     -3.229660588939     -0.175591852496     -2.103706637057
O     -5.602656128462      0.605163569691     -0.682933241356
H      6.215157759859      0.971559906883      1.030888069212
H      7.009598130284     -0.506480686044      1.576671563129
H      5.580507516990      0.087932875825      2.421586146970
H      5.645464104156     -0.965991113740     -0.459308572272
H      4.982071570261     -1.836399751546      0.917524820269
H      3.387422303481      0.073181852262      1.264627040847
H      2.622175618765     -1.934682842282      0.173408692845
H     -2.106513245326     -1.250783980286      0.868983024276
H     -2.451128947672      0.839067455627      1.837028735800
H     -3.968242571408      2.405980337863     -0.144304315434
H     -1.846171999243      3.445740851119     -0.783954800769
H      3.619851393452     -0.703345488914     -2.437794961877
H      2.572740634898     -2.123108044504     -2.336246144964
H      4.208109545250     -2.188955397033     -1.682436181346
H     -2.532712038653     -1.906790000326     -1.386325260421
H     -4.286152866924     -2.360477824429      0.220617567597
H     -5.018365238413     -1.935624762902     -1.322555690298
H     -6.136823170820     -0.869780859200      0.663532787078
H     -4.286177467174     -0.574638576276      2.116725315890
H     -4.971059605225      1.008639546548      1.782287812035
H     -0.283550167027     -0.733438173742      2.106048585123
H      1.379591602092     -1.217620065891      1.811085386037
H      0.061891489051     -2.305787437607      1.397541820669
H     -3.826596793804      0.537314095452     -1.840330398375
H     -6.170595257433      0.226524288140     -1.362607420850
H      1.860197012746      1.308293960141      1.032735505069
H      0.606698429827      2.784264898304     -1.340450770510
H      1.303443276794     -0.034344169235     -1.711069564902
H     -0.931409200795      0.253617982392     -1.444850737032
H     -0.537148709680      1.625924982547      1.269932255983
```

<MoleculeViewer 
  xyzData={`55
OptimizedStructure
C      6.042051723374     -0.024203704867      1.437942960676
C      5.153180372743     -0.837389003869      0.505866467811
C      3.801417581570     -0.184121809965      0.283529082250
C      2.788607409505     -1.063070092480     -0.466132016449
C      1.455820169445     -0.365953159443     -0.688497907056
C      0.292533574101     -0.638498910611      0.027510475198
C     -0.895556199503     -0.042260988127     -0.403915527204
C     -2.249224947565     -0.441031099907      0.145637992164
C     -3.019436025244      0.676300155574      0.912373351704
C     -3.022662293346      1.974432255058      0.158423426444
C     -1.867979964253      2.549924340518     -0.173066983224
C     -0.591642100947      1.958149719318      0.235771250741
C      0.611508440035      2.268876585510     -0.385198575204
C      1.777068688397      1.636814347660      0.004906765403
C      3.042381210297      1.874722647364     -0.727703569489
C      3.335440366057     -1.549226937420     -1.808977824673
C     -3.088231503567     -1.050385535028     -0.995285270034
C     -4.441429884392     -1.537063783159     -0.483260761373
C     -5.227942913408     -0.441845046589      0.226388323676
C     -4.405845806505      0.185934283147      1.339490800415
C      0.369509237266     -1.256473972203      1.403366942009
O      3.209278346640      2.733872561652     -1.551012127989
O      4.061198128393      1.023131571527     -0.450507707162
O     -3.229660588939     -0.175591852496     -2.103706637057
O     -5.602656128462      0.605163569691     -0.682933241356
H      6.215157759859      0.971559906883      1.030888069212
H      7.009598130284     -0.506480686044      1.576671563129
H      5.580507516990      0.087932875825      2.421586146970
H      5.645464104156     -0.965991113740     -0.459308572272
H      4.982071570261     -1.836399751546      0.917524820269
H      3.387422303481      0.073181852262      1.264627040847
H      2.622175618765     -1.934682842282      0.173408692845
H     -2.106513245326     -1.250783980286      0.868983024276
H     -2.451128947672      0.839067455627      1.837028735800
H     -3.968242571408      2.405980337863     -0.144304315434
H     -1.846171999243      3.445740851119     -0.783954800769
H      3.619851393452     -0.703345488914     -2.437794961877
H      2.572740634898     -2.123108044504     -2.336246144964
H      4.208109545250     -2.188955397033     -1.682436181346
H     -2.532712038653     -1.906790000326     -1.386325260421
H     -4.286152866924     -2.360477824429      0.220617567597
H     -5.018365238413     -1.935624762902     -1.322555690298
H     -6.136823170820     -0.869780859200      0.663532787078
H     -4.286177467174     -0.574638576276      2.116725315890
H     -4.971059605225      1.008639546548      1.782287812035
H     -0.283550167027     -0.733438173742      2.106048585123
H      1.379591602092     -1.217620065891      1.811085386037
H      0.061891489051     -2.305787437607      1.397541820669
H     -3.826596793804      0.537314095452     -1.840330398375
H     -6.170595257433      0.226524288140     -1.362607420850
H      1.860197012746      1.308293960141      1.032735505069
H      0.606698429827      2.784264898304     -1.340450770510
H      1.303443276794     -0.034344169235     -1.711069564902
H     -0.931409200795      0.253617982392     -1.444850737032
H     -0.537148709680      1.625924982547      1.269932255983`}
  caption="遷移状態構造 (No.2)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -531.6315             30.6593             42.9691
Reduced mass [au]                   9.9441              3.5762              4.5042
Force const [Dyne/A]               -1.6559              0.0020              0.0049
Char temp [K]                       0.0000             44.1119             61.8230
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                -0.00191    0.00065   -0.00055   -0.05737   -0.06417    0.08029   -0.04785    0.03309    0.08742
       C                -0.00414    0.00221   -0.00033   -0.02927   -0.02745    0.02150   -0.01163    0.01958    0.06432
       C                -0.00851    0.00140   -0.00129   -0.01900   -0.01384   -0.00066   -0.00838    0.01016    0.01828
       C                 0.00349   -0.02028    0.00084   -0.00006    0.01335   -0.05776    0.01229   -0.00173    0.00394
       C                -0.03610   -0.13647   -0.03054   -0.00496    0.01054   -0.03717    0.01100   -0.01116   -0.02234
       C                 0.03369   -0.00498   -0.00424    0.00285    0.00530   -0.02653    0.00541   -0.00760   -0.03011
       C                 0.00577    0.13349    0.03150   -0.00296    0.00437   -0.01250    0.00554   -0.01253   -0.03771
       C                 0.00711    0.02107   -0.00351    0.00571    0.00905    0.01176    0.00591   -0.01375   -0.03697
       C                -0.00868    0.00468    0.00198    0.00714    0.02481   -0.00893    0.02772   -0.03096    0.00946
       C                -0.01075    0.00403    0.00456    0.00184    0.00835   -0.03712    0.00507   -0.01639    0.03424
       C                -0.00267   -0.01764    0.00134    0.00139    0.00435   -0.04648   -0.00561   -0.01027    0.00738
       C                -0.03439   -0.12945   -0.02991    0.00017    0.01151   -0.03350    0.00483   -0.01072   -0.02890
       C                 0.02310   -0.00953   -0.00173    0.00512    0.00784   -0.02586   -0.00376   -0.00689   -0.04325
       C                 0.00782    0.12963    0.04525   -0.00130    0.00418   -0.01325   -0.00212   -0.00092   -0.03950
       C                 0.00101    0.01685    0.00307    0.01493    0.00683    0.01684    0.00216   -0.01345   -0.03374
       C                 0.00813   -0.00505   -0.00241    0.02405    0.08836   -0.07487    0.04324   -0.00337    0.01738
       C                 0.00867    0.00654    0.00065   -0.00273   -0.02513    0.03618   -0.01982    0.03208   -0.04178
       C                 0.00664    0.00142    0.00130    0.00425   -0.01762    0.06193   -0.01005    0.01837   -0.02821
       C                 0.00042   -0.00083   -0.00080    0.00534   -0.00108    0.03770    0.00963   -0.00795    0.03451
       C                -0.00373   -0.00082    0.00133    0.01163    0.03223    0.01384    0.04009   -0.04469    0.03309
       C                 0.00279   -0.00117   -0.00156    0.01577   -0.00011   -0.02994   -0.00218   -0.00264   -0.02713
       O                 0.00649    0.00188   -0.01007    0.03660    0.01172    0.02637    0.00657   -0.03773   -0.05815
       O                -0.00800    0.00163   -0.00130    0.00822    0.00602    0.04129    0.00395    0.00098    0.00708
       O                 0.00012    0.00015   -0.00206   -0.01797   -0.05443    0.01502   -0.03958    0.07192   -0.00777
       O                -0.00000   -0.00044    0.00001   -0.00517   -0.02705    0.01195   -0.01908    0.02359    0.08323
       H                -0.00075    0.00080    0.00017   -0.04020   -0.05004    0.12201   -0.04293    0.03186    0.08635
       H                -0.00235   -0.00099   -0.00259   -0.06367   -0.07243    0.09546   -0.04831    0.04222    0.12222
       H                -0.00008    0.00038    0.00034   -0.09005   -0.09803    0.06882   -0.08082    0.03590    0.07164
       H                -0.00474    0.00323   -0.00073    0.00254    0.00385    0.03355    0.01992    0.01505    0.08099
       H                -0.00327    0.00184   -0.00110   -0.04760   -0.04086   -0.01876   -0.01844    0.02190    0.06710
       H                -0.00796    0.00049   -0.00081   -0.04777   -0.04063   -0.00573   -0.03330    0.02109    0.00467
       H                 0.04019   -0.02511    0.00435    0.00066   -0.02110   -0.10436    0.00648    0.00010    0.00493
       H                 0.03133    0.02314   -0.00655    0.01796    0.02914    0.03165    0.00628   -0.03854   -0.06467
       H                -0.00524    0.00332    0.00044    0.01277    0.04652   -0.01640    0.05199   -0.05052   -0.00190
       H                -0.00985    0.02001    0.02541    0.00071   -0.00080   -0.04678   -0.00424   -0.01282    0.06871
       H                 0.02415   -0.00778    0.01679    0.00189   -0.00763   -0.06401   -0.02466   -0.00179    0.01922
       H                -0.00357    0.00243    0.00217    0.01465    0.12369   -0.03148    0.04392   -0.00399    0.01696
       H                 0.01185   -0.00854   -0.00337    0.04141    0.09811   -0.11057    0.06107   -0.01750    0.00696
       H                 0.01525    0.00381   -0.00992    0.03549    0.09984   -0.09579    0.04970    0.00952    0.03848
       H                 0.01039    0.00620    0.00249   -0.00263   -0.03280    0.05311   -0.03240    0.04352   -0.08473
       H                 0.00568    0.00178    0.00203    0.01441    0.00320    0.08404    0.00422   -0.01033   -0.06491
       H                 0.01088   -0.00052   -0.00069   -0.00113   -0.04425    0.07828   -0.03217    0.05352   -0.02975
       H                 0.00057   -0.00424   -0.00380    0.01012    0.00776    0.05621    0.02334   -0.02567    0.04584
       H                -0.00154   -0.00241   -0.00048    0.01967    0.05400    0.03391    0.06275   -0.06997    0.00490
       H                -0.00699   -0.00413    0.00311    0.01249    0.04267   -0.00446    0.05154   -0.05965    0.07549
       H                 0.00765    0.01853   -0.01119    0.07974    0.04633   -0.00401   -0.03160   -0.02243   -0.04021
       H                 0.00009   -0.02332    0.00661    0.03389   -0.07301   -0.06946   -0.01103    0.02963   -0.00798
       H                -0.02544    0.00684    0.00121   -0.06071    0.02234   -0.01807    0.03148   -0.01255   -0.03168
       H                 0.00334    0.00227   -0.00016   -0.02332   -0.05372    0.00119   -0.02525    0.06932    0.03107
       H                 0.00162   -0.00057   -0.00126   -0.01220   -0.04660    0.02870   -0.03182    0.04523    0.08186
       H                -0.03850   -0.04847   -0.01281   -0.01936   -0.00350   -0.01407   -0.00703    0.00955   -0.03598
       H                 0.00841   -0.01629   -0.00579    0.01507    0.00762   -0.02604   -0.01150   -0.01177   -0.04572
       H                 0.00219    0.01657    0.01526   -0.01687    0.02184   -0.03165    0.02165   -0.02112   -0.02716
       H                -0.00616   -0.02528   -0.01588   -0.01852   -0.00128   -0.01349    0.00824   -0.01107   -0.03760
       H                -0.00833    0.05558    0.03181   -0.00563    0.01868   -0.03098    0.02479   -0.01762   -0.03210
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在することを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、BH9データセットの2. Pericyclic, No. 126の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- _J. Phys. Chem. A_ 2019, 123, 3761−3781 http://dx.doi.org/10.1021/acs.jpca.9b01546 (MOBH35のデータセットについて)

