---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Co錯体触媒が関わる酸化的環化反応(配位子:Tris(4-(N,N'-dimethylamino)phenyl)arsine), NNP使用）
published: 2025-09-14
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-09-14

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(4-(N,N'-dimethylamino)phenyl)arsine)の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

酸化的環化について
- https://www.sciencedirect.com/topics/chemistry/oxidative-cyclization

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.15.3
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.15.3.zip
unzip v1.15.3.zip
cd MultiOptPy-v1.15.3
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.15.3`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1::(uma-s-1.ptの絶対パス)
```

これで、`MultiOptPy-v1.15.3`がNNP`uma-s-1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`co_cat_oxidative_cyclization_As_pNMe2Ph_3.xyz`とした。
初期構造は以下のものを使用した。

```
77
OptimizedStructure
Co     3.372103406059     -0.464743456556     -0.342146426658
C      4.653345289045      0.321215233057     -1.769623763483
C      3.875953486356      1.451882674344     -1.435794633620
C      3.835990901884     -0.513644152932     -2.562762076001
H      5.669232695058      0.129310596267     -1.462502018504
C      2.681298675380      1.420773796769     -2.233466337690
H      4.215464069943      2.292470235686     -0.849412803830
C      2.657439803896      0.225832561285     -2.918066767575
H      4.118237405162     -1.471020641853     -2.971609067333
H      1.906800061409      2.172418714247     -2.207744676314
H      1.854390083967     -0.145917576702     -3.535062092645
As     0.873999724169     -0.259483366493     -0.187742729537
C      3.230850085882     -0.010968466229      1.660887231947
H      2.435457669199     -0.174618020983      2.360443146239
C      4.352598971398      0.309008270381      1.261411829107
H      5.344037302862      0.708573412512      1.296901928218
C      3.405605389052     -2.440591422353      0.171187412326
H      2.671330574537     -3.120555909881      0.544770013771
C      4.535336066534     -2.098840381051     -0.191492048514
H      5.573461892083     -2.189453080997     -0.434947737319
C     -0.470040683499     -0.608126031404     -1.565230941109
C     -1.249357660055     -1.756649638122     -1.605654872493
C     -0.645861029365      0.315439111630     -2.592915409952
C     -2.152614387872     -1.990513177924     -2.631451165569
H     -1.177570209408     -2.497502997757     -0.821200428687
C     -1.543242272630      0.101291690551     -3.622719096828
H     -0.074852886997      1.235570846896     -2.594550843721
C     -2.322244827253     -1.065625831589     -3.669727285729
H     -2.727120174472     -2.904630093852     -2.608690864326
H     -1.632982205745      0.854176106385     -4.391952270644
C      0.278731423428      1.517306546596      0.324645410388
C     -1.066316200895      1.875910409043      0.302478583592
C      1.197045624662      2.477477433963      0.730549194479
C     -1.483821334041      3.140315219300      0.675380224445
H     -1.810268629099      1.157136608501     -0.021859735534
C      0.797682218381      3.748499221621      1.111249767964
H      2.251640429877      2.232963316376      0.744082882646
C     -0.558140778975      4.109006796125      1.100794322952
H     -2.537782406645      3.371672042650      0.630311002595
H      1.553645791917      4.460237124652      1.408535131508
C      0.131670294477     -1.293424816702      1.292076520608
C     -0.361719168512     -0.702573586200      2.450012174668
C      0.172569295461     -2.685429859638      1.260673982126
C     -0.804880494182     -1.459172459017      3.524152173818
H     -0.401132308514      0.377180152570      2.530290517382
C     -0.280433588803     -3.458734130577      2.313963345872
H      0.561391785049     -3.195459658034      0.386327561252
C     -0.791964663517     -2.860259454660      3.476491512538
H     -1.163670320756     -0.943165996872      4.402541643728
H     -0.229906279753     -4.533699607714      2.225177685434
N     -3.232501408588     -1.283722342867     -4.694546463836
N     -1.270003659891     -3.625921999036      4.526428868192
N     -0.972544900071      5.367847333874      1.497852823964
C     -2.318901299366      5.788733790141      1.174071578909
H     -2.460835535073      6.811225528364      1.515011844016
H     -2.525577708349      5.752044585578      0.097022089107
H     -3.057796389570      5.168041071876      1.683507965196
C      0.024375783717      6.401348452688      1.675967041073
H     -0.469635037851      7.318278360175      1.987354508466
H      0.732284675303      6.129241144721      2.459837451303
H      0.591771584368      6.607117175521      0.759020886175
C     -3.777262391179     -2.616384560254     -4.844994353334
H     -4.455398395476     -2.627880946184     -5.694937075272
H     -3.001551798798     -3.376510401252     -5.008117375381
H     -4.353748836944     -2.902183829407     -3.964600151076
C     -3.092149717890     -0.500925763420     -5.905701011856
H     -3.842699405536     -0.823658640877     -6.623220040082
H     -3.262405762209      0.558094372450     -5.710427683058
H     -2.101483193242     -0.609752594211     -6.366035602498
C     -0.939029357197     -5.034696801827      4.557574213637
H      0.143640508678     -5.215452331029      4.560426079580
H     -1.364099659765     -5.477613878180      5.454814892592
H     -1.368504926592     -5.556096611687      3.701092564699
C     -1.525830265832     -2.976911144399      5.793990122695
H     -2.298980337378     -2.214420490230      5.690899589370
H     -1.891481873547     -3.716946278296      6.501538139051
H     -0.631038597864     -2.503757507549      6.219159992381

```

<MoleculeViewer 
  xyzData={`77
OptimizedStructure
Co     3.372103406059     -0.464743456556     -0.342146426658
C      4.653345289045      0.321215233057     -1.769623763483
C      3.875953486356      1.451882674344     -1.435794633620
C      3.835990901884     -0.513644152932     -2.562762076001
H      5.669232695058      0.129310596267     -1.462502018504
C      2.681298675380      1.420773796769     -2.233466337690
H      4.215464069943      2.292470235686     -0.849412803830
C      2.657439803896      0.225832561285     -2.918066767575
H      4.118237405162     -1.471020641853     -2.971609067333
H      1.906800061409      2.172418714247     -2.207744676314
H      1.854390083967     -0.145917576702     -3.535062092645
As     0.873999724169     -0.259483366493     -0.187742729537
C      3.230850085882     -0.010968466229      1.660887231947
H      2.435457669199     -0.174618020983      2.360443146239
C      4.352598971398      0.309008270381      1.261411829107
H      5.344037302862      0.708573412512      1.296901928218
C      3.405605389052     -2.440591422353      0.171187412326
H      2.671330574537     -3.120555909881      0.544770013771
C      4.535336066534     -2.098840381051     -0.191492048514
H      5.573461892083     -2.189453080997     -0.434947737319
C     -0.470040683499     -0.608126031404     -1.565230941109
C     -1.249357660055     -1.756649638122     -1.605654872493
C     -0.645861029365      0.315439111630     -2.592915409952
C     -2.152614387872     -1.990513177924     -2.631451165569
H     -1.177570209408     -2.497502997757     -0.821200428687
C     -1.543242272630      0.101291690551     -3.622719096828
H     -0.074852886997      1.235570846896     -2.594550843721
C     -2.322244827253     -1.065625831589     -3.669727285729
H     -2.727120174472     -2.904630093852     -2.608690864326
H     -1.632982205745      0.854176106385     -4.391952270644
C      0.278731423428      1.517306546596      0.324645410388
C     -1.066316200895      1.875910409043      0.302478583592
C      1.197045624662      2.477477433963      0.730549194479
C     -1.483821334041      3.140315219300      0.675380224445
H     -1.810268629099      1.157136608501     -0.021859735534
C      0.797682218381      3.748499221621      1.111249767964
H      2.251640429877      2.232963316376      0.744082882646
C     -0.558140778975      4.109006796125      1.100794322952
H     -2.537782406645      3.371672042650      0.630311002595
H      1.553645791917      4.460237124652      1.408535131508
C      0.131670294477     -1.293424816702      1.292076520608
C     -0.361719168512     -0.702573586200      2.450012174668
C      0.172569295461     -2.685429859638      1.260673982126
C     -0.804880494182     -1.459172459017      3.524152173818
H     -0.401132308514      0.377180152570      2.530290517382
C     -0.280433588803     -3.458734130577      2.313963345872
H      0.561391785049     -3.195459658034      0.386327561252
C     -0.791964663517     -2.860259454660      3.476491512538
H     -1.163670320756     -0.943165996872      4.402541643728
H     -0.229906279753     -4.533699607714      2.225177685434
N     -3.232501408588     -1.283722342867     -4.694546463836
N     -1.270003659891     -3.625921999036      4.526428868192
N     -0.972544900071      5.367847333874      1.497852823964
C     -2.318901299366      5.788733790141      1.174071578909
H     -2.460835535073      6.811225528364      1.515011844016
H     -2.525577708349      5.752044585578      0.097022089107
H     -3.057796389570      5.168041071876      1.683507965196
C      0.024375783717      6.401348452688      1.675967041073
H     -0.469635037851      7.318278360175      1.987354508466
H      0.732284675303      6.129241144721      2.459837451303
H      0.591771584368      6.607117175521      0.759020886175
C     -3.777262391179     -2.616384560254     -4.844994353334
H     -4.455398395476     -2.627880946184     -5.694937075272
H     -3.001551798798     -3.376510401252     -5.008117375381
H     -4.353748836944     -2.902183829407     -3.964600151076
C     -3.092149717890     -0.500925763420     -5.905701011856
H     -3.842699405536     -0.823658640877     -6.623220040082
H     -3.262405762209      0.558094372450     -5.710427683058
H     -2.101483193242     -0.609752594211     -6.366035602498
C     -0.939029357197     -5.034696801827      4.557574213637
H      0.143640508678     -5.215452331029      4.560426079580
H     -1.364099659765     -5.477613878180      5.454814892592
H     -1.368504926592     -5.556096611687      3.701092564699
C     -1.525830265832     -2.976911144399      5.793990122695
H     -2.298980337378     -2.214420490230      5.690899589370
H     -1.891481873547     -3.716946278296      6.501538139051
H     -0.631038597864     -2.503757507549      6.219159992381
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`co_cat_oxidative_cyclization_As_pNMe2Ph_3.xyz`として保存し、以下を実行する。
```
python optmain.py .\co_cat_oxidative_cyclization_As_pNMe2Ph_3.xyz -os uma-s-1 -opt rsirfo_fsb -ma 100 1 13 100 1 17 200 15 19
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）今回はUMAモデルのNNPを使用し、ラジカル反応を扱うためスピンだ重度を2とした。
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。


これを実行すると、`omol`のデータセットを使用した`uma-s-1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.15.3`ディレクトリに置く。

`co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj.xyz`は次のNEB計算に使用する。

※`co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`co_cat_oxidative_cyclization_As_pNMe2Ph_3_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）



```
python .\nebmain.py co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj.xyz -os uma-s-1 -ns 15 -modelhess -spng -nd 0.3 -aneb 3 5
```

- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `-aneb A B`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.15.3`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-5063.4282937658045,-5063.400922844395,-5063.401795440318,-5063.402424351234,-5063.3906384241445,-5063.379429169514,-5063.38328136178,-5063.380866726489,-5063.390710655748,-5063.41587190145,-5063.44949462188,-5063.471692430038,-5063.49047746142,-5063.503371521042,-5063.50636401573,-5063.5077588637105,-5063.508036995687,-5063.508199937356,-5063.50832770949,-5063.50854313385,-5063.508748087957,-5063.508868465201,-5063.508985775843,-5063.50906011902,-5063.509169325073,-5063.509241048497,-5063.509311308713,-5063.509330409259,-5063.509393686386,-5063.509436767753,-5063.509502936247,-5063.50957108489];

export const dataset1_itr5 = [-5063.428321678448,-5063.42119657052,-5063.412536424384,-5063.412153274456,-5063.399443852708,-5063.3849433238765,-5063.394627610253,-5063.397675669566,-5063.402994030197,-5063.437559556388,-5063.471416146785,-5063.485660303913,-5063.503076522759,-5063.509918758622,-5063.511567591284,-5063.512407778708,-5063.512907555864,-5063.51382782539,-5063.513825231922,-5063.513917028441,-5063.514171424923,-5063.514444133396,-5063.5145599282605,-5063.514614426146,-5063.514638424492,-5063.5148107324385,-5063.514969109253,-5063.51541049832,-5063.515517987076,-5063.515651244045,-5063.5155110653195,-5063.515934449056];

export const dataset1_itr10 = [-5063.4283339098065,-5063.426125978776,-5063.421042434376,-5063.4206900282215,-5063.409649675145,-5063.403409921023,-5063.397411768809,-5063.392823599898,-5063.390475530665,-5063.389548552948,-5063.392127195552,-5063.396072528167,-5063.400528837055,-5063.406882269883,-5063.408315183353,-5063.460592078085,-5063.485416386447,-5063.494964354728,-5063.507652365029,-5063.512208274389,-5063.513453524797,-5063.5139673382255,-5063.514225765098,-5063.514860341285,-5063.514959637835,-5063.515149688261,-5063.5153231878,-5063.515565274069,-5063.515714144419,-5063.51574827131,-5063.515778481714,-5063.515967305499,-5063.516081584587,-5063.5164048832185,-5063.516460441272,-5063.516495610808,-5063.51638377624,-5063.516381524479,-5063.516366489371,-5063.516344427365,-5063.51644237461,-5063.516511451995,-5063.516514921635,-5063.516381007537];


export const dataset2 = [-5063.428337657631,-5063.427206048896,-5063.425295687713,-5063.425041107234,-5063.417990176011,-5063.412587035353,-5063.404699532283,-5063.398401259194,-5063.39367997131,-5063.393185353711,-5063.3928895876825,-5063.392810104662,-5063.392957878703,-5063.3933753318515,-5063.39403071712,-5063.394893265543,-5063.395950186108,-5063.400215215741,-5063.404375949579,-5063.413687788603,-5063.414122955755,-5063.480412131214,-5063.495239358771,-5063.501907744625,-5063.5107289284,-5063.51355380266,-5063.514429483803,-5063.5146573760885,-5063.514900724043,-5063.515339843826,-5063.515462455308,-5063.515645461312,-5063.515782958952,-5063.515988202196,-5063.516113258197,-5063.516163401509,-5063.516227511,-5063.516353364317,-5063.516442006618,-5063.516667769805,-5063.516717676551,-5063.516731353593,-5063.516635360211,-5063.516622594388,-5063.516632030758,-5063.516623190184,-5063.516579048649,-5063.516578917223,-5063.516574133325,-5063.51660195178,-5063.516622480485,-5063.516641361987,-5063.5166572469825,-5063.5167412806195,-5063.516753923778,-5063.51676688236
];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [4.952383702388561e-05,0.011813532126264273,0.005340383915977672,0.005058583941209266,0.004795555308165341,0.0039308749428560025,0.007336956987856853,0.008549896392859177,0.008143159812267832,0.008168723915380009,0.007717111737449404,0.006738688338403921,0.0065947025696656385,0.0057503276735498205,0.005233527843215183,0.005313817232505173,0.0053146572742614065,0.005316154106490979,0.005309428536859081,0.005307521584016683,0.005304506850585281,0.005308602117543483,0.005307315954509879,0.005307786335279104,0.005303927180757525,0.005308554818736795,0.005308779942477084,0.005310254312107774,0.005311594469038313,0.005311842536444001,0.00530583038161913,0.005308895192172937];

export const dataset1_grad_itr5 = [5.3337752933782414e-05,0.0035064847681920744,0.004066267758211009,0.0038577502126240317,0.004111849753060895,0.002633394833368734,0.0037521386201422573,0.003712518877146095,0.003080648383978133,0.008089073195792822,0.005199251280598667,0.0037129147013239714,0.0027131388575731357,0.0017659737291749608,0.0025234445559590454,0.0021273622164043235,0.0022375902003531276,0.0017582783457895494,0.001969471519682437,0.0021554103362658047,0.002014233267915161,0.002028925664727135,0.002046090293779537,0.0019878594756634325,0.001971810250547407,0.001954270987702078,0.00192252203135926,0.0014300132743852681,0.0013258216925395685,0.001250813475235231,0.0013984095248030382,0.0011999927405410274];

export const dataset1_grad_itr10 = [5.226185417953311e-05,0.0015219564150959436,0.002719396061801945,0.0025018542372688877,0.003513769752094724,0.003556571931249902,0.0031889318362224722,0.002723494840498487,0.0020957382671107066,0.0022814611599416474,0.0030880105066075276,0.003477446196480725,0.0032080478321735383,0.002902842011210553,0.003079516414239382,0.007731324862415166,0.0041311376481017415,0.0029290788762718315,0.0018559527831410788,0.0010218748412879973,0.0016755035151327085,0.0011750664739988463,0.0015408058034020007,0.0012423060049303917,0.0012661218179237216,0.0013357857107786828,0.0012383723500259847,0.001234085505517643,0.001191322731193378,0.0011951317004591715,0.001222298531059721,0.0011202216436574399,0.0010958673507854059,0.0006737643808294562,0.0006396806598803969,0.0006578863108105454,0.0007853947021644907,0.0008026052070464738,0.0008340521866341633,0.0008262203396874056,0.0007286892837754966,0.0006843155113683021,0.0007022989141487769,0.0009867067510447814];


export const dataset2_grad = [5.4103221229803154e-05,0.0009954071890811561,0.0016745752778227238,0.0015623934602228967,0.002626002139914083,0.0030986150874187175,0.002970567757432716,0.00238861462353572,0.0018509237765309719,0.0018587505641127976,0.0019265268636983678,0.0020583955576804615,0.002249095312662809,0.002470810427575894,0.0026967150237631964,0.0029084705152333076,0.003078476935627821,0.003239916693513761,0.0029943749033738707,0.00336710975173244,0.0036794115836728293,0.006524149748421322,0.003562078964391436,0.002593015945113042,0.001414976354391506,0.0007282612612205352,0.0011856398664394196,0.0008910513242947676,0.0011498801918676783,0.000996244155435572,0.000988609668770044,0.0009895549869090986,0.0009177480145295371,0.000905696103014513,0.0008454909864267935,0.0008648885584035069,0.0008841366796625251,0.0007978136407509573,0.0007649818337886722,0.00044331472834751966,0.0004323002125483901,0.00042017021320679693,0.0006016787294144867,0.0006248243569834506,0.0006344356857422318,0.0006517250571260526,0.0007004069996948327,0.0006896805901559359,0.0006799194474712141,0.0006018262195545283,0.0005848641407331291,0.0005674461940452935,0.0005549887808973002,0.00047729474081460065,0.00047597978038488634,0.0004303482071942014];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、緩和後に得られた経路の11番(グラフ上では12番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj_11.xyz`
```
77
0 1
Co      3.227299248432     -0.482806895066     -0.333605378913
C       4.603700867324      0.344531832653     -1.814008157837
C       3.843702755491      1.481148235987     -1.486783957877
C       3.800445595783     -0.491006593851     -2.613598600810
H       5.593388853688      0.120216171694     -1.449616582589
C       2.646253869866      1.445768996127     -2.284153681167
H       4.191267715185      2.306753594425     -0.882946525017
C       2.620203586759      0.249123897431     -2.961442961221
H       4.088803279150     -1.457641586144     -2.999112193492
H       1.868066999643      2.191871936999     -2.239626147148
H       1.819266982379     -0.130904901068     -3.573856013988
As      0.833303016103     -0.256820881116     -0.193844020306
C       3.245168291721     -0.127716096032      1.508568310180
H       2.564754502818      0.086086155601      2.317318335737
C       4.480909219190     -0.239681873962      1.144705066162
H       5.456809123119      0.181108833589      1.302330417834
C       3.406029504328     -2.247302482470      0.205759312165
H       2.831181907572     -3.144141923779      0.330708549693
C       4.597250674433     -1.740077851092      0.225230751503
H       5.631643170023     -1.955028290803      0.019433527024
C      -0.478881020668     -0.608959166851     -1.574860421829
C      -1.252916524949     -1.759789091230     -1.612416388509
C      -0.648191007236      0.315947925656     -2.600839169781
C      -2.153381824759     -1.994702959920     -2.638734509190
H      -1.176611706392     -2.496827373463     -0.824745051040
C      -1.544612662219      0.100972859393     -3.629510001500
H      -0.072626118906      1.232759247549     -2.600779224482
C      -2.322562317343     -1.066861692357     -3.674461885959
H      -2.726661346472     -2.908750342173     -2.615435678310
H      -1.635133795599      0.854114509880     -4.397782477460
C       0.271662924032      1.520513561305      0.326812830212
C      -1.072232454864      1.880548743483      0.306599633438
C       1.195047403648      2.476223294564      0.731524688358
C      -1.488344639180      3.144286533437      0.679618363172
H      -1.813449063074      1.159437681318     -0.018270163996
C       0.796989880473      3.747736856775      1.112519834119
H       2.251426109370      2.233168573766      0.737906899569
C      -0.559057617689      4.110101009227      1.103285918286
H      -2.542106571581      3.374165393498      0.634678955138
H       1.553426158740      4.460007565553      1.407267934558
C       0.117246514091     -1.295274182382      1.293240701858
C      -0.372095446264     -0.703171586051      2.451568104013
C       0.173883788809     -2.686403401527      1.263682169528
C      -0.809656748024     -1.460445400552      3.527201159623
H      -0.410236991407      0.376733475047      2.529952360337
C      -0.275721684896     -3.460189455854      2.318023246068
H       0.573543963519     -3.192853661128      0.391903828675
C      -0.793318084216     -2.861402861882      3.477871291204
H      -1.169865884885     -0.944752522557      4.405071737301
H      -0.219018583034     -4.535233285338      2.232401175844
N      -3.233337019769     -1.284080842427     -4.697489124827
N      -1.273370142931     -3.627378172957      4.526753702700
N      -0.972297467184      5.368754259515      1.500565874035
C      -2.318727695583      5.789078830144      1.175243734384
H      -2.462929893603      6.810258023948      1.519011477616
H      -2.522775628042      5.754618379445      0.097479809624
H      -3.058075698925      5.166199071158      1.681180945398
C       0.024969206550      6.402581728051      1.675355748180
H      -0.468534853075      7.320105538749      1.986177842026
H       0.734043695889      6.131074705107      2.458524427180
H       0.590446595220      6.606084342804      0.756877145224
C      -3.779438056389     -2.615989267905     -4.848341796555
H      -4.457479018638     -2.625143839245     -5.698249063908
H      -3.004794821970     -3.376831355794     -5.012543471734
H      -4.356122541175     -2.901793361242     -3.968082877294
C      -3.096606463564     -0.498697075147     -5.907323877491
H      -3.848866445385     -0.821134399500     -6.623018644387
H      -3.267924790732      0.559707976120     -5.709636608545
H      -2.106891853932     -0.605296711391     -6.370211906556
C      -0.939985026744     -5.035629583858      4.559840020640
H       0.143087876532     -5.214309695048      4.564082376698
H      -1.364775524654     -5.477679426726      5.457652160766
H      -1.368468685234     -5.559976131825      3.704495009655
C      -1.524559997084     -2.976889191179      5.794502042223
H      -2.295654807811     -2.212093431345      5.693155453949
H      -1.889832201863     -3.715287193033      6.504008380649
H      -0.627092551936     -2.504833702730      6.215235311171

```


<MoleculeViewer 
  xyzData={`77
0 1
Co      3.227299248432     -0.482806895066     -0.333605378913
C       4.603700867324      0.344531832653     -1.814008157837
C       3.843702755491      1.481148235987     -1.486783957877
C       3.800445595783     -0.491006593851     -2.613598600810
H       5.593388853688      0.120216171694     -1.449616582589
C       2.646253869866      1.445768996127     -2.284153681167
H       4.191267715185      2.306753594425     -0.882946525017
C       2.620203586759      0.249123897431     -2.961442961221
H       4.088803279150     -1.457641586144     -2.999112193492
H       1.868066999643      2.191871936999     -2.239626147148
H       1.819266982379     -0.130904901068     -3.573856013988
As      0.833303016103     -0.256820881116     -0.193844020306
C       3.245168291721     -0.127716096032      1.508568310180
H       2.564754502818      0.086086155601      2.317318335737
C       4.480909219190     -0.239681873962      1.144705066162
H       5.456809123119      0.181108833589      1.302330417834
C       3.406029504328     -2.247302482470      0.205759312165
H       2.831181907572     -3.144141923779      0.330708549693
C       4.597250674433     -1.740077851092      0.225230751503
H       5.631643170023     -1.955028290803      0.019433527024
C      -0.478881020668     -0.608959166851     -1.574860421829
C      -1.252916524949     -1.759789091230     -1.612416388509
C      -0.648191007236      0.315947925656     -2.600839169781
C      -2.153381824759     -1.994702959920     -2.638734509190
H      -1.176611706392     -2.496827373463     -0.824745051040
C      -1.544612662219      0.100972859393     -3.629510001500
H      -0.072626118906      1.232759247549     -2.600779224482
C      -2.322562317343     -1.066861692357     -3.674461885959
H      -2.726661346472     -2.908750342173     -2.615435678310
H      -1.635133795599      0.854114509880     -4.397782477460
C       0.271662924032      1.520513561305      0.326812830212
C      -1.072232454864      1.880548743483      0.306599633438
C       1.195047403648      2.476223294564      0.731524688358
C      -1.488344639180      3.144286533437      0.679618363172
H      -1.813449063074      1.159437681318     -0.018270163996
C       0.796989880473      3.747736856775      1.112519834119
H       2.251426109370      2.233168573766      0.737906899569
C      -0.559057617689      4.110101009227      1.103285918286
H      -2.542106571581      3.374165393498      0.634678955138
H       1.553426158740      4.460007565553      1.407267934558
C       0.117246514091     -1.295274182382      1.293240701858
C      -0.372095446264     -0.703171586051      2.451568104013
C       0.173883788809     -2.686403401527      1.263682169528
C      -0.809656748024     -1.460445400552      3.527201159623
H      -0.410236991407      0.376733475047      2.529952360337
C      -0.275721684896     -3.460189455854      2.318023246068
H       0.573543963519     -3.192853661128      0.391903828675
C      -0.793318084216     -2.861402861882      3.477871291204
H      -1.169865884885     -0.944752522557      4.405071737301
H      -0.219018583034     -4.535233285338      2.232401175844
N      -3.233337019769     -1.284080842427     -4.697489124827
N      -1.273370142931     -3.627378172957      4.526753702700
N      -0.972297467184      5.368754259515      1.500565874035
C      -2.318727695583      5.789078830144      1.175243734384
H      -2.462929893603      6.810258023948      1.519011477616
H      -2.522775628042      5.754618379445      0.097479809624
H      -3.058075698925      5.166199071158      1.681180945398
C       0.024969206550      6.402581728051      1.675355748180
H      -0.468534853075      7.320105538749      1.986177842026
H       0.734043695889      6.131074705107      2.458524427180
H       0.590446595220      6.606084342804      0.756877145224
C      -3.779438056389     -2.615989267905     -4.848341796555
H      -4.457479018638     -2.625143839245     -5.698249063908
H      -3.004794821970     -3.376831355794     -5.012543471734
H      -4.356122541175     -2.901793361242     -3.968082877294
C      -3.096606463564     -0.498697075147     -5.907323877491
H      -3.848866445385     -0.821134399500     -6.623018644387
H      -3.267924790732      0.559707976120     -5.709636608545
H      -2.106891853932     -0.605296711391     -6.370211906556
C      -0.939985026744     -5.035629583858      4.559840020640
H       0.143087876532     -5.214309695048      4.564082376698
H      -1.364775524654     -5.477679426726      5.457652160766
H      -1.368468685234     -5.559976131825      3.704495009655
C      -1.524559997084     -2.976889191179      5.794502042223
H      -2.295654807811     -2.212093431345      5.693155453949
H      -1.889832201863     -3.715287193033      6.504008380649
H      -0.627092551936     -2.504833702730      6.215235311171
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj_11.xyz`を`MultiOptPy-v1.15.3`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py .\co_cat_oxidative_cyclization_As_pNMe2Ph_3_traj_11.xyz -fc 5 -order 1 -opt rsirfo_bofill -freq -tcc -os uma-s-1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
77
OptimizedStructure
Co     3.159569511533     -0.645960119920     -0.555848801649
C      4.345991002635     -0.182123836136     -2.236633617067
C      3.764884152371      1.053514837533     -1.881193162371
C      3.330509316976     -0.947648507752     -2.839260847686
H      5.344024446100     -0.512458552835     -1.997112583909
C      2.487735647830      1.150724392735     -2.572742828954
H      4.293058025354      1.876383551065     -1.422484107305
C      2.227653174631     -0.057387351571     -3.148265767187
H      3.430674006573     -1.962105968024     -3.193323636828
H      1.822322274610      2.001293413943     -2.539490392215
H      1.318938882601     -0.344441153846     -3.654650887764
As     0.880446420175     -0.225840557029     -0.128206674164
C      3.611147711076      0.178572875441      1.173764167457
H      3.242246380050      0.953010416832      1.823652135207
C      4.632401595131     -0.507964659808      0.879531168015
H      5.676570232383     -0.680361666804      1.063892472250
C      2.942501666048     -2.501886376352     -0.003930516859
H      2.173165642339     -3.252137663057      0.001107156142
C      4.188410898690     -2.300218934360      0.049995094805
H      5.168751845443     -2.737965933898      0.052677922612
C     -0.455683948357     -0.526029579866     -1.493521604489
C     -0.626665430667     -1.815475826739     -1.986391091472
C     -1.160991220846      0.500750482929     -2.102738286137
C     -1.483078620868     -2.080583526762     -3.038164257314
H     -0.069909526944     -2.638497469359     -1.549773967662
C     -2.021603989439      0.254899733367     -3.162007110328
H     -1.034897246288      1.521145423284     -1.759890767008
C     -2.212478463959     -1.046015191684     -3.649084180813
H     -1.575431603903     -3.098267386047     -3.387153306020
H     -2.540426345738      1.089961014748     -3.608682945621
C      0.415606672727      1.556472898495      0.479783980376
C     -0.823593089722      1.843192541827      1.043807322629
C      1.327628921389      2.597029503522      0.361222783830
C     -1.147512303971      3.118352513713      1.468592732947
H     -1.561732049485      1.057451516036      1.157545011444
C      1.024140721181      3.880730625294      0.785460612313
H      2.300219973252      2.403603217285     -0.074209346200
C     -0.222052476142      4.171068251295      1.360172492610
H     -2.125836189372      3.289386407176      1.892745526149
H      1.768228845877      4.654269295781      0.666054564942
C      0.138409473182     -1.304916954230      1.306536949079
C     -1.202705024902     -1.666632294476      1.366420562881
C      0.967139250952     -1.721151803396      2.344111302643
C     -1.706980876895     -2.408557569415      2.422065177012
H     -1.878535202024     -1.373746168919      0.571076097836
C      0.480323933457     -2.460729590733      3.406920525273
H      2.021925858955     -1.469953494289      2.319067239931
C     -0.872374437580     -2.832722407014      3.467209198427
H     -2.757518632089     -2.659084860426      2.421082525936
H      1.166032052007     -2.753976761679      4.187903555270
N     -3.092111652657     -1.306290669482     -4.689363727572
N     -1.360559862887     -3.604278146112      4.509777622429
N     -0.525984606232      5.441913013606      1.815908544214
C     -1.905546080654      5.757315632475      2.117846980675
H     -1.969139475233      6.794324087564      2.438175804592
H     -2.570196204995      5.620087884882      1.254947179531
H     -2.278415741645      5.139722910563      2.936096377170
C      0.337538868124      6.538560701875      1.432891781939
H     -0.049411624370      7.459361492675      1.862392122336
H      1.346498700819      6.395347509924      1.821774562215
H      0.405055114334      6.664654489065      0.344450570607
C     -2.993427260110     -2.582765630908     -5.365948291512
H     -3.727353790064     -2.614707281301     -6.167592526404
H     -1.999527861669     -2.758152463953     -5.797960486192
H     -3.219016159875     -3.404309641388     -4.685210142684
C     -3.570873059585     -0.188501687411     -5.475140834549
H     -4.231982624383     -0.561987329847     -6.253465327466
H     -4.149168028855      0.501158375000     -4.859314633097
H     -2.757658001347      0.375539186709     -5.950723805260
C     -0.543161719262     -3.756989200440      5.694847768039
H     -0.299287116142     -2.797031339437      6.168582038033
H     -1.078278752493     -4.370319767656      6.415842511674
H      0.391433548394     -4.268278560829      5.461556559678
C     -2.794055387537     -3.698452672220      4.682059165401
H     -3.260731334131     -4.178079355205      3.820623063463
H     -3.006129277444     -4.315590846230      5.551820901561
H     -3.269162466433     -2.719221437789      4.827488630191

```

<MoleculeViewer 
  xyzData={`77
OptimizedStructure
Co     3.159569511533     -0.645960119920     -0.555848801649
C      4.345991002635     -0.182123836136     -2.236633617067
C      3.764884152371      1.053514837533     -1.881193162371
C      3.330509316976     -0.947648507752     -2.839260847686
H      5.344024446100     -0.512458552835     -1.997112583909
C      2.487735647830      1.150724392735     -2.572742828954
H      4.293058025354      1.876383551065     -1.422484107305
C      2.227653174631     -0.057387351571     -3.148265767187
H      3.430674006573     -1.962105968024     -3.193323636828
H      1.822322274610      2.001293413943     -2.539490392215
H      1.318938882601     -0.344441153846     -3.654650887764
As     0.880446420175     -0.225840557029     -0.128206674164
C      3.611147711076      0.178572875441      1.173764167457
H      3.242246380050      0.953010416832      1.823652135207
C      4.632401595131     -0.507964659808      0.879531168015
H      5.676570232383     -0.680361666804      1.063892472250
C      2.942501666048     -2.501886376352     -0.003930516859
H      2.173165642339     -3.252137663057      0.001107156142
C      4.188410898690     -2.300218934360      0.049995094805
H      5.168751845443     -2.737965933898      0.052677922612
C     -0.455683948357     -0.526029579866     -1.493521604489
C     -0.626665430667     -1.815475826739     -1.986391091472
C     -1.160991220846      0.500750482929     -2.102738286137
C     -1.483078620868     -2.080583526762     -3.038164257314
H     -0.069909526944     -2.638497469359     -1.549773967662
C     -2.021603989439      0.254899733367     -3.162007110328
H     -1.034897246288      1.521145423284     -1.759890767008
C     -2.212478463959     -1.046015191684     -3.649084180813
H     -1.575431603903     -3.098267386047     -3.387153306020
H     -2.540426345738      1.089961014748     -3.608682945621
C      0.415606672727      1.556472898495      0.479783980376
C     -0.823593089722      1.843192541827      1.043807322629
C      1.327628921389      2.597029503522      0.361222783830
C     -1.147512303971      3.118352513713      1.468592732947
H     -1.561732049485      1.057451516036      1.157545011444
C      1.024140721181      3.880730625294      0.785460612313
H      2.300219973252      2.403603217285     -0.074209346200
C     -0.222052476142      4.171068251295      1.360172492610
H     -2.125836189372      3.289386407176      1.892745526149
H      1.768228845877      4.654269295781      0.666054564942
C      0.138409473182     -1.304916954230      1.306536949079
C     -1.202705024902     -1.666632294476      1.366420562881
C      0.967139250952     -1.721151803396      2.344111302643
C     -1.706980876895     -2.408557569415      2.422065177012
H     -1.878535202024     -1.373746168919      0.571076097836
C      0.480323933457     -2.460729590733      3.406920525273
H      2.021925858955     -1.469953494289      2.319067239931
C     -0.872374437580     -2.832722407014      3.467209198427
H     -2.757518632089     -2.659084860426      2.421082525936
H      1.166032052007     -2.753976761679      4.187903555270
N     -3.092111652657     -1.306290669482     -4.689363727572
N     -1.360559862887     -3.604278146112      4.509777622429
N     -0.525984606232      5.441913013606      1.815908544214
C     -1.905546080654      5.757315632475      2.117846980675
H     -1.969139475233      6.794324087564      2.438175804592
H     -2.570196204995      5.620087884882      1.254947179531
H     -2.278415741645      5.139722910563      2.936096377170
C      0.337538868124      6.538560701875      1.432891781939
H     -0.049411624370      7.459361492675      1.862392122336
H      1.346498700819      6.395347509924      1.821774562215
H      0.405055114334      6.664654489065      0.344450570607
C     -2.993427260110     -2.582765630908     -5.365948291512
H     -3.727353790064     -2.614707281301     -6.167592526404
H     -1.999527861669     -2.758152463953     -5.797960486192
H     -3.219016159875     -3.404309641388     -4.685210142684
C     -3.570873059585     -0.188501687411     -5.475140834549
H     -4.231982624383     -0.561987329847     -6.253465327466
H     -4.149168028855      0.501158375000     -4.859314633097
H     -2.757658001347      0.375539186709     -5.950723805260
C     -0.543161719262     -3.756989200440      5.694847768039
H     -0.299287116142     -2.797031339437      6.168582038033
H     -1.078278752493     -4.370319767656      6.415842511674
H      0.391433548394     -4.268278560829      5.461556559678
C     -2.794055387537     -3.698452672220      4.682059165401
H     -3.260731334131     -4.178079355205      3.820623063463
H     -3.006129277444     -4.315590846230      5.551820901561
H     -3.269162466433     -2.719221437789      4.827488630191
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -441.3691             19.0816             20.9727
Reduced mass [au]                   5.4358              4.6218              4.4491
Force const [Dyne/A]               -0.6239              0.0010              0.0012
Char temp [K]                       0.0000             27.4541             30.1750
Normal mode                   x         y         z            x         y         z            x         y         z     
      Co                -0.02506    0.00265   -0.00462    0.00887    0.00046    0.01618    0.01542    0.00866    0.00387
       C                -0.00432    0.00482   -0.00300    0.01557   -0.00879    0.01817    0.02710    0.00577    0.01124
       C                -0.00004    0.00695   -0.00845    0.01528   -0.00632    0.00865    0.02257    0.00596    0.00304
       C                -0.00322    0.00268   -0.00386    0.01685   -0.01214    0.01999    0.03291    0.00239    0.00566
       H                -0.00586    0.00226    0.00160    0.01472   -0.00781    0.02307    0.02583    0.00806    0.01967
       C                -0.00155    0.00292   -0.00479    0.01705   -0.01019    0.00503    0.02758    0.00186   -0.00670
       H                -0.00081    0.00928   -0.01219    0.01417   -0.00395    0.00568    0.01781    0.00806    0.00476
       C                -0.00116    0.00222   -0.00528    0.01803   -0.01365    0.01178    0.03384   -0.00023   -0.00514
       H                 0.00211    0.00572   -0.01066    0.01756   -0.01423    0.02623    0.03744    0.00165    0.00905
       H                -0.00107    0.00352   -0.00708    0.01710   -0.00991   -0.00197    0.02586    0.00083   -0.01444
       H                -0.00045    0.00299   -0.00725    0.01906   -0.01628    0.01146    0.03808   -0.00285   -0.01114
      As                -0.00034    0.00027    0.00031    0.00748    0.00342    0.00915    0.01084    0.00480   -0.01727
       C                 0.01574   -0.04502   -0.04804   -0.00161    0.00828    0.01544   -0.00132    0.01586    0.00463
       H                 0.20526    0.05718   -0.05721   -0.00653    0.01038    0.01016   -0.00936    0.01706   -0.00141
       C                -0.01560   -0.17094   -0.00716    0.00127    0.00928    0.02304    0.00330    0.01815    0.01541
       H                -0.00433   -0.04531    0.07866    0.00080    0.01254    0.02870    0.00233    0.02200    0.02445
       C                 0.03500    0.06018   -0.00257    0.01047    0.00185    0.02135    0.01646    0.01047    0.00990
       H                 0.15747   -0.07057   -0.12438    0.01173    0.00056    0.01871    0.01832    0.00855    0.00797
       C                 0.05569    0.12603    0.11138    0.00961    0.00475    0.02846    0.01551    0.01431    0.01824
       H                -0.00171   -0.01692    0.09799    0.01066    0.00719    0.03595    0.01673    0.01708    0.02742
       C                 0.00257   -0.00002   -0.00151    0.00584    0.01110    0.00837    0.01587   -0.00270   -0.02060
       C                 0.00090   -0.00033   -0.00004   -0.00150    0.01286    0.00624    0.03639   -0.00299   -0.02739
       C                 0.00111   -0.00003   -0.00032    0.00294    0.01434    0.01714   -0.01864   -0.01424    0.00050
       C                 0.00033   -0.00005    0.00022   -0.01344    0.01736    0.01480    0.02009   -0.01540   -0.01064
       H                -0.00026   -0.00012    0.00177    0.00069    0.01042   -0.00114    0.06449    0.00687   -0.04458
       C                 0.00021   -0.00004    0.00046   -0.00890    0.01894    0.02570   -0.03609   -0.02676    0.01710
       H                 0.00099   -0.00016   -0.00001    0.00824    0.01320    0.01838   -0.03537   -0.01392    0.00570
       C                 0.00031   -0.00006    0.00022   -0.01888    0.02031    0.02615   -0.01943   -0.02818    0.01454
       H                -0.00032   -0.00015    0.00068   -0.01963    0.01839    0.01338    0.03606   -0.01502   -0.01601
       H                -0.00030   -0.00007    0.00103   -0.01135    0.02132    0.03298   -0.06443   -0.03550    0.03365
       C                 0.00100    0.00092   -0.00097    0.00965    0.00519    0.00543    0.00623    0.00295   -0.01463
       C                 0.00070   -0.00018   -0.00067    0.01087    0.00739    0.00687    0.01011   -0.00314   -0.00295
       C                 0.00092    0.00050   -0.00042    0.00436    0.00767   -0.01338    0.00402    0.00526   -0.01272
       C                 0.00035   -0.00028   -0.00019    0.00557    0.01284   -0.01330    0.01232   -0.00739    0.01172
       H                 0.00107   -0.00049   -0.00027    0.01548    0.00521    0.02214    0.01216   -0.00508   -0.00319
       C                 0.00009    0.00018    0.00004   -0.00117    0.01319   -0.03410    0.00621    0.00095    0.00168
       H                 0.00072    0.00092   -0.00097    0.00395    0.00561   -0.01334    0.00151    0.00995   -0.02036
       C                 0.00006   -0.00016   -0.00007   -0.00167    0.01673   -0.03708    0.01110   -0.00594    0.01593
       H                 0.00043   -0.00077    0.00023    0.00636    0.01451   -0.01216    0.01560   -0.01237    0.02131
       H                -0.00009    0.00048    0.00053   -0.00557    0.01505   -0.04935    0.00473    0.00268    0.00352
       C                 0.00211   -0.00169   -0.00006    0.00234   -0.00008    0.00406   -0.00073    0.00593   -0.02176
       C                 0.00158    0.00007   -0.00075    0.00339   -0.00551   -0.00451   -0.00006    0.00080   -0.03759
       C                 0.00157   -0.00024    0.00041   -0.00013   -0.00774    0.00309   -0.01285    0.01487   -0.00856
       C                 0.00053    0.00042   -0.00033    0.00283   -0.02143   -0.01595   -0.01131    0.00492   -0.04016
       H                 0.00190    0.00005   -0.00103    0.00483    0.00142   -0.00312    0.00908   -0.00584   -0.04773
       C                 0.00023    0.00008    0.00001   -0.00067   -0.02362   -0.00823   -0.02434    0.01917   -0.01071
       H                 0.00091    0.00377    0.00123   -0.00120   -0.00254    0.01045   -0.01343    0.01872    0.00401
       C                 0.00010    0.00014   -0.00051    0.00135   -0.03315   -0.01954   -0.02383    0.01464   -0.02639
       H                 0.00041    0.00094   -0.00086    0.00388   -0.02581   -0.02287   -0.01037    0.00105   -0.05283
       H                -0.00042    0.00118    0.00104   -0.00240   -0.02995   -0.00908   -0.03368    0.02613    0.00011
       N                 0.00014    0.00002    0.00023   -0.03390    0.02444    0.03800   -0.04130   -0.04285    0.03706
       N                -0.00006   -0.00038   -0.00027    0.00230   -0.05350   -0.03451   -0.03533    0.01964   -0.02788
       N                -0.00001    0.00006    0.00026   -0.00914    0.02455   -0.06296    0.01534   -0.01173    0.03423
       C                 0.00000   -0.00002   -0.00006   -0.01172    0.02190   -0.07140    0.01930   -0.01624    0.05644
       H                -0.00016   -0.00004    0.00014   -0.01901    0.02846   -0.09408    0.02310   -0.02054    0.07111
       H                 0.00006    0.00010   -0.00018   -0.00982   -0.00154   -0.06918    0.00800   -0.00487    0.06336
       H                -0.00015   -0.00017   -0.00022   -0.00841    0.03739   -0.05827    0.03021   -0.02742    0.05303
       C                -0.00010   -0.00014   -0.00004   -0.01946    0.02234   -0.09310    0.01234   -0.00677    0.04194
       H                 0.00006    0.00000   -0.00006   -0.02480    0.02949   -0.11322    0.01574   -0.01240    0.05704
       H                -0.00003   -0.00017   -0.00023   -0.01665    0.03967   -0.09418    0.01550   -0.01189    0.03199
       H                -0.00017   -0.00025   -0.00010   -0.02539   -0.00316   -0.09645    0.00368    0.00757    0.04310
       C                 0.00010    0.00005    0.00016   -0.04834    0.02499    0.03507   -0.03082   -0.03624    0.02630
       H                 0.00007    0.00010    0.00015   -0.06030    0.02845    0.04588   -0.05179   -0.04772    0.04597
       H                 0.00011    0.00006    0.00016   -0.05537    0.02203    0.02010   -0.03865   -0.01091   -0.00188
       H                 0.00010    0.00002    0.00012   -0.04102    0.02494    0.03747    0.00641   -0.04589    0.02708
       C                 0.00012    0.00001    0.00018   -0.04480    0.02692    0.04832   -0.09749   -0.04976    0.06193
       H                 0.00015   -0.00001    0.00014   -0.05740    0.02969    0.05770   -0.11305   -0.06138    0.08072
       H                 0.00008    0.00000    0.00013   -0.03432    0.02606    0.05918   -0.09583   -0.07054    0.08685
       H                 0.00017   -0.00001    0.00024   -0.05163    0.02721    0.03702   -0.12873   -0.02357    0.03957
       C                -0.00008    0.00022   -0.00028   -0.00096   -0.07141   -0.03469   -0.05278    0.03486   -0.01386
       H                -0.00040    0.00038   -0.00037   -0.00786   -0.07907   -0.01569   -0.06534    0.04055   -0.01890
       H                 0.00022   -0.00002   -0.00015   -0.00006   -0.08790   -0.04806   -0.06057    0.03851   -0.01654
       H                 0.00018    0.00079   -0.00044    0.00272   -0.06183   -0.04115   -0.04640    0.03781    0.00531
       C                 0.00005    0.00020   -0.00007    0.00241   -0.07070   -0.04402   -0.03747    0.01473   -0.04821
       H                -0.00021    0.00053   -0.00016    0.01189   -0.06010   -0.05511   -0.02274    0.00724   -0.05198
       H                -0.00023    0.00007   -0.00014    0.00373   -0.08806   -0.05602   -0.04755    0.01933   -0.04739
       H                 0.00027    0.00034    0.00015   -0.00817   -0.07804   -0.02935   -0.04385    0.01364   -0.06140
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(4-(N,N'-dimethylamino)phenyl)arsine)のある1つの遷移状態構造を算出する手順を説明した。




## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.


