---
title:  【計算化学】自作pythonモジュールで遷移状態構造を求めてみる(SN2反応（基質-fluoromethane, 求核剤-2,4-pentanedione）, NNP使用）
published: 2025-08-19
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-08-19

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作モジュール(MultiOptPy)で、SN2反応（基質-fluoromethane, 求核剤-2,4-pentanedione）の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonモジュールである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

SN2反応について：
- https://en.wikipedia.org/wiki/SN2_reaction

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)



## 使用した自作モジュールMultiOptPyのバージョン
```
v1.12c
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.12c.zip
unzip v1.12c.zip
cd MultiOptPy-v1.12c
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作モジュールへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.12c`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.12c`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作モジュールでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`sn2_F_beta_diketone.xyz`とした。
初期構造は以下のものを使用した。

```
19
OptimizedStructure
C     -0.282463638213     -0.583087831700     -0.079688385275
C      1.204661278836     -0.734136623173      0.032764442014
H     -0.751547770457     -0.771558301047     -1.037557519103
C     -1.010959032335      0.256630751822      0.920525635567
C      1.757319002131     -2.018078708610      0.598990909008
C     -0.117650151839      2.267698564466     -2.438289910594
F      0.162346665323      3.107757551912     -3.510366286145
H      1.794080270505     -1.912061804054      1.686687553635
H      1.117010107348     -2.868879677761      0.370740760312
H      2.770309566588     -2.184692839991      0.235865458563
C     -1.597202775974     -0.451546903274      2.113345990371
H     -2.564020178088     -0.866110008425      1.811966750954
H     -0.969083127790     -1.288189074646      2.421256214454
H     -1.745973019798      0.253860886286      2.927714096837
O      1.917764787138      0.181937925057     -0.296015079067
O     -1.121335294765      1.445635561165      0.745940983336
H      0.288844574542      1.280688415265     -2.657815674425
H      0.346617405212      2.661691261240     -1.537087733568
H     -1.198718668362      2.222440855467     -2.308978206875


```

<MoleculeViewer 
  xyzData={`19
OptimizedStructure
C     -0.282463638213     -0.583087831700     -0.079688385275
C      1.204661278836     -0.734136623173      0.032764442014
H     -0.751547770457     -0.771558301047     -1.037557519103
C     -1.010959032335      0.256630751822      0.920525635567
C      1.757319002131     -2.018078708610      0.598990909008
C     -0.117650151839      2.267698564466     -2.438289910594
F      0.162346665323      3.107757551912     -3.510366286145
H      1.794080270505     -1.912061804054      1.686687553635
H      1.117010107348     -2.868879677761      0.370740760312
H      2.770309566588     -2.184692839991      0.235865458563
C     -1.597202775974     -0.451546903274      2.113345990371
H     -2.564020178088     -0.866110008425      1.811966750954
H     -0.969083127790     -1.288189074646      2.421256214454
H     -1.745973019798      0.253860886286      2.927714096837
O      1.917764787138      0.181937925057     -0.296015079067
O     -1.121335294765      1.445635561165      0.745940983336
H      0.288844574542      1.280688415265     -2.657815674425
H      0.346617405212      2.661691261240     -1.537087733568
H     -1.198718668362      2.222440855467     -2.308978206875
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`sn2_F_beta_diketone.xyz`として保存し、以下を実行する。
```
python .\optmain.py sn2_F_beta_diketone.xyz -opt rsirfo_fsb -os uma-s-1p1 -ma 300 1 6 -elec -1   
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。

これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`sn2_F_beta_diketone_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.12c`ディレクトリに置く。

`sn2_F_beta_diketone_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`sn2_F_beta_diketone_traj.xyz`は次のNEB計算に使用する。

※`sn2_F_beta_diketone_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`sn2_F_beta_diketone_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `sn2_F_beta_diketone_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`sn2_F_beta_diketone_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py sn2_F_beta_diketone_traj.xyz -os uma-s-1p1 -ns 20 -modelhess -spng -nd 0.12 -elec -1
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.12c`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-484.9052808080566,-484.9052808080566,-484.90949236328174,-484.9030799367806,-484.9027604418292,-484.9002557404583,-484.8962335883863,-484.8911546438888,-484.885727002729,-484.8805848993874,-484.8750337552412,-484.8713873735401,-484.86605392742,-484.8644965145231,-484.8616461217592,-484.862357117651,-484.86421187697147,-484.86601366732583,-484.86736306389497,-484.86805983075675,-484.8688727911417,-484.86916050843723,-484.87001469270535,-484.8708759082522,-484.87243278668427,-484.8735343142514,-484.879609864743,-484.87763383448373,-484.89014010046753,-484.90733660937735,-484.91439285896405,-484.9210905796793,-484.9338401250865,-484.94107801932495,-484.9474212928716,-484.95187366063016,-484.95524412268907,-484.9579233049121,-484.9602668366709,-484.9614725191606,-484.9626692690789,-484.9638695499695,-484.96455441403737,-484.965235620088,-484.9658438278851,-484.96637683385677,-484.96713981740226,-484.9676392046619,-484.9678961814698,-484.96814532530186,-484.96864951836386,-484.96897887134327,-484.96923466093835,-484.96946492764897,-484.96980301606123,-484.9702064055577,-484.97057602301214,-484.9708253858871,-484.9715185166359,-484.97209650088683,-484.97259671612886,-484.9730350736418,-484.97346563760664,-484.9738863271153,-484.97419411312586,-484.9744250588696,-484.97475597581564,-484.9751526801213,-484.97565351744527,-484.9761453433423,-484.97650907730315,-484.9768445853894,-484.9771956937146,-484.9774493410697,-484.9777718730516,-484.9783546499623,-484.97867363344847,-484.97895302711186,-484.9792875319814,-484.9795958042674,-484.97984710348203,-484.98023959778214,-484.9806312597191,-484.98107145281193,-484.9814354934329,-484.9820835670469,-484.98174671841775,-484.9826924976858,-484.9833097388142,-484.98391247491844,-484.9844118577973,-484.9849681392727,-484.9854723936667,-484.9860161809323,-484.98657162128285,-484.9875759069228,-484.98839682732853,-484.98900737012355,-484.99015873872344,-484.9914452962512,-484.99324707346295,-484.9938376307792,-484.99493002863613,-484.9958310837147,-484.99680545684936,-484.99754293065297,-484.9985169883658,-484.99951541241643,-485.0009612711198,-485.002166909801,-485.00355065668555,-485.00453298546023,-485.0055498967358,-485.0064183845085,-485.0070455219974,-485.0076479426798,-485.0084072944932,-485.00902466266655,-485.00917766854786,-485.0094981196218,-485.00986524436746,-485.0101339487349,-485.01039635342715,-485.0107242782465,-485.01109304143347,-485.0115565801239,-485.01194971841034,-485.0121841556987,-485.01242525189275,-485.01266668979383,-485.0128736853814,-485.0130681429506
];

export const dataset_itr5 = [-484.9294759089727,-484.9138863916886,-484.9150068325192,-484.9113765751173,-484.9103939517299,-484.90862031496584,-484.9061519385825,-484.90303463760335,-484.89945082990175,-484.8957956054368,-484.8913296701579,-484.8879323118152,-484.88314442939907,-484.88127935753647,-484.87901130359734,-484.88151655038513,-484.8863607202681,-484.8882190850356,-484.88724815744644,-484.8860516528563,-484.88378043374655,-484.88148450002075,-484.8835550955023,-484.8900508645602,-484.8965876691243,-484.90167331195516,-484.90814745709304,-484.9109265842332,-484.9166387928509,-484.92469559312144,-484.9356259494002,-484.9404136511059,-484.9456444055102,-484.94971250184096,-484.9542707418189,-484.9596297064426,-484.96261584888424,-484.9646980317379,-484.965426292595,-484.96680165889626,-484.96812901536384,-484.9690733007589,-484.9696545093221,-484.96975664028787,-484.9701887331725,-484.9712194003453,-484.97192738658697,-484.9722997552209,-484.9728247486014,-484.9730825709151,-484.97330521055017,-484.97383424308265,-484.97400694092516,-484.9741561748869,-484.9745911547576,-484.97505517534256,-484.97558492633596,-484.97604369865184,-484.97653205490855,-484.97711339051665,-484.97761014488003,-484.9780457117858,-484.9784672336577,-484.97886295227,-484.9791986093055,-484.979544333555,-484.9799292226839,-484.98030680015916,-484.9806852976148,-484.9810484445405,-484.98141169222595,-484.9818734216217,-484.9822561071785,-484.9825522882936,-484.98301826274167,-484.98349964467087,-484.98369713817533,-484.98409290059624,-484.9844813119358,-484.984923174136,-484.98531423151434,-484.98579034327014,-484.9862701918987,-484.9867708890352,-484.9871721581959,-484.9880082319929,-484.98842078186556,-484.98873864823264,-484.98913805114745,-484.9897727762841,-484.99036891043386,-484.9909998680318,-484.9917958963967,-484.9923461147633,-484.99300570565566,-484.9937619864869,-484.994701891023,-484.9950824124355,-484.9974787072601,-484.99816578366176,-484.99988005759593,-485.00057052478246,-485.00213504343265,-485.0023856198056,-485.0037379734546,-485.00405682989583,-485.00502042611737,-485.0060944637943,-485.0076106440463,-485.0086970620307,-485.00950512023445,-485.010171913259,-485.01125826114964,-485.0118227611166,-485.012142204593,-485.0129532505425,-485.01342479744324,-485.0138741859592,-485.013959043198,-485.0139879743908,-485.0139011720506,-485.01448320421525,-485.0150974269318,-485.0153663678656,-485.0158848688131,-485.01616327240237,-485.01645530922485,-485.0162531588673,-485.016814898893,-485.01726029206554,-485.0168785264891,-485.0176650396283
];

export const dataset1_itr10 = [-484.9476487908793,-484.9219292641132,-484.92237632064314,-484.91860325298774,-484.91915035505764,-484.9182076411588,-484.91660274988106,-484.9141940457258,-484.9110273527519,-484.9080175788616,-484.90465316019765,-484.9016676190289,-484.89804289848513,-484.8962605613351,-484.89597315727104,-484.89987698234154,-484.9019304683783,-484.9050659192563,-484.901624896892,-484.899787551486,-484.8956843622842,-484.8887027165358,-484.9004392546417,-484.9141776054572,-484.9223896433829,-484.92746528580795,-484.9314551690202,-484.93513782751944,-484.93564281899296,-484.93705204823914,-484.9477655035343,-484.95028196751156,-484.9546280337266,-484.95671187911614,-484.9588233786782,-484.963216644268,-484.96520519064137,-484.9670275754139,-484.96782774807144,-484.9685553211337,-484.96925115049163,-484.97009212646986,-484.9706643411295,-484.97117635840567,-484.9717464352061,-484.972139091598,-484.9727899426766,-484.97323821845436,-484.9736971484812,-484.9739468399206,-484.97430620178415,-484.9747653727582,-484.9750293896065,-484.97529566259726,-484.9757372619459,-484.9761556427418,-484.9766188222019,-484.97704376990544,-484.9774319271552,-484.9779387312091,-484.9783747581051,-484.9787757118439,-484.97916609457,-484.9795366407666,-484.9798728454095,-484.98023101567935,-484.98061879179437,-484.9809933815238,-484.98138214333204,-484.9817581042703,-484.9821578970815,-484.98262154091265,-484.98311638084067,-484.9835869201438,-484.98411024003616,-484.9846066570734,-484.985061276335,-484.98555101256227,-484.9860386635007,-484.98651402174875,-484.9869676202702,-484.9875259037982,-484.98804174556426,-484.988497849937,-484.988951461601,-484.98967854838793,-484.9903892639048,-484.9906835612505,-484.9911331688093,-484.9918044872612,-484.99249597956873,-484.9933056280243,-484.994290440746,-484.9950389805994,-484.995941244795,-484.99702586662727,-484.9979860633022,-484.9993489835831,-485.00061399166543,-485.00137204674456,-485.0031448577167,-485.0039829248045,-485.0053451967183,-485.0057425844379,-485.00708980372013,-485.0074974338881,-485.00865491816717,-485.00934546420916,-485.00958378293865,-485.0106168157753,-485.0110466831835,-485.0115346670672,-485.01261354121243,-485.0128409954116,-485.0133173875424,-485.01376558446464,-485.0141846311512,-485.01455741596664,-485.0145927344519,-485.0150471083854,-485.01473144120945,-485.0156160242582,-485.0160297262967,-485.0163163659009,-485.01669618637595,-485.01694635970983,-485.01721954131517,-485.0167651849051,-485.01747486653926,-485.01754953389997,-485.01723083516964,-485.01779308337507
];

export const dataset1_itr15 = [-484.96219629839896,-484.9298662446045,-484.9288340868444,-484.92636748854227,-484.92764545903873,-484.92800281282604,-484.92676332762824,-484.9240661162538,-484.92101578762237,-484.9175709410761,-484.9147427050542,-484.911247147019,-484.90774867735547,-484.9064479017499,-484.90622284388064,-484.91217660484926,-484.9128017780705,-484.91428651415947,-484.90984117384636,-484.9090593493215,-484.90590311017235,-484.89665096815594,-484.9211196442616,-484.93524052252087,-484.9388915030287,-484.94343990031166,-484.9469780550817,-484.9475632896543,-484.9473636582906,-484.9470365526919,-484.9542938179937,-484.95509867159905,-484.95985855813575,-484.961154512606,-484.9619117922731,-484.96563280190725,-484.9665770215895,-484.9684445116862,-484.9690639213398,-484.96942978001726,-484.9699869595688,-484.97085130742977,-484.9713339904741,-484.9719023499778,-484.9724744507351,-484.97263502235995,-484.9733989609327,-484.973864711957,-484.9742417243014,-484.9744436468543,-484.97498164700517,-484.97537010653417,-484.97569812773247,-484.97601451775006,-484.9764350451669,-484.9768406338546,-484.97728155855094,-484.9776866565824,-484.9779312311785,-484.97850179425427,-484.97889507272816,-484.97926125997003,-484.9796192637673,-484.9799624514994,-484.98029406500206,-484.98065556910564,-484.98103735220553,-484.98140803858956,-484.98180427414326,-484.98219419687916,-484.98262101520953,-484.9831058273513,-484.9836983078647,-484.9843178445632,-484.98486189029944,-484.9853571551708,-484.98598623338023,-484.9865318562257,-484.9871086532639,-484.9876178667903,-484.9881488707093,-484.98874016839073,-484.98930241659616,-484.9897986846842,-484.9903329348198,-484.9908552252103,-484.9917766337597,-484.9922133572123,-484.99274344553174,-484.9934586689525,-484.9942238998787,-484.9951528128396,-484.9962201478022,-484.9970688253306,-484.99808085632924,-484.9992369299717,-485.00026763219137,-485.0016396120887,-485.0028515679685,-485.00378476102867,-485.0053758364461,-485.00629277651933,-485.007540033361,-485.00807917691606,-485.00919987074127,-485.00971238743534,-485.01057977999335,-485.010903376524,-485.0110496972145,-485.0119656296902,-485.0122328883742,-485.01230712641075,-485.01338942638773,-485.0135390502459,-485.01401921867716,-485.0142597278361,-485.0146753837377,-485.01498143054727,-485.0147614939022,-485.01559249904534,-485.0148606677882,-485.016153310329,-485.0164637642827,-485.01676179412027,-485.0170599729071,-485.0172825731144,-485.0174800359529,-485.01687196396233,-485.01764281114976,-485.0176543415706,-485.0173104090925,-485.0181027137273
];

export const dataset2 = [-484.97444584166465,-484.9360188752149,-484.9347345070215,-484.9331922595632,-484.9354104680887,-484.9371109105558,-484.9353120258062,-484.9331214473584,-484.9303880509101,-484.92664844617235,-484.9233842974306,-484.91965505328744,-484.9155625406498,-484.9146317959422,-484.9141154208066,-484.918262485954,-484.91940517757814,-484.92166614623085,-484.9160518563146,-484.91636834983,-484.9135108573365,-484.90688868844916,-484.9402337620833,-484.94712619163823,-484.94858115157626,-484.95168326411726,-484.9550467934668,-484.9547896545671,-484.9552938782951,-484.9546531623338,-484.9589379644261,-484.9592260321903,-484.96328073185424,-484.96384669064724,-484.964281915846,-484.96745175646714,-484.96807599820823,-484.96953404884226,-484.96981818697594,-484.9699847384733,-484.9707148392912,-484.97157060066854,-484.9718299957106,-484.9725380958546,-484.97304018172343,-484.97321054894894,-484.97395306074037,-484.9744085517929,-484.97465342866826,-484.9748177152615,-484.9755567793169,-484.97587484720356,-484.97627354041913,-484.9766133592707,-484.97701742780026,-484.9773873387723,-484.97783392791933,-484.9781673638593,-484.9782826593064,-484.9789823701054,-484.9793446978105,-484.9796857871112,-484.9800170895728,-484.9803361781996,-484.98067394680913,-484.98104301227534,-484.9814062161522,-484.9817745368724,-484.98217748828296,-484.98258244174605,-484.9830394792418,-484.9835705663972,-484.9842450697335,-484.98496274205445,-484.98554476545735,-484.9860040459529,-484.986789722348,-484.9874047905704,-484.9880319893913,-484.98857555323303,-484.98917343534555,-484.98977104146394,-484.99038557960233,-484.99091810367946,-484.99150259788684,-484.9917482063657,-484.9929950645491,-484.9935599806977,-484.99409337218486,-484.99493113261263,-484.9957733527548,-484.99678543632376,-484.99791929901113,-484.99884801483336,-484.9999357733606,-485.00112132142243,-485.00224554622,-485.0036138812426,-485.0048176712013,-485.0058516503035,-485.0073103974941,-485.0082289760086,-485.00932875561296,-485.0099458258879,-485.01080614773946,-485.01133646824445,-485.01186802415174,-485.01180507120796,-485.01188155224435,-485.0128748682134,-485.01298213792677,-485.0131243844184,-485.01400530506896,-485.0140807346992,-485.01459217370194,-485.01467180019506,-485.0151588640984,-485.0154400626757,-485.0147786405843,-485.01601066956005,-485.014898080324,-485.0165387295419,-485.01676231106165,-485.01707247587865,-485.01728156551684,-485.01741679387237,-485.01757207780037,-485.01690650265465,-485.01772008950246,-485.0177286321775,-485.01733950675793,-485.01817296518215
];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.013678617569381204,0.013678616670837133,0.008411524598684429,0.013081470173218937,0.011054385549360045,0.010929363379046594,0.011677448847687882,0.012633351304517147,0.013404752351680047,0.013680448314675539,0.013914348177610569,0.013478382337239268,0.013606120002897792,0.013463600211337447,0.013957575224321336,0.013888004065283904,0.013512873969237414,0.012932598379692357,0.012014557433617123,0.011323055899396231,0.010856061755240648,0.01126581328579269,0.012440209446826103,0.01470726326779628,0.017431588375321088,0.019755550382740444,0.02021439200290856,0.02214658484369645,0.018773245068351225,0.016781195005419525,0.01984091084079748,0.01932979622761843,0.014123201167025434,0.013873246834520937,0.009889800321795093,0.011321845223020828,0.012239878526254003,0.011857542656004095,0.010718292787127088,0.011090117022060957,0.011022038321672025,0.010824861167111326,0.011003170194687271,0.010811861526019225,0.010723531902696476,0.010980192305205744,0.010743023257710642,0.01071254496433769,0.011026136389977317,0.011192572808766121,0.010787422104650625,0.010712744730000265,0.010827919972513582,0.01078829639618129,0.010731449411604206,0.010747725667796295,0.010786476229812752,0.010948569021938344,0.011034537244645674,0.011142011336583083,0.011206599602390399,0.0112154896528271,0.011191077124060464,0.01112938477350275,0.011140504315541207,0.01123682598154798,0.011278556476490266,0.011246314370632352,0.011263357619863537,0.011269098391033948,0.011321958675360322,0.011311050996464829,0.011237876241029182,0.011201541174700225,0.011104603927091,0.010852195498995913,0.010760003555723345,0.010723354897101684,0.010687475798228664,0.01074608904160133,0.010871944945220424,0.010982291952149444,0.01111659989811555,0.011174768681739954,0.011267579814407791,0.01148213504211184,0.012142666378547974,0.011541411265004535,0.011216087006655924,0.010970046878116353,0.010854082557671193,0.01071883081746428,0.010911086933203598,0.010938009573846155,0.010880903514839406,0.010905429930249089,0.011390351347940988,0.011948008819318925,0.011855132578724347,0.011701824269886035,0.01152376757172202,0.012564789974848388,0.012034589474866884,0.011680416083213931,0.011588793688151347,0.011784207024834832,0.011753993698027002,0.011556253409373772,0.01119693467377935,0.011057557348079942,0.011218231675068979,0.011307905942184582,0.011353123974940711,0.011013899125730075,0.01085184435145783,0.010975966496947391,0.011023723338944892,0.01085247342521728,0.010873764214759841,0.010883638454382604,0.010783659766843628,0.010765950125624271,0.010867717068626373,0.01098939802684069,0.011066822669363787,0.01103403468686995,0.010906540248844354,0.010883692435080314,0.010796939020940593,0.01077660123523602,0.010827333770364505,0.010775433018648091
];

export const dataset1_grad_itr5 = [0.006409950891505589,0.0077163656387727,0.007055530367624826,0.009369126174729344,0.009420011457806939,0.009558845357723441,0.009888317882928759,0.010286786024293386,0.010674928940436597,0.010926197048100633,0.011358338202634512,0.011420722600862913,0.011789971694187135,0.01171226703014589,0.011900704379227382,0.011470721515486872,0.010437003330099113,0.009832764849432319,0.009773659513645401,0.00912252230834703,0.00806437931853543,0.006910572060633882,0.008372952956541942,0.011662780042365307,0.012972119166401987,0.013767479374785254,0.013079502089964756,0.014119906226447322,0.01284016957980786,0.011189370276065445,0.010605496354716432,0.009339493788648505,0.0098245728018924,0.00959154370861798,0.0063955003104630495,0.00410086778693494,0.003818035774280811,0.0032655008094433567,0.00448341948841932,0.003687791057211823,0.002040400086470973,0.0016652676845151915,0.0021419704629174834,0.003960246412337324,0.0043205460123821125,0.002566922487410873,0.0020917582173674543,0.0022889834672278216,0.0017856803151931112,0.002381322125211531,0.0029891530783298314,0.0019629569695565055,0.0026690919574840146,0.0033695377967609126,0.003330023033352203,0.003338700231721291,0.0029337468938017267,0.0026511780829490553,0.002735108458115619,0.002521715923045367,0.002466842969809458,0.0024758953954863204,0.002444241590438737,0.0024227158190493676,0.002596892184596904,0.002734210289226831,0.0027433009054742418,0.002763687766722267,0.0028769743598713185,0.0030489302310011185,0.0031403805243498065,0.002771769204615737,0.0028447247947620833,0.0031956632819883017,0.0027303806034229073,0.002469451304905272,0.0033705236587274006,0.0032469381580610425,0.0032211064452901746,0.0029983669142709117,0.0029081152633663432,0.0028620507078866955,0.0028992080161091907,0.0025885272511682544,0.002621369491597584,0.0024825345947495966,0.003156400143626965,0.003136859666702893,0.0028774618293755908,0.0022719094506133703,0.002059616210889166,0.0022812479350168197,0.002418404174162415,0.0031911920110297646,0.0035021584517633533,0.004442731801207157,0.005089595594429116,0.006871674724465507,0.0036511645601699258,0.0048925175844047875,0.004107075283009726,0.005410402711117803,0.0038856550706129448,0.005389379576142691,0.004282178239230474,0.0054501875824990095,0.005521304104157008,0.005109730111565836,0.0034323948774915014,0.0026011795309220367,0.0021460770102033817,0.0027725898293602235,0.002246219036329601,0.002212184582346864,0.003098321473957614,0.00152514875544674,0.0017197333535073787,0.0013080693383044108,0.0018378236278032015,0.003300525712129106,0.004389308665937043,0.0037523016963382583,0.0027562875133891594,0.003410159417767703,0.002951871662208282,0.003137915010029243,0.0030400705305421256,0.003831576320595234,0.002794006848114186,0.0013301534033989533,0.0029184947506493107,0.0018971450983858529
];

export const dataset1_grad_itr10 = [0.0061453696553539815,0.005456044321964139,0.0059845706539102175,0.00789189949015276,0.008246587956123508,0.008603932428581526,0.008922319343976795,0.00921014134746293,0.009430059964887261,0.009495716343171118,0.00971039448066781,0.009735770096861157,0.00992646755325979,0.010043007959812965,0.009785907046691356,0.008455096945904893,0.007923625773146667,0.007274964946692998,0.008165703242192434,0.008138888120908148,0.008211441947203045,0.00580996538319086,0.010479909793683004,0.011539437688415097,0.010750413640073186,0.010323390070980673,0.010084998357877427,0.008094973723935767,0.008451242113272927,0.007779193338046176,0.0061970774330741525,0.005675611368190603,0.005885655714970184,0.006776785869919123,0.005076485193754379,0.0029015865686535807,0.0025054178332519507,0.0017528142081916485,0.0023148289816383788,0.0020422179734071863,0.001366452648997277,0.0009539294324147958,0.0014072275586926304,0.0016735986768056368,0.0015896972427625411,0.0012017425543915015,0.0009798257393707278,0.001294608200352965,0.0009267148914364387,0.0012655414245722584,0.00186780601650348,0.000907780953587753,0.0015268011457265896,0.002081440031263729,0.0018888219948447165,0.0020586685937851023,0.0018731641938010749,0.0016698925734497045,0.0016045090077165954,0.0015382280643700672,0.0014932923905279654,0.001453931347576163,0.0013896244708474059,0.0013434767557938898,0.001465854557137511,0.0015618085756645196,0.0015219344400108688,0.0015056837681210295,0.001520890006990257,0.0016990273756880545,0.001770067383909342,0.0015399262999011888,0.001497127306344675,0.0018813419294214152,0.0014425418921854313,0.0013349102591476288,0.0019976597342912586,0.0019482826287447234,0.0018808763272009864,0.0017999956034277724,0.0018044943559823753,0.0015469990378057833,0.001608319900827827,0.0016579592943641369,0.0016302614734961137,0.0015406947073503118,0.0018043682925493179,0.001926400559535656,0.0017392066278817352,0.0014050446332399913,0.0014160610929080954,0.0015479238477938313,0.0014989371443844893,0.002178909233257286,0.0019780032296530434,0.0023476252979406846,0.003200173348210113,0.0024100731153685437,0.0018497052958309796,0.003615734537665417,0.001999402454337076,0.0033810643346364644,0.0021996650096765234,0.003963266428489904,0.0021434860648807783,0.0036756772532916594,0.0023316654870807097,0.002256892783207066,0.0018863991175383855,0.0015533471396099506,0.0013819731658819042,0.001730555151072284,0.0010696889694170057,0.0011630714616807155,0.0015417443873069604,0.0011012664890004476,0.0008041496038643657,0.0006797622457011991,0.0008450649381710422,0.001146053968492915,0.0018184561887576202,0.0016457364005786786,0.0009924259893606471,0.0015889277729730124,0.0010640779311289544,0.001339765192070279,0.0008064946267981497,0.001707704672736001,0.0008253669026978619,0.0003801311864384811,0.0010899446697144545,0.0012608568742133869
];

export const dataset1_grad_itr15 = [0.005806330085323461,0.0043441235701585,0.005311182087955182,0.006728561112886939,0.007202586396541669,0.00759399355980898,0.008045699708842904,0.00826990037502782,0.008468348758951501,0.008532434478738117,0.00872605404578327,0.008818566972382631,0.008797785403554803,0.008944498469683097,0.00862087281647609,0.0055471581666507895,0.005787779780530918,0.005856779221926007,0.006549580559448877,0.006610778088682623,0.007082694205409849,0.0071941678448437,0.011077866262008348,0.008377243656957058,0.007608115579041289,0.006499683906638395,0.006884784082273988,0.0060667927072048525,0.005868911411176406,0.005903143876164621,0.004663493074283475,0.0046551478784342985,0.003944290795014876,0.0046934623943406095,0.003792430612325686,0.0023686207895779725,0.002045563840010657,0.001495824614568127,0.0016615926132138102,0.0014659452708847493,0.001109328909658726,0.000917427210472175,0.0011633058359000036,0.0010977925368256718,0.0007632481651933734,0.0009586167638806779,0.0007606863013757506,0.0009219107185574159,0.0007345977370753669,0.0008655248415661151,0.001409752783694146,0.0007266247010677521,0.001186489124388558,0.0015956698996270917,0.0014613809284180087,0.0016020794526341046,0.001428977363053356,0.00127659650798599,0.0011252553953987967,0.0010910992184849314,0.0010574948456969976,0.00101739031554481,0.0009499759120922164,0.0009024112352296123,0.0010026907838647885,0.001092357787651335,0.001018280546952298,0.0009862168962053925,0.0009420492482576944,0.00114072094654784,0.0011893002741941165,0.001036182538992281,0.0009628584058112092,0.0012416263517816125,0.0010060206763076276,0.0009095150385032562,0.0011580023367006053,0.0013168889671172014,0.0011236677573626419,0.0011633182828323999,0.0011978576403480626,0.00101459168003663,0.0011197005583933439,0.0011712936973807772,0.0011273664293577092,0.0012746244248078673,0.0012573545181815617,0.0014275706831080957,0.0013191389468400084,0.0011732430847549184,0.0012706997158865357,0.0012864836365589097,0.0012314546816017374,0.0018819690271463174,0.0016154185223201634,0.0016425744271779388,0.0025833817483640964,0.0014988576973939635,0.001532113637211098,0.0029181833512878144,0.0016712724158105586,0.002763995179020453,0.0018119509072279856,0.0032120796345346324,0.001721318782828136,0.0027704095728964613,0.001727409809546947,0.0017433573304193844,0.0014709678641557193,0.001310121733074846,0.0011758111983154159,0.0012281978006386755,0.0007879655700247526,0.0008581661732000278,0.0010590997521590891,0.0009710203890249424,0.0006470832948594186,0.0006048428325363297,0.0005879721964748415,0.0006802949214295431,0.0011216436553064917,0.0009690763190103776,0.0006671359442443619,0.0009362913308569174,0.0006163443759274725,0.0006961066687322707,0.00040912467391429494,0.0010147957154257878,0.00039701383999445587,0.0003672003579943486,0.0006088608813320308,0.0010519359983583916
];

export const dataset2_grad = [0.005074732169484689,0.004073777755040525,0.0047529334487787485,0.005827001337429638,0.006278492757629958,0.006626881625907052,0.007048521872968882,0.007333445658805493,0.007529323507863509,0.00747362922513761,0.007888039771301444,0.007826294098520477,0.007775005791787658,0.008076668119511202,0.00774162059949488,0.004797906529180463,0.004959826346994825,0.004994041859101546,0.005729690995726782,0.005787870677721465,0.006018400953506268,0.006944702696225183,0.008119337344076397,0.006182267983395497,0.0058599332445492605,0.005025313477059382,0.005473811192519937,0.004707293791747938,0.004136357024691961,0.0043618115929777304,0.00376970410190342,0.0038455902378939305,0.002891095937523156,0.003051531988528625,0.002741747667857931,0.0019586142478216074,0.0015262017539827192,0.0012612789180724145,0.001260357942053346,0.0012025252126404225,0.0010089612055009629,0.0008645703605959155,0.0008272835938663743,0.0008253614540293869,0.0005817684854878993,0.0007869184254040325,0.0007170518252376769,0.0007882173998797718,0.0005806250761187092,0.0007247791353306772,0.001101411961622647,0.0006188654002122704,0.0009677805813968966,0.001265000395068228,0.0012018486283373105,0.001305452689261094,0.0011378341432993861,0.0010499245363808061,0.0008050149838466621,0.0008117069219806983,0.0007829951922234242,0.0007596748761796812,0.000703904405626809,0.0006672577824157169,0.0007437455940510947,0.0008185285538650478,0.0007314519430581059,0.0006927976524319246,0.0006438958831989125,0.0008081828059785662,0.0008483280755017821,0.0007668031880044149,0.0007303782349512684,0.0009318365854314903,0.0008349237736133281,0.0007227438042489917,0.0008178441670527093,0.0009751402995383329,0.0008269359744324956,0.0009026306951533467,0.0008769112601119143,0.0008876412543472839,0.0009403344589285972,0.000978188910499857,0.001000761340860313,0.0011656412802302446,0.0011142341594813415,0.0011863343962544423,0.0011259370529179248,0.0010746921467334393,0.001252151385571861,0.0011851404567341185,0.00115922251077201,0.0017579905330868885,0.0015430133225533492,0.0012856635078396282,0.0022371731940542205,0.001292884594430882,0.0013839653319578252,0.0024695979600149283,0.0014729185148329275,0.0023458108233220818,0.0016080051550764623,0.00242206495360461,0.0014171736577725494,0.0019322349140503297,0.001345865531421918,0.0014354562255795619,0.001252768878871477,0.0011842474317948107,0.000987076246736324,0.0009999841176297083,0.0007431736794699675,0.0007679790666500915,0.000881712341776832,0.0007985829759686667,0.0006420284711433573,0.0005951327298234512,0.00047188471116969686,0.0006410326325558571,0.0010165303893163499,0.0006995286163847228,0.0005742837636131961,0.0005845535421445246,0.00045068445915832103,0.0004855543852897671,0.0003785015273946187,0.0008537628291394283,0.0004203425559451703,0.0003149281730675436,0.0004788167577207497,0.001016350135818557
];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、ITR. 5の経路の21番(グラフ上では22番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`sn2_F_beta_diketone_traj_21_itr5.xyz`
```
19
-1 1
C      -0.144839067937      0.177691186159     -0.418092774277
C       1.188982868038     -0.469265092026     -0.110885079199
H      -0.733613403309     -0.422771831059     -1.135270173156
C      -1.055562568294      0.493861501521      0.705973200009
C       1.538493317060     -1.897690551181      0.494554143052
C      -0.092440591590      1.695171801365     -1.927326779791
F       0.091619925511      2.799502808613     -3.231754844004
H       1.621180615503     -1.820266560260      1.591044407996
H       1.008126071681     -2.847201163098      0.303172229273
H       2.579267593811     -2.081278058319      0.191399982679
C      -1.408217616289     -0.406781466030      1.915606610713
H      -2.405223044634     -0.829070758838      1.709778099521
H      -0.774212880579     -1.222731185232      2.285332603123
H      -1.564669164699      0.268672578139      2.763662306603
O       2.201766854900      0.172432801645     -0.306395796734
O      -1.709001942371      1.525856772657      0.694516340093
H       0.405372282125      0.903954108989     -2.463039222738
H       0.430515822413      2.264483583580     -1.175579018024
H      -1.177545071340      1.695429523374     -1.886696235140

```


<MoleculeViewer 
  xyzData={`19
-1 1
C      -0.144839067937      0.177691186159     -0.418092774277
C       1.188982868038     -0.469265092026     -0.110885079199
H      -0.733613403309     -0.422771831059     -1.135270173156
C      -1.055562568294      0.493861501521      0.705973200009
C       1.538493317060     -1.897690551181      0.494554143052
C      -0.092440591590      1.695171801365     -1.927326779791
F       0.091619925511      2.799502808613     -3.231754844004
H       1.621180615503     -1.820266560260      1.591044407996
H       1.008126071681     -2.847201163098      0.303172229273
H       2.579267593811     -2.081278058319      0.191399982679
C      -1.408217616289     -0.406781466030      1.915606610713
H      -2.405223044634     -0.829070758838      1.709778099521
H      -0.774212880579     -1.222731185232      2.285332603123
H      -1.564669164699      0.268672578139      2.763662306603
O       2.201766854900      0.172432801645     -0.306395796734
O      -1.709001942371      1.525856772657      0.694516340093
H       0.405372282125      0.903954108989     -2.463039222738
H       0.430515822413      2.264483583580     -1.175579018024
H      -1.177545071340      1.695429523374     -1.886696235140
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`sn2_F_beta_diketone_traj_21_itr5.xyz`を`MultiOptPy-v1.12c`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py sn2_F_beta_diketone_traj_21_itr5.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1 -elec -1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
19
OptimizedStructure
C      0.081098389005     -0.169412064936      0.325211093169
C      1.529298891579     -0.279349874862      0.281733049571
H     -0.433261778229     -1.099138136917      0.090726586786
C     -0.626731796543      0.657847030912      1.286969449368
C      2.045668968313     -1.552463559722     -0.385256828726
C     -0.286791682223      0.833383203454     -1.390929918804
F     -0.665941937114      1.731113173018     -3.026123294955
H      1.869483419348     -2.408499315896      0.270933252212
H      1.518852583211     -1.744226212262     -1.322557475196
H      3.112959817361     -1.454310623391     -0.572423970861
C     -2.084859539034      0.260401048760      1.508400761626
H     -2.582779304643      0.039173747735      0.562103038196
H     -2.127152432905     -0.643370255043      2.121645334629
H     -2.603749889662      1.066880015025      2.022365377764
O      2.329529821890      0.553749668131      0.676154858386
O     -0.179275757742      1.630015145820      1.874225364170
H      0.200607816453      0.094941951959     -2.000774009720
H      0.255402568385      1.700937678398     -1.058177991771
H     -1.352358157450      0.782327379817     -1.264224675842

```

<MoleculeViewer 
  xyzData={`19
OptimizedStructure
C      0.081098389005     -0.169412064936      0.325211093169
C      1.529298891579     -0.279349874862      0.281733049571
H     -0.433261778229     -1.099138136917      0.090726586786
C     -0.626731796543      0.657847030912      1.286969449368
C      2.045668968313     -1.552463559722     -0.385256828726
C     -0.286791682223      0.833383203454     -1.390929918804
F     -0.665941937114      1.731113173018     -3.026123294955
H      1.869483419348     -2.408499315896      0.270933252212
H      1.518852583211     -1.744226212262     -1.322557475196
H      3.112959817361     -1.454310623391     -0.572423970861
C     -2.084859539034      0.260401048760      1.508400761626
H     -2.582779304643      0.039173747735      0.562103038196
H     -2.127152432905     -0.643370255043      2.121645334629
H     -2.603749889662      1.066880015025      2.022365377764
O      2.329529821890      0.553749668131      0.676154858386
O     -0.179275757742      1.630015145820      1.874225364170
H      0.200607816453      0.094941951959     -2.000774009720
H      0.255402568385      1.700937678398     -1.058177991771
H     -1.352358157450      0.782327379817     -1.264224675842
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -656.2388             67.2426             74.0904
Reduced mass [au]                  10.7949              5.8877              5.0158
Force const [Dyne/A]               -2.7390              0.0157              0.0162
Char temp [K]                       0.0000             96.7470            106.5995
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                -0.02163    0.05362   -0.09752    0.00087    0.00119    0.00188    0.01309    0.02442    0.00505
       C                 0.01373    0.00412   -0.01211    0.00015   -0.01412    0.01809    0.01242    0.01013    0.01478
       H                 0.00903    0.00454    0.01793    0.00059    0.00132    0.00208    0.00409    0.03798   -0.02822
       C                -0.01097    0.01515   -0.00027   -0.00285    0.01733   -0.01467    0.01050    0.01000    0.01560
       C                 0.00030    0.00028    0.00167   -0.01037    0.03733   -0.08980    0.00510    0.06141   -0.08931
       C                 0.04678   -0.11770    0.20972    0.00056   -0.00064    0.00108   -0.00706    0.00018   -0.01340
       F                -0.01579    0.03212   -0.06352    0.00211   -0.00437   -0.00124   -0.04778   -0.07102   -0.04040
       H                -0.01040    0.00686    0.00791    0.01823   -0.00844   -0.14163    0.00379    0.00971   -0.15706
       H                -0.00323    0.00822    0.00439   -0.03347    0.09428   -0.08784    0.00511    0.13652   -0.10437
       H                 0.00097   -0.00982    0.00394   -0.01592    0.05896   -0.11017    0.00547    0.07244   -0.08140
       C                 0.00100    0.00009    0.00114    0.02899   -0.04839    0.07320   -0.02111    0.07533   -0.07247
       H                 0.00957    0.00375   -0.00168   -0.02079   -0.02409    0.09285    0.03168    0.03829   -0.09075
       H                 0.01350   -0.00387   -0.00326    0.10009   -0.07917    0.03232   -0.09215    0.11338   -0.02085
       H                -0.00335   -0.00723    0.00668    0.03100   -0.08811    0.13734   -0.02677    0.12017   -0.14825
       O                -0.00554   -0.00370    0.00493    0.01097   -0.07384    0.12286    0.02014   -0.03663    0.09891
       O                 0.00302   -0.00793    0.00075   -0.03125    0.08731   -0.10931    0.03262   -0.04832    0.09606
       H                -0.01650    0.04737   -0.04650    0.01226    0.00728    0.00148   -0.00648   -0.01297    0.00423
       H                -0.01388    0.01857   -0.04593   -0.01673    0.00770    0.00769   -0.01165    0.01632   -0.04823
       H                 0.00415    0.03982   -0.05819    0.00023   -0.01424   -0.00429   -0.00382   -0.00569    0.00611

(...snip...)
```
その結果、虚振動が１つであることが確認できた。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作モジュールで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、SN2反応（基質-fluoromethane, 求核剤-2,4-pentanedione）のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作モジュールMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.


### 個人的な技術的補足

`-modelhess`を使わない場合のアルゴリズムを用いた`nebmain.py`による経路緩和の結果

#### コマンド
```
python .\nebmain.py sn2_F_beta_diketone_traj.xyz -os uma-s-1p1 -ns 20 -spng -nd 0.12 -elec -1
```

#### 結果

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1_nomh = [-484.9052808080566,-484.9052808080566,-484.90949236328174,-484.9030799367806,-484.9027604418292,-484.9002557404583,-484.8962335883863,-484.8911546438888,-484.885727002729,-484.8805848993874,-484.8750337552412,-484.8713873735401,-484.86605392742,-484.8644965145231,-484.8616461217592,-484.862357117651,-484.86421187697147,-484.86601366732583,-484.86736306389497,-484.86805983075675,-484.8688727911417,-484.86916050843723,-484.87001469270535,-484.8708759082522,-484.87243278668427,-484.8735343142514,-484.879609864743,-484.87763383448373,-484.89014010046753,-484.90733660937735,-484.91439285896405,-484.9210905796793,-484.9338401250865,-484.94107801932495,-484.9474212928716,-484.95187366063016,-484.95524412268907,-484.9579233049121,-484.9602668366709,-484.9614725191606,-484.9626692690789,-484.9638695499695,-484.96455441403737,-484.965235620088,-484.9658438278851,-484.96637683385677,-484.96713981740226,-484.9676392046619,-484.9678961814698,-484.96814532530186,-484.96864951836386,-484.96897887134327,-484.96923466093835,-484.96946492764897,-484.96980301606123,-484.9702064055577,-484.97057602301214,-484.9708253858871,-484.9715185166359,-484.97209650088683,-484.97259671612886,-484.9730350736418,-484.97346563760664,-484.9738863271153,-484.97419411312586,-484.9744250588696,-484.97475597581564,-484.9751526801213,-484.97565351744527,-484.9761453433423,-484.97650907730315,-484.9768445853894,-484.9771956937146,-484.9774493410697,-484.9777718730516,-484.9783546499623,-484.97867363344847,-484.97895302711186,-484.9792875319814,-484.9795958042674,-484.97984710348203,-484.98023959778214,-484.9806312597191,-484.98107145281193,-484.9814354934329,-484.9820835670469,-484.98174671841775,-484.9826924976858,-484.9833097388142,-484.98391247491844,-484.9844118577973,-484.9849681392727,-484.9854723936667,-484.9860161809323,-484.98657162128285,-484.9875759069228,-484.98839682732853,-484.98900737012355,-484.99015873872344,-484.9914452962512,-484.99324707346295,-484.9938376307792,-484.99493002863613,-484.9958310837147,-484.99680545684936,-484.99754293065297,-484.9985169883658,-484.99951541241643,-485.0009612711198,-485.002166909801,-485.00355065668555,-485.00453298546023,-485.0055498967358,-485.0064183845085,-485.0070455219974,-485.0076479426798,-485.0084072944932,-485.00902466266655,-485.00917766854786,-485.0094981196218,-485.00986524436746,-485.0101339487349,-485.01039635342715,-485.0107242782465,-485.01109304143347,-485.0115565801239,-485.01194971841034,-485.0121841556987,-485.01242525189275,-485.01266668979383,-485.0128736853814,-485.0130681429506
];

export const dataset_itr5_nomh = [-484.9135099663793,-484.90627942596024,-484.9098812039455,-484.90467221693433,-484.9035588982852,-484.9013983385785,-484.89811150711785,-484.8936902456486,-484.8887704270925,-484.88409439676826,-484.8785200691163,-484.8748303037685,-484.86938038813116,-484.8678936122047,-484.8656092527084,-484.867074864705,-484.8730538785877,-484.8756991551526,-484.87614746597717,-484.8759478871838,-484.87551489622314,-484.8746377737773,-484.8744936172311,-484.87553990654715,-484.87838627330166,-484.88163332656256,-484.8939148303851,-484.8924902626564,-484.9041828136523,-484.9130642260237,-484.923259830929,-484.9312119678234,-484.93685718982135,-484.94268277616504,-484.94913331504426,-484.9559140370756,-484.9596432783438,-484.9622763805014,-484.96279071087116,-484.9643758721289,-484.96661954658776,-484.96774210665893,-484.9682550088686,-484.967831739034,-484.968173283944,-484.9698685887587,-484.97033325332995,-484.9712539127525,-484.97173466821886,-484.972066544573,-484.9721748043606,-484.97276476149915,-484.9726379268694,-484.9725989591287,-484.9730070711911,-484.9734416261185,-484.9740957365562,-484.9746208482199,-484.97523201309684,-484.97596662181866,-484.97653365830297,-484.9769850182054,-484.9774302405244,-484.97783267499364,-484.9781148767877,-484.97839980347595,-484.9787533869865,-484.97910915654563,-484.97953164658736,-484.97992895983236,-484.9803023492064,-484.98084506316155,-484.9811480565124,-484.98126056135226,-484.9817832985904,-484.98220018113255,-484.98217611707406,-484.98249830734903,-484.98281940240923,-484.9832557972974,-484.9836288800113,-484.9841050793843,-484.98457149191825,-484.98515065900114,-484.9855636075319,-484.9864087058985,-484.986539242354,-484.98693747557945,-484.9873784221801,-484.98797956365166,-484.988478898341,-484.9889314629797,-484.9895455761748,-484.98986144048934,-484.990348118877,-484.9906766175889,-484.9913970936596,-484.99127220851216,-484.99447755161464,-484.99502664410045,-484.99699304523165,-484.997447857251,-484.9993468807708,-484.99920409105266,-485.0007326866591,-485.000779325284,-485.0014231012753,-485.00218612424857,-485.0046740929285,-485.0062620754595,-485.0077421486717,-485.0084750050499,-485.0095896620514,-485.01034260904896,-485.0103165604614,-485.0117072553883,-485.01241535115145,-485.0130183851541,-485.01290920538617,-485.01247819895457,-485.0122641414223,-485.0125240315014,-485.01359029753445,-485.01340008939854,-485.0141832467997,-485.0143923189145,-485.014684820108,-485.01463231113206,-485.01527611340856,-485.0163453409023,-485.0159368783711,-485.016972452106
];

export const dataset1_itr10_nomh = [-484.91661497658475,-484.90738397522483,-484.91034458711545,-484.90512522184935,-484.9039625133959,-484.9020080358677,-484.89934921806775,-484.89582166059563,-484.8909807303579,-484.88750164270976,-484.88166435618683,-484.8786266729391,-484.8737657112236,-484.8729719784288,-484.87093466433305,-484.87171043560596,-484.8787102860139,-484.884407599711,-484.88286615285466,-484.88121638706923,-484.87904410308863,-484.87678338270746,-484.8767531635421,-484.87886014205765,-484.8834883618772,-484.88756558572766,-484.90772885506374,-484.9076811453188,-484.91587090493374,-484.92154323284643,-484.9298215768186,-484.93711894833683,-484.94187921053225,-484.9451062958379,-484.95065261446786,-484.95664165613687,-484.96038210145196,-484.96303242038545,-484.9641535917243,-484.965350109457,-484.96695366594173,-484.9681610569665,-484.96878794474645,-484.96886774209304,-484.96919359038526,-484.97045368752464,-484.97095830991077,-484.9718123978,-484.97216034752586,-484.97251347104617,-484.9725499811251,-484.97315283113164,-484.9732725161995,-484.9732144654369,-484.9737425998933,-484.9741133651328,-484.97475449070447,-484.97523126397,-484.9757894116914,-484.9764224721016,-484.9769736016869,-484.97745202653624,-484.9779305521454,-484.97835461053455,-484.9786480317085,-484.97896954295027,-484.979341543592,-484.9796738492704,-484.9800688713262,-484.9803683118003,-484.9807093047221,-484.9812415396625,-484.9816589128609,-484.9817043379878,-484.9823714858619,-484.98265979019254,-484.9827044574309,-484.98314123345375,-484.98347183497793,-484.98388342544246,-484.9841789888564,-484.9847488071862,-484.98518752831046,-484.9856145087326,-484.98600697674755,-484.9869207626023,-484.98739992343604,-484.98751750131066,-484.9879711261172,-484.988547406214,-484.9890421497631,-484.98959718707465,-484.99034206014903,-484.9908044948631,-484.9914885966615,-484.99217773644773,-484.9929783909998,-484.9943772518479,-484.9957634958221,-484.99594035109976,-484.9983941403178,-484.99899134777803,-485.0006150080247,-485.00048417805164,-485.0021541176927,-485.00221013135587,-485.00376927031124,-485.00465010334466,-485.00627096860325,-485.00714372333266,-485.0083224284927,-485.00898579568553,-485.0100559431596,-485.0108503944153,-485.0110800653291,-485.0120820641606,-485.01279678378256,-485.01333456927136,-485.01336442920626,-485.01305790050225,-485.0131509499474,-485.013669135473,-485.01442965259486,-485.01437844911493,-485.0152967209693,-485.0152347230528,-485.01552963371876,-485.015762397519,-485.0163021368709,-485.0168296448644,-485.01674794184413,-485.0173051170148
];

export const dataset1_itr15_nomh = [-484.91928864768715,-484.91051270367467,-484.9116769859517,-484.9054451570771,-484.9041762182691,-484.9024040830445,-484.90040741017765,-484.89805848558143,-484.89345993951025,-484.8919454042708,-484.8852976478813,-484.8848661705074,-484.87897895095364,-484.87576970450584,-484.8742473779086,-484.874632748932,-484.8831959658243,-484.8891509857423,-484.8860766128004,-484.88309008484316,-484.8812699386896,-484.8784222138689,-484.878921460941,-484.8834705449236,-484.8884359156516,-484.8933569148492,-484.91447480786,-484.92299484152994,-484.93004371922615,-484.9334210466387,-484.93784618297775,-484.94122898372603,-484.9458639566397,-484.94861365316916,-484.95248170195464,-484.95724058308423,-484.9606915390463,-484.96327926864734,-484.96488674162003,-484.9660656263953,-484.96718381436915,-484.9683175412499,-484.96901740537896,-484.9694209701098,-484.96995591680195,-484.9707313857956,-484.97125856522473,-484.9719688470365,-484.9723594269013,-484.97267261013013,-484.97278886060445,-484.97329828879293,-484.97363028343034,-484.9737311877556,-484.9742157677119,-484.97450884717875,-484.97525830701255,-484.97559943574095,-484.9761974755644,-484.97674627891354,-484.97726802169666,-484.9777415531265,-484.9782167799488,-484.9786281601321,-484.9789223523372,-484.9792677173562,-484.9796588273049,-484.97998761077264,-484.9804970301994,-484.98061551491185,-484.9810647019082,-484.9816681433308,-484.98194488219366,-484.9821369478138,-484.9827172188731,-484.98292241830853,-484.98334451407294,-484.9837457175207,-484.9840923004186,-484.98451833457517,-484.9847530566194,-484.985388592215,-484.9856953443428,-484.9861727221669,-484.98651561638144,-484.9872618037136,-484.98794704015444,-484.9879065172087,-484.9884648138793,-484.98898614048085,-484.9894604955122,-484.9902240529502,-484.9910198228445,-484.9914617244724,-484.99224199050667,-484.9927612055341,-484.9935927144761,-484.9951362356691,-484.9965327483768,-484.9971916646168,-484.9990841431333,-484.9997187543676,-485.001399435875,-485.001394713309,-485.0028332472162,-485.00313585067056,-485.0047813100716,-485.0057883906996,-485.006959534497,-485.0077053406944,-485.00876329185706,-485.0093067374156,-485.0104310060218,-485.01106800920513,-485.011343442572,-485.01227392826127,-485.0129649824829,-485.013456278296,-485.0136349034408,-485.01346958734564,-485.01354915250676,-485.01428693297044,-485.01471072850813,-485.0146904188458,-485.0156329869442,-485.0156199933164,-485.0159415045582,-485.01635897413547,-485.016548823041,-485.01700098902154,-485.0170147186336,-485.0174593144898
];

export const dataset2_nomh = [-484.9234050829637,-484.9145299004476,-484.91547215531455,-484.9074394982317,-484.9049159153586,-484.9037022597055,-484.9021976525877,-484.9032683531452,-484.8982927629684,-484.9008288663366,-484.8921933061293,-484.8943709785665,-484.8835899583782,-484.878837418542,-484.8768877961008,-484.87700614938746,-484.8899531035012,-484.89578622601766,-484.88937368013814,-484.885270999116,-484.8833151339507,-484.8804682590166,-484.8816818182908,-484.88768770217223,-484.8949616870224,-484.8994817434333,-484.92120019572343,-484.93259389336583,-484.9411764024659,-484.9444319567837,-484.9470919508443,-484.9493607867668,-484.95004735279844,-484.95309276388144,-484.95472056623026,-484.95792675702893,-484.96106813959,-484.9635288943739,-484.9654061187393,-484.96667621737976,-484.96741613570265,-484.96842620845734,-484.96924466243945,-484.9698070376898,-484.9705425225834,-484.97096928834344,-484.97145275118066,-484.97207241930494,-484.9725242654828,-484.9727918220652,-484.9729986774653,-484.97343465617183,-484.9738830896605,-484.9740343125322,-484.9745987292628,-484.97500663104404,-484.9756625376339,-484.97591082281764,-484.9764994525559,-484.9769288555931,-484.9775806266521,-484.97798596124994,-484.9783928773379,-484.9787727679067,-484.9790511583534,-484.9794453874737,-484.9798518523332,-484.9801453655051,-484.98069909293974,-484.98081766965026,-484.98137073995605,-484.9819201522446,-484.9820907954643,-484.98248564666653,-484.98289440271526,-484.9831650434224,-484.983775691358,-484.9841550080343,-484.98456435549895,-484.9850023713049,-484.98526549007715,-484.9858667980214,-484.986145968261,-484.98665095425844,-484.9869266723811,-484.98753433257093,-484.9883519279047,-484.9882932682027,-484.98895297737823,-484.9894281341068,-484.98991149180335,-484.9908159157625,-484.9916769560749,-484.9921688213997,-484.9930498559526,-484.99344225387387,-484.99423002431956,-484.9957662294781,-484.99713601894587,-484.9979396349586,-484.999768144172,-485.0003351237051,-485.0022062236296,-485.00260134206434,-485.00363314826046,-485.0041540148718,-485.00584437807754,-485.00658201835375,-485.0076884481021,-485.0083813685697,-485.0091524435618,-485.0096439058475,-485.0107379990969,-485.01128675425656,-485.0115867642424,-485.01246234900674,-485.0130802604066,-485.0135378323671,-485.01379158048195,-485.0137733561085,-485.0137617117853,-485.01459654579924,-485.01493225102416,-485.01495160565923,-485.01583507596973,-485.01583474302447,-485.016263918257,-485.01666600225747,-485.01669054382955,-485.0170905250177,-485.0171740767605,-485.0175671975235
];

<MultiDataGraph datasets={[ { data: dataset1_nomh, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5_nomh, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10_nomh, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15_nomh, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_nomh, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad_nomh = [0.013678616768477243,0.013678617598899292,0.008411524498578444,0.01308147036218912,0.011054386656573914,0.010929364506627523,0.011677449843424517,0.012633352016863709,0.01340475232469275,0.013680448345213866,0.013914348287309105,0.01347838238243743,0.013606119785728748,0.013463599955575736,0.013957575717436206,0.013888003755653633,0.013512874045328596,0.012932598125907545,0.012014557325721788,0.011323056810678456,0.010856060438504402,0.011265813385816828,0.012440210852478643,0.014707263382908339,0.017431587763978698,0.01975554948271455,0.02021439275171775,0.022146585157649966,0.01877324412598313,0.016781194220278912,0.019840912026190996,0.019329796617326464,0.014123200915282704,0.01387324625660738,0.009889800545227664,0.011321845687315632,0.01223987859162771,0.011857541946242965,0.010718293073929755,0.01109011727585962,0.011022038334416673,0.010824862337802282,0.011003169470288147,0.010811861042139718,0.010723531900276834,0.010980191338110894,0.01074302329649806,0.01071254544635842,0.01102613685903646,0.011192574016196548,0.010787421634860838,0.010712744983954674,0.010827919499913961,0.010788297366425352,0.010731450409792623,0.010747725672697004,0.01078647595714868,0.010948569230528959,0.011034537507424013,0.01114201107536519,0.011206597623452693,0.011215488231727995,0.01119107834705236,0.011129385971807241,0.01114050508201533,0.011236825877866752,0.011278556022448882,0.011246314128903668,0.011263358362376187,0.011269097854987063,0.011321959144283491,0.011311051041880337,0.011237875502418365,0.011201540721794894,0.011104603973370018,0.010852196060748175,0.010760004093685393,0.010723355153497956,0.010687476135243743,0.01074609025439422,0.010871945147123575,0.01098229292835608,0.01111659943088604,0.011174768373293465,0.011267579168395577,0.011482135239673102,0.012142667044023421,0.011541411779295602,0.01121608708868056,0.010970047455001365,0.01085408227212568,0.010718830827863431,0.010911087356519349,0.010938009940503458,0.010880902947858415,0.010905429638405755,0.011390351213024197,0.0119480087214173,0.011855132761615214,0.011701824428294098,0.011523766846839825,0.01256478977175059,0.012034589415409315,0.011680415820464229,0.011588792507475035,0.011784206796555502,0.011753993365680497,0.011556253328853815,0.011196934920113269,0.011057557444198911,0.011218232319618066,0.011307905898384818,0.011353123717555978,0.011013898971770738,0.010851843466683627,0.010975966718427873,0.011023723191533217,0.010852473419619023,0.01087376454171066,0.010883638454115158,0.01078365870248562,0.010765949830253026,0.010867716766318494,0.010989397804559053,0.01106682228282127,0.01103403502138478,0.010906540488917482,0.0108836927420485,0.010796938856256669,0.010776600960963018,0.010827333551431121,0.01077543318039018
];

export const dataset1_grad_itr5_nomh = [0.005356857879176076,0.011878797970860595,0.008121476042673437,0.011182533788872746,0.01067556257183589,0.010570018118628849,0.010946551340033367,0.011587211501936121,0.01220259895485806,0.012545994458778987,0.013086204505772801,0.01300703390946488,0.013344566968655488,0.013107855806154266,0.013336225093817008,0.01305726271209742,0.011891346987162143,0.011049752736541843,0.01026171408127759,0.009355839266659073,0.008512289925874795,0.008494988065194258,0.0094845875886475,0.011383035452360463,0.013857072973056135,0.015572561686677202,0.015096307703868021,0.017566310187308795,0.015286767169960953,0.013861198441111002,0.014066492148415885,0.012119159795709593,0.012613628388778308,0.011849493506689745,0.0076771494496947045,0.00497467409601742,0.004832264018851211,0.004278586513413922,0.006314971199128871,0.005925998700410565,0.002832161785044,0.002440811180142466,0.003223666690866407,0.005973059089054758,0.006505464633125168,0.004019739171571894,0.004787220088932272,0.0030570384614109557,0.002845276250167693,0.0030780790175550343,0.0037109989617162232,0.002501323616423352,0.0040568897529604025,0.004812307916682004,0.004768782899675404,0.004850494631461754,0.004254168314360667,0.00380554980768084,0.003856017074922448,0.003554255474525086,0.003521284999068496,0.0035997301342435527,0.003599115735413614,0.0036371708976769336,0.003930983134356452,0.00413747786573197,0.004207542291724146,0.00431191136990386,0.004399595650658929,0.004491293166320973,0.004479534434407114,0.003793261945325376,0.0038885929549789004,0.004364160345301873,0.0036502005256834145,0.003524045840287599,0.0044732175150512775,0.004255902358318379,0.004188126018519173,0.003910730552314971,0.003779707634041382,0.003719222099974284,0.003782191575340563,0.003290766011119405,0.0032747668307785993,0.003233664796363125,0.004170295731457945,0.004016724083582966,0.0036125578131443767,0.002950267108283192,0.0026105774113999915,0.0028847639112952856,0.003106273920900379,0.004147661840929328,0.0045894943314434035,0.006037641203911867,0.006817261421730918,0.009058181523898801,0.004930595335380223,0.006298641010511693,0.005329607105520081,0.006792669217750747,0.004872716331412001,0.006777597370440967,0.005351397776614137,0.006759183726563206,0.00746218712120216,0.007772141785209427,0.005465909203658534,0.0038821569399338485,0.0030414241470812196,0.0040858114458625005,0.003596556346732604,0.0034987442175006844,0.004867857007023348,0.0024625472835155806,0.0025825528005741826,0.0020521593430651453,0.003198015955224939,0.0052043381974487095,0.006419968261557456,0.006270269052428545,0.004504157647275859,0.006191480456108915,0.0055150901301107575,0.0059013161516837396,0.00592377529071467,0.006412870492849818,0.005254821728545883,0.0028703861423325498,0.004721543643674902,0.0018326524844928024
];

export const dataset1_grad_itr10_nomh = [0.003376014292880949,0.010723181401366615,0.007691922361227734,0.010527988765178612,0.010533699292004997,0.010640133099622523,0.01094567084862561,0.011380176978621604,0.011992417829828858,0.01209844196937521,0.012703890000158709,0.012580987490031111,0.012959460551212807,0.012802599680645007,0.013244284874540073,0.013415637563081952,0.011254314922082087,0.010182238258787965,0.01018833635234114,0.009222217815113714,0.008303914285184587,0.008028574404633712,0.008630312753468174,0.010260430253640289,0.012765212049755168,0.014520087363593507,0.012037634690918947,0.013978170282786615,0.01282044373139336,0.01153998815447758,0.010187882794590425,0.008642221052246355,0.009201923808186185,0.00988856278791756,0.006662214472944994,0.0041373071862531325,0.0037377209389952274,0.003219524373688078,0.0039079318425567534,0.0043374586629768355,0.00231390704144471,0.001395012681201424,0.002105764713586486,0.0037801753407086624,0.0046371367295398435,0.002602196684236933,0.0033057858722533215,0.001735312063382809,0.0019549317266576815,0.001873220161991638,0.0030383819795210807,0.0015264175531703966,0.0025940717064756274,0.0036239651002747124,0.003253890097999549,0.00365534568617676,0.0033042249593060705,0.003047388156512296,0.0028474611491442563,0.002835590074453976,0.002810159176562759,0.0027935291508795483,0.002732696423829768,0.0027548556524288384,0.0030735505417586826,0.003257655574263355,0.0032876533459985503,0.0033792104256956945,0.003389672908625774,0.0036974335715210162,0.0037643669753685202,0.0031722072188948734,0.0028076915859621397,0.0038153928197167375,0.002537936286445243,0.002651565539762915,0.0038592989080136046,0.0033731499019954846,0.003341174683045215,0.0032226118680923205,0.003276835633824826,0.0027633736492794006,0.002811752647655906,0.0028254330893681683,0.0026808720462605275,0.002210006397818306,0.0028630658375594204,0.002984470461585102,0.002483400692817659,0.0020550513434099277,0.0019866907668904367,0.002242996015078592,0.002309389076783842,0.0031415089428045756,0.0031368062280172576,0.004167498407905312,0.004693172848232882,0.0036693056433124978,0.0029606729543936185,0.0056390427821229085,0.002946215594995687,0.004568848781859956,0.003257159821645484,0.005532328833170333,0.003172524030488435,0.005152324126903709,0.0033555160300833345,0.003705698245203858,0.0028097491560886293,0.0024209888320270035,0.0022192064569934986,0.0033191342097277686,0.0027559828679603426,0.00256719061404778,0.0032723599165772324,0.001926166205187094,0.0017649342651000538,0.0013011036670900655,0.0020261257592152143,0.003834797310835329,0.004539762644968695,0.0038111324725160186,0.002598842596035151,0.004421556245345854,0.0028158913739190017,0.004287841762270822,0.004350656988310223,0.0040491611480899725,0.0028908223503976414,0.0014084845874171175,0.0025550942258891506,0.0009242331503803775
];

export const dataset1_grad_itr15_nomh = [0.002887118871838732,0.00816820312360626,0.006685815635788201,0.009921466090891186,0.010360171902673264,0.010605381823656211,0.010776892858182816,0.011349702848141602,0.011732305566405882,0.011946644090602428,0.01245240848957211,0.012334632980300329,0.012574745442535461,0.013323747152820588,0.013707579473645704,0.01376988259324208,0.011604091456720258,0.009629258083830389,0.009767348194885296,0.008855115803455044,0.007963282802480232,0.007374283663008811,0.007952584003374358,0.009575299583679251,0.012537441090810963,0.01322571452804301,0.011483796302762838,0.011132963745911426,0.009484693622534903,0.00829202144217043,0.007460117175600155,0.006983512748898045,0.006043199596535233,0.007718758105557773,0.005501296281484403,0.00366586676065556,0.0034609780760306067,0.003241006119753245,0.002875510633103311,0.003049434782912693,0.001966328700067546,0.001250908407360757,0.0019384198414960552,0.0024061614495775045,0.003246361600249937,0.002175783489761385,0.0025646447610721147,0.001467964053909121,0.0015386131557017567,0.00146029387863758,0.002505769227989476,0.0012935466617299256,0.0018454034418100113,0.002454187804393684,0.002163652588427781,0.003001412634601041,0.0023376286768786174,0.0026344290800968794,0.0020672947832910244,0.0022808402349692595,0.0022721855447545053,0.002219142720303901,0.002124153565946314,0.0021680776915158355,0.002490757559817811,0.002654639316808052,0.002605003195819125,0.0026556070943601464,0.0021882956847910882,0.0033034829687588227,0.0028433973025411125,0.0020062473756867175,0.0022505717376524762,0.0029225376785696933,0.0016734254145561124,0.0021113888311145913,0.0023161506813122357,0.0020437393488499387,0.002306915832201699,0.002155272990203843,0.0024393611561017966,0.0016442806175657918,0.0021444333759895826,0.0018781107906944091,0.0017949867274043355,0.0017462840950522459,0.0019521090858882358,0.0024912996715133855,0.0019794667213784505,0.0016588120948460511,0.001732926738050464,0.0016688656957308259,0.0017972572808810804,0.0026808076818141814,0.0026048507796351573,0.003950115075093803,0.0041507944530249485,0.0028891942307224102,0.0024240670714626967,0.0038392393269249584,0.0022984803974237956,0.003920462344265368,0.0026544733989936095,0.004946706664728089,0.002649305792235837,0.0045042680721239115,0.0026554873223337935,0.002601529882341832,0.002084028892782661,0.0020580903323549247,0.0018911071157445842,0.002938693645462773,0.0021258024242189933,0.0023606983339805564,0.0028796482281011546,0.0017807818107071314,0.0015127656433280721,0.0011387969861932172,0.0011172479005092278,0.0025459032509610297,0.0034711081017502793,0.0022772212050127466,0.002006896300045941,0.003902018881681607,0.002127549348526465,0.003473259739881688,0.0033485760423394777,0.0026438831132105916,0.002248597232514991,0.00097510826436979,0.00178306811342701,0.0005612551867467369
];

export const dataset2_grad_nomh = [0.0029122050630884695,0.006001657054576609,0.004977809604144663,0.008493291668630616,0.00975420858679875,0.010541742248947304,0.010571448072734814,0.01041938126936364,0.010712050025044838,0.009902107272674418,0.011090452508107957,0.01078032722650098,0.01224223208031302,0.012937042039492051,0.012994592256597938,0.012796715502356594,0.009874697568414336,0.008799643006697864,0.00881319118614085,0.008374095389142572,0.007453661743771139,0.006786665814225106,0.007465525832318578,0.008193866847910578,0.012608117056642703,0.013027265585593658,0.011756658981315024,0.009774404049450581,0.007347319515971064,0.0069080050449836896,0.006099058681945713,0.005387080423252599,0.0052262619560224256,0.004917176808499428,0.00412731210666134,0.0032623047988334115,0.0029730898467074953,0.002765770454902717,0.002288151789426683,0.001797828792088731,0.0014184694217647918,0.0011229358495547471,0.0012798141017796346,0.0019743669942354687,0.0015590438336268862,0.0017930806254823723,0.002186097967898431,0.0013399781046515775,0.0010204898421925597,0.0012974878197641053,0.002173930036668818,0.00127378726731866,0.0015795302809065489,0.002096244703557605,0.0015325656569990466,0.002038646940019001,0.0013478757319923004,0.0022209440511548398,0.0014991542768553285,0.0019695488981190867,0.0013126706907666708,0.0014577091971795066,0.0016982018345331395,0.0017898352190599913,0.0021480779677121296,0.0021718774380454454,0.002006268871028879,0.0022218486011950592,0.0016116376084048336,0.0028007061386269897,0.0017922477106541415,0.0010786715564879653,0.0020872356515485332,0.0017546520700412308,0.0014679421461592415,0.0016094100679774766,0.001268800693364067,0.0015984274949503992,0.0017910207919673293,0.0015511648420228133,0.0017821565820894702,0.0012261519882781613,0.0018612108665607833,0.001290899032008714,0.001613916885902222,0.001681535666933259,0.0014398079175663653,0.002054543177705402,0.0015972757234045934,0.001502342931949626,0.0016792494814649877,0.0014404562266428877,0.0016031922069140551,0.0020748510038675117,0.0023113335154869388,0.0029043878285857807,0.0036856010393113837,0.002756353140408416,0.0023577636712435895,0.0033544552646881907,0.002102185963408993,0.003445889215349033,0.0020491739049299205,0.003755514302746195,0.0025114916701230784,0.0035507409472019095,0.0022062939838755746,0.0023006043608150475,0.0018319403175751452,0.001836901277968912,0.0018883615842618644,0.0024243091643648,0.0018740493792319813,0.002307671000372058,0.002555030929374726,0.0015171150494235391,0.001385160474191376,0.0011160946714128717,0.0008644451194622028,0.0017857919454882716,0.00288465062468995,0.0015586232021012696,0.001676494389413012,0.0034531415191643875,0.0018771407578587285,0.0028957321968391646,0.0024818182943505203,0.0016288357133093765,0.0019219763704386313,0.0008997374676637336,0.0013160679180711536,0.0003584348524453688
];

<MultiDataGraph datasets={[ { data: dataset1_grad_nomh, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5_nomh, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10_nomh, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15_nomh, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad_nomh, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

緩和後の経路のエネルギー極大値を示すノードの分子構造
`sn2_F_beta_diketone_traj_14.xyz`
```
19
-1 1
C      -0.182789696796      0.067114085979     -0.433393486015
C       1.186955358283     -0.598889650895     -0.070724242779
H      -0.720470344161     -0.569987761463     -1.251897498112
C      -1.032185636069      0.456256553110      0.740595557643
C       1.668463327679     -1.980487636594      0.566984866754
C      -0.110074244746      1.880566264007     -2.110491755429
F       0.098535723278      2.846750575321     -3.257198825792
H       1.739365399824     -1.886572957855      1.657103194399
H       1.080383299267     -2.871023851707      0.340973656983
H       2.700861344985     -2.142177794752      0.228998145950
C      -1.490521107501     -0.405326811162      2.024665207253
H      -2.462584141589     -0.819121691858      1.733791794802
H      -0.919645159240     -1.265888944001      2.395052372061
H      -1.703759358499      0.253237380823      2.876534475489
O       2.164047071648      0.096525300146     -0.295683048593
O      -1.511116826644      1.575522063567      0.778206900194
H       0.327716212462      0.989654882087     -2.502650302294
H       0.366076550082      2.418666098207     -1.319687587613
H      -1.199257772263      1.955183897039     -2.101179424902

```

`sn2_F_beta_diketone_traj_21.xyz`
```
19
-1 1
C      -0.147276585170      0.185926403423     -0.441327910699
C       1.188446714399     -0.474834175982     -0.110113124742
H      -0.714049550740     -0.412219169240     -1.156251706585
C      -1.052886993480      0.496497764307      0.703191746912
C       1.543755880530     -1.893189308104      0.500685936667
C      -0.089500945402      1.681640610482     -1.915956514217
F       0.056432908401      2.808538786701     -3.209638366611
H       1.626919992058     -1.824491874023      1.594969164933
H       1.029597201767     -2.853409172842      0.319740580153
H       2.582391246193     -2.082762011559      0.195229117972
C      -1.410929200553     -0.400335279709      1.913890290271
H      -2.408249103487     -0.807725967389      1.698145532811
H      -0.816422306984     -1.238252280434      2.279447355041
H      -1.572973203808      0.272785139380      2.758828425137
O       2.204811410361      0.168086173369     -0.298047200258
O      -1.699617943375      1.534631028093      0.697471179679
H       0.399122128015      0.912936775300     -2.478986099815
H       0.448601594490      2.243900438156     -1.178953152940
H      -1.168173243215      1.682276120070     -1.872325253706

```

