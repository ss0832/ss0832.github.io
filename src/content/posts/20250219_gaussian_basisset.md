---
title:  【Gaussian】複数の種類の基底関数を割り当てる方法
published: 2025-02-19
tags: [Gaussian, basis set, ECP]
category: Computational Chemistry
draft: false
---
最終更新：2025-02-19

### 概要

電子状態計算ソフトウェアGaussian16/09/03を使用する時、基底関数や有効内核ポテンシャル(ECP)を複数種類割り当て無ければならない場面がある。例えば、
- 使う基底関数に系中の原子が対応していない時
- ヨウ素等の重原子等の分極しやすい原子の電子軌道の分極をより精密に記述したい時

等が挙げられる。

そこで、本記事では、複数種類の基底関数を割り当てる方法について解説する。さらに有効内核ポテンシャル(ECP)の割り当て方法や、Gaussianが対応していない基底関数の割り当て方法についても解説する。

### 方法

以下の入力ファイルを例に考える。ヨウ化メチルが酸化的付加しているdmpeが配位したPd(Ⅱ)錯体である。初めにGaussianが対応している2種類の基底関数とそれらに対応した有効内核ポテンシャルを割り当てる方法について解説する。

```gjf
%chk=test.chk
# hf/3-21g 

Title Card Required

0 1
 C                 -8.14958884    0.93174289   -0.12397338
 H                 -7.80868684   -0.00409470    0.26704305
 H                 -7.88136012    1.00058835   -1.15751760
 C                 -7.50091308    2.07544773    0.73219254
 H                 -6.43507147    2.08379110    0.63832009
 H                 -7.88598527    3.01981506    0.40848005
 P                 -9.98187800    1.06913208    0.05493863
 P                 -7.97861271    1.73526939    2.47921530
 Pd               -10.25092586    1.43020334    2.31268138
 I                -12.83092062    1.08382995    2.12359800
 C                -10.49049941    1.75171907    4.32308734
 H                -11.45415660    2.18038763    4.50338735
 H                -10.41077216    0.82110746    4.84510802
 H                 -9.73161516    2.42147767    4.67010050
 C                 -7.51890334    3.07564004    3.62135093
 H                 -7.70213841    2.76450873    4.62858587
 H                 -6.48064667    3.30530263    3.50227877
 H                 -8.10365639    3.94512857    3.40466321
 C                 -7.18711965    0.19859777    3.04893371
 H                 -6.12427363    0.29495495    2.97164438
 H                 -7.45548623    0.01594535    4.06850101
 H                 -7.51627095   -0.61853446    2.44159991
 C                -10.82360905   -0.42657872   -0.55065038
 H                -11.81644568   -0.17610742   -0.86119756
 H                -10.28142444   -0.82977197   -1.38033167
 H                -10.86782068   -1.15320287    0.23354518
 C                -10.62816117    2.50513986   -0.85753040
 H                -10.02895554    2.67386230   -1.72780929
 H                -11.63915345    2.31510036   -1.15194440
 H                -10.59633205    3.37070292   -0.22928881



```

方法は以下のとおりである。

1, hf/3-21g(計算方法/基底関数)の基底関数部分をGenECPに書き換える。

2, カーテシアン座標以下に割り当てる基底関数の情報、有効内核ポテンシャルの情報の順に入力する。

3, 最後に改行を2つ入れる。

以上の作業を基に入力ファイルを作成すると以下のようになる。
(### xxx ###はコメントであり、実際に入力ファイルを作る際には取り除くこと。)

```
%chk=test.chk
# hf/genECP

Title Card Required

0 1
 C                 -8.14958884    0.93174289   -0.12397338
 H                 -7.80868684   -0.00409470    0.26704305
 H                 -7.88136012    1.00058835   -1.15751760
 C                 -7.50091308    2.07544773    0.73219254
 H                 -6.43507147    2.08379110    0.63832009
 H                 -7.88598527    3.01981506    0.40848005
 P                 -9.98187800    1.06913208    0.05493863
 P                 -7.97861271    1.73526939    2.47921530
 Pd               -10.25092586    1.43020334    2.31268138
 I                -12.83092062    1.08382995    2.12359800
 C                -10.49049941    1.75171907    4.32308734
 H                -11.45415660    2.18038763    4.50338735
 H                -10.41077216    0.82110746    4.84510802
 H                 -9.73161516    2.42147767    4.67010050
 C                 -7.51890334    3.07564004    3.62135093
 H                 -7.70213841    2.76450873    4.62858587
 H                 -6.48064667    3.30530263    3.50227877
 H                 -8.10365639    3.94512857    3.40466321
 C                 -7.18711965    0.19859777    3.04893371
 H                 -6.12427363    0.29495495    2.97164438
 H                 -7.45548623    0.01594535    4.06850101
 H                 -7.51627095   -0.61853446    2.44159991
 C                -10.82360905   -0.42657872   -0.55065038
 H                -11.81644568   -0.17610742   -0.86119756
 H                -10.28142444   -0.82977197   -1.38033167
 H                -10.86782068   -1.15320287    0.23354518
 C                -10.62816117    2.50513986   -0.85753040
 H                -10.02895554    2.67386230   -1.72780929
 H                -11.63915345    2.31510036   -1.15194440
 H                -10.59633205    3.37070292   -0.22928881
### 必ずここには空行を入れること。以下基底関数の情報 ###
H C P 0 ### 半角スペース区切りで割り当てる原子の元素記号を過不足なく入力し、最後に0を入力する。 ###
6-31G(d) ### ここに割り当てる基底関数の種類を入れる ###
****
Pd I 0
LANL2DZ
****
### 必ずここには改行を入れること。以下ECPの情報(ECPの割り当てのない原子の場合は不要) ###
Pd I 0 ### ここも過不足なく入力 ###
LANL2DZ　### ここに割り当てるECPの種類を入れる ###



```

さらにGaussianに対応していない基底関数及びECPの使用方法を以下に示す。ここではヨウ素に基底関数`LANL2DZdp`を割り当てる方法について示す。

1, 初めにBasis Set Exchange(BSE)にアクセスする。(基底関数の情報が得られるならこのサイト以外でも良い。ここではBSEを使った場合の解説を行う。)

https://www.basissetexchange.org/

2, (2025年2月のサイトのGUIを基に説明) search basis setsに`LANL2DZdp`を入力する。

3, 周期表の`I`（ヨウ素）を左クリックする。（基底関数の割り当てに必要な原子の元素記号を指定している。）

4, Download basis setのFormatをGaussianとして、Get Basis Setをクリックする。

5, 基底関数の情報が表示されるので、コピーアンドペーストして利用する。（上が基底関数。下がECPである。）


```
%chk=test.chk
# hf/genECP

Title Card Required

0 1
 C                 -8.14958884    0.93174289   -0.12397338
 H                 -7.80868684   -0.00409470    0.26704305
 H                 -7.88136012    1.00058835   -1.15751760
 C                 -7.50091308    2.07544773    0.73219254
 H                 -6.43507147    2.08379110    0.63832009
 H                 -7.88598527    3.01981506    0.40848005
 P                 -9.98187800    1.06913208    0.05493863
 P                 -7.97861271    1.73526939    2.47921530
 Pd               -10.25092586    1.43020334    2.31268138
 I                -12.83092062    1.08382995    2.12359800
 C                -10.49049941    1.75171907    4.32308734
 H                -11.45415660    2.18038763    4.50338735
 H                -10.41077216    0.82110746    4.84510802
 H                 -9.73161516    2.42147767    4.67010050
 C                 -7.51890334    3.07564004    3.62135093
 H                 -7.70213841    2.76450873    4.62858587
 H                 -6.48064667    3.30530263    3.50227877
 H                 -8.10365639    3.94512857    3.40466321
 C                 -7.18711965    0.19859777    3.04893371
 H                 -6.12427363    0.29495495    2.97164438
 H                 -7.45548623    0.01594535    4.06850101
 H                 -7.51627095   -0.61853446    2.44159991
 C                -10.82360905   -0.42657872   -0.55065038
 H                -11.81644568   -0.17610742   -0.86119756
 H                -10.28142444   -0.82977197   -1.38033167
 H                -10.86782068   -1.15320287    0.23354518
 C                -10.62816117    2.50513986   -0.85753040
 H                -10.02895554    2.67386230   -1.72780929
 H                -11.63915345    2.31510036   -1.15194440
 H                -10.59633205    3.37070292   -0.22928881

H C P 0 
6-31G(d)
****
Pd 0
LANL2DZ
****
I     0
S    2   1.00
      0.7242000             -2.9731048
      0.4653000              3.4827643
S    1   1.00
      0.1336000              1.0000000
P    2   1.00
      1.2900000             -0.2092377
      0.3180000              1.1035347
P    1   1.00
      0.1053000              1.0000000
P    1   1.00
      0.0308                 1.0
D    1   1.00
      0.2940                 1.0
****

Pd 0
LANL2DZ
I     0 
I-ECP     3     46
f potential
  5
0      1.0715702             -0.0747621
1     44.1936028            -30.0811224
2     12.9367609            -75.3722721
2      3.1956412            -22.0563758
2      0.8589806             -1.6979585
s-f potential
  5
0    127.9202670              2.9380036
1     78.6211465             41.2471267
2     36.5146237            287.8680095
2      9.9065681            114.3758506
2      1.9420086             37.6547714
p-f potential
  5
0     13.0035304              2.2222630
1     76.0331404             39.4090831
2     24.1961684            177.4075002
2      6.4053433             77.9889462
2      1.5851786             25.7547641
d-f potential
  5
0     40.4278108              7.0524360
1     28.9084375             33.3041635
2     15.6268936            186.9453875
2      4.1442856             71.9688361
2      0.9377235              9.3630657



```

ポイントとして、
- 2種類目以降の指定の下に基底関数やECPの指定を書けばよいこと
- Gaussianが対応していない基底関数は基底関数名ではなく、基底関数の中身を直接入力する必要があること

がある。


### 参考
- https://gaussian.com/gen/
- https://www.hpc.co.jp/chem/software/gaussian/gaussian_nyumon/crib10/
- https://www.hpc.co.jp/chem/software/gaussian/help/keywords/gen/