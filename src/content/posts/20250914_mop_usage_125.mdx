---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Co錯体触媒が関わる酸化的環化反応(配位子:Tris(3,5-dimethylphenyl)phosphine, NNP使用）
published: 2025-09-14
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-09-14

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(3,5-dimethylphenyl)phosphineの遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

酸化的環化について
- https://www.sciencedirect.com/topics/chemistry/oxidative-cyclization

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.15.3
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.15.3.zip
unzip v1.15.3.zip
cd MultiOptPy-v1.15.3
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.15.3`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1::(uma-s-1.ptの絶対パス)
```

これで、`MultiOptPy-v1.15.3`がNNP`uma-s-1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`co_cat_oxidative_cyclization_P_mmdiMePh_3.xyz`とした。
初期構造は以下のものを使用した。

```
71
OptimizedStructure
Co     2.908229758890     -0.353632538010     -0.213595305289
C      4.194504388069      0.239918030142     -1.733154583073
C      3.432824448005      1.412899783399     -1.549649848242
C      3.361971884791     -0.683945406511     -2.404583723920
H      5.213056114830      0.085359529867     -1.415221173722
C      2.232750487324      1.291416590476     -2.331072079401
H      3.788999696247      2.321496622558     -1.086921051217
C      2.191578791347      0.018794907797     -2.853124608436
H      3.631698639871     -1.689959618499     -2.684355783124
H      1.475972929894      2.055288499331     -2.415645304994
H      1.383785689845     -0.418141297925     -3.419404656169
P      0.486756155851     -0.173771093297     -0.065313566053
C      2.771215104361      0.319158696443      1.734664551214
H      1.994348519182      0.191063582991      2.461110442787
C      3.866287697142      0.652342566962      1.278919723777
H      4.836593552339      1.100173979406      1.238611718603
C      3.073612869815     -2.259096334447      0.510151253608
H      2.390114831573     -2.959656298245      0.937703861400
C      4.188161800285     -1.870322959294      0.149234674875
H      5.241068705019     -1.901035122249     -0.040460248198
C     -0.744584131269     -0.551832714823     -1.395619898720
C     -1.379654790721     -1.780188827208     -1.533246676004
C     -1.008934887181      0.437451375205     -2.344927053379
C     -2.254029300705     -2.030941531432     -2.588926967031
H     -1.223565190752     -2.568255522661     -0.811202006692
C     -1.868994665258      0.212986939786     -3.408972322136
H     -0.539735739395      1.408501343281     -2.254050698014
C     -2.484983142597     -1.030517447363     -3.520397148610
H     -3.159213345154     -1.219107079093     -4.349543001772
C     -0.112133068265      1.507103935249      0.371702777844
C     -1.478302784607      1.760369150236      0.504217366811
C      0.788006737520      2.547845571960      0.551871664917
C     -1.944509075984      3.027211475579      0.818735116025
H     -2.190686041445      0.956177975242      0.353454548995
C      0.346739124612      3.832853807757      0.864905875775
H      1.847148563067      2.357252226615      0.443944834927
C     -1.017023215424      4.053445316265      0.994622833464
H     -1.372845228367      5.051182827958      1.235072476197
C     -0.152267526280     -1.170537616319      1.346312434508
C     -0.636450441959     -0.602103429836      2.518099664535
C     -0.054655862022     -2.562917057551      1.277652638594
C     -1.042287496461     -1.395134834335      3.592556219169
H     -0.702412379449      0.475223156504      2.613955207824
C     -0.465742258064     -3.375411241814      2.321823275014
H      0.364814532368     -3.027156397511      0.392737661504
C     -0.962313137988     -2.773735703312      3.476471451464
H     -1.279368232139     -3.397197687587      4.306243986608
C     -2.138679761892      1.302193676541     -4.412511794092
H     -2.439527880831      0.886223906172     -5.374012821042
H     -2.941260852486      1.959428786258     -4.070394923492
H     -1.252747232175      1.917635873519     -4.569777317488
C     -2.939765091206     -3.367199123055     -2.694629819765
H     -2.226553149202     -4.184829072562     -2.581207704591
H     -3.694913655962     -3.481730624243     -1.914187209048
H     -3.435709522953     -3.481269494945     -3.657911161184
C     -0.376831002720     -4.874071821640      2.209583112983
H     -0.088714917874     -5.324460503167      3.159559976749
H     -1.339078178903     -5.302756395833      1.921102419678
H      0.354337930803     -5.169912952346      1.457094912888
C     -1.565474554702     -0.750364724805      4.848200751808
H     -0.899036364885      0.043746239976      5.187455580846
H     -2.546361764766     -0.301994129627      4.678063385881
H     -1.665061705624     -1.477716438292      5.653163407683
C     -3.420613074544      3.292826916820      0.949916110751
H     -3.647478978360      3.819455247635      1.878021239522
H     -3.782763256138      3.911416188705      0.126391365810
H     -3.986057211640      2.361596087348      0.940420368977
C      1.332226919403      4.955029433049      1.058180656920
H      1.091388443542      5.807074921880      0.420561402692
H      1.328527845641      5.308670020824      2.090980599387
H      2.344597936711      4.630087850101      0.820548901881

```

<MoleculeViewer 
  xyzData={`71
OptimizedStructure
Co     2.908229758890     -0.353632538010     -0.213595305289
C      4.194504388069      0.239918030142     -1.733154583073
C      3.432824448005      1.412899783399     -1.549649848242
C      3.361971884791     -0.683945406511     -2.404583723920
H      5.213056114830      0.085359529867     -1.415221173722
C      2.232750487324      1.291416590476     -2.331072079401
H      3.788999696247      2.321496622558     -1.086921051217
C      2.191578791347      0.018794907797     -2.853124608436
H      3.631698639871     -1.689959618499     -2.684355783124
H      1.475972929894      2.055288499331     -2.415645304994
H      1.383785689845     -0.418141297925     -3.419404656169
P      0.486756155851     -0.173771093297     -0.065313566053
C      2.771215104361      0.319158696443      1.734664551214
H      1.994348519182      0.191063582991      2.461110442787
C      3.866287697142      0.652342566962      1.278919723777
H      4.836593552339      1.100173979406      1.238611718603
C      3.073612869815     -2.259096334447      0.510151253608
H      2.390114831573     -2.959656298245      0.937703861400
C      4.188161800285     -1.870322959294      0.149234674875
H      5.241068705019     -1.901035122249     -0.040460248198
C     -0.744584131269     -0.551832714823     -1.395619898720
C     -1.379654790721     -1.780188827208     -1.533246676004
C     -1.008934887181      0.437451375205     -2.344927053379
C     -2.254029300705     -2.030941531432     -2.588926967031
H     -1.223565190752     -2.568255522661     -0.811202006692
C     -1.868994665258      0.212986939786     -3.408972322136
H     -0.539735739395      1.408501343281     -2.254050698014
C     -2.484983142597     -1.030517447363     -3.520397148610
H     -3.159213345154     -1.219107079093     -4.349543001772
C     -0.112133068265      1.507103935249      0.371702777844
C     -1.478302784607      1.760369150236      0.504217366811
C      0.788006737520      2.547845571960      0.551871664917
C     -1.944509075984      3.027211475579      0.818735116025
H     -2.190686041445      0.956177975242      0.353454548995
C      0.346739124612      3.832853807757      0.864905875775
H      1.847148563067      2.357252226615      0.443944834927
C     -1.017023215424      4.053445316265      0.994622833464
H     -1.372845228367      5.051182827958      1.235072476197
C     -0.152267526280     -1.170537616319      1.346312434508
C     -0.636450441959     -0.602103429836      2.518099664535
C     -0.054655862022     -2.562917057551      1.277652638594
C     -1.042287496461     -1.395134834335      3.592556219169
H     -0.702412379449      0.475223156504      2.613955207824
C     -0.465742258064     -3.375411241814      2.321823275014
H      0.364814532368     -3.027156397511      0.392737661504
C     -0.962313137988     -2.773735703312      3.476471451464
H     -1.279368232139     -3.397197687587      4.306243986608
C     -2.138679761892      1.302193676541     -4.412511794092
H     -2.439527880831      0.886223906172     -5.374012821042
H     -2.941260852486      1.959428786258     -4.070394923492
H     -1.252747232175      1.917635873519     -4.569777317488
C     -2.939765091206     -3.367199123055     -2.694629819765
H     -2.226553149202     -4.184829072562     -2.581207704591
H     -3.694913655962     -3.481730624243     -1.914187209048
H     -3.435709522953     -3.481269494945     -3.657911161184
C     -0.376831002720     -4.874071821640      2.209583112983
H     -0.088714917874     -5.324460503167      3.159559976749
H     -1.339078178903     -5.302756395833      1.921102419678
H      0.354337930803     -5.169912952346      1.457094912888
C     -1.565474554702     -0.750364724805      4.848200751808
H     -0.899036364885      0.043746239976      5.187455580846
H     -2.546361764766     -0.301994129627      4.678063385881
H     -1.665061705624     -1.477716438292      5.653163407683
C     -3.420613074544      3.292826916820      0.949916110751
H     -3.647478978360      3.819455247635      1.878021239522
H     -3.782763256138      3.911416188705      0.126391365810
H     -3.986057211640      2.361596087348      0.940420368977
C      1.332226919403      4.955029433049      1.058180656920
H      1.091388443542      5.807074921880      0.420561402692
H      1.328527845641      5.308670020824      2.090980599387
H      2.344597936711      4.630087850101      0.820548901881
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`co_cat_oxidative_cyclization_P_mmdiMePh_3.xyz`として保存し、以下を実行する。
```
python optmain.py .\co_cat_oxidative_cyclization_P_mmdiMePh_3.xyz -os uma-s-1 -opt rsirfo_fsb -ma 100 1 13 100 1 17 200 15 19
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）今回はUMAモデルのNNPを使用し、ラジカル反応を扱うためスピンだ重度を2とした。
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。


これを実行すると、`omol`のデータセットを使用した`uma-s-1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`co_cat_oxidative_cyclization_P_mmdiMePh_3_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.15.3`ディレクトリに置く。

`co_cat_oxidative_cyclization_P_mmdiMePh_3_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`co_cat_oxidative_cyclization_P_mmdiMePh_3_traj.xyz`は次のNEB計算に使用する。

※`co_cat_oxidative_cyclization_P_mmdiMePh_3_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`co_cat_oxidative_cyclization_P_mmdiMePh_3_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `co_cat_oxidative_cyclization_P_mmdiMePh_3_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`co_cat_oxidative_cyclization_P_mmdiMePh_3_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）



```
python .\nebmain.py co_cat_oxidative_cyclization_P_mmdiMePh_3_traj.xyz -os uma-s-1 -ns 15 -modelhess -spng -nd 0.3 -aneb 3 5
```

- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `-aneb A B`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.15.3`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-3003.016239633491,-3002.9890983808045,-3002.990062388827,-3002.989262636732,-3002.9763916992833,-3002.9679944687578,-3002.9704407228983,-3002.981465364846,-3002.989323924949,-3003.0183003194693,-3003.040105414284,-3003.063347360756,-3003.0811082568257,-3003.093586204937,-3003.0959002622762,-3003.096766323053,-3003.0971804018454,-3003.097446249893,-3003.097714060565,-3003.0979634891532,-3003.0983105232795,-3003.0985992744577,-3003.0988599881384,-3003.098941402022,-3003.09901626214,-3003.0991410290044,-3003.099242419605,-3003.0993160005128,-3003.099346210917,-3003.09939967492,-3003.0994812114673,-3003.0995115971054,-3003.0995943077232];

export const dataset1_itr5 = [-3003.016260950751,-3003.008907678924,-3003.0004812105453,-3002.9990352467016,-3002.984015454106,-3002.975295310464,-3002.9853616745527,-3002.991339645791,-3003.001158964479,-3003.0435568828066,-3003.0622650082087,-3003.0778877647126,-3003.093961241514,-3003.1001236556776,-3003.100214269365,-3003.1016454083824,-3003.10216166633,-3003.102965992042,-3003.1030409748246,-3003.1031381773237,-3003.103726036031,-3003.103840814537,-3003.104116265427,-3003.10418620146,-3003.104539736781,-3003.104494018137,-3003.104954446417,-3003.1050999960767,-3003.105275458241,-3003.105130995035,-3003.105182969546,-3003.1054985841515,-3003.1059399469336];

export const dataset1_itr10 = [-3003.0162692568597,-3003.0138497697676,-3003.0090653898483,-3003.0078446021566,-3002.991810193856,-3002.9863589070096,-3002.9822415742046,-3002.9802640194066,-3002.9809364812627,-3002.982790320603,-3002.985921881278,-3002.9893761185035,-3002.992074315845,-3002.997377722415,-3003.015598722581,-3003.063790230554,-3003.074313088912,-3003.0846227921943,-3003.0978359711094,-3003.1020913447815,-3003.1020019226876,-3003.102099002523,-3003.1019618816363,-3003.1018978685247,-3003.102581878325,-3003.102753134865,-3003.1028804951975,-3003.102937008279,-3003.1034514437893,-3003.104052515167,-3003.1042429773925,-3003.1045097191354,-3003.1048816715875,-3003.105032127809,-3003.1054341504773,-3003.1054790104736,-3003.1057571424494,-3003.105542532929,-3003.105533806258,-3003.105506154276,-3003.1055248342586,-3003.1057540933716,-3003.105838468716,-3003.1058981710626,-3003.1059486911286,-3003.1061427456584,-3003.106259294031,-3003.106133247956,-3003.1061558531887,-3003.1061545915013,-3003.106097938233,-3003.1060703037742,-3003.10610032142,-3003.1061184406526,-3003.106131197714,-3003.106536479742,-3003.1068540219253];


export const dataset2 = [-3003.0162998002083,-3003.0150309895407,-3003.0132783480435,-3003.012543003337,-3003.0002019921167,-3002.9925112890064,-3002.986652591035,-3002.9856686763897,-3002.9843709170054,-3002.9839218351494,-3002.9836948190364,-3002.9835613167393,-3002.9836806513385,-3002.983993961612,-3002.9844968053694,-3002.9874303687416,-3002.990090102141,-3002.9932116919813,-3002.9962753055333,-3003.0020971429567,-3003.0357963663278,-3003.0793541433595,-3003.082067717516,-3003.0902918164943,-3003.100311769763,-3003.1028102612663,-3003.1027708861056,-3003.1027806466595,-3003.10266350249,-3003.102611457885,-3003.1024241148307,-3003.1024048916215,-3003.102381970967,-3003.1026873518863,-3003.1028712428233,-3003.103035384848,-3003.103175554813,-3003.1033597086016,-3003.1034216364246,-3003.1034298198692,-3003.1041394314093,-3003.1046311390232,-3003.104797997181,-3003.1051128933254,-3003.105442894672,-3003.1055375737965,-3003.1059528792293,-3003.1059025168747,-3003.1059084397957,-3003.105894578758,-3003.1058714127757,-3003.1059996668037,-3003.106062943931,-3003.106121472207,-3003.106183995827,-3003.1059766234853,-3003.1059058463275,-3003.105885098579,-3003.10580105618,-3003.1057982874772,-3003.1057972535946,-3003.105803737266,-3003.1058078552733,-3003.1058117980465,-3003.105814987312,-3003.1060244975124,-3003.1062066886766,-3003.1062572087426,-3003.1062777987795,-3003.1064992950105,-3003.106599791916,-3003.106527157274,-3003.106517554431,-3003.106454785483,-3003.1064454454918,-3003.1064192304316,-3003.1064374372813,-3003.106450001585,-3003.1064630740684,-3003.106476812442,-3003.106497858089,-3003.106499943378,-3003.106398184785,-3003.1063793120443,-3003.106347910047,-3003.106375439365,-3003.106386812075,-3003.1064002875974,-3003.1064139208306,-3003.1064796512387,-3003.1065185707903,-3003.1067791267596,-3003.1067643194565];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [7.653134846373075e-05,0.01216657590090512,0.005410298989058981,0.005327012512163181,0.005545738873881512,0.006650554283508824,0.009916413449920617,0.00608809356558809,0.006547233375290569,0.009776857534863286,0.009115741363699206,0.008403701020668746,0.007634454165908265,0.005956763479253786,0.005367992886110123,0.005608711087184688,0.005566415464377607,0.005560687523790318,0.005568207622322563,0.005507477321514292,0.005495565022987221,0.005532975737677253,0.005452741640229877,0.005479679924136925,0.005489576008287501,0.005498179384205513,0.005503237947720556,0.005512701924621064,0.005534072093642209,0.005528092680612323,0.005531650399963888,0.0055231926876618785,0.005532212177273481];

export const dataset1_grad_itr5 = [0.00043496217133934836,0.0037308802756316935,0.004234071977429898,0.004080251680519783,0.003878080927542414,0.0032768115352100587,0.003750982028371472,0.002853507189414302,0.004604940537266696,0.007773463275672954,0.005138352815998008,0.0031739085266312013,0.002658473001148324,0.001997510252041675,0.0028646721265391775,0.002243017067836111,0.0022623058732747963,0.002146196170750231,0.0022088338806330824,0.0023686686038053117,0.0021986674163709543,0.00222383686296737,0.0023285069969192036,0.002386727280434685,0.0022679059288637483,0.0022069607949360176,0.0017013443012128852,0.001747171980192379,0.0015804102703251637,0.001657097108287029,0.0017352560571038743,0.0014035341203316133,0.0012125408874679275];

export const dataset1_grad_itr10 = [0.0004497068914927913,0.0017251041174700327,0.002797943363585191,0.0027078524332409255,0.003427047635464691,0.0030739993988573105,0.002695422174513679,0.0023600697255767283,0.002766001504369642,0.003358829508054193,0.003612783832935649,0.0034092746847237034,0.0030238765390945958,0.0025341862499924264,0.006625036187468872,0.006675541234497886,0.0038006031508441055,0.0026172093401469494,0.0018263268069764454,0.0010309021018726444,0.001401378379355422,0.0016626785421193246,0.0019347274802448487,0.0019500463524248241,0.001490222138614128,0.001454197319746229,0.0014336179788478152,0.001438515835440321,0.0015787807067868679,0.001549151625821382,0.001420426195458886,0.001587649782257873,0.0015118507813419095,0.0013659328213055542,0.001353888782898752,0.0013302768212313917,0.0012587751246972657,0.0014665378225733846,0.0014844850056040199,0.0015163642474085406,0.0014468404750010897,0.0010604993362158049,0.0009998545689484965,0.0009624939340641707,0.0009330919505441396,0.0009449937675418511,0.0008038869792981345,0.0009496955942059531,0.0009628905764518319,0.0009775336493863043,0.0010406829196495135,0.0010903371809895626,0.0010893219392410856,0.0010998885087578458,0.0011148221356171346,0.000646102049514157,0.00043770522259742496];


export const dataset2_grad = [0.00045264956409749057,0.0011058992502131371,0.0017231349993444168,0.001731404828794549,0.003139202483118423,0.002757120318668945,0.0022371235348042575,0.0021414346524372243,0.002071772492265537,0.0020240609222931705,0.002072255285592909,0.0021639333435490675,0.0023070570673240634,0.002494512943881472,0.0027092460940496632,0.0032843081321166996,0.003359352475301106,0.0030793812955487963,0.0028610756079202305,0.0026209750115035024,0.00807875789745455,0.005287988500811921,0.0030735694338166774,0.002578301519770287,0.0014106315684512703,0.0007657192504856442,0.0011126755058001243,0.0013341254819721666,0.0015793323610604386,0.0016338923372089648,0.001700657607692051,0.0017023882963475372,0.0017020080786532572,0.0015367725388090161,0.00142086316318691,0.0013278266337679264,0.0012639919688640536,0.0011202113944520373,0.0012096764529157618,0.0012333253680814565,0.0012677399209816925,0.0012139000056236456,0.0011352766000865655,0.0012626899725086238,0.0011745837489888819,0.000980217163101346,0.00088764464185265,0.0009195787284703263,0.0009249401663281877,0.0009462599118777804,0.0009584971655307093,0.0008586233248151432,0.0008473805544952439,0.0008311027344990179,0.0007788041930216002,0.001166536238280921,0.001216204010576399,0.0012786828458035608,0.0013709805652759475,0.0013765645051377472,0.0013811837409463746,0.0013745341360688276,0.0013676681174539908,0.0013606784318023718,0.001355059693766491,0.0009930097495270606,0.0007321491551519945,0.0007238638544776856,0.0007145223217899561,0.0006195113869906395,0.0005152733299950197,0.0005862994116931382,0.0006115275999985517,0.0006604741338027748,0.0006679595263261363,0.0007055301010453847,0.0007126281172828225,0.0007107397357412924,0.0007104523700314411,0.000707253894524998,0.0007256279196701264,0.000729962076503447,0.0008286888175920449,0.0008514037185092731,0.0008897728170455352,0.0008778493820993076,0.0008745444620580114,0.0008699560791421623,0.0008651952386590117,0.0008271005443682761,0.0007882311040306431,0.0004982538286617255,0.0006114929137535439];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、緩和後に得られた経路の11番(グラフ上では12番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`co_cat_oxidative_cyclization_P_mmdiMePh_3_traj_11.xyz`
```
71
0 1
Co      2.780151731046     -0.368974926117     -0.201262339858
C       4.148444147698      0.254198010525     -1.784003836984
C       3.405108196699      1.430320969054     -1.598121549905
C       3.325094385445     -0.669550176101     -2.457637778981
H       5.141383091969      0.070383868936     -1.407010275597
C       2.200867634406      1.308755625294     -2.379290011617
H       3.771875713047      2.326768300904     -1.118912911143
C       2.155356709426      0.038800812929     -2.899711705292
H       3.601068363811     -1.679766301699     -2.721087214637
H       1.441250853081      2.070695415018     -2.440403088763
H       1.345870481762     -0.403590679440     -3.456350971445
P       0.454160834725     -0.179255617583     -0.072104748408
C       2.779931193737      0.207000632154      1.599639445780
H       2.085956913995      0.469676381753      2.389947507892
C       4.013388711681      0.119164804839      1.237711436551
H       4.969633208552      0.605981028661      1.334302379286
C       3.065602158150     -2.062529615619      0.523254115674
H       2.543264115334     -2.981046906207      0.732947093460
C       4.221417726334     -1.494185890962      0.490658647518
H       5.278681690680     -1.645339806485      0.349269657095
C      -0.755167661283     -0.555086775888     -1.403065989913
C      -1.383219176867     -1.785400423671     -1.541588496042
C      -1.012919889883      0.437014365497     -2.348606011680
C      -2.254124481355     -2.034612067794     -2.599050817615
H      -1.225196688755     -2.570146044285     -0.816348043513
C      -1.869002463945      0.213120335705     -3.414753475769
H      -0.543241680748      1.406629575773     -2.250786812457
C      -2.481742430466     -1.031643594228     -3.528908369108
H      -3.153441762300     -1.219627377934     -4.359949809161
C      -0.118661930868      1.504402926778      0.373728566176
C      -1.483280554512      1.760702233392      0.508154651627
C       0.785966840156      2.541664841060      0.554298819840
C      -1.947659151493      3.028152089021      0.821279078441
H      -2.193328845422      0.955112402314      0.357311442284
C       0.346196470282      3.827908838176      0.864802857486
H       1.846031590356      2.352341550242      0.437455770765
C      -1.017397224044      4.051481401243      0.994254063644
H      -1.371302595546      5.050268910667      1.232838123493
C      -0.164768357448     -1.176122757173      1.347723559882
C      -0.645741724152     -0.606420553184      2.518988909017
C      -0.049229632285     -2.566543553875      1.282828095848
C      -1.039556682501     -1.398794993207      3.598164602449
H      -0.714221488924      0.470724343181      2.611023216365
C      -0.455773173217     -3.378551801517      2.328696550570
H       0.375302967440     -3.027597077881      0.398423669304
C      -0.951009151205     -2.776777082697      3.483714561754
H      -1.260699877655     -3.400647062009      4.315809021634
C      -2.141643423173      1.305713562579     -4.412523817882
H      -2.444311830694      0.892697590648     -5.374468068437
H      -2.944002342651      1.959908192204     -4.063757692459
H      -1.256167267750      1.922199257431     -4.567971824422
C      -2.944279698337     -3.367441968698     -2.699445142320
H      -2.233078377662     -4.186373581135     -2.583096721393
H      -3.697488908713     -3.474535012668     -1.916006767113
H      -3.442444422112     -3.482002614776     -3.661035079428
C      -0.374757286300     -4.876585004687      2.213293494918
H      -0.085597869079     -5.329957066093      3.161059821076
H      -1.341952284785     -5.296791432918      1.928162072730
H       0.350665017631     -5.174357280730      1.456107085749
C      -1.564654775386     -0.751324862677      4.850869941252
H      -0.899211528475      0.044893354606      5.187027577992
H      -2.545191368776     -0.304503422484      4.674506504556
H      -1.665295507031     -1.476558517475      5.657078003252
C      -3.422380952279      3.298077435807      0.949542442105
H      -3.646488511989      3.826068562300      1.877333646009
H      -3.779078976196      3.917743200529      0.124514897692
H      -3.991743763169      2.369281507896      0.939916455086
C       1.328913486137      4.952905124629      1.054000578534
H       1.082636847857      5.802900445564      0.415701725050
H       1.324253808614      5.306781351579      2.086757083468
H       2.341980829376      4.632202601012      0.814162198035

```


<MoleculeViewer 
  xyzData={`71
0 1
Co      2.780151731046     -0.368974926117     -0.201262339858
C       4.148444147698      0.254198010525     -1.784003836984
C       3.405108196699      1.430320969054     -1.598121549905
C       3.325094385445     -0.669550176101     -2.457637778981
H       5.141383091969      0.070383868936     -1.407010275597
C       2.200867634406      1.308755625294     -2.379290011617
H       3.771875713047      2.326768300904     -1.118912911143
C       2.155356709426      0.038800812929     -2.899711705292
H       3.601068363811     -1.679766301699     -2.721087214637
H       1.441250853081      2.070695415018     -2.440403088763
H       1.345870481762     -0.403590679440     -3.456350971445
P       0.454160834725     -0.179255617583     -0.072104748408
C       2.779931193737      0.207000632154      1.599639445780
H       2.085956913995      0.469676381753      2.389947507892
C       4.013388711681      0.119164804839      1.237711436551
H       4.969633208552      0.605981028661      1.334302379286
C       3.065602158150     -2.062529615619      0.523254115674
H       2.543264115334     -2.981046906207      0.732947093460
C       4.221417726334     -1.494185890962      0.490658647518
H       5.278681690680     -1.645339806485      0.349269657095
C      -0.755167661283     -0.555086775888     -1.403065989913
C      -1.383219176867     -1.785400423671     -1.541588496042
C      -1.012919889883      0.437014365497     -2.348606011680
C      -2.254124481355     -2.034612067794     -2.599050817615
H      -1.225196688755     -2.570146044285     -0.816348043513
C      -1.869002463945      0.213120335705     -3.414753475769
H      -0.543241680748      1.406629575773     -2.250786812457
C      -2.481742430466     -1.031643594228     -3.528908369108
H      -3.153441762300     -1.219627377934     -4.359949809161
C      -0.118661930868      1.504402926778      0.373728566176
C      -1.483280554512      1.760702233392      0.508154651627
C       0.785966840156      2.541664841060      0.554298819840
C      -1.947659151493      3.028152089021      0.821279078441
H      -2.193328845422      0.955112402314      0.357311442284
C       0.346196470282      3.827908838176      0.864802857486
H       1.846031590356      2.352341550242      0.437455770765
C      -1.017397224044      4.051481401243      0.994254063644
H      -1.371302595546      5.050268910667      1.232838123493
C      -0.164768357448     -1.176122757173      1.347723559882
C      -0.645741724152     -0.606420553184      2.518988909017
C      -0.049229632285     -2.566543553875      1.282828095848
C      -1.039556682501     -1.398794993207      3.598164602449
H      -0.714221488924      0.470724343181      2.611023216365
C      -0.455773173217     -3.378551801517      2.328696550570
H       0.375302967440     -3.027597077881      0.398423669304
C      -0.951009151205     -2.776777082697      3.483714561754
H      -1.260699877655     -3.400647062009      4.315809021634
C      -2.141643423173      1.305713562579     -4.412523817882
H      -2.444311830694      0.892697590648     -5.374468068437
H      -2.944002342651      1.959908192204     -4.063757692459
H      -1.256167267750      1.922199257431     -4.567971824422
C      -2.944279698337     -3.367441968698     -2.699445142320
H      -2.233078377662     -4.186373581135     -2.583096721393
H      -3.697488908713     -3.474535012668     -1.916006767113
H      -3.442444422112     -3.482002614776     -3.661035079428
C      -0.374757286300     -4.876585004687      2.213293494918
H      -0.085597869079     -5.329957066093      3.161059821076
H      -1.341952284785     -5.296791432918      1.928162072730
H       0.350665017631     -5.174357280730      1.456107085749
C      -1.564654775386     -0.751324862677      4.850869941252
H      -0.899211528475      0.044893354606      5.187027577992
H      -2.545191368776     -0.304503422484      4.674506504556
H      -1.665295507031     -1.476558517475      5.657078003252
C      -3.422380952279      3.298077435807      0.949542442105
H      -3.646488511989      3.826068562300      1.877333646009
H      -3.779078976196      3.917743200529      0.124514897692
H      -3.991743763169      2.369281507896      0.939916455086
C       1.328913486137      4.952905124629      1.054000578534
H       1.082636847857      5.802900445564      0.415701725050
H       1.324253808614      5.306781351579      2.086757083468
H       2.341980829376      4.632202601012      0.814162198035
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`co_cat_oxidative_cyclization_P_mmdiMePh_3_traj_11.xyz`を`MultiOptPy-v1.15.3`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py .\co_cat_oxidative_cyclization_P_mmdiMePh_3_traj_11.xyz -fc 5 -order 1 -opt rsirfo_bofill -freq -tcc -os uma-s-1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
71
OptimizedStructure
Co     2.593021911661     -0.747515868906     -0.472929322916
C      3.795773553733     -0.450651178837     -2.171269260089
C      3.358611103522      0.847822587674     -1.834439927736
C      2.698379506049     -1.102512798296     -2.762531480340
H      4.751661902518     -0.887565359873     -1.931698168132
C      2.105792530783      1.083286660376     -2.542501419378
H      3.980456242800      1.613654384083     -1.394451058234
C      1.712627799910     -0.091987917838     -3.103268685314
H      2.680952839575     -2.127568714061     -3.099899609938
H      1.547968412898      2.008263765066     -2.533504430031
H      0.786834271633     -0.277415614627     -3.625453792858
P      0.470587603909     -0.143265867801     -0.026873427382
C      3.206666455301      0.054608572731      1.218200525891
H      2.944298555447      0.875823101533      1.861756829722
C      4.136624350306     -0.741573715703      0.902843161524
H      5.163186842080     -1.022768416389      1.046494328228
C      2.220888546230     -2.570932927616      0.106110464457
H      1.386429168754     -3.245743210046      0.160137823064
C      3.481486420269     -2.489383744266      0.109120927905
H      4.414784845081     -3.019254304340      0.076282858240
C     -0.772921831806     -0.356613709867     -1.344521868977
C     -0.966263151418     -1.649645220645     -1.836917084004
C     -1.434487869334      0.703122711734     -1.939086512924
C     -1.815651856822     -1.887132662463     -2.902268334601
H     -0.431125220453     -2.479957349266     -1.387357149631
C     -2.288992364987      0.492235260798     -3.023735455086
H     -1.281675322719      1.712597942137     -1.575197428650
C     -2.469151954229     -0.799933777724     -3.488143477032
H     -3.130700627549     -0.973170206107     -4.331176524747
C      0.170776702801      1.574998875616      0.543709584788
C     -1.039301101550      1.942059847851      1.137699213323
C      1.157458607088      2.533282327331      0.377535046265
C     -1.265764268560      3.244656610245      1.549140034028
H     -1.815641456186      1.200547883880      1.284913326466
C      0.955632673297      3.854124130347      0.782103653313
H      2.099351481750      2.248664062882     -0.073463949042
C     -0.256187921220      4.190765055896      1.361350840014
H     -0.424761310452      5.213971704056      1.682822431640
C     -0.297241954133     -1.097594410161      1.345571362780
C     -1.651145221634     -1.420983109740      1.363432338865
C      0.503199680018     -1.489666490338      2.414991206062
C     -2.209208696139     -2.117556065084      2.430639530981
H     -2.286373082897     -1.143610329434      0.530372404306
C     -0.030864718304     -2.179780281209      3.496244218417
H      1.565835808463     -1.276341556328      2.391384669995
C     -1.386854064877     -2.489546328389      3.486779303762
H     -1.809655596781     -3.046052386713      4.317647252822
C     -2.979315844751      1.660684267025     -3.673431075221
H     -2.254400440894      2.317887876554     -4.157524126367
H     -3.690982450494      1.330230558993     -4.429106145074
H     -3.517640646454      2.257369765579     -2.935306760951
C     -2.031713644912     -3.278678296323     -3.432133306275
H     -1.801501138927     -3.331725627980     -4.497421904351
H     -1.400985672003     -3.999383516133     -2.913194786978
H     -3.071256357113     -3.587703364636     -3.306959702803
C      0.842584050185     -2.576473476151      4.655534209808
H      0.519796829981     -3.523210850248      5.089219782852
H      1.882368656399     -2.676350186414      4.345159384672
H      0.803831178037     -1.822480056922      5.444878995791
C     -3.678980643483     -2.443036343555      2.444949725102
H     -4.242346798987     -1.675959387745      2.981187021807
H     -4.078977849159     -2.498817406869      1.432611578306
H     -3.868078271237     -3.395246566184      2.940842770439
C     -2.567272107917      3.640360650699      2.193140714003
H     -2.406672133580      3.997313142835      3.212043737276
H     -3.051452023741      4.445624553727      1.637911227168
H     -3.255921910112      2.797397406769      2.236603917662
C      2.041363015876      4.876580512583      0.580681345643
H      1.756397867867      5.843942495720      0.992649941323
H      2.968834621387      4.561696904118      1.061963787133
H      2.257003490206      5.011214982390     -0.480895300786

```

<MoleculeViewer 
  xyzData={`71
OptimizedStructure
Co     2.593021911661     -0.747515868906     -0.472929322916
C      3.795773553733     -0.450651178837     -2.171269260089
C      3.358611103522      0.847822587674     -1.834439927736
C      2.698379506049     -1.102512798296     -2.762531480340
H      4.751661902518     -0.887565359873     -1.931698168132
C      2.105792530783      1.083286660376     -2.542501419378
H      3.980456242800      1.613654384083     -1.394451058234
C      1.712627799910     -0.091987917838     -3.103268685314
H      2.680952839575     -2.127568714061     -3.099899609938
H      1.547968412898      2.008263765066     -2.533504430031
H      0.786834271633     -0.277415614627     -3.625453792858
P      0.470587603909     -0.143265867801     -0.026873427382
C      3.206666455301      0.054608572731      1.218200525891
H      2.944298555447      0.875823101533      1.861756829722
C      4.136624350306     -0.741573715703      0.902843161524
H      5.163186842080     -1.022768416389      1.046494328228
C      2.220888546230     -2.570932927616      0.106110464457
H      1.386429168754     -3.245743210046      0.160137823064
C      3.481486420269     -2.489383744266      0.109120927905
H      4.414784845081     -3.019254304340      0.076282858240
C     -0.772921831806     -0.356613709867     -1.344521868977
C     -0.966263151418     -1.649645220645     -1.836917084004
C     -1.434487869334      0.703122711734     -1.939086512924
C     -1.815651856822     -1.887132662463     -2.902268334601
H     -0.431125220453     -2.479957349266     -1.387357149631
C     -2.288992364987      0.492235260798     -3.023735455086
H     -1.281675322719      1.712597942137     -1.575197428650
C     -2.469151954229     -0.799933777724     -3.488143477032
H     -3.130700627549     -0.973170206107     -4.331176524747
C      0.170776702801      1.574998875616      0.543709584788
C     -1.039301101550      1.942059847851      1.137699213323
C      1.157458607088      2.533282327331      0.377535046265
C     -1.265764268560      3.244656610245      1.549140034028
H     -1.815641456186      1.200547883880      1.284913326466
C      0.955632673297      3.854124130347      0.782103653313
H      2.099351481750      2.248664062882     -0.073463949042
C     -0.256187921220      4.190765055896      1.361350840014
H     -0.424761310452      5.213971704056      1.682822431640
C     -0.297241954133     -1.097594410161      1.345571362780
C     -1.651145221634     -1.420983109740      1.363432338865
C      0.503199680018     -1.489666490338      2.414991206062
C     -2.209208696139     -2.117556065084      2.430639530981
H     -2.286373082897     -1.143610329434      0.530372404306
C     -0.030864718304     -2.179780281209      3.496244218417
H      1.565835808463     -1.276341556328      2.391384669995
C     -1.386854064877     -2.489546328389      3.486779303762
H     -1.809655596781     -3.046052386713      4.317647252822
C     -2.979315844751      1.660684267025     -3.673431075221
H     -2.254400440894      2.317887876554     -4.157524126367
H     -3.690982450494      1.330230558993     -4.429106145074
H     -3.517640646454      2.257369765579     -2.935306760951
C     -2.031713644912     -3.278678296323     -3.432133306275
H     -1.801501138927     -3.331725627980     -4.497421904351
H     -1.400985672003     -3.999383516133     -2.913194786978
H     -3.071256357113     -3.587703364636     -3.306959702803
C      0.842584050185     -2.576473476151      4.655534209808
H      0.519796829981     -3.523210850248      5.089219782852
H      1.882368656399     -2.676350186414      4.345159384672
H      0.803831178037     -1.822480056922      5.444878995791
C     -3.678980643483     -2.443036343555      2.444949725102
H     -4.242346798987     -1.675959387745      2.981187021807
H     -4.078977849159     -2.498817406869      1.432611578306
H     -3.868078271237     -3.395246566184      2.940842770439
C     -2.567272107917      3.640360650699      2.193140714003
H     -2.406672133580      3.997313142835      3.212043737276
H     -3.051452023741      4.445624553727      1.637911227168
H     -3.255921910112      2.797397406769      2.236603917662
C      2.041363015876      4.876580512583      0.580681345643
H      1.756397867867      5.843942495720      0.992649941323
H      2.968834621387      4.561696904118      1.061963787133
H      2.257003490206      5.011214982390     -0.480895300786
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -434.7947             21.2317             24.0939
Reduced mass [au]                   5.4357              1.6856              1.6145
Force const [Dyne/A]               -0.6054              0.0004              0.0006
Char temp [K]                       0.0000             30.5477             34.6657
Normal mode                   x         y         z            x         y         z            x         y         z     
      Co                -0.02475    0.00557   -0.00328    0.00128    0.00419   -0.00317    0.00224    0.00024    0.00764
       C                -0.00469    0.00587   -0.00282    0.00125    0.02282   -0.00099    0.00702   -0.01896    0.00864
       C                 0.00055    0.00737   -0.00877   -0.00390    0.01820    0.00974    0.00789   -0.01441   -0.00837
       C                -0.00341    0.00313   -0.00327    0.00326    0.02254   -0.00433    0.00736   -0.02492    0.01400
       H                -0.00717    0.00297    0.00362    0.00340    0.02510   -0.00539    0.00601   -0.01718    0.01595
       C                -0.00140    0.00308   -0.00463   -0.00656    0.01802    0.01449    0.00992   -0.02148   -0.01433
       H                -0.00000    0.00990   -0.01277   -0.00659    0.01745    0.01485    0.00730   -0.01006   -0.01510
       C                -0.00101    0.00204   -0.00491   -0.00233    0.02037    0.00615    0.00980   -0.02754   -0.00121
       H                 0.00320    0.00559   -0.01089    0.00700    0.02503   -0.01199    0.00732   -0.02875    0.02563
       H                -0.00107    0.00340   -0.00690   -0.01087    0.01533    0.02388    0.01099   -0.02073   -0.02760
       H                -0.00041    0.00262   -0.00647   -0.00290    0.01926    0.00749    0.01105   -0.03194   -0.00180
       P                -0.00023    0.00054   -0.00023    0.00025    0.00071    0.00203    0.00041   -0.00011   -0.00002
       C                 0.00771   -0.04973   -0.05088    0.00070   -0.01241    0.00519   -0.01192    0.02011    0.00356
       H                 0.20618    0.02884   -0.06468   -0.00043   -0.02086    0.01549   -0.02045    0.02607   -0.00754
       C                -0.03170   -0.16781   -0.00470    0.00207   -0.00716   -0.00418   -0.00628    0.02140    0.01703
       H                -0.00456   -0.04271    0.08714    0.00271   -0.00656   -0.00753   -0.00563    0.02828    0.02582
       C                 0.04096    0.05833   -0.00374    0.00464   -0.00265   -0.02166    0.00846    0.00323    0.02108
       H                 0.14362   -0.08374   -0.12919    0.00684   -0.00594   -0.02943    0.01060    0.00044    0.01950
       C                 0.07273    0.11817    0.10808    0.00453   -0.00011   -0.02114    0.00791    0.00967    0.03082
       H                 0.00007   -0.02072    0.10138    0.00543    0.00182   -0.02705    0.01103    0.01445    0.04305
       C                 0.00199   -0.00020   -0.00118   -0.00102   -0.00526    0.00387    0.00195    0.00621   -0.00228
       C                 0.00042   -0.00035    0.00033   -0.01071   -0.00923    0.01868    0.00311    0.00891   -0.00982
       C                 0.00098   -0.00005   -0.00017    0.00971   -0.00662   -0.01100   -0.00150    0.00890    0.00657
       C                 0.00032   -0.00009    0.00019   -0.01013   -0.01482    0.01923    0.00041    0.01418   -0.00876
       H                -0.00163   -0.00012    0.00310   -0.02062   -0.00890    0.03096    0.00662    0.00729   -0.01676
       C                 0.00025    0.00002    0.00045    0.01175   -0.01211   -0.01124   -0.00411    0.01426    0.00748
       H                 0.00134   -0.00026    0.00011    0.01793   -0.00350   -0.02318   -0.00301    0.00669    0.01349
       C                 0.00035   -0.00007    0.00034    0.00160   -0.01631    0.00387   -0.00302    0.01689   -0.00014
       H                 0.00016   -0.00001    0.00046    0.00274   -0.02066    0.00387   -0.00482    0.02106    0.00042
       C                 0.00115    0.00064   -0.00069   -0.00353    0.00167   -0.00220    0.00230   -0.00026    0.00143
       C                 0.00056   -0.00027   -0.00067   -0.01570    0.00762   -0.03035    0.01612   -0.00702    0.03337
       C                 0.00081    0.00051   -0.00032    0.00595   -0.00372    0.02406   -0.01062    0.00737   -0.03309
       C                 0.00018   -0.00029   -0.00030   -0.01826    0.00789   -0.03321    0.01706   -0.00618    0.03214
       H                 0.00090   -0.00060   -0.00050   -0.02437    0.01256   -0.05173    0.02729   -0.01301    0.06191
       C                 0.00003    0.00015   -0.00002    0.00483   -0.00389    0.02456   -0.01192    0.00896   -0.03961
       H                 0.00052    0.00082   -0.00112    0.01401   -0.00731    0.04323   -0.01932    0.01157   -0.05389
       C                -0.00002   -0.00006   -0.00002   -0.00733    0.00207   -0.00472    0.00209    0.00198   -0.00579
       H                -0.00023   -0.00016    0.00020   -0.00906    0.00226   -0.00624    0.00234    0.00268   -0.00786
       C                 0.00211   -0.00222   -0.00066    0.00356    0.00027    0.00372   -0.00362   -0.00228   -0.00399
       C                 0.00138   -0.00013   -0.00078   -0.00515    0.02501    0.01844   -0.00465   -0.01083   -0.01255
       C                 0.00134   -0.00048   -0.00006    0.00868   -0.02633   -0.01356   -0.00967    0.00302   -0.00124
       C                 0.00046    0.00049   -0.00037   -0.00315    0.02621    0.01655   -0.00536   -0.01546   -0.01948
       H                 0.00185   -0.00035   -0.00121   -0.00981    0.04388    0.02842   -0.00078   -0.01215   -0.01556
       C                 0.00033   -0.00003   -0.00030    0.00910   -0.02952   -0.01180   -0.01325   -0.00180   -0.00252
       H                 0.00091    0.00505    0.00009    0.01262   -0.04653   -0.02475   -0.01053    0.00955    0.00641
       C                 0.00011    0.00025   -0.00040    0.00574   -0.00204    0.00350   -0.00804   -0.01133   -0.01214
       H                -0.00024    0.00062   -0.00024    0.00584   -0.00280    0.00307   -0.00985   -0.01514   -0.01558
       C                 0.00007   -0.00011    0.00029    0.02668   -0.01369   -0.03000   -0.00923    0.01706    0.01794
       H                 0.00005   -0.00028    0.00004    0.03396   -0.03932   -0.05404   -0.01162    0.02877    0.03033
       H                -0.00002   -0.00039    0.00050    0.01147   -0.01729   -0.01411   -0.00251    0.02099    0.00991
       H                 0.00016    0.00012    0.00017    0.04723    0.01412   -0.03759   -0.01808    0.00364    0.02238
       C                 0.00001   -0.00001    0.00017   -0.02530   -0.02030    0.03983    0.00017    0.01704   -0.01609
       H                 0.00034    0.00002    0.00022   -0.06741   -0.02938    0.03132   -0.02149    0.02755   -0.02124
       H                -0.00017   -0.00000    0.00046   -0.00283   -0.01338    0.02214    0.01600    0.01746   -0.03475
       H                -0.00004    0.00007   -0.00010   -0.01930   -0.02291    0.08416    0.00504    0.00822    0.00298
       C                 0.00010    0.00024   -0.00003    0.02382   -0.05290   -0.03092   -0.01206    0.01258    0.00143
       H                 0.00040    0.00012    0.00011   -0.12606    0.06639    0.11649   -0.15577    0.13698    0.16450
       H                 0.00007    0.00072   -0.00028   -0.01980   -0.29396   -0.10134   -0.04910   -0.22058   -0.04955
       H                 0.00023    0.00034   -0.00013    0.23723    0.05799   -0.12632    0.17780    0.14058   -0.11145
       C                 0.00029    0.00039   -0.00033   -0.00741    0.04635    0.03923   -0.00078   -0.03655   -0.02376
       H                -0.00005    0.00003   -0.00012    0.04540   -0.09146    0.29147    0.02332   -0.20329    0.23964
       H                 0.00012    0.00036   -0.00030   -0.08371    0.32387    0.05459   -0.06200    0.25365   -0.01496
       H                 0.00051    0.00019   -0.00055    0.01502   -0.08503   -0.20305    0.04201   -0.18518   -0.29121
       C                 0.00016   -0.00036   -0.00010   -0.03339    0.01514   -0.06822    0.03443   -0.01493    0.07265
       H                 0.00017   -0.00053   -0.00003   -0.05767    0.02705   -0.06861    0.06366   -0.01860    0.06938
       H                 0.00005   -0.00029    0.00006   -0.02023    0.00869   -0.08915    0.01392   -0.01478    0.09083
       H                 0.00017   -0.00039   -0.00011   -0.03450    0.01569   -0.07508    0.03986   -0.01844    0.09008
       C                -0.00001    0.00024    0.00008    0.01764   -0.01098    0.05750   -0.03033    0.01933   -0.08614
       H                 0.00011    0.00026    0.00017    0.00224   -0.00337    0.02897   -0.00326    0.00492   -0.03354
       H                 0.00002    0.00015    0.00004   -0.00570   -0.00636    0.10569    0.00687    0.00656   -0.16661
       H                 0.00008    0.00026    0.00007    0.06727   -0.02914    0.06535   -0.11075    0.05550   -0.09806
                     
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(3,5-dimethylphenyl)phosphineのある1つの遷移状態構造を算出する手順を説明した。




## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.

