---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応3, NNP使用）
published: 2025-09-01
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-09-01

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

移動挿入反応について：
- https://en.wikipedia.org/wiki/Migratory_insertion
- https://chem.libretexts.org/Bookshelves/Inorganic_Chemistry/Organometallic_Chemistry_(Evans)/04%3A_Fundamentals_of_Organometallic_Chemistry/4.05%3A_Migratory_Insertion-_12-Insertions

今回参考にした論文
- _Org. Lett._ 2025, 27, 2005-2010 (論文中の計算に使用している系の基質の置換基を変えて計算を行った。)
 
今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)

:::note

今回は反応に関わる系中のDPPBZ配位子のフェニル基の最安定な立体配座の探索は行わずに算出した。本来は、適当に１つ遷移状態構造を求めた後に、その構造のフェニル基を回転させることで立体配座探索を行うことで最安定な遷移状態構造を探す必要がある。

:::

## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.15.1b
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.15.1b.zip
unzip v1.15.1b.zip
cd MultiOptPy-v1.15.1b
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.15.1b`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1::(uma-s-1.ptの絶対パス)
```

これで、`MultiOptPy-v1.15.1b`がNNP`uma-s-1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`migratory_insertion_CuH_Ph_dppbz.xyz`とした。
初期構造は以下のものを使用した。

```
78

Cu     1.286017828704      0.337895453409     -1.018572500830
H      2.101376734000      1.628308416333     -0.635511455811
P      1.568438751130     -1.079007524588      0.726462913358
P     -0.602944205612      1.041825550486      0.331455680098
C      0.217578285576      0.983551036634      1.969832245914
C     -0.070703766294      1.859460635889      3.011305050764
C      1.196939256886     -0.002517811766      2.153322202689
C      0.593231115534      1.752047879348      4.224711225637
H     -0.803786669691      2.644042326481      2.865863679588
C      1.858681059002     -0.104497242775      3.372180384040
C      1.556006706728      0.769614382275      4.406116636598
H      0.365301506756      2.443143183439      5.026200262174
H      2.623792944078     -0.858961769221      3.508769779226
H      2.080715725585      0.690393467795      5.349567653054
C      0.900071369966     -0.693753923823     -2.772585736894
H     -0.041004946616     -1.219581865264     -2.675787515888
C      0.982392173381      0.653768708835     -3.051271182730
H      1.929007667604      1.059847439401     -3.383618643003
Se     2.441500703789     -1.806970765640     -2.981238399799
C      2.034794156672     -2.354089942235     -4.815003004518
F      2.960473653664     -3.232452813015     -5.228585191176
F      0.833313152924     -2.948020760084     -4.919734763425
F      2.030078357266     -1.328599431112     -5.677318435150
C     -1.172323969190      2.767448363883      0.226463823809
C     -2.509379628300      3.115470859842      0.071687893262
C     -0.199182397747      3.770111480302      0.229984991258
C     -2.873698803812      4.450154225991     -0.060643601719
H     -3.271833749794      2.347026114754      0.050743289968
C     -0.567393573343      5.099038455282      0.108486366771
H      0.846117332962      3.495505190177      0.319057708615
C     -1.906930873844      5.442301651250     -0.036671490715
H     -3.917688937861      4.710928804482     -0.181100049237
H      0.192761085497      5.870001568294      0.120382576607
H     -2.193252788923      6.481944282018     -0.134078942790
C     -2.128486767801      0.082160146046      0.651758144238
C     -2.498394109937     -0.864612629910     -0.298282407734
C     -2.894532107362      0.211104309456      1.809593425704
C     -3.614877662208     -1.666510021827     -0.104592733679
H     -1.891990887626     -0.983658802577     -1.188363375862
C     -4.009410897829     -0.588026309866      2.006773103370
H     -2.614352251145      0.934863051386      2.565570744183
C     -4.371021660228     -1.527946092714      1.048777371504
H     -3.884308045453     -2.405590651030     -0.848233606853
H     -4.596662508291     -0.480725398330      2.910084774814
H     -5.239358598700     -2.154992677284      1.206846998468
C      3.181243698471     -1.816189934303      1.118520449468
C      3.329442300835     -3.041730960785      1.762208437762
C      4.311667384397     -1.094030482412      0.736837915993
C      4.598682365779     -3.535765749997      2.029121159004
H      2.454464959104     -3.612399125413      2.049103689682
C      5.577392102136     -1.586901729591      1.013922535860
H      4.186246486975     -0.147913649614      0.220411306527
C      5.721002767624     -2.808290985399      1.658748705171
H      4.710558113198     -4.490935691810      2.525931322038
H      6.452117632209     -1.022686414837      0.717421653145
H      6.709524129098     -3.197284081598      1.866662214535
C      0.375514775580     -2.445847410122      0.922598632406
C      0.255396117430     -3.356124271572     -0.128065673275
C     -0.457160993575     -2.576379052514      2.030896640411
C     -0.672275968957     -4.383816571291     -0.065412902054
H      0.892638468406     -3.260269242439     -1.000671797855
C     -1.396433449903     -3.597418611348      2.085387451877
H     -0.387225324080     -1.871268489660      2.849774183356
C     -1.504003335206     -4.502514767302      1.040627426988
H     -0.751576546533     -5.086782145803     -0.885020465484
H     -2.048127965563     -3.679981892140      2.945860108064
H     -2.237880715353     -5.297217552824      1.084784420827
C     -0.192783750704      1.540402618438     -3.202393522392
C     -0.005722218819      2.921118867392     -3.159532621177
C     -1.482152587789      1.043245672553     -3.383540065000
C     -1.082333869605      3.783864712337     -3.280412388680
H      0.993399402005      3.309372389547     -3.001232551554
C     -2.560738331143      1.906532103496     -3.500185565509
H     -1.646372147895     -0.024474292315     -3.459116959296
C     -2.364251338746      3.279166103171     -3.446901973560
H     -0.922629406862      4.853227886486     -3.230616772061
H     -3.556196863680      1.504550097180     -3.641270469778
H     -3.206495648934      3.953302104062     -3.535250413335

```

<MoleculeViewer 
  xyzData={`78

Cu     1.286017828704      0.337895453409     -1.018572500830
H      2.101376734000      1.628308416333     -0.635511455811
P      1.568438751130     -1.079007524588      0.726462913358
P     -0.602944205612      1.041825550486      0.331455680098
C      0.217578285576      0.983551036634      1.969832245914
C     -0.070703766294      1.859460635889      3.011305050764
C      1.196939256886     -0.002517811766      2.153322202689
C      0.593231115534      1.752047879348      4.224711225637
H     -0.803786669691      2.644042326481      2.865863679588
C      1.858681059002     -0.104497242775      3.372180384040
C      1.556006706728      0.769614382275      4.406116636598
H      0.365301506756      2.443143183439      5.026200262174
H      2.623792944078     -0.858961769221      3.508769779226
H      2.080715725585      0.690393467795      5.349567653054
C      0.900071369966     -0.693753923823     -2.772585736894
H     -0.041004946616     -1.219581865264     -2.675787515888
C      0.982392173381      0.653768708835     -3.051271182730
H      1.929007667604      1.059847439401     -3.383618643003
Se     2.441500703789     -1.806970765640     -2.981238399799
C      2.034794156672     -2.354089942235     -4.815003004518
F      2.960473653664     -3.232452813015     -5.228585191176
F      0.833313152924     -2.948020760084     -4.919734763425
F      2.030078357266     -1.328599431112     -5.677318435150
C     -1.172323969190      2.767448363883      0.226463823809
C     -2.509379628300      3.115470859842      0.071687893262
C     -0.199182397747      3.770111480302      0.229984991258
C     -2.873698803812      4.450154225991     -0.060643601719
H     -3.271833749794      2.347026114754      0.050743289968
C     -0.567393573343      5.099038455282      0.108486366771
H      0.846117332962      3.495505190177      0.319057708615
C     -1.906930873844      5.442301651250     -0.036671490715
H     -3.917688937861      4.710928804482     -0.181100049237
H      0.192761085497      5.870001568294      0.120382576607
H     -2.193252788923      6.481944282018     -0.134078942790
C     -2.128486767801      0.082160146046      0.651758144238
C     -2.498394109937     -0.864612629910     -0.298282407734
C     -2.894532107362      0.211104309456      1.809593425704
C     -3.614877662208     -1.666510021827     -0.104592733679
H     -1.891990887626     -0.983658802577     -1.188363375862
C     -4.009410897829     -0.588026309866      2.006773103370
H     -2.614352251145      0.934863051386      2.565570744183
C     -4.371021660228     -1.527946092714      1.048777371504
H     -3.884308045453     -2.405590651030     -0.848233606853
H     -4.596662508291     -0.480725398330      2.910084774814
H     -5.239358598700     -2.154992677284      1.206846998468
C      3.181243698471     -1.816189934303      1.118520449468
C      3.329442300835     -3.041730960785      1.762208437762
C      4.311667384397     -1.094030482412      0.736837915993
C      4.598682365779     -3.535765749997      2.029121159004
H      2.454464959104     -3.612399125413      2.049103689682
C      5.577392102136     -1.586901729591      1.013922535860
H      4.186246486975     -0.147913649614      0.220411306527
C      5.721002767624     -2.808290985399      1.658748705171
H      4.710558113198     -4.490935691810      2.525931322038
H      6.452117632209     -1.022686414837      0.717421653145
H      6.709524129098     -3.197284081598      1.866662214535
C      0.375514775580     -2.445847410122      0.922598632406
C      0.255396117430     -3.356124271572     -0.128065673275
C     -0.457160993575     -2.576379052514      2.030896640411
C     -0.672275968957     -4.383816571291     -0.065412902054
H      0.892638468406     -3.260269242439     -1.000671797855
C     -1.396433449903     -3.597418611348      2.085387451877
H     -0.387225324080     -1.871268489660      2.849774183356
C     -1.504003335206     -4.502514767302      1.040627426988
H     -0.751576546533     -5.086782145803     -0.885020465484
H     -2.048127965563     -3.679981892140      2.945860108064
H     -2.237880715353     -5.297217552824      1.084784420827
C     -0.192783750704      1.540402618438     -3.202393522392
C     -0.005722218819      2.921118867392     -3.159532621177
C     -1.482152587789      1.043245672553     -3.383540065000
C     -1.082333869605      3.783864712337     -3.280412388680
H      0.993399402005      3.309372389547     -3.001232551554
C     -2.560738331143      1.906532103496     -3.500185565509
H     -1.646372147895     -0.024474292315     -3.459116959296
C     -2.364251338746      3.279166103171     -3.446901973560
H     -0.922629406862      4.853227886486     -3.230616772061
H     -3.556196863680      1.504550097180     -3.641270469778
H     -3.206495648934      3.953302104062     -3.535250413335
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`migratory_insertion_CuH_Ph_dppbz.xyz`として保存し、以下を実行する。
```
python .\optmain.py .\migratory_insertion_CuH_Ph_dppbz.xyz -opt rsirfo_fsb -os uma-s-1 -modelhess -ma 200 1 15 200 2 17
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。


これを実行すると、`omol`のデータセットを使用した`uma-s-1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`migratory_insertion_CuH_Ph_dppbz_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.15.1b`ディレクトリに置く。

`migratory_insertion_CuH_Ph_dppbz_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`migratory_insertion_CuH_Ph_dppbz_traj.xyz`は次のNEB計算に使用する。

※`migratory_insertion_CuH_Ph_dppbz_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`migratory_insertion_CuH_Ph_dppbz_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `migratory_insertion_CuH_Ph_dppbz_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`migratory_insertion_CuH_Ph_dppbz_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py migratory_insertion_CuH_Ph_dppbz_traj.xyz -os uma-s-1 -modelhess -ns 20 -spng -nd 0.2
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.15.1b`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-6529.570159932668,-6529.563940234392,-6529.554982989899,-6529.54914740534,-6529.546135144216,-6529.541446293309,-6529.537581043892,-6529.536634568068,-6529.535063285371,-6529.508207927543,-6529.538480153869,-6529.546620000167,-6529.549998658813,-6529.554968235166,-6529.562948758384,-6529.567959129296,-6529.570933347039,-6529.574405195317,-6529.578656293271,-6529.580379074833,-6529.5828789331645,-6529.5851498828515,-6529.586672459158,-6529.587430698233,-6529.58786035536,-6529.589672821868,-6529.591150362943,-6529.592533487746,-6529.593672686319,-6529.5944686883995,-6529.5953196790215,-6529.595364258643,-6529.595612092598,-6529.5958660772785,-6529.5960705933,-6529.596171668479,-6529.596306511319,-6529.59665035618,-6529.597124224936,-6529.597508689121,-6529.59770803573,-6529.597783947254,-6529.597868445262,-6529.597895554018,-6529.5980581364565,-6529.598361800079,-6529.598627946025,-6529.598577250725,-6529.598433698737,-6529.598654108515,-6529.598773793583,-6529.5987559372015,-6529.598722852955,-6529.598824646594,-6529.59892917389,-6529.599063894066,-6529.599241897128,-6529.599385764538,-6529.599479900436,-6529.59955228975,-6529.599610975737,-6529.599670467802,-6529.599730433,-6529.59978780473,-6529.599851817841,-6529.599898955884,-6529.5999629339485,-6529.600019166655,-6529.600050691316,-6529.600144319035,-6529.600194348444,-6529.600229044848,-6529.600293986701,-6529.600387246428,-6529.600372561788,-6529.600465120578,-6529.600434892651,-6529.60042183769,-6529.600423554987,-6529.600437766494,-6529.600444723298,-6529.6004381344865];

export const dataset1_itr5 = [-6529.570222596475,-6529.567656096517,-6529.563850584494,-6529.560461867395,-6529.556366097178,-6529.549682991637,-6529.543282381408,-6529.543413772131,-6529.547336533465,-6529.538985231865,-6529.5503071413805,-6529.555721252257,-6529.5628568479615,-6529.56672062541,-6529.571153616629,-6529.575475666975,-6529.579293112458,-6529.582605129477,-6529.585534609889,-6529.587920530839,-6529.589597996796,-6529.590926430955,-6529.592300058055,-6529.59429355918,-6529.595484101421,-6529.596605688942,-6529.597674145404,-6529.598645627172,-6529.599522797807,-6529.600268455056,-6529.600931401686,-6529.601343465283,-6529.60184538906,-6529.602187761952,-6529.602426851713,-6529.6026353455545,-6529.602880813845,-6529.603265891352,-6529.6035534509365,-6529.603615448853,-6529.603763153895,-6529.603933639403,-6529.604043914386,-6529.604148774627,-6529.604247904705,-6529.604506200151,-6529.604538460797,-6529.60454582064,-6529.6047363354355,-6529.6048818500485,-6529.604657883013,-6529.604730097092,-6529.605100612623,-6529.605035390394,-6529.605026155544,-6529.6051155601135,-6529.605405502885,-6529.605343872961,-6529.605687490018,-6529.605572553801,-6529.605664464223,-6529.605681234151,-6529.6058579930495,-6529.606037958737,-6529.606075809359,-6529.606258508703,-6529.6062255295965,-6529.606296849981,-6529.606371727623,-6529.606491237456,-6529.6063844496375,-6529.6064316928205,-6529.606763884597,-6529.606734147326,-6529.606594800963,-6529.606684415815,-6529.606811916335,-6529.606976426352,-6529.606961478861,-6529.606957045432,-6529.606864276361,-6529.607360732826];

export const dataset1_itr10 = [-6529.570250195887,-6529.56927938001,-6529.5672180807105,-6529.564795115217,-6529.56105843525,-6529.5546028890485,-6529.549005710836,-6529.549936380522,-6529.5555037513695,-6529.554266474125,-6529.557558619567,-6529.56241665925,-6529.568365269971,-6529.572122978061,-6529.575786164737,-6529.579332540189,-6529.582664113363,-6529.58556434716,-6529.587943626728,-6529.590197859056,-6529.59175586775,-6529.592992286347,-6529.5948537133345,-6529.596186212931,-6529.597196544156,-6529.598210765585,-6529.5991014818355,-6529.599931146436,-6529.600694625019,-6529.601367577531,-6529.601999770531,-6529.602399445059,-6529.602848833575,-6529.603166848891,-6529.603431119829,-6529.603663147645,-6529.603909334398,-6529.60406438176,-6529.604317577886,-6529.6044820178095,-6529.604637590874,-6529.604774308721,-6529.604827772725,-6529.605028205786,-6529.605154935274,-6529.605269188077,-6529.605304427707,-6529.605392325262,-6529.605545304858,-6529.605572483707,-6529.605560690435,-6529.605632992132,-6529.6058986999915,-6529.60589955864,-6529.605956019151,-6529.606157398477,-6529.606259963148,-6529.6062166977845,-6529.606446727928,-6529.606407808377,-6529.606606296337,-6529.606639380584,-6529.606788820446,-6529.606838376723,-6529.606917021903,-6529.607030258348,-6529.60694703955,-6529.607144318392,-6529.60718199378,-6529.607297823692,-6529.607190773021,-6529.60735957628,-6529.607466714568,-6529.607493542948,-6529.607388787847,-6529.607512731111,-6529.607516305891,-6529.60759805272,-6529.607628210553,-6529.607601382173,-6529.6075123105475,-6529.607659752738];

export const dataset1_itr15 = [-6529.570253052207,-6529.569824937143,-6529.568705662715,-6529.566971298162,-6529.563860642946,-6529.557604268118,-6529.553368941257,-6529.55524089983,-6529.560784736703,-6529.561194294449,-6529.562705182623,-6529.566830795252,-6529.572095781688,-6529.5753782016245,-6529.578861878222,-6529.581943339394,-6529.584947574783,-6529.587542094716,-6529.5896413673,-6529.591699267053,-6529.593165943597,-6529.594392759352,-6529.596104571243,-6529.597251006995,-6529.5981479791135,-6529.5990590575975,-6529.599893365908,-6529.600650220632,-6529.601340819244,-6529.601953491137,-6529.60252077733,-6529.60288614097,-6529.603268975477,-6529.603548929889,-6529.603788124791,-6529.604003260015,-6529.604231082206,-6529.604356725242,-6529.604572981965,-6529.60474676188,-6529.6048940288365,-6529.605019724442,-6529.605082318156,-6529.605255572367,-6529.6053715950375,-6529.605475158543,-6529.605533564156,-6529.605633395171,-6529.605748576715,-6529.6058015851095,-6529.605815761569,-6529.605900767757,-6529.606096136545,-6529.606142818979,-6529.606225967682,-6529.606360880616,-6529.606451494304,-6529.606406616784,-6529.606617301055,-6529.606548293764,-6529.606778919705,-6529.606820275014,-6529.606940380644,-6529.60699487853,-6529.607079148734,-6529.60717465146,-6529.607065638164,-6529.607303553855,-6529.607346591413,-6529.607448385053,-6529.607314926565,-6529.6075319367965,-6529.607600838946,-6529.607635202405,-6529.607493735705,-6529.6076422117785,-6529.607576604035,-6529.607671283159,-6529.607686090462,-6529.607672877792,-6529.607551808373,-6529.607693818298];

export const dataset2 = [-6529.570266790581,-6529.5700629754965,-6529.569411646904,-6529.568361712713,-6529.56611000376,-6529.560339220867,-6529.557284973591,-6529.559566717715,-6529.564221818485,-6529.56508353345,-6529.566602464881,-6529.57020982189,-6529.575217406576,-6529.578073971969,-6529.581277203498,-6529.584105626254,-6529.586862150352,-6529.589206155244,-6529.591091799621,-6529.592990393816,-6529.594354996347,-6529.595569755977,-6529.597030316842,-6529.598124883225,-6529.598920587406,-6529.5997435931,-6529.600526610315,-6529.601220503333,-6529.601846790935,-6529.602402021004,-6529.60290271814,-6529.603235348002,-6529.603564000045,-6529.60381306064,-6529.604027372263,-6529.604222478199,-6529.604431567837,-6529.6045534608575,-6529.60474171513,-6529.604908012538,-6529.605046202354,-6529.605166395601,-6529.605236594486,-6529.605386840426,-6529.605495398112,-6529.605596438244,-6529.605669756301,-6529.6057637344875,-6529.60586778865,-6529.605930014372,-6529.60598538843,-6529.60606857218,-6529.606215646379,-6529.606288140833,-6529.60638094495,-6529.606482265457,-6529.606564222567,-6529.606490098433,-6529.606717535108,-6529.606613498469,-6529.6068715836345,-6529.6069203864035,-6529.60702048027,-6529.607082741038,-6529.607160142054,-6529.607248810641,-6529.607098985263,-6529.607382321699,-6529.607433770508,-6529.607520143523,-6529.60734937764,-6529.60760544761,-6529.607650009708,-6529.607663309996,-6529.607527503367,-6529.607670687362,-6529.60759984011,-6529.607688613837,-6529.607696394243,-6529.6076911021655,-6529.607568368019,-6529.607700161781];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.00038077886405038036,0.0035280272623464375,0.00564211900804855,0.006015384020668859,0.005336103261346224,0.005062614817136054,0.004458752663095586,0.004534274319095703,0.006201259949297417,0.017633626420753154,0.0067131911583804835,0.00528101703394271,0.0071611855453002655,0.006338012558965487,0.005385695609389177,0.00537428653228847,0.006083315800394926,0.006395004397263221,0.005670237413287161,0.0057260620016975185,0.005342619221404772,0.005004687562714172,0.005003228858775917,0.0053446127732332295,0.005839239377076006,0.005591639957010947,0.005511664433698138,0.005358813260922801,0.005237751046643741,0.005211290815625241,0.005083710566323072,0.005216451697280142,0.005343999709032367,0.005429377298409299,0.00546831986717017,0.005497309981934551,0.005566935218093932,0.005561774995701886,0.005449344754056555,0.005333946141074923,0.005308821173799854,0.005365200841681464,0.005376290745074488,0.005458592516339329,0.005454603967496316,0.005351019748009765,0.00526137275440377,0.005375088992427249,0.005514792223201901,0.005402353645248813,0.005406557612893325,0.00544739272935026,0.005510289417459472,0.0054949303520011395,0.005477103633890686,0.0054520174755407205,0.005408451187832155,0.005358410586424236,0.005362861004374121,0.005379952408664164,0.005400829772861279,0.005414262709944078,0.005421837853042127,0.005427057020538138,0.005425250857527144,0.005429016998857958,0.00542631855645089,0.005428216433927326,0.005440089602145536,0.00542987485614497,0.005448649084839298,0.005463410377878306,0.005449829540392074,0.005402599545489635,0.005431206413540928,0.0053889061771695244,0.0054052654283872625,0.005418037998543926,0.005420617606217092,0.005417489777448503,0.0054167661609578616,0.005414100089265419];

export const dataset1_grad_itr5 = [0.00030233327063167664,0.0016857030772257089,0.0026095722053617754,0.002846362858262454,0.0027185997544101888,0.003062322713661377,0.0034178020084632793,0.003321498656280467,0.003920974392142104,0.00976214098619,0.004418070540085568,0.003574639486945138,0.0028440741347318514,0.002711662501032112,0.002666980872604508,0.002477534615647583,0.002401502902314781,0.002332997595287771,0.0019453383350803073,0.001858960105691294,0.0018805858809033556,0.0020288135371003143,0.0021764139472333077,0.0017792286720943534,0.0015997117463640135,0.001495485864438408,0.0013910659809344018,0.0013324719676245835,0.001283512699108001,0.0012720182368043875,0.0013012514069276775,0.001346956650986404,0.001283750582675815,0.0013127848456110389,0.0014235578937527105,0.0015100308358821277,0.0015229339602427124,0.0013046163319374185,0.0012707712224337717,0.0015706183568815384,0.001587107349554876,0.0014870763943581734,0.001491220277396073,0.0015767897900946005,0.0015589184560733775,0.0013325868116954647,0.001480404009713466,0.0016067771778404557,0.001471075707631498,0.0013191396172167282,0.0016841778836438985,0.0016667424073293434,0.0013412432974775552,0.001472154442621313,0.001574858426533491,0.001598081405174197,0.0014199294162628758,0.00156495861702863,0.0012600439887245456,0.001521827791769653,0.0015284504486046395,0.0015964666975894215,0.0015034806616626589,0.001400906691067221,0.0014234159117055853,0.0013334771505066232,0.001420999612726577,0.0014322471585707026,0.0014295816484153677,0.0013729990488525322,0.0015232074505682834,0.001503431991038565,0.0011490395972875373,0.001234484551940676,0.0013898415838192047,0.0012695337866889726,0.0011582010213109643,0.0010059648364997601,0.0010715460332268532,0.0010455493945568716,0.0011197292935143722,0.0008098944404985713];

export const dataset1_grad_itr10 = [0.00024166881275529848,0.0008418591301653563,0.001414931713834931,0.0016403637751915387,0.001741687516999358,0.001982377944634561,0.002814943770506913,0.002845591321380591,0.0026385649939198157,0.005466989520734418,0.00312685040208126,0.0024866218563705787,0.0017599830565087464,0.0015510828661295204,0.0016080422079795375,0.001497834503822216,0.0014284530882094897,0.0013652402605148592,0.0012624929230086392,0.0010956316246742335,0.0011544105729517343,0.0013769893895042495,0.0010454017020343886,0.0008865092004702345,0.0007987083513757859,0.0006624974793194106,0.0006671754084704077,0.0006860347963165518,0.0006835669961124123,0.0006933216174622715,0.0006381808286340883,0.0007084876244761146,0.0005634758819682375,0.0005671296531898372,0.0006067249507935774,0.0006466634233173623,0.0006364427649401728,0.0005749305414858877,0.0004946887297282932,0.0006617261990542352,0.0006578251523479996,0.0006120723532141717,0.0007288084711910246,0.0006348274744731743,0.0005901877562452017,0.0005085047601510569,0.0006977502936710908,0.0006751077431269686,0.0005529629983614373,0.0006348744323502998,0.00079565241626037,0.0008063931981367924,0.0005019899657160918,0.0006968185588856441,0.0007643773652329881,0.0005713230898422288,0.0005273007546540505,0.0007154494807696778,0.00040296610381914283,0.0006274233887146009,0.000416104651780947,0.0005342243371435155,0.0003802685416974633,0.0004799494871413871,0.00044716570224711155,0.000366695939854764,0.000555183597472119,0.0004160897411617699,0.0005358871757212733,0.000427043835236907,0.0005858443782910678,0.00045158182105831205,0.00037497337560544656,0.00041133756965869295,0.0005256946445770721,0.00039218569897098626,0.00044054920502972414,0.00026500574277704274,0.00022931757656297248,0.000283802377274542,0.0003871722019564847,0.00023792756528980943];

export const dataset1_grad_itr15 = [0.000273680108222275,0.0005035872856821894,0.000879858070751616,0.001126711620964317,0.0013079032260941775,0.00163723680702753,0.002601966382571615,0.002418906172941803,0.0018227538653341334,0.0031849035491137313,0.0020713178194462782,0.001945944216165995,0.00141511023433049,0.001270545654145332,0.0012170818566830854,0.001224251245926932,0.001175680170682295,0.0011263368387804179,0.0010703708495610992,0.0009452477643985551,0.000969525603402726,0.001124194460111796,0.0006926699502409503,0.0006536968247137277,0.0005590763622958142,0.0004666880348407802,0.0004500082232308698,0.00046629653191877904,0.00046553677682148047,0.00045686599223580614,0.00036916037956851556,0.0004419303909316919,0.00030952240356671375,0.0003308233374068041,0.0003602473952784656,0.00037813315269633383,0.00035447014108967153,0.0003651121943205385,0.00029612122869158096,0.0003679108040456002,0.0003649517024644171,0.0003554091775073507,0.00048102100830341106,0.00036356046349839176,0.0003320985789774777,0.00029555608973357185,0.00044579722119608326,0.0003317130726766753,0.00032760027210158377,0.00038818801634679315,0.0005539648763837162,0.000536402582330645,0.00031836834306143194,0.00045402504495273033,0.0004793941011064828,0.0003455849780259011,0.0003164764531370686,0.00048232472287792273,0.00023088765475184938,0.0004255341553602202,0.00022628604036919545,0.0003346430448680392,0.00020088459962505864,0.00029711936926545837,0.00020791935740398234,0.0001781338500113837,0.00032593325589046413,0.00019532705164623514,0.00032603434001868416,0.00020618277563614116,0.00034015475600069673,0.00021799849927025883,0.0001737556231008498,0.00014528776956018217,0.00031661493427114173,0.00014249797938255848,0.0003134324356336889,0.000110615537183045,6.276981546287365e-05,0.00013158729694253253,0.00029843040985592836,8.413814935405163e-05];

export const dataset2_grad = [0.0002262217954401499,0.00033355372711824457,0.0006014949141426014,0.0007848614542822539,0.0010080823892997493,0.0014502508779035408,0.002477659277303755,0.0020578213058954397,0.001630581638269829,0.0024379207348971584,0.00157539616768901,0.0016337467691582583,0.001236991848417572,0.0011393156897336499,0.0010936477446033073,0.0010851484593927085,0.0010472349078772705,0.0010181120384802102,0.0009796521841036543,0.0008730031250534017,0.00088556181038294,0.0009403874180639259,0.0006021103384412706,0.0005700830775687493,0.0004824058139224985,0.0004168952731818814,0.00037809072919764214,0.0003787376012156098,0.000369011814442243,0.0003397569282062683,0.00027902550624687045,0.0003148475974398272,0.00023228781979285583,0.0002534595254897071,0.00027316661105458137,0.00027765375351574773,0.0002446155646658981,0.00026354413184713585,0.0002151986327605224,0.00023477685556967122,0.00023687533131313505,0.00024078399012491896,0.00036578835431959366,0.00024830844126908663,0.00022131713598257073,0.0002095712551144833,0.000314638256730521,0.00020882087421648116,0.00022891384092190635,0.000275784198126647,0.00038317275395093823,0.0003685906532382621,0.00023034248007451256,0.000320027507079325,0.0002970178578190439,0.0002218370110245282,0.0002087948867097984,0.00034644419230952497,0.00016206276407889844,0.00030263317787889154,0.0001563359602962279,0.00023189547842970165,0.00014139609360424698,0.00020255507902676944,0.00013522609853989736,0.00011145684897235445,0.00023274284651606913,0.0001261281525001105,0.0002195769295881155,0.00012123332585442538,0.0002525792814238698,0.00013043344234833838,7.972459476933564e-05,6.42995786887126e-05,0.0002286937105729123,6.721440422740769e-05,0.00024307597896091834,5.577429854417906e-05,2.761576979348678e-05,6.93180475805395e-05,0.00026080494556873725,3.247715651779562e-05];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、ITR. 5の経路の6番(グラフ上では7番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`migratory_insertion_CuH_Ph_dppbz_traj_6_itr5.xyz`
```
78
0 1
Cu      1.144241671160      0.136738799572     -0.988404833944
H       1.719515553178      1.524676946375     -1.431328417068
P       1.576220056468     -1.092812167830      0.781518303533
P      -0.619658165835      1.025074599494      0.357275926690
C       0.214451456795      0.981238773190      1.987683699752
C      -0.072850440443      1.864259198546      3.022185420667
C       1.194532209334     -0.003897440105      2.182500896470
C       0.592553034583      1.761759745401      4.235157079007
H      -0.806763158108      2.647099430724      2.870758908540
C       1.859708418540     -0.098713142180      3.397148978877
C       1.556750926129      0.782016533832      4.423326473214
H       0.362926244575      2.455261006443      5.033161213717
H       2.625322788800     -0.853372047930      3.530704859001
H       2.080867579811      0.706224756138      5.366620229093
C       0.921194453034     -0.686551400146     -2.740208925205
H      -0.040660527415     -1.183369881435     -2.815936659954
C       1.087668662004      0.754618171165     -2.842284946694
H       1.990361827049      1.109937831871     -3.318035171606
Se      2.418136544830     -1.823539162064     -2.991990055251
C       2.028380329245     -2.340522138648     -4.828270722149
F       2.952057501770     -3.220865710776     -5.250876043041
F       0.824965292998     -2.935076843463     -4.941256642146
F       2.021706551201     -1.310230314792     -5.686335808767
C      -1.169359109229      2.755411318313      0.224203231347
C      -2.505539251436      3.106498476297      0.066945131984
C      -0.196236969355      3.757454578878      0.224832851442
C      -2.868093706265      4.441543514546     -0.064192984986
H      -3.269187213964      2.339661604213      0.045049973911
C      -0.561462673492      5.087309875233      0.104768870867
H       0.850248367667      3.488295126669      0.317260822042
C      -1.900664142419      5.432556634065     -0.037776109248
H      -3.911948274605      4.703571607265     -0.183382890431
H       0.198621040459      5.858094263399      0.117769992608
H      -2.185772240737      6.472759512577     -0.132240962627
C      -2.139667546106      0.069927364317      0.667053395665
C      -2.505528367865     -0.871866390675     -0.289348194198
C      -2.907385362480      0.204092834407      1.822029404200
C      -3.623852787832     -1.670621247717     -0.098228234496
H      -1.895741773758     -0.987795394236     -1.177727537606
C      -4.023263920446     -0.593931960982      2.015615052880
H      -2.627099755604      0.930139022856      2.575805171430
C      -4.381271302107     -1.532706703749      1.055080195432
H      -3.892578601083     -2.408308407309     -0.843276553679
H      -4.612384909728     -0.487360892048      2.917533678281
H      -5.249348949343     -2.160259359291      1.211732496974
C       3.191078808339     -1.816410273564      1.137477865879
C       3.339586958270     -3.044013631123      1.774228821908
C       4.317595308327     -1.095756770826      0.744887316093
C       4.609116302327     -3.539178433495      2.033042965997
H       2.463365664516     -3.613945207797      2.058637470245
C       5.583980452632     -1.587982196758      1.014889680119
H       4.192605653925     -0.154028203711      0.220859716203
C       5.728669929642     -2.809433183226      1.659979745402
H       4.721925049240     -4.495473400255      2.526502328029
H       6.457363844957     -1.025310670192      0.712378675106
H       6.717923228799     -3.197756525978      1.864489706914
C       0.372693303751     -2.451215662782      0.941114596531
C       0.260763666246     -3.356410689532     -0.115178536500
C      -0.459361562038     -2.584863004642      2.047900689922
C      -0.669299078445     -4.382296210086     -0.057262728462
H       0.897742054493     -3.255175018566     -0.987500957000
C      -1.401533750326     -3.603991673162      2.095498941491
H      -0.388509931427     -1.881966258729      2.868598872092
C      -1.505233907161     -4.504110195113      1.046261816115
H      -0.749162686638     -5.080990909402     -0.880522834730
H      -2.057339793033     -3.687356594638      2.952248695616
H      -2.240902342673     -5.297417431481      1.084898394614
C      -0.132261846768      1.594834385259     -3.113323455917
C       0.012793641816      2.976929147304     -3.117461339788
C      -1.407851631240      1.065885031910     -3.335292169483
C      -1.075459849978      3.816580526902     -3.287261965086
H       1.003154025717      3.385156221829     -2.952871600884
C      -2.502923378769      1.905122211450     -3.497811983785
H      -1.565670524072     -0.002685937997     -3.401433209995
C      -2.344117093515      3.282352534313     -3.459644986538
H      -0.935414161954      4.888888967286     -3.256838360517
H      -3.488824746543      1.480978132220     -3.652023946592
H      -3.200602968393      3.936620004164     -3.562088787527

```


<MoleculeViewer 
  xyzData={`78
0 1
Cu      1.144241671160      0.136738799572     -0.988404833944
H       1.719515553178      1.524676946375     -1.431328417068
P       1.576220056468     -1.092812167830      0.781518303533
P      -0.619658165835      1.025074599494      0.357275926690
C       0.214451456795      0.981238773190      1.987683699752
C      -0.072850440443      1.864259198546      3.022185420667
C       1.194532209334     -0.003897440105      2.182500896470
C       0.592553034583      1.761759745401      4.235157079007
H      -0.806763158108      2.647099430724      2.870758908540
C       1.859708418540     -0.098713142180      3.397148978877
C       1.556750926129      0.782016533832      4.423326473214
H       0.362926244575      2.455261006443      5.033161213717
H       2.625322788800     -0.853372047930      3.530704859001
H       2.080867579811      0.706224756138      5.366620229093
C       0.921194453034     -0.686551400146     -2.740208925205
H      -0.040660527415     -1.183369881435     -2.815936659954
C       1.087668662004      0.754618171165     -2.842284946694
H       1.990361827049      1.109937831871     -3.318035171606
Se      2.418136544830     -1.823539162064     -2.991990055251
C       2.028380329245     -2.340522138648     -4.828270722149
F       2.952057501770     -3.220865710776     -5.250876043041
F       0.824965292998     -2.935076843463     -4.941256642146
F       2.021706551201     -1.310230314792     -5.686335808767
C      -1.169359109229      2.755411318313      0.224203231347
C      -2.505539251436      3.106498476297      0.066945131984
C      -0.196236969355      3.757454578878      0.224832851442
C      -2.868093706265      4.441543514546     -0.064192984986
H      -3.269187213964      2.339661604213      0.045049973911
C      -0.561462673492      5.087309875233      0.104768870867
H       0.850248367667      3.488295126669      0.317260822042
C      -1.900664142419      5.432556634065     -0.037776109248
H      -3.911948274605      4.703571607265     -0.183382890431
H       0.198621040459      5.858094263399      0.117769992608
H      -2.185772240737      6.472759512577     -0.132240962627
C      -2.139667546106      0.069927364317      0.667053395665
C      -2.505528367865     -0.871866390675     -0.289348194198
C      -2.907385362480      0.204092834407      1.822029404200
C      -3.623852787832     -1.670621247717     -0.098228234496
H      -1.895741773758     -0.987795394236     -1.177727537606
C      -4.023263920446     -0.593931960982      2.015615052880
H      -2.627099755604      0.930139022856      2.575805171430
C      -4.381271302107     -1.532706703749      1.055080195432
H      -3.892578601083     -2.408308407309     -0.843276553679
H      -4.612384909728     -0.487360892048      2.917533678281
H      -5.249348949343     -2.160259359291      1.211732496974
C       3.191078808339     -1.816410273564      1.137477865879
C       3.339586958270     -3.044013631123      1.774228821908
C       4.317595308327     -1.095756770826      0.744887316093
C       4.609116302327     -3.539178433495      2.033042965997
H       2.463365664516     -3.613945207797      2.058637470245
C       5.583980452632     -1.587982196758      1.014889680119
H       4.192605653925     -0.154028203711      0.220859716203
C       5.728669929642     -2.809433183226      1.659979745402
H       4.721925049240     -4.495473400255      2.526502328029
H       6.457363844957     -1.025310670192      0.712378675106
H       6.717923228799     -3.197756525978      1.864489706914
C       0.372693303751     -2.451215662782      0.941114596531
C       0.260763666246     -3.356410689532     -0.115178536500
C      -0.459361562038     -2.584863004642      2.047900689922
C      -0.669299078445     -4.382296210086     -0.057262728462
H       0.897742054493     -3.255175018566     -0.987500957000
C      -1.401533750326     -3.603991673162      2.095498941491
H      -0.388509931427     -1.881966258729      2.868598872092
C      -1.505233907161     -4.504110195113      1.046261816115
H      -0.749162686638     -5.080990909402     -0.880522834730
H      -2.057339793033     -3.687356594638      2.952248695616
H      -2.240902342673     -5.297417431481      1.084898394614
C      -0.132261846768      1.594834385259     -3.113323455917
C       0.012793641816      2.976929147304     -3.117461339788
C      -1.407851631240      1.065885031910     -3.335292169483
C      -1.075459849978      3.816580526902     -3.287261965086
H       1.003154025717      3.385156221829     -2.952871600884
C      -2.502923378769      1.905122211450     -3.497811983785
H      -1.565670524072     -0.002685937997     -3.401433209995
C      -2.344117093515      3.282352534313     -3.459644986538
H      -0.935414161954      4.888888967286     -3.256838360517
H      -3.488824746543      1.480978132220     -3.652023946592
H      -3.200602968393      3.936620004164     -3.562088787527
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`migratory_insertion_CuH_Ph_dppbz_traj_6_itr5.xyz`を`MultiOptPy-v1.15.1b`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py .\migratory_insertion_CuH_Ph_dppbz_traj_6_itr5.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
78
OptimizedStructure
Cu     0.882510904827     -0.024105783212     -0.939063176961
H      1.743521395233      1.169508147337     -1.516067974876
P      1.529110999751     -1.187061656780      0.855735796700
P     -0.731061320055      0.880542392951      0.457381137158
C      0.123673664235      0.868165298585      2.079107631133
C     -0.210216241971      1.718262003691      3.130306742793
C      1.162440401659     -0.058824098847      2.248418873468
C      0.479498493988      1.657888271541      4.331190474835
H     -1.000511288130      2.447724188884      3.001791712147
C      1.852018219984     -0.109736883431      3.456559228188
C      1.514315474292      0.746916227142      4.492967350932
H      0.215147103717      2.328939405782      5.138363332538
H      2.662469394387     -0.816770790548      3.583780180080
H      2.061126854098      0.705529916282      5.426146490497
C      0.227821575428     -0.644746806075     -2.812702339550
H     -0.853834333485     -0.631110885923     -2.843160143444
C      0.943519120572      0.584683961698     -2.946043241811
H      1.927945206865      0.532212132255     -3.395161599408
Se     1.041654036329     -2.281225790222     -3.293802422430
C      0.837334955997     -2.114035531019     -5.232156445289
F      1.318342416403     -3.209467261692     -5.843279502745
F     -0.447326350884     -1.973046023969     -5.607344859315
F      1.491602262220     -1.051750150265     -5.732617949249
C     -1.336985944683      2.584188051931      0.285391428279
C     -2.601818163848      2.845383810626     -0.233283650335
C     -0.468775075322      3.647443837247      0.534013257773
C     -2.999795061389      4.152183003926     -0.480138158958
H     -3.278694837448      2.027530978076     -0.448533663312
C     -0.874515714713      4.950961494252      0.301473794298
H      0.528804984836      3.452872263217      0.910768163838
C     -2.142033165965      5.206069904023     -0.205882692636
H     -3.983867751250      4.344190567769     -0.887758101863
H     -0.196669882554      5.769500228451      0.508154776236
H     -2.456387854048      6.224743083360     -0.393421137348
C     -2.215017181535     -0.127435007245      0.784731884592
C     -2.424302700431     -1.248388338565     -0.012560139387
C     -3.095270796313      0.141376228322      1.832391351422
C     -3.497603827791     -2.094793149529      0.233778054009
H     -1.730623080874     -1.466527054979     -0.816695236138
C     -4.165921649052     -0.701771975760      2.077811988871
H     -2.941819912696      1.011575033669      2.459807302229
C     -4.365986271149     -1.822394423018      1.278442094532
H     -3.645824621305     -2.968916232904     -0.386956164073
H     -4.845308381202     -0.488569362950      2.893230712008
H     -5.201385075662     -2.482434765170      1.474892270792
C      3.223480099009     -1.757057670792      1.172506160950
C      3.517501616220     -2.883172920560      1.937215075637
C      4.260721786510     -1.008266411699      0.619818924247
C      4.838207805308     -3.247641479966      2.156764491942
H      2.714515706684     -3.478750223887      2.354650776071
C      5.579266837665     -1.369727605114      0.848841336446
H      4.025155753403     -0.147234336912      0.003595426588
C      5.867885056791     -2.489517210862      1.617034377849
H      5.063021700438     -4.125882114579      2.748119941762
H      6.381240388569     -0.785042791050      0.417458687972
H      6.897281126090     -2.777191693965      1.787778876254
C      0.476907581737     -2.629188331853      1.229256280752
C      0.415132261613     -3.639246280144      0.269072262600
C     -0.317876487476     -2.724341327502      2.367586539542
C     -0.418626127627     -4.730215177724      0.448984741736
H      1.016874124209     -3.566925437604     -0.630077028160
C     -1.162218552606     -3.813564318633      2.541593964139
H     -0.296011769714     -1.942683806977      3.116478702703
C     -1.212735535919     -4.816375970103      1.586164669566
H     -0.457518566921     -5.506414835823     -0.304414083299
H     -1.785522726200     -3.871806149352      3.424715315722
H     -1.873766626603     -5.662757562263      1.722558117124
C      0.162544811127      1.818544367695     -3.300407758053
C      0.495549350736      3.080462562482     -2.813731630634
C     -0.909775065845      1.709823459655     -4.183647218460
C     -0.230665865169      4.199278454092     -3.187674082421
H      1.319426419279      3.175396233823     -2.117181786211
C     -1.640718585514      2.829896917400     -4.556031248398
H     -1.161926708569      0.742398186244     -4.598640726401
C     -1.307162816379      4.078220659610     -4.055702462966
H      0.037499987699      5.169106798639     -2.788041812390
H     -2.469936800998      2.722394619916     -5.243963488205
H     -1.879051158610      4.952202938890     -4.340688774219

```

<MoleculeViewer 
  xyzData={`78
OptimizedStructure
Cu     0.882510904827     -0.024105783212     -0.939063176961
H      1.743521395233      1.169508147337     -1.516067974876
P      1.529110999751     -1.187061656780      0.855735796700
P     -0.731061320055      0.880542392951      0.457381137158
C      0.123673664235      0.868165298585      2.079107631133
C     -0.210216241971      1.718262003691      3.130306742793
C      1.162440401659     -0.058824098847      2.248418873468
C      0.479498493988      1.657888271541      4.331190474835
H     -1.000511288130      2.447724188884      3.001791712147
C      1.852018219984     -0.109736883431      3.456559228188
C      1.514315474292      0.746916227142      4.492967350932
H      0.215147103717      2.328939405782      5.138363332538
H      2.662469394387     -0.816770790548      3.583780180080
H      2.061126854098      0.705529916282      5.426146490497
C      0.227821575428     -0.644746806075     -2.812702339550
H     -0.853834333485     -0.631110885923     -2.843160143444
C      0.943519120572      0.584683961698     -2.946043241811
H      1.927945206865      0.532212132255     -3.395161599408
Se     1.041654036329     -2.281225790222     -3.293802422430
C      0.837334955997     -2.114035531019     -5.232156445289
F      1.318342416403     -3.209467261692     -5.843279502745
F     -0.447326350884     -1.973046023969     -5.607344859315
F      1.491602262220     -1.051750150265     -5.732617949249
C     -1.336985944683      2.584188051931      0.285391428279
C     -2.601818163848      2.845383810626     -0.233283650335
C     -0.468775075322      3.647443837247      0.534013257773
C     -2.999795061389      4.152183003926     -0.480138158958
H     -3.278694837448      2.027530978076     -0.448533663312
C     -0.874515714713      4.950961494252      0.301473794298
H      0.528804984836      3.452872263217      0.910768163838
C     -2.142033165965      5.206069904023     -0.205882692636
H     -3.983867751250      4.344190567769     -0.887758101863
H     -0.196669882554      5.769500228451      0.508154776236
H     -2.456387854048      6.224743083360     -0.393421137348
C     -2.215017181535     -0.127435007245      0.784731884592
C     -2.424302700431     -1.248388338565     -0.012560139387
C     -3.095270796313      0.141376228322      1.832391351422
C     -3.497603827791     -2.094793149529      0.233778054009
H     -1.730623080874     -1.466527054979     -0.816695236138
C     -4.165921649052     -0.701771975760      2.077811988871
H     -2.941819912696      1.011575033669      2.459807302229
C     -4.365986271149     -1.822394423018      1.278442094532
H     -3.645824621305     -2.968916232904     -0.386956164073
H     -4.845308381202     -0.488569362950      2.893230712008
H     -5.201385075662     -2.482434765170      1.474892270792
C      3.223480099009     -1.757057670792      1.172506160950
C      3.517501616220     -2.883172920560      1.937215075637
C      4.260721786510     -1.008266411699      0.619818924247
C      4.838207805308     -3.247641479966      2.156764491942
H      2.714515706684     -3.478750223887      2.354650776071
C      5.579266837665     -1.369727605114      0.848841336446
H      4.025155753403     -0.147234336912      0.003595426588
C      5.867885056791     -2.489517210862      1.617034377849
H      5.063021700438     -4.125882114579      2.748119941762
H      6.381240388569     -0.785042791050      0.417458687972
H      6.897281126090     -2.777191693965      1.787778876254
C      0.476907581737     -2.629188331853      1.229256280752
C      0.415132261613     -3.639246280144      0.269072262600
C     -0.317876487476     -2.724341327502      2.367586539542
C     -0.418626127627     -4.730215177724      0.448984741736
H      1.016874124209     -3.566925437604     -0.630077028160
C     -1.162218552606     -3.813564318633      2.541593964139
H     -0.296011769714     -1.942683806977      3.116478702703
C     -1.212735535919     -4.816375970103      1.586164669566
H     -0.457518566921     -5.506414835823     -0.304414083299
H     -1.785522726200     -3.871806149352      3.424715315722
H     -1.873766626603     -5.662757562263      1.722558117124
C      0.162544811127      1.818544367695     -3.300407758053
C      0.495549350736      3.080462562482     -2.813731630634
C     -0.909775065845      1.709823459655     -4.183647218460
C     -0.230665865169      4.199278454092     -3.187674082421
H      1.319426419279      3.175396233823     -2.117181786211
C     -1.640718585514      2.829896917400     -4.556031248398
H     -1.161926708569      0.742398186244     -4.598640726401
C     -1.307162816379      4.078220659610     -4.055702462966
H      0.037499987699      5.169106798639     -2.788041812390
H     -2.469936800998      2.722394619916     -5.243963488205
H     -1.879051158610      4.952202938890     -4.340688774219
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -616.6845             10.5067             14.5647
Reduced mass [au]                   1.1730              7.7875              6.0670
Force const [Dyne/A]               -0.2628              0.0005              0.0008
Char temp [K]                       0.0000             15.1167             20.9554
Normal mode                   x         y         z            x         y         z            x         y         z     
      Cu                 0.01275    0.01498   -0.00767   -0.01123    0.00269   -0.00420   -0.01004    0.00703    0.00068
       H                 0.25083    0.18649    0.82208   -0.01847    0.00990   -0.00196    0.00797   -0.00021    0.01514
       P                -0.00717   -0.00388   -0.00343   -0.00928   -0.00126   -0.00668   -0.00965    0.00012   -0.00228
       P                -0.00021   -0.00433   -0.00274   -0.00452    0.00273    0.00450   -0.00703    0.00057    0.00539
       C                 0.00099    0.00015   -0.00252    0.00853    0.00663   -0.00218    0.00082    0.00483    0.00096
       C                 0.00046   -0.00014   -0.00137    0.02091    0.01275   -0.00329    0.00882    0.00902    0.00001
       C                 0.00062    0.00150   -0.00350    0.00670    0.00361   -0.00680   -0.00056    0.00261   -0.00201
       C                -0.00037   -0.00074   -0.00087    0.03115    0.01561   -0.00890    0.01554    0.01088   -0.00364
       H                 0.00143    0.00091   -0.00157    0.02271    0.01533    0.00016    0.00973    0.01043    0.00217
       C                 0.00014    0.00032   -0.00218    0.01683    0.00630   -0.01260    0.00576    0.00426   -0.00568
       C                -0.00037   -0.00100   -0.00101    0.02898    0.01243   -0.01359    0.01379    0.00847   -0.00644
       H                -0.00034   -0.00059   -0.00087    0.04077    0.02045   -0.00977    0.02197    0.01421   -0.00430
       H                 0.00180    0.00204   -0.00336    0.01529    0.00383   -0.01645    0.00469    0.00258   -0.00812
       H                -0.00002   -0.00129   -0.00117    0.03690    0.01471   -0.01813    0.01885    0.00993   -0.00934
       C                -0.00840    0.01622   -0.03606    0.00771   -0.00528   -0.00796   -0.00488    0.01653   -0.00447
       H                -0.01306   -0.01275    0.06325    0.00777   -0.02138   -0.01511   -0.00442    0.03549   -0.01715
       C                -0.06003   -0.04590   -0.04220   -0.00792    0.00436   -0.00402    0.01626    0.00439    0.00156
       H                 0.06497    0.02371    0.24187   -0.00580    0.01758   -0.00084    0.02179   -0.01160    0.01556
      Se                 0.00182   -0.00360    0.00067    0.03714    0.00694   -0.00058   -0.02766    0.00045    0.01162
       C                -0.00105    0.00570   -0.00272    0.05321    0.00278   -0.00258    0.00591   -0.00049    0.00795
       F                -0.00064    0.00208    0.00676    0.07861    0.01095    0.00274   -0.00779   -0.01238    0.01856
       F                -0.00031    0.00047    0.00106    0.05464   -0.01980   -0.01573    0.01475    0.02585   -0.01255
       F                -0.00031   -0.00040    0.00081    0.03984    0.01400    0.00372    0.03629   -0.01577    0.01512
       C                 0.00171   -0.00128   -0.00202   -0.00611    0.00256    0.00785   -0.02350   -0.00508    0.00953
       C                 0.00052   -0.00036   -0.00039   -0.01516    0.00313    0.03051   -0.03267   -0.01582    0.02666
       C                 0.00089   -0.00098   -0.00031   -0.00021    0.00190   -0.00966   -0.02715    0.00177   -0.00683
       C                -0.00012   -0.00051    0.00033   -0.01785    0.00328    0.03510   -0.04424   -0.01955    0.02505
       H                -0.00016   -0.00003   -0.00021   -0.02027    0.00362    0.04481   -0.03061   -0.02126    0.04093
       C                -0.00017   -0.00062   -0.00001   -0.00267    0.00195   -0.00462   -0.03867   -0.00206   -0.00767
       H                 0.00148   -0.00367   -0.00524    0.00625    0.00106   -0.02708   -0.02068    0.00976   -0.01965
       C                 0.00016   -0.00023    0.00009   -0.01151    0.00262    0.01759   -0.04691   -0.01279    0.00733
       H                -0.00058   -0.00047    0.00111   -0.02507    0.00387    0.05279   -0.05123   -0.02773    0.03810
       H                 0.00027   -0.00074   -0.00056    0.00204    0.00148   -0.01820   -0.04127    0.00339   -0.02072
       H                -0.00007   -0.00015    0.00015   -0.01359    0.00269    0.02144   -0.05570   -0.01581    0.00584
       C                -0.00306    0.00237    0.00377   -0.00208    0.00363    0.01809    0.00445   -0.01433    0.01164
       C                -0.00178    0.00186    0.00309   -0.01972    0.01455    0.00742   -0.00139   -0.00262   -0.00335
       C                -0.00334   -0.00042    0.00168    0.01686   -0.00648    0.03648    0.02050   -0.03760    0.03100
       C                -0.00049    0.00004    0.00018   -0.01881    0.01561    0.01461    0.00824   -0.01362    0.00059
       H                 0.00070   -0.00154    0.00673   -0.03345    0.02202   -0.00646   -0.01282    0.01476   -0.01797
       C                -0.00209   -0.00121    0.00091    0.01782   -0.00562    0.04393    0.03027   -0.04887    0.03521
       H                -0.00322   -0.00052    0.00183    0.03128   -0.01557    0.04554    0.02621   -0.04773    0.04370
       C                -0.00093   -0.00062    0.00019   -0.00009    0.00554    0.03287    0.02415   -0.03680    0.01991
       H                 0.00047   -0.00058    0.00071   -0.03261    0.02393    0.00620    0.00375   -0.00456   -0.01109
       H                -0.00255   -0.00316    0.00114    0.03266   -0.01367    0.05841    0.04293   -0.06718    0.05056
       H                -0.00034   -0.00148   -0.00024    0.00090    0.00602    0.03871    0.03218   -0.04594    0.02335
       C                -0.00134    0.00039   -0.00244   -0.01374   -0.01828   -0.01409   -0.00763    0.00004   -0.01359
       C                -0.00101    0.00059   -0.00095   -0.02203   -0.01899   -0.01189   -0.00233    0.00224   -0.01235
       C                -0.00149    0.00228   -0.00147   -0.00852   -0.03213   -0.02300   -0.01159   -0.00285   -0.02495
       C                -0.00076    0.00045   -0.00017   -0.02491   -0.03335   -0.01859   -0.00087    0.00148   -0.02257
       H                -0.00033    0.00040    0.00032   -0.02636   -0.00839   -0.00509    0.00058    0.00441   -0.00362
       C                -0.00130   -0.00003   -0.00052   -0.01126   -0.04650   -0.02979   -0.01002   -0.00369   -0.03524
       H                -0.00782    0.00366    0.00254   -0.00232   -0.03159   -0.02461   -0.01616   -0.00460   -0.02566
       C                -0.00054    0.00019   -0.00033   -0.01949   -0.04709   -0.02761   -0.00467   -0.00152   -0.03411
       H                -0.00125    0.00075    0.00067   -0.03139   -0.03385   -0.01688    0.00327    0.00318   -0.02161
       H                -0.00132    0.00122    0.00087   -0.00716   -0.05730   -0.03681   -0.01309   -0.00606   -0.04416
       H                -0.00045    0.00057    0.00063   -0.02175   -0.05836   -0.03292   -0.00353   -0.00223   -0.04218
       C                 0.00326   -0.00484    0.00716   -0.02214    0.00944   -0.00078   -0.00699    0.00040    0.00564
       C                 0.00004   -0.00169    0.00359   -0.04187    0.01188   -0.00200   -0.00493   -0.00518    0.01140
       C                -0.00038   -0.00282    0.00275   -0.01233    0.01560    0.00666   -0.00737    0.00575    0.00582
       C                -0.00063   -0.00065    0.00024   -0.05134    0.02006    0.00422   -0.00324   -0.00550    0.01734
       H                 0.00481   -0.00220    0.00644   -0.05036    0.00730   -0.00800   -0.00401   -0.00962    0.01161
       C                -0.00246   -0.00145   -0.00012   -0.02207    0.02419    0.01277   -0.00585    0.00552    0.01158
       H                 0.00132   -0.00445    0.00439    0.00304    0.01398    0.00792   -0.00871    0.00999    0.00145
       C                -0.00143   -0.00112    0.00026   -0.04141    0.02628    0.01155   -0.00373   -0.00013    0.01738
       H                -0.00055   -0.00118    0.00051   -0.06642    0.02171    0.00328   -0.00153   -0.01007    0.02197
       H                -0.00416   -0.00168   -0.00120   -0.01438    0.02921    0.01854   -0.00622    0.00968    0.01160
       H                -0.00129   -0.00127   -0.00036   -0.04893    0.03292    0.01635   -0.00243   -0.00041    0.02196
       C                -0.00616   -0.00690    0.01167   -0.02211   -0.00502   -0.00525    0.03741    0.01365   -0.01340
       C                 0.00791   -0.00304    0.00250   -0.03512   -0.00101   -0.00681    0.02166    0.00733    0.01303
       C                -0.00307    0.00082    0.00486   -0.02157   -0.01729   -0.00436    0.07076    0.02558   -0.05572
       C                 0.00289   -0.00508    0.00072   -0.04750   -0.00912   -0.00699    0.03776    0.01302   -0.00234
       H                 0.01331   -0.01666   -0.00534   -0.03534    0.00837   -0.00781   -0.00461   -0.00194    0.04521
       C                -0.00179    0.00036   -0.00035   -0.03411   -0.02549   -0.00441    0.08823    0.03112   -0.07245
       H                 0.00180    0.00206   -0.00198   -0.01127   -0.02018   -0.00381    0.08350    0.02973   -0.07342
       C                 0.00053   -0.00211    0.00103   -0.04720   -0.02149   -0.00565    0.07154    0.02505   -0.04559
       H                 0.00431   -0.00449   -0.00159   -0.05748   -0.00589   -0.00816    0.02414    0.00798    0.01912
       H                 0.00201    0.00073   -0.00483   -0.03356   -0.03497   -0.00358    0.11444    0.04045   -0.10546
       H                 0.00403   -0.00026   -0.00109   -0.05695   -0.02793   -0.00577    0.08446    0.02938   -0.05817

(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、Cu-DPPBZ錯体触媒が関わるヒドリドの移動挿入反応のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.

