---
title:  【計算化学】自作pythonモジュールで遷移状態構造を求めてみる(SN2反応（基質-bromomethane, 求核剤-3-methyl-2,4-pentanedione）, NNP使用）
published: 2025-08-19
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-08-19

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作モジュール(MultiOptPy)で、SN2反応（基質-bromomethane, 求核剤-3-methyl-2,4-pentanedione）の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonモジュールである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

SN2反応について：
- https://en.wikipedia.org/wiki/SN2_reaction

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)



## 使用した自作モジュールMultiOptPyのバージョン
```
v1.12c
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.12c.zip
unzip v1.12c.zip
cd MultiOptPy-v1.12c
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作モジュールへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.12c`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.12c`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作モジュールでの具体的な使用の仕方に関しては、https://github.com/ss0832/MultiOptPy/blob/main/multioptpy/ase_calculation_tools.py を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`sn2_Br_beta_methyl_diketone.xyz`とした。
初期構造は以下のものを使用した。

```
22
OptimizedStructure
C     -0.150604824667     -0.427273398559      0.101286017171
C      1.334643016814     -0.557522980477      0.220386871651
C     -0.850072611156      0.411045182340      1.120234294655
C      1.882700674699     -1.834064682282      0.819438805904
H      1.921756513702     -1.692871545201      1.904442684854
C      0.185087262045      2.519159315564     -2.089804867039
Br     0.704064125757      3.503157905262     -3.681466837711
H      1.243896610389     -2.693873666293      0.616707105041
H      2.896342253495     -2.015945732888      0.466896535165
C     -1.409972935994     -0.321865476318      2.320553591042
H     -2.388731498931     -0.732068510984      2.047586897621
H     -0.770130757220     -1.159988473360      2.603864035135
H     -1.535160393096      0.362568500682      3.157123989039
O      2.059527671441      0.355943618263     -0.095067920982
O     -0.981724636467      1.600991262979      0.963713064109
H      0.592820704411      1.520218811549     -2.182651659411
H      0.591009508569      3.013862241785     -1.216127799289
H     -0.897144709073      2.505585020644     -2.043068995281
C     -0.940232349657     -0.983181923671     -1.033834815407
H     -1.566411841689     -1.827219046272     -0.720919014644
H     -1.618124195265     -0.221980513728     -1.431278983964
H     -0.303537588107     -1.324675909036     -1.848012997657


```

<MoleculeViewer 
  xyzData={`22
OptimizedStructure
C     -0.150604824667     -0.427273398559      0.101286017171
C      1.334643016814     -0.557522980477      0.220386871651
C     -0.850072611156      0.411045182340      1.120234294655
C      1.882700674699     -1.834064682282      0.819438805904
H      1.921756513702     -1.692871545201      1.904442684854
C      0.185087262045      2.519159315564     -2.089804867039
Br     0.704064125757      3.503157905262     -3.681466837711
H      1.243896610389     -2.693873666293      0.616707105041
H      2.896342253495     -2.015945732888      0.466896535165
C     -1.409972935994     -0.321865476318      2.320553591042
H     -2.388731498931     -0.732068510984      2.047586897621
H     -0.770130757220     -1.159988473360      2.603864035135
H     -1.535160393096      0.362568500682      3.157123989039
O      2.059527671441      0.355943618263     -0.095067920982
O     -0.981724636467      1.600991262979      0.963713064109
H      0.592820704411      1.520218811549     -2.182651659411
H      0.591009508569      3.013862241785     -1.216127799289
H     -0.897144709073      2.505585020644     -2.043068995281
C     -0.940232349657     -0.983181923671     -1.033834815407
H     -1.566411841689     -1.827219046272     -0.720919014644
H     -1.618124195265     -0.221980513728     -1.431278983964
H     -0.303537588107     -1.324675909036     -1.848012997657
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`sn2_Br_beta_methyl_diketone.xyz`として保存し、以下を実行する。
```
python .\optmain.py sn2_Br_beta_methyl_diketone.xyz -opt rsirfo_fsb -os uma-s-1p1 -ma 300 1 6 -elec -1   
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。

これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`sn2_Br_beta_methyl_diketone_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.12c`ディレクトリに置く。

`sn2_Br_beta_methyl_diketone_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`sn2_Br_beta_methyl_diketone_traj.xyz`は次のNEB計算に使用する。

※`sn2_Br_beta_methyl_diketone_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`sn2_Br_beta_methyl_diketone_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）

```
22
OptimizedStructure
C     -0.069557691309      0.456066485335      0.053199264200
C      1.072073836884     -0.422417400202      0.585695235052
C     -0.925087991458      0.856070991837      1.262265395094
C      1.788756286089     -1.313593901836     -0.386506765919
H      2.787744304518     -1.518917183262     -0.006106591918
C      0.509796799049      1.601829040277     -0.596941254226
Br     1.336184248056     -0.282632296903     -3.972253591896
H      1.234991703939     -2.255307940222     -0.452760688562
H      1.824209064034     -0.909990768465     -1.401998432158
C     -1.691884275221     -0.241096189064      1.973133899146
H     -2.682918941040     -0.313492837124      1.518100626466
H     -1.204848759994     -1.210245983190      1.892448172879
H     -1.813687062055      0.030214661651      3.018983895129
O      1.387859082331     -0.361666486334      1.757033838022
O     -1.050431800198      2.007329396099      1.608331268236
H      1.080000729132      1.302570611710     -1.479922226168
H      1.155415535340      2.172862381273      0.073464549898
H     -0.269513734493      2.284879075937     -0.941460692776
C     -0.951795779103     -0.334984361248     -0.933743234054
H     -1.307245776374     -1.276194483472     -0.511027611111
H     -1.818173882972      0.270204125276     -1.211613532339
H     -0.391885895156     -0.541486938072     -1.848321522995


```

<MoleculeViewer 
  xyzData={`22
OptimizedStructure
C     -0.069557691309      0.456066485335      0.053199264200
C      1.072073836884     -0.422417400202      0.585695235052
C     -0.925087991458      0.856070991837      1.262265395094
C      1.788756286089     -1.313593901836     -0.386506765919
H      2.787744304518     -1.518917183262     -0.006106591918
C      0.509796799049      1.601829040277     -0.596941254226
Br     1.336184248056     -0.282632296903     -3.972253591896
H      1.234991703939     -2.255307940222     -0.452760688562
H      1.824209064034     -0.909990768465     -1.401998432158
C     -1.691884275221     -0.241096189064      1.973133899146
H     -2.682918941040     -0.313492837124      1.518100626466
H     -1.204848759994     -1.210245983190      1.892448172879
H     -1.813687062055      0.030214661651      3.018983895129
O      1.387859082331     -0.361666486334      1.757033838022
O     -1.050431800198      2.007329396099      1.608331268236
H      1.080000729132      1.302570611710     -1.479922226168
H      1.155415535340      2.172862381273      0.073464549898
H     -0.269513734493      2.284879075937     -0.941460692776
C     -0.951795779103     -0.334984361248     -0.933743234054
H     -1.307245776374     -1.276194483472     -0.511027611111
H     -1.818173882972      0.270204125276     -1.211613532339
H     -0.391885895156     -0.541486938072     -1.848321522995
`}
  caption="初期パスを求めるための構造最適化の結果（安定構造ではない）"
  backgroundColor="#333333"
/>



#### b. `sn2_Br_beta_methyl_diketone_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`sn2_Br_beta_methyl_diketone_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py sn2_Br_beta_methyl_diketone_traj.xyz -os uma-s-1p1 -ns 20 -modelhess -spng -nd 0.12 -elec -1
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.12c`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-2998.3630541830025,-2998.3630541830025,-2998.369310012413,-2998.3648254431505,-2998.3576453080736,-2998.3578347084886,-2998.3548941390277,-2998.34839093045,-2998.340014635502,-2998.330919763038,-2998.323979614976,-2998.319893957972,-2998.3188590391755,-2998.3185527798946,-2998.3193608052416,-2998.3217375110553,-2998.325711587581,-2998.328147038523,-2998.353045858108,-2998.372879648036,-2998.393853937036,-2998.4101570234193,-2998.4174319830104,-2998.4160283251217,-2998.424652930991,-2998.4413601779015,-2998.4537545041762,-2998.4612899934523,-2998.4662807906857,-2998.4702990109367,-2998.4752066682286,-2998.480044039018,-2998.4831097028123,-2998.4847012951714,-2998.4860708831193,-2998.487508032675,-2998.488582815098,-2998.489675743039,-2998.4906949849315,-2998.4912538335902,-2998.4917602696523,-2998.4920747715196,-2998.4924234002783,-2998.4928034135114,-2998.493124556761,-2998.493355252796,-2998.4936921145677,-2998.4939986520335,-2998.49419926909,-2998.4944125818765,-2998.494683774572,-2998.494983153714,-2998.495308905627,-2998.4956340792673,-2998.495941142436,-2998.4962398294024,-2998.496540312521,-2998.496814650673,-2998.497090355653,-2998.4971896171564,-2998.497601233906,-2998.497861474454,-2998.498102255226,-2998.498368926875,-2998.4986065709522,-2998.498917585656,-2998.4992198386417,-2998.4994527338677,-2998.4998043503724,-2998.5003952581574,-2998.500930721791,-2998.501309385719,-2998.50157239497,-2998.501816408816,-2998.50205092496,-2998.502293501884,-2998.502586055648,-2998.5029345792664,-2998.503336409177,-2998.5036575611884,-2998.504052188967,-2998.5043879380005,-2998.504729136823,-2998.505003869252,-2998.505274641385,-2998.5055910270216,-2998.506117728937,-2998.5066980175197,-2998.507521005691,-2998.5079638754887,-2998.508350828002,-2998.5090213622807,-2998.5094179702073,-2998.5095365863453,-2998.509925536531,-2998.510476753733,-2998.5106309774933,-2998.5110526789804,-2998.511512073378,-2998.512055913214,-2998.5124049099654,-2998.5127448646235,-2998.513151916518,-2998.513429452697,-2998.513655890537,-2998.5138970655867,-2998.514127270965,-2998.514328790479,-2998.514564445646,-2998.5147542419813,-2998.5149302473724,-2998.5150886592337,-2998.5152447580017,-2998.5154506583744,-2998.5156339535147,-2998.5159497959253,-2998.5165511652012,-2998.5169247122863,-2998.517179923608,-2998.5174925241827,-2998.5177502413558,-2998.5183559564443,-2998.5189379448,-2998.5194213638288,-2998.5196045888756,-2998.5198371073475,-2998.5201615362416,-2998.520505854235,-2998.5206758666113,-2998.5210201670816,-2998.5213649757316,-2998.5215739777527,-2998.5218717359767,-2998.5220534364844,-2998.5221951660346,-2998.522424512765,-2998.522554852082];

export const dataset_itr5 = [-2998.383065732239,-2998.37141169447,-2998.3743293684665,-2998.373361549097,-2998.372196994111,-2998.370603247465,-2998.367634779599,-2998.362107839151,-2998.3546330176537,-2998.3464598461615,-2998.33961828276,-2998.336264627867,-2998.3376905887085,-2998.3436411357698,-2998.3490955724533,-2998.3539204268895,-2998.3604505700496,-2998.3656162911498,-2998.3881588751005,-2998.4041062072574,-2998.417624845947,-2998.4304290497703,-2998.438623805755,-2998.439897864692,-2998.446025924159,-2998.457918580747,-2998.466983936078,-2998.4738087886926,-2998.478360369765,-2998.4818663887436,-2998.4850333730446,-2998.487373601636,-2998.489345785501,-2998.4901884875376,-2998.4908494540196,-2998.4933830975356,-2998.4941494236764,-2998.494577696452,-2998.4951496789263,-2998.4950095615322,-2998.495919746321,-2998.4967088792137,-2998.497173259029,-2998.4973132099503,-2998.497738126988,-2998.498191799984,-2998.498647838644,-2998.4988988881496,-2998.498896215826,-2998.4992805485854,-2998.49968357009,-2998.5000425902463,-2998.5004383833334,-2998.5007547864934,-2998.501051948921,-2998.5013370201777,-2998.5016377749093,-2998.5019385296414,-2998.502189885807,-2998.502403058406,-2998.502628812832,-2998.5029456015077,-2998.5032889907593,-2998.5036110890364,-2998.5039105645574,-2998.5041788658855,-2998.504441542191,-2998.5046263969175,-2998.5051408674744,-2998.5055812839914,-2998.5060300416635,-2998.5064380047766,-2998.5067793788335,-2998.5071061032972,-2998.507446618705,-2998.5077587811943,-2998.508050336122,-2998.5083915875143,-2998.5088146908765,-2998.509151421222,-2998.509452123384,-2998.509735161922,-2998.509687445606,-2998.5100324820605,-2998.5102939317253,-2998.511128485364,-2998.511712226064,-2998.5117948841116,-2998.5125947063,-2998.5131620275406,-2998.513392232919,-2998.5145007479564,-2998.514817238734,-2998.5151617319616,-2998.51553810032,-2998.515810677367,-2998.5153223692996,-2998.516165859891,-2998.5166563233406,-2998.516886809094,-2998.5165650087156,-2998.517508663267,-2998.5178449380037,-2998.5177322272634,-2998.5184606764974,-2998.5187104730776,-2998.5189985233183,-2998.5192596575616,-2998.5195019716343,-2998.519724659459,-2998.5199377794875,-2998.5201133818396,-2998.5201405782122,-2998.5201854557317,-2998.521010862137,-2998.5212047239092,-2998.521388141714,-2998.522200352972,-2998.5224574042545,-2998.522270096247,-2998.523077558654,-2998.523498015977,-2998.523264253341,-2998.5237533324394,-2998.5239450213057,-2998.524643803363,-2998.52519580912,-2998.5255119844755,-2998.5247689557427,-2998.525798387513,-2998.5262916897595,-2998.5265116614514,-2998.526192033979,-2998.5268250681042,-2998.5270078200183,-2998.5266477134087,-2998.5273017581335];

export const dataset1_itr10 = [-2998.399018628087,-2998.3774880247547,-2998.37975249077,-2998.381090335014,-2998.380251972218,-2998.379103665839,-2998.3774329507855,-2998.373460317753,-2998.3681506388884,-2998.3621829369313,-2998.3534754275834,-2998.349873609726,-2998.355576934372,-2998.3657702443916,-2998.373595767342,-2998.3808184216673,-2998.3884868371574,-2998.3949725236685,-2998.413651787971,-2998.4281706468637,-2998.437248785541,-2998.4460794757797,-2998.4523953689577,-2998.4576860710363,-2998.4629558764177,-2998.470196446266,-2998.474725097922,-2998.480974603563,-2998.4839697004804,-2998.48653503513,-2998.488837710998,-2998.4901819775814,-2998.4918102903002,-2998.492887534766,-2998.493524231289,-2998.494889981605,-2998.4954298173357,-2998.4958774622696,-2998.496190719973,-2998.496277285747,-2998.496968646629,-2998.4974919840447,-2998.497963785035,-2998.4983613392274,-2998.498729305098,-2998.499050369492,-2998.499338831534,-2998.499657092178,-2998.49981219211,-2998.500138855242,-2998.5005253170993,-2998.5008962181455,-2998.501263526887,-2998.5015853973596,-2998.501895737411,-2998.502192864791,-2998.50250334503,-2998.5028087259493,-2998.50308142566,-2998.503318570319,-2998.503605288779,-2998.503934466524,-2998.5042741232837,-2998.5046225768083,-2998.504963915818,-2998.5052578714567,-2998.505568929969,-2998.505849480179,-2998.506253185097,-2998.506650318727,-2998.50706781459,-2998.5074932485686,-2998.507866602896,-2998.5082359268326,-2998.5086397719383,-2998.509008727883,-2998.5093536767204,-2998.509730045079,-2998.510152044464,-2998.5104972211066,-2998.5108165156335,-2998.5111136955843,-2998.511314023505,-2998.511715923509,-2998.512088874797,-2998.5126890875267,-2998.5131844575385,-2998.5135170698773,-2998.514347470462,-2998.514713464946,-2998.5150286589887,-2998.5156765880347,-2998.515980304227,-2998.516303068395,-2998.5165722984652,-2998.5168299455445,-2998.5159430494023,-2998.5170735037814,-2998.5172850817476,-2998.517660258512,-2998.5169578841505,-2998.518114238168,-2998.5183892509726,-2998.5180072575913,-2998.5190699663667,-2998.5193904349644,-2998.5198146773496,-2998.5201524065315,-2998.5204562103413,-2998.5207382149965,-2998.521020026894,-2998.5213098294785,-2998.521590887868,-2998.5218591541498,-2998.522360569747,-2998.5225927903207,-2998.5223713641835,-2998.523357846013,-2998.5237503184085,-2998.523610551483,-2998.524283363808,-2998.5245138145146,-2998.523965436109,-2998.524901678247,-2998.52504388093,-2998.525531225208,-2998.5258575992034,-2998.5261159121733,-2998.5251452364837,-2998.5263826013456,-2998.526607777498,-2998.52677654571,-2998.5263787286663,-2998.5270894617065,-2998.5272292812024,-2998.5268924457155,-2998.5272078149933];

export const dataset1_itr15 = [-2998.4113036475487,-2998.382386026633,-2998.384660730716,-2998.386104344229,-2998.3856154578884,-2998.3849984445646,-2998.3838167144218,-2998.380622075948,-2998.3766669707325,-2998.3727381024814,-2998.36605126883,-2998.3625289585316,-2998.3735235182157,-2998.38286908205,-2998.392829276021,-2998.4023233290714,-2998.4109782373425,-2998.4173194913133,-2998.431884073231,-2998.4436416591734,-2998.4482311784845,-2998.45798403078,-2998.461994435579,-2998.46851118238,-2998.471378156695,-2998.4771465125923,-2998.4793636478075,-2998.485929556608,-2998.4871736241844,-2998.489615348517,-2998.4911873058654,-2998.4918101501125,-2998.4935176950476,-2998.4942557646477,-2998.4946224600694,-2998.4958626549665,-2998.4960737597994,-2998.4964926049665,-2998.4967884443745,-2998.4968118031147,-2998.4975760176817,-2998.498061872468,-2998.498529616783,-2998.498937571135,-2998.499314184821,-2998.4995856228443,-2998.499726686504,-2998.5001853449176,-2998.500434738459,-2998.500728080777,-2998.501096318261,-2998.501467464635,-2998.5018351238455,-2998.5021692081527,-2998.502497141734,-2998.502814876675,-2998.5031410228657,-2998.5034568127057,-2998.5037443021965,-2998.503931697821,-2998.5043276398574,-2998.5046795454987,-2998.5050393366864,-2998.505411341709,-2998.5057812439195,-2998.5061023433605,-2998.5064493599634,-2998.5067724045057,-2998.507155414246,-2998.507540579369,-2998.5079558672787,-2998.5083869613272,-2998.5087788729734,-2998.5091933898516,-2998.509657340343,-2998.5100623770422,-2998.5104155268477,-2998.510782415027,-2998.511200979819,-2998.511572844654,-2998.511912133422,-2998.512223665067,-2998.512495015473,-2998.512921570952,-2998.5133234884797,-2998.5138430758802,-2998.5143146665896,-2998.5146625768875,-2998.5153882398954,-2998.515719012273,-2998.515936565731,-2998.5164292371337,-2998.5166934555014,-2998.516949017292,-2998.517206524184,-2998.517429842852,-2998.516126554824,-2998.517550333998,-2998.517701175735,-2998.5180595825714,-2998.517050302752,-2998.5185029605486,-2998.518724106311,-2998.5180954179978,-2998.519496206424,-2998.519902820233,-2998.520481724464,-2998.5208870941087,-2998.5212238244544,-2998.521538177373,-2998.5218462393773,-2998.522165025725,-2998.522483514174,-2998.52284018619,-2998.523201712198,-2998.5234418708883,-2998.5230769803807,-2998.5241770491216,-2998.5245569046438,-2998.524065529975,-2998.524962624757,-2998.5249990910274,-2998.5241212369783,-2998.525468596448,-2998.525547416863,-2998.5259201929166,-2998.526174896059,-2998.5263596456443,-2998.5252559670757,-2998.526536509684,-2998.5267212592694,-2998.526881440998,-2998.5264480163323,-2998.5271693685745,-2998.5273048072113,-2998.5269783455988,-2998.527472050884
];

export const dataset2 = [-2998.420994865539,-2998.387024169098,-2998.389339864879,-2998.390812039402,-2998.3900341740787,-2998.3904238777714,-2998.3892334231477,-2998.3866884857775,-2998.383699300829,-2998.380962034987,-2998.3767590848643,-2998.3774159245772,-2998.3925230408345,-2998.4005247586483,-2998.410892657262,-2998.4213847094193,-2998.4304637724586,-2998.4362269501803,-2998.446361892236,-2998.4559237478406,-2998.456323904263,-2998.4673371910244,-2998.4681678982693,-2998.475884588635,-2998.477209369157,-2998.4818445019723,-2998.482534180604,-2998.488660952099,-2998.489687238413,-2998.4921642549452,-2998.4926646541835,-2998.492853258925,-2998.4948720726534,-2998.4950215826093,-2998.4951946878714,-2998.496514623164,-2998.496503189122,-2998.497029601901,-2998.497242581742,-2998.4973060691505,-2998.4981009234452,-2998.4985806450286,-2998.4990261783887,-2998.499415277523,-2998.4997843123233,-2998.4999826250482,-2998.500020484432,-2998.500643512675,-2998.500897882872,-2998.5012234683127,-2998.501585046891,-2998.501957244671,-2998.5023286013266,-2998.5026759683983,-2998.503018884517,-2998.5033541954645,-2998.5036956571385,-2998.504017702845,-2998.504295203977,-2998.5043672778693,-2998.504971310708,-2998.505346101957,-2998.505730338338,-2998.5061250537333,-2998.506523466574,-2998.5068792273714,-2998.507246045457,-2998.50755552686,-2998.5080021641966,-2998.5083807755545,-2998.508796992206,-2998.509257280299,-2998.509696400082,-2998.510146559629,-2998.510620165533,-2998.5110328424507,-2998.5113940880838,-2998.5117708594807,-2998.5122071229434,-2998.5126063243383,-2998.512956950769,-2998.513275789687,-2998.513522975275,-2998.513992533266,-2998.514376243944,-2998.514819534304,-2998.515249927415,-2998.5155038244793,-2998.5161250127617,-2998.516413623752,-2998.516509704752,-2998.516974180946,-2998.5172109926602,-2998.51737311949,-2998.517680287799,-2998.517870679931,-2998.51618166603,-2998.517896982609,-2998.5179819887967,-2998.51841040176,-2998.5171041697945,-2998.5188213088104,-2998.519036899643,-2998.5181247522296,-2998.519884017586,-2998.5203794927384,-2998.521116177987,-2998.521588592298,-2998.521945211744,-2998.52228082059,-2998.522608018187,-2998.522939579119,-2998.523277676293,-2998.5236414803476,-2998.52381142263,-2998.5241628025683,-2998.523710312404,-2998.52485161379,-2998.5251775496995,-2998.5242686441215,-2998.5253991335476,-2998.5253197173356,-2998.5241670782866,-2998.5258697604677,-2998.525947406813,-2998.526152746436,-2998.526352443512,-2998.5265009721556,-2998.5253192617265,-2998.5266206572232,-2998.5267883740294,-2998.526943701766,-2998.5264848155475,-2998.527214841891,-2998.527345426536,-2998.527025588782,-2998.527253183169
];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.012548498996415882,0.012548499979409806,0.006447894397007154,0.011827983301826162,0.014667928758817459,0.011085796375923369,0.009916426891410483,0.010773445760059263,0.011989567352737873,0.013435946246801776,0.014008115376104732,0.014367577664568493,0.015028836007116096,0.01645434083516376,0.01789575360670089,0.019271842133611584,0.020484743160484327,0.021754005515314326,0.01999900009624526,0.019244069463932378,0.016937199119737026,0.014878317971373456,0.016247185841880767,0.02204486086632965,0.020340639322343326,0.013250506551443348,0.011795763340041085,0.01175721008426245,0.012707404511800585,0.01344781536701958,0.012868957499645806,0.010773282153683476,0.010101274932793034,0.01004773214110623,0.010233597303576075,0.010452656921755028,0.01033554101600782,0.009936136342044124,0.009872361222163907,0.010029722524113216,0.010097676898298378,0.009980506546109378,0.01012871606208572,0.010250535795343078,0.01028113744161841,0.010265059471086545,0.010098604901574538,0.010053986511211335,0.01009656660698654,0.01006553841302787,0.010017029749515162,0.010045875783770423,0.010132828129328633,0.010236749119588393,0.010327899266524443,0.010382938730762207,0.010384067394984337,0.010347833562720407,0.010242037999632482,0.010217399377027795,0.01000710775171571,0.010022851940159411,0.010044236321553185,0.010082592954750742,0.010151046485309201,0.010130062859791384,0.010174126391075226,0.010436010902717754,0.010384665586784912,0.010353733558549676,0.010310955150053385,0.010237534317989128,0.01022527733257911,0.010217010787923,0.010238749134645684,0.010250036138311125,0.010211377368402353,0.010176358409943619,0.01017150143981633,0.010167941540455432,0.010068029372433146,0.00999113530287448,0.009961961756328307,0.009988002684788002,0.010098610314741812,0.01020600593777615,0.010220204898690565,0.010361040139802517,0.010365414567427105,0.010447808143193198,0.010592662994886991,0.010360063271541743,0.010224512279679727,0.010358402423683088,0.010190986205626756,0.010033125949896199,0.010153064256612818,0.010134466497093013,0.01012034028398655,0.010030676243414274,0.010078822213838906,0.010126142016868905,0.010017738378013036,0.010077365496367443,0.010007986042466251,0.00998671287501152,0.009988749771744193,0.010024048602184749,0.01005050528680619,0.010086300473972042,0.01012690917171649,0.010155937547939961,0.010163765801458391,0.01012101822474046,0.01017354303233024,0.010050336187228129,0.01011486883654192,0.010183700355210172,0.010287268347033167,0.010334036502311034,0.010315699288042936,0.01027124652114865,0.010026095962668829,0.009938445159672536,0.010087659751185214,0.010227907134586038,0.01020867891163525,0.010102329006637883,0.010116468586855892,0.010096354088021503,0.010058208909136217,0.010059574611092309,0.010072388424297276,0.01006999457528898,0.010095891153944946,0.010082179755496426,0.01003220921224921
];

export const dataset1_grad_itr5 = [0.006685642039386247,0.006249189470889015,0.005169166349150697,0.006934858535128977,0.007046917393403087,0.007261353153473406,0.007604052676133791,0.008641065411430351,0.009870738947512621,0.010968151575415072,0.01144029968244295,0.011473717954783639,0.012124782398211763,0.011741266079811852,0.012356600351573179,0.014044672481893792,0.01493115092978061,0.015575472170102907,0.013512212513859234,0.012975199202773367,0.012415746671000358,0.011286180126230509,0.011788265106827858,0.01513593678438463,0.013865381237501832,0.008873375140887915,0.006449323595485799,0.006267721060695071,0.006048756334995608,0.0060844887976064,0.004471538137285355,0.003203675233282797,0.0032608646665148867,0.004598069567846475,0.0055282865393319084,0.001887114807975864,0.002153419291728059,0.0030317906388746796,0.003173935235531156,0.004775383058915459,0.003340438967552187,0.0018689043433615864,0.0017268003334065451,0.0030605008148729346,0.002868730210382038,0.0022527684804220143,0.0013990189815283893,0.0013193422411163743,0.002301071959705621,0.001728753499532273,0.001564487108401345,0.0017411275123523182,0.0015693477712168695,0.0016706815639933148,0.001716548952437346,0.0017037573973332871,0.0015824024822085293,0.0013212219872962047,0.0013558232474633572,0.0015780111474317474,0.0017921144450738784,0.0018798973848955442,0.0017744139906776008,0.0018443503996826481,0.001958040657761139,0.0019487335901867979,0.0020708579488394234,0.002741815031144065,0.001715074471060015,0.0015250794613347056,0.0014031313154340965,0.0013789836259855168,0.0013977970884521968,0.0015047896400072112,0.0016754451827513627,0.0017020968294176944,0.0017236454496738908,0.0017319736991564117,0.001676196626904085,0.0017078296266256994,0.0017283154576090867,0.0016476627054412452,0.0030130770807860266,0.0032224551522122467,0.003692083826198738,0.0022632479301669946,0.0020141783422419784,0.003754161173778181,0.0036128543504344345,0.0033033144402433963,0.0037942405372007795,0.0015926375660464936,0.0019973348039443463,0.0019306811292915977,0.0016063073444332093,0.0018234028226731766,0.003167003497067873,0.0019838042175809993,0.0014791163101985567,0.0022809798994368924,0.0032963727710893266,0.0013184058192822297,0.0014693442275005035,0.0023692847352027257,0.00123315450884083,0.0014389531238437861,0.0015362139554263776,0.0016369243287175867,0.0018901478688044667,0.0020458735170305505,0.0022198550751132287,0.002501104665686845,0.0032146592461632724,0.003803146164212579,0.0024459277833772265,0.002334388198774137,0.0023084325021663727,0.0017827833272895236,0.0023467576602222364,0.0038484419571492654,0.0021471892400937186,0.002022424791153737,0.0035267401508969095,0.003337991087213457,0.0037627440511568476,0.0027138465543710415,0.0016680729074759811,0.0015596689036082858,0.0032299551290493954,0.0018911652586766933,0.0008289958708441659,0.0006786193206334903,0.002206665650237839,0.0010149866537331144,0.0008888345522051226,0.0026479060909379614,0.0011684898878700559
];

export const dataset1_grad_itr10 = [0.005284636392856837,0.004493079742464287,0.004449318437446757,0.004510259167172042,0.004763230265627178,0.004933552189554131,0.005363458654514021,0.006651814434711583,0.008174993887606698,0.00921108014426278,0.01021275850959773,0.009522393646126604,0.010844082793823078,0.008579667306280922,0.009620051492199367,0.011192969915125537,0.011937776625149079,0.012091331579057963,0.010561281763225327,0.009321825137089252,0.009053081555864474,0.00919973163251428,0.010170522280699545,0.011105744249801515,0.007117578766943067,0.0057780510968360515,0.005399767361322908,0.00493770519667802,0.0044782412862391765,0.0042480076517681705,0.002888144296697024,0.0022325218361398556,0.002022710484324028,0.002249727579637911,0.0025810012750122537,0.001288837375607067,0.0013029396308258407,0.001253926452434953,0.0018537192583172228,0.002589689110912032,0.0016470943395159848,0.0011506124302811884,0.0008774207647075926,0.0012707193497059118,0.0013942786645923253,0.0012878557677071484,0.0007025678768644945,0.0007308567014012881,0.0012416131098001452,0.0010830738379860386,0.0008739247343899472,0.0009620273564195854,0.0009075528280154505,0.0010573856238742963,0.0011158289874280802,0.0011505729949971143,0.0010864973639447204,0.0008487324749385246,0.0009082792105096966,0.0011093100989226722,0.001224539046255813,0.001239370215058119,0.0011632409305745884,0.0011845462827104489,0.0012642336864999053,0.0013028138621450122,0.0013958453914684884,0.0018765543444702471,0.0011042968265083007,0.0009503100165929324,0.0008662233795791712,0.0008370973234488463,0.0008420964225173515,0.0009158636065269679,0.0010342976382977805,0.001114143675401471,0.0011635312132956188,0.001174623664442292,0.0011409090877810637,0.0011887660117381694,0.0011829247836262758,0.001137859389420433,0.0016703266725535814,0.001894538831833287,0.0021518331447178993,0.0012482179458099014,0.001214957285533462,0.002242553521512543,0.001593972247897796,0.001936850680501142,0.002150543407767177,0.00098136887253829,0.0010859591642475486,0.001069951363693754,0.0010014383678615267,0.0009192920911394422,0.002113147195887182,0.001072608224087769,0.0007535260735957579,0.0008239360692981141,0.001979354040544532,0.0007236879188475597,0.000596611986954442,0.001170278530859573,0.000660109318902774,0.0008410390757829068,0.0009599624397251552,0.001074703625680225,0.0012370473496358676,0.001360405878571184,0.0014102621834545439,0.001422107838785021,0.001426213797305404,0.0017409729592914626,0.0012579787010407318,0.001015112919762423,0.0012919337031598599,0.001023685124769009,0.0009784496438089104,0.0016483724033973396,0.0008718701442837582,0.0008948049453040074,0.0017285895436721962,0.0017904212380222481,0.0022725908770662604,0.0011736648207603068,0.0008213300936433876,0.0004937027358942978,0.002169648826634472,0.00044171424636144823,0.0002491419609130253,0.00023516925354769098,0.0014065265437205345,0.0002421280528800093,0.00023573237524574726,0.0016858385678261449,0.0016210109838241935
];

export const dataset1_grad_itr15 = [0.00442429663084536,0.004028431759712801,0.004085738734752199,0.00371525990665631,0.0042206586029427855,0.0045368515701251725,0.004704014439363742,0.005906116624879885,0.007142038794577245,0.007927756046628811,0.009252451931776456,0.008475016800281386,0.010278434322235392,0.008260483138183618,0.00917170018200095,0.01003878516211918,0.010395465288247576,0.010105225684313086,0.0090985979936594,0.007957946804212053,0.007923076741922531,0.007638741040829851,0.008658148045795544,0.00885958006314358,0.005834061383277103,0.0053084711332702685,0.004571332306150003,0.0038136922585558647,0.0032692270611427757,0.0031239051750846848,0.002051977022472365,0.0018460909202780056,0.001531948342083885,0.0017566753834933127,0.0016218384751089674,0.0008782479901797843,0.0010879904030398813,0.0009205349870725129,0.0013387431856491043,0.0019775359534120094,0.0013352891475010462,0.0009142273688380043,0.0006397559060775547,0.0007736613815169902,0.0007447446214301022,0.0008104255151141454,0.0005153725983149005,0.0005853336280655141,0.0005312026736869162,0.0008048602497863385,0.0006848507711063781,0.000726907869352978,0.0006808154033242544,0.0008337120220431954,0.0008950312111727381,0.0009300707818318294,0.0008956987337094185,0.0007517084011215969,0.0008188002110690661,0.0009989307612090917,0.0010610681665213257,0.0010487220836296455,0.0009874808066537395,0.000968067019637035,0.00099609749438704,0.0010418870647307453,0.0010649261710932688,0.0014157859687167317,0.0008772382831768912,0.0007556832853885184,0.0006888563511341351,0.0006674352239433289,0.0007057755723763079,0.000781700858391761,0.0008711429083274289,0.0009329662704704569,0.0009668701719594041,0.000986463859191997,0.0009724138269457007,0.0010180825077228252,0.0010020864409581536,0.0009821436613435468,0.001130908103564495,0.0013269635399286966,0.0015103582110137825,0.0009671606737844846,0.0010238010200760588,0.0017149893793843686,0.0010847307355558258,0.0013873626747360722,0.0015177704619279417,0.0008018605739678056,0.0008697351254805172,0.0007807793638392109,0.0007726890886363967,0.0006273457845917116,0.0016553284613475602,0.0007741443853677286,0.0005392402343289116,0.00047958256524281093,0.0016293852532432642,0.0005619252561242622,0.00039103485838513246,0.0006859673608974991,0.0005151190039778268,0.0006753956471096898,0.0007661192972023584,0.0008526362989936701,0.00096433416529558,0.0010604516845939824,0.001111808991664945,0.001106699544905085,0.0010607956436485806,0.001193474547686868,0.0009000369797966729,0.0007258399912190411,0.0009457986242438253,0.0007997549413748519,0.0006791313125680528,0.0011533887191734677,0.0006455956529426213,0.0007316092314546065,0.001253954700275818,0.0012001687650017292,0.0014992045661504651,0.0006639269782669146,0.0004584977826127316,0.0003111290003481584,0.0017924190030904003,0.0002628196505678891,0.00023392961223152344,0.00021719084851812924,0.001092091357770148,0.00019403135229906335,0.00016789575705464965,0.0012679267907771859,0.0007978946402629482
];

export const dataset2_grad = [0.003966921074937374,0.003695687949423778,0.003792404753163664,0.003336688445000255,0.00376664942374398,0.004254205064409738,0.0041667242504539615,0.00519604330866862,0.006398842328758119,0.006710821492442259,0.007829194888555333,0.008473066974636581,0.009854791143285859,0.008762863446229726,0.009171824208648705,0.009423212421850378,0.009143524357781844,0.008489839596095906,0.00857304519543749,0.007130497008248461,0.0068905860733222005,0.006717055983050771,0.007493593712188604,0.007019499157134921,0.004979994559016761,0.004813749650161185,0.0035456223936351236,0.003278777752564072,0.0022064970819954087,0.002076339965817797,0.0016148323369553348,0.0015904236609234979,0.0011900150506924197,0.0014634043296384422,0.0012627325188206743,0.0007123916991099008,0.000895745660339054,0.000770277263725469,0.0010974526907076886,0.0012575427833795266,0.0011611484807897015,0.0007728924983152605,0.0005268690464416288,0.0005660606191449618,0.00044369731992250326,0.0005502973085783165,0.000457142017449265,0.0005105948582992411,0.0004066639916856978,0.0006465354830172583,0.000595647045509301,0.0006196280293693684,0.0005848236269629811,0.0007007116116821788,0.0007525347919967718,0.0007828819594384705,0.0007674708014231454,0.0007029579693042449,0.0007726838053205802,0.0009302696026628142,0.000968903521709141,0.0009445147426882921,0.0008835921675685958,0.0008551342113643583,0.0008544707157512843,0.0008979892867866939,0.0008763485990174644,0.0011175422658798615,0.0007538406118264439,0.0006595776667332523,0.0006098133348830947,0.0006090843926769086,0.0006670770391729064,0.0007149090446324382,0.0007803497288899811,0.0008407226224464855,0.0008743271076459866,0.0008973502413942006,0.000888406655579385,0.000931805143737681,0.0009165451567671535,0.0008942903441062887,0.0009048689489518918,0.0010061473825379425,0.0011258473210390833,0.0008075328139144084,0.0008824505007091607,0.0013555402552062413,0.0008075715457274851,0.0009987327951916272,0.0011088026377314875,0.0006860749026685105,0.0007433246927398222,0.0006529090030062801,0.000664645264977314,0.0005695902855296051,0.0014540592499705123,0.0006793876258976222,0.00045833162312367004,0.00043545523907427065,0.0014275101048268908,0.0004770128340150455,0.0003693306541709046,0.0006924342788174255,0.0004535287732706313,0.000595020026914684,0.0006647887145264993,0.0007293635767904555,0.0008065085141280705,0.0008765815690498524,0.0009274351247205984,0.0009258770626116311,0.0008631211145929111,0.0009010009031992061,0.0007323803858130893,0.00059681156931928,0.0007165274528492101,0.000681605142801385,0.0005118656102164937,0.0008767330407518984,0.0005345739358300113,0.0006239659237112408,0.0011402420487490218,0.0006357658464691817,0.0006637823669153239,0.00036560468794909966,0.00030349427858215335,0.0002614219560205727,0.0015948794407536892,0.0002244495262619393,0.00021599228683959632,0.00020248341216913147,0.0009080333032043643,0.00016885564832035393,0.0001481918236757246,0.001028218215710939,0.001643066494309915
];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、ITR. 5の経路の11番(グラフ上では12番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`sn2_Br_beta_methyl_diketone_traj_11_itr5.xyz`
```
22
-1 1
C      -0.085247299014      0.128773105683     -0.267782193141
C       1.341726934541     -0.414502824398      0.146068403100
C      -0.818460126808      0.576668168182      1.020481023227
C       1.824349907143     -1.802282347699      0.734006667890
H       1.880154050191     -1.674645938708      1.820525720830
C       0.112155145941      2.084539671458     -1.703332547736
Br      0.673607995596      3.491622519816     -3.643533188804
H       1.216626547577     -2.691345702108      0.575736710243
H       2.870746676835     -2.006716011012      0.439246231846
C      -1.362160312811     -0.294525145551      2.223259240641
H      -2.351861988800     -0.717735222104      2.007993084089
H      -0.755921840234     -1.136930998728      2.569077415478
H      -1.532349969565      0.365900510341      3.091395874376
O       2.263959765894      0.384016953447      0.103840338437
O      -1.084792523370      1.755698646357      1.155268477720
H       0.666072410599      1.278891542725     -2.150610713399
H       0.597760712098      2.863122829803     -1.106207781902
H      -0.927860089244      2.337868549960     -1.946737317525
C      -0.963304760414     -0.994806179404     -1.023749835446
H      -1.585089459174     -1.882893062969     -0.710364956102
H      -1.657079531616     -0.305257899060     -1.500593581872
H      -0.323032245363     -1.345461166033     -1.833987071950

```


<MoleculeViewer 
  xyzData={`22
-1 1
C      -0.085247299014      0.128773105683     -0.267782193141
C       1.341726934541     -0.414502824398      0.146068403100
C      -0.818460126808      0.576668168182      1.020481023227
C       1.824349907143     -1.802282347699      0.734006667890
H       1.880154050191     -1.674645938708      1.820525720830
C       0.112155145941      2.084539671458     -1.703332547736
Br      0.673607995596      3.491622519816     -3.643533188804
H       1.216626547577     -2.691345702108      0.575736710243
H       2.870746676835     -2.006716011012      0.439246231846
C      -1.362160312811     -0.294525145551      2.223259240641
H      -2.351861988800     -0.717735222104      2.007993084089
H      -0.755921840234     -1.136930998728      2.569077415478
H      -1.532349969565      0.365900510341      3.091395874376
O       2.263959765894      0.384016953447      0.103840338437
O      -1.084792523370      1.755698646357      1.155268477720
H       0.666072410599      1.278891542725     -2.150610713399
H       0.597760712098      2.863122829803     -1.106207781902
H      -0.927860089244      2.337868549960     -1.946737317525
C      -0.963304760414     -0.994806179404     -1.023749835446
H      -1.585089459174     -1.882893062969     -0.710364956102
H      -1.657079531616     -0.305257899060     -1.500593581872
H      -0.323032245363     -1.345461166033     -1.833987071950
`}
  caption="NEB法により緩和したパスのエネルギー極大値を示す構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`sn2_Br_beta_methyl_diketone_traj_11_itr5.xyz`を`MultiOptPy-v1.12c`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py sn2_Br_beta_methyl_diketone_traj_11_itr5.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1 -elec -1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造を以下に示す。


(実行して得られた正確な遷移状態構造は`sn2_Br_beta_methyl_diketone_traj_11_itr5_optimized.xyz`として保存されている。)

```
22
OptimizedStructure
C      0.115154016122     -0.141312403332      0.405969062595
C      1.560886025419     -0.244506408123      0.420031998389
C     -0.558967162385      0.732170346012      1.345580730326
C      2.178093370764     -1.460270400504     -0.278203249964
H      1.749267177866     -2.401754121850      0.071259737620
C      0.055831017605      1.360532105311     -1.306905114157
Br    -0.066553326836      2.846718266408     -3.128760547970
H      2.015460675731     -1.409622978578     -1.358566571309
H      3.248183396079     -1.444249820458     -0.084614339624
C     -2.066793010114      0.526582623280      1.524752405022
H     -2.604653222826      0.776879114577      0.605725522251
H     -2.317247532033     -0.505924791667      1.776580023744
H     -2.398962209285      1.193004352364      2.317466722577
O      2.332383495726      0.578562587730      0.900977258278
O     -0.037844286048      1.645360096621      1.976811837189
H      0.530921830313      0.604224721339     -1.904536445535
H      0.646395418012      2.007101978143     -0.679618495151
H     -1.013377622858      1.336668960984     -1.204770729390
C     -0.678462736587     -1.273848090559     -0.214070594784
H     -0.805708636812     -2.142193217034      0.446240295805
H     -1.677988133104     -0.946083061663     -0.503882249654
H     -0.206018544750     -1.638039859002     -1.127467256257

```

<MoleculeViewer 
  xyzData={`22
OptimizedStructure
C      0.115154016122     -0.141312403332      0.405969062595
C      1.560886025419     -0.244506408123      0.420031998389
C     -0.558967162385      0.732170346012      1.345580730326
C      2.178093370764     -1.460270400504     -0.278203249964
H      1.749267177866     -2.401754121850      0.071259737620
C      0.055831017605      1.360532105311     -1.306905114157
Br    -0.066553326836      2.846718266408     -3.128760547970
H      2.015460675731     -1.409622978578     -1.358566571309
H      3.248183396079     -1.444249820458     -0.084614339624
C     -2.066793010114      0.526582623280      1.524752405022
H     -2.604653222826      0.776879114577      0.605725522251
H     -2.317247532033     -0.505924791667      1.776580023744
H     -2.398962209285      1.193004352364      2.317466722577
O      2.332383495726      0.578562587730      0.900977258278
O     -0.037844286048      1.645360096621      1.976811837189
H      0.530921830313      0.604224721339     -1.904536445535
H      0.646395418012      2.007101978143     -0.679618495151
H     -1.013377622858      1.336668960984     -1.204770729390
C     -0.678462736587     -1.273848090559     -0.214070594784
H     -0.805708636812     -2.142193217034      0.446240295805
H     -1.677988133104     -0.946083061663     -0.503882249654
H     -0.206018544750     -1.638039859002     -1.127467256257
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -492.1399             50.7565             54.0147
Reduced mass [au]                  11.2717              3.4870              5.8648
Force const [Dyne/A]               -1.6085              0.0053              0.0101
Char temp [K]                       0.0000             73.0272             77.7151
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.00865   -0.07097    0.09619   -0.02156    0.01184    0.01210   -0.01210   -0.01926   -0.01065
       C                -0.01507   -0.00517    0.00991   -0.02055    0.02646   -0.01608   -0.01055   -0.00149   -0.02256
       C                 0.00983   -0.01633   -0.00022   -0.01451   -0.00939    0.03761   -0.01026    0.00760   -0.03449
       C                -0.00126    0.00055   -0.00407   -0.02069    0.09225   -0.13092   -0.00660   -0.04002    0.04885
       H                 0.00761   -0.00647   -0.00983    0.02379    0.05635   -0.17286   -0.00356   -0.02113    0.10338
       C                -0.00924    0.16392   -0.19345   -0.01943    0.01127    0.01155   -0.01823   -0.03509   -0.01065
      Br                 0.00147   -0.01232    0.01616    0.02823   -0.01542   -0.01470    0.01604    0.01601    0.02370
       H                 0.00591   -0.00137   -0.00674   -0.07604    0.15956   -0.11946   -0.00788   -0.10247    0.04618
       H                -0.00149    0.00842   -0.00034   -0.01181    0.10876   -0.18187   -0.00644   -0.02498    0.04674
       C                -0.00062   -0.00034   -0.00351    0.00408   -0.07520    0.11968    0.01192   -0.06448    0.06468
       H                -0.00683    0.00385   -0.00061   -0.05680   -0.07040    0.15659   -0.05414   -0.11163    0.09047
       H                -0.01284    0.00254   -0.00058    0.05841   -0.09171    0.10557    0.07715   -0.07059    0.10389
       H                 0.00682    0.00382   -0.00314    0.02298   -0.10834    0.15555    0.02673   -0.05996    0.06713
       O                 0.00471    0.00453   -0.00647   -0.01991   -0.00851    0.04301   -0.01476    0.03747   -0.08299
       O                -0.00355    0.01012   -0.00292   -0.02282    0.02188   -0.00103   -0.02497    0.08322   -0.13220
       H                -0.00578   -0.00080    0.01519   -0.01305    0.00686    0.02300   -0.01249   -0.02248   -0.02281
       H                -0.00636   -0.00750   -0.01355   -0.02973    0.01791    0.01435   -0.02669   -0.04490    0.00765
       H                 0.01258   -0.00731    0.00922   -0.02112    0.01321   -0.00080   -0.02041   -0.03521   -0.02884
       C                -0.00145   -0.00901    0.00649   -0.02168    0.01464    0.00696   -0.00389   -0.05557    0.04580
       H                -0.04278   -0.04604   -0.04636    0.02358   -0.00925   -0.01577    0.02876   -0.03789    0.07543
       H                 0.00838    0.01975   -0.00311   -0.04013    0.00264    0.05749   -0.01703   -0.08331    0.05970
       H                 0.01017    0.01759   -0.00048   -0.05072    0.05380   -0.02367   -0.01755   -0.07397    0.04589

(...snip...)
```
その結果、虚振動が１つであることが確認できた。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作モジュールで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、SN2反応（基質-bromomethane, 求核剤-3-methyl-2,4-pentanedione）のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作モジュールMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.


### 個人的な技術的補足

`-modelhess`を使わない場合のアルゴリズムを用いた`nebmain.py`による経路緩和の結果

#### コマンド
```
python .\nebmain.py sn2_Br_beta_methyl_diketone_traj.xyz -os uma-s-1p1 -ns 20 -spng -nd 0.12 -elec -1
```

#### 結果

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1_nomh = [-2998.3630541830025,-2998.3630541830025,-2998.369310012413,-2998.3648254431505,-2998.3576453080736,-2998.3578347084886,-2998.3548941390277,-2998.34839093045,-2998.340014635502,-2998.330919763038,-2998.323979614976,-2998.319893957972,-2998.3188590391755,-2998.3185527798946,-2998.3193608052416,-2998.3217375110553,-2998.325711587581,-2998.328147038523,-2998.353045858108,-2998.372879648036,-2998.393853937036,-2998.4101570234193,-2998.4174319830104,-2998.4160283251217,-2998.424652930991,-2998.4413601779015,-2998.4537545041762,-2998.4612899934523,-2998.4662807906857,-2998.4702990109367,-2998.4752066682286,-2998.480044039018,-2998.4831097028123,-2998.4847012951714,-2998.4860708831193,-2998.487508032675,-2998.488582815098,-2998.489675743039,-2998.4906949849315,-2998.4912538335902,-2998.4917602696523,-2998.4920747715196,-2998.4924234002783,-2998.4928034135114,-2998.493124556761,-2998.493355252796,-2998.4936921145677,-2998.4939986520335,-2998.49419926909,-2998.4944125818765,-2998.494683774572,-2998.494983153714,-2998.495308905627,-2998.4956340792673,-2998.495941142436,-2998.4962398294024,-2998.496540312521,-2998.496814650673,-2998.497090355653,-2998.4971896171564,-2998.497601233906,-2998.497861474454,-2998.498102255226,-2998.498368926875,-2998.4986065709522,-2998.498917585656,-2998.4992198386417,-2998.4994527338677,-2998.4998043503724,-2998.5003952581574,-2998.500930721791,-2998.501309385719,-2998.50157239497,-2998.501816408816,-2998.50205092496,-2998.502293501884,-2998.502586055648,-2998.5029345792664,-2998.503336409177,-2998.5036575611884,-2998.504052188967,-2998.5043879380005,-2998.504729136823,-2998.505003869252,-2998.505274641385,-2998.5055910270216,-2998.506117728937,-2998.5066980175197,-2998.507521005691,-2998.5079638754887,-2998.508350828002,-2998.5090213622807,-2998.5094179702073,-2998.5095365863453,-2998.509925536531,-2998.510476753733,-2998.5106309774933,-2998.5110526789804,-2998.511512073378,-2998.512055913214,-2998.5124049099654,-2998.5127448646235,-2998.513151916518,-2998.513429452697,-2998.513655890537,-2998.5138970655867,-2998.514127270965,-2998.514328790479,-2998.514564445646,-2998.5147542419813,-2998.5149302473724,-2998.5150886592337,-2998.5152447580017,-2998.5154506583744,-2998.5156339535147,-2998.5159497959253,-2998.5165511652012,-2998.5169247122863,-2998.517179923608,-2998.5174925241827,-2998.5177502413558,-2998.5183559564443,-2998.5189379448,-2998.5194213638288,-2998.5196045888756,-2998.5198371073475,-2998.5201615362416,-2998.520505854235,-2998.5206758666113,-2998.5210201670816,-2998.5213649757316,-2998.5215739777527,-2998.5218717359767,-2998.5220534364844,-2998.5221951660346,-2998.522424512765,-2998.522554852082];

export const dataset_itr5_nomh = [-2998.3707562073473,-2998.3640252934924,-2998.369892545091,-2998.367843292059,-2998.3625770417448,-2998.3599445205987,-2998.3564354826603,-2998.3505304187725,-2998.3428643722323,-2998.3344507156758,-2998.327264100487,-2998.3234018453873,-2998.323214975466,-2998.324139967558,-2998.326026277825,-2998.3296634860076,-2998.3351258805214,-2998.3387617131143,-2998.3635915577856,-2998.3840701054964,-2998.4008323825674,-2998.416133093365,-2998.4258135519653,-2998.425725352131,-2998.434310289322,-2998.447612250726,-2998.459145536688,-2998.4669002791948,-2998.4724712598704,-2998.476813856445,-2998.481097565513,-2998.4841022302267,-2998.4865102920385,-2998.48696975653,-2998.487494916383,-2998.4914440942966,-2998.492417328408,-2998.492826053791,-2998.4932331845407,-2998.492839555598,-2998.4943521873543,-2998.4955919967356,-2998.4961169112607,-2998.495821904216,-2998.496390785042,-2998.4969804486627,-2998.497660892444,-2998.4979215798394,-2998.4977857469253,-2998.4981895569845,-2998.4985528090506,-2998.498879367042,-2998.49933876144,-2998.4996660291304,-2998.499990037462,-2998.5002818815265,-2998.5005912490274,-2998.5009063466914,-2998.5011166804934,-2998.501188281253,-2998.5013767107603,-2998.5016970742167,-2998.5020797334887,-2998.502384886603,-2998.5026370138,-2998.5029024588084,-2998.503115824165,-2998.503085280816,-2998.5038812303255,-2998.504444416035,-2998.5049565910217,-2998.5053501498705,-2998.5056439127516,-2998.505906746768,-2998.5061577875117,-2998.5064434195183,-2998.506713508237,-2998.5070290702724,-2998.50744174719,-2998.5077527706558,-2998.5080362472795,-2998.508247019168,-2998.5078582617402,-2998.5080509669656,-2998.5080843140645,-2998.509239020879,-2998.510004637321,-2998.5098270197736,-2998.5105455332196,-2998.5113562900324,-2998.5113662783906,-2998.5131261044967,-2998.5133772153345,-2998.513612327275,-2998.5139946536015,-2998.5142369676746,-2998.513657695451,-2998.514672670387,-2998.5154474515857,-2998.515350739742,-2998.5152078185984,-2998.516568636067,-2998.516941972871,-2998.516831540177,-2998.517448540358,-2998.517725866256,-2998.518003945662,-2998.5182257397914,-2998.518355255507,-2998.5185639596293,-2998.5186255019366,-2998.518608451633,-2998.518473801551,-2998.5185445086154,-2998.5192312170248,-2998.519536002147,-2998.520235993321,-2998.52082422002,-2998.5208141440444,-2998.520344270632,-2998.5213984630177,-2998.5221442254065,-2998.5216694103847,-2998.5222822925584,-2998.522132554798,-2998.523209036994,-2998.5240520369293,-2998.5242073120958,-2998.523867427531,-2998.5243408582014,-2998.5251513171156,-2998.5254382108096,-2998.5254335846225,-2998.5258462264933,-2998.525995981777,-2998.5254453253247,-2998.5265487235188
];

export const dataset1_itr10_nomh = [-2998.3735336971413,-2998.3653375316153,-2998.3701654211313,-2998.3701206378,-2998.3642117833742,-2998.361037369684,-2998.3575977141477,-2998.352146800496,-2998.3465608025094,-2998.338285950732,-2998.331782949971,-2998.325570701346,-2998.325751788533,-2998.3273402814343,-2998.3308184753873,-2998.334359008964,-2998.342194536701,-2998.345359433523,-2998.37028926692,-2998.391471595248,-2998.4076120334785,-2998.4202577334427,-2998.430520714864,-2998.4347572508423,-2998.445884290988,-2998.4526691463598,-2998.461150042531,-2998.4686291413896,-2998.4744705086823,-2998.4787887038724,-2998.482630419315,-2998.4849238603315,-2998.4871309458563,-2998.488408746047,-2998.4894204002912,-2998.4918340170325,-2998.4929887588937,-2998.4936823890607,-2998.494278667779,-2998.494094102189,-2998.4953462831163,-2998.4959758037926,-2998.4965895446144,-2998.4965518517038,-2998.497076853846,-2998.4975232896627,-2998.4980650880184,-2998.4982667827667,-2998.4982536489515,-2998.498582160806,-2998.4989698493036,-2998.4993644946057,-2998.499821356867,-2998.5001685224192,-2998.500421771116,-2998.500665688583,-2998.5009370652747,-2998.501237434491,-2998.5014432122,-2998.501563966197,-2998.5017693408668,-2998.5021110829157,-2998.502476481603,-2998.5028028731217,-2998.5030616767476,-2998.5033269465216,-2998.5035315326368,-2998.5034593886508,-2998.5042529199263,-2998.5047619757415,-2998.5052442382234,-2998.5056745787647,-2998.5060221210706,-2998.506328255497,-2998.5066431691653,-2998.50692165161,-2998.507169432995,-2998.5074742356405,-2998.507888594808,-2998.5081974979375,-2998.5084971311694,-2998.5087833940197,-2998.508619059237,-2998.508839907101,-2998.5089186574223,-2998.509845647186,-2998.510574569553,-2998.51076299906,-2998.5117319048827,-2998.5121140910214,-2998.51226009629,-2998.513639138132,-2998.5138063467584,-2998.5140618034084,-2998.5144716765762,-2998.5146936809865,-2998.5142183227385,-2998.515078057555,-2998.5158876402975,-2998.516044001917,-2998.51592447456,-2998.516937048785,-2998.5173731019663,-2998.517484673683,-2998.5178935480153,-2998.5180943140213,-2998.518301738933,-2998.518514473446,-2998.5187414895595,-2998.5189129739038,-2998.5190869640996,-2998.519321988423,-2998.5193710715675,-2998.51971237553,-2998.5200293394405,-2998.5203951762137,-2998.52088164432,-2998.5213514826855,-2998.521545169224,-2998.521446915318,-2998.522090148083,-2998.522752814338,-2998.5228136381847,-2998.5231369455787,-2998.5229133114885,-2998.5237944073733,-2998.524387698346,-2998.524754954517,-2998.5244414602475,-2998.5248966840672,-2998.525591085265,-2998.5258860222166,-2998.5260041126517,-2998.5262956675797,-2998.526483396149,-2998.5263831796187,-2998.5269062366597
];

export const dataset1_itr15_nomh = [-2998.376051860892,-2998.367511992883,-2998.370681077806,-2998.373081288023,-2998.366012774222,-2998.3621848754615,-2998.3592949109457,-2998.3532478246407,-2998.350679012581,-2998.3423864314677,-2998.3348976465295,-2998.3275053982006,-2998.3282225404373,-2998.330377377647,-2998.3350738183935,-2998.337586836825,-2998.348084937306,-2998.352478087351,-2998.3738024146514,-2998.394571587453,-2998.4105139670487,-2998.4242645809836,-2998.434271527482,-2998.440344791165,-2998.4526243476957,-2998.457226694162,-2998.463200354635,-2998.4701560459844,-2998.475501526324,-2998.4803856233557,-2998.4835963373916,-2998.48556374612,-2998.487511055468,-2998.488824883843,-2998.490554998963,-2998.49233002665,-2998.49328402879,-2998.493988137972,-2998.494721388627,-2998.494960697431,-2998.4956658492565,-2998.4961567858395,-2998.4968269083165,-2998.497025098378,-2998.4974326409283,-2998.4978492430955,-2998.4982898348467,-2998.4984841434666,-2998.4986684111577,-2998.4988731987924,-2998.499192300562,-2998.4996286428795,-2998.500045446566,-2998.5004082079768,-2998.500670700286,-2998.5009167205653,-2998.5011667975205,-2998.501457038191,-2998.501663797212,-2998.501815935683,-2998.5020655745525,-2998.502380225369,-2998.502728819081,-2998.5030934467372,-2998.503378850939,-2998.503641597338,-2998.5038961602927,-2998.503854436992,-2998.5045807658903,-2998.5049834719725,-2998.5054554832445,-2998.505901770112,-2998.5062588276437,-2998.506590371053,-2998.506941786038,-2998.507227277857,-2998.5074834704915,-2998.507786257942,-2998.5082072409677,-2998.5085283579324,-2998.508881104699,-2998.509170136252,-2998.5092123502095,-2998.509379821687,-2998.509418811332,-2998.510216337951,-2998.5108354058975,-2998.5112240757076,-2998.512262619665,-2998.512488514278,-2998.512733754765,-2998.5139221241,-2998.5141265525044,-2998.5143438255873,-2998.514733056147,-2998.515000656538,-2998.514642530077,-2998.5153443787353,-2998.516083464695,-2998.516389651692,-2998.516344160852,-2998.517130489995,-2998.5175525244276,-2998.517732945724,-2998.51809236892,-2998.518280623193,-2998.518496914963,-2998.518707020961,-2998.518943569823,-2998.5191585648595,-2998.5193346929145,-2998.5196008213366,-2998.5197111664133,-2998.520026307886,-2998.5205604572616,-2998.520687274368,-2998.52108992788,-2998.5215709111512,-2998.5219324897294,-2998.5218885759987,-2998.522418449656,-2998.522994848036,-2998.5231489140856,-2998.5236590388304,-2998.523563133065,-2998.5240438359615,-2998.524562056534,-2998.525048962726,-2998.524910527582,-2998.5252298045857,-2998.5257637612035,-2998.5260954448,-2998.5261433363507,-2998.526449418207,-2998.526666463485,-2998.5267523808916,-2998.5270764417937
];

export const dataset2_nomh = [-2998.3791536251547,-2998.369741139318,-2998.372040565684,-2998.375959087441,-2998.370769374019,-2998.3658467933315,-2998.3655151995426,-2998.355752148881,-2998.3576274108955,-2998.349543932015,-2998.3420077872534,-2998.3313853453988,-2998.3326772607174,-2998.3394434284396,-2998.353303023464,-2998.355091450453,-2998.3695375958473,-2998.3793706025294,-2998.3912878795445,-2998.4060065537965,-2998.4177271784324,-2998.428247119138,-2998.4374303195764,-2998.445622499616,-2998.4564061067017,-2998.461597529754,-2998.4667359268888,-2998.4728511504395,-2998.4773724948227,-2998.4818841312226,-2998.4844405902522,-2998.4864794420296,-2998.488246295033,-2998.4893944568444,-2998.490954831202,-2998.4926114530317,-2998.4936119185627,-2998.494304400944,-2998.4949709749258,-2998.4954280474685,-2998.4959656489614,-2998.496432122827,-2998.4970008722275,-2998.497320937786,-2998.4977043418035,-2998.4981578833736,-2998.498468013144,-2998.4986906922068,-2998.498869334875,-2998.4990771365406,-2998.499356977052,-2998.4997862223777,-2998.5001840131363,-2998.5005584013466,-2998.500823530933,-2998.501100786737,-2998.501362762105,-2998.50163160666,-2998.501854837711,-2998.502072163364,-2998.5023650851203,-2998.5026583398217,-2998.502978843466,-2998.5033606791358,-2998.503671282039,-2998.5039156463536,-2998.5041652326527,-2998.504252709645,-2998.5048988162534,-2998.505254349246,-2998.5056519560085,-2998.5060972966107,-2998.5064585247205,-2998.5068068731043,-2998.5071874996574,-2998.507486554616,-2998.5077566258115,-2998.5080654588473,-2998.508495396349,-2998.5088418697255,-2998.509252689159,-2998.50948846699,-2998.5096852551765,-2998.509775886387,-2998.509863205669,-2998.5105077702146,-2998.5110784033845,-2998.5115971321366,-2998.512570699193,-2998.512836529717,-2998.513252571134,-2998.5141508925567,-2998.514418422854,-2998.5146340312103,-2998.515020633255,-2998.515313660152,-2998.515063215205,-2998.5155622826614,-2998.5162267888777,-2998.516532660453,-2998.516662561684,-2998.5172556248517,-2998.5176555797543,-2998.5179212876146,-2998.518256756273,-2998.518440314265,-2998.5186767755104,-2998.5189124832477,-2998.5191129688787,-2998.519428127875,-2998.5195597288794,-2998.519782626985,-2998.5200317927215,-2998.5202843580046,-2998.5209067729274,-2998.520930482136,-2998.521264846818,-2998.521749510011,-2998.5221713516853,-2998.5223773046287,-2998.5227356588944,-2998.523184469137,-2998.5233167535553,-2998.5239217326593,-2998.5240043731833,-2998.5244060103364,-2998.524707115537,-2998.525169103403,-2998.5252587007317,-2998.525544981105,-2998.5258707067333,-2998.5262141836024,-2998.5262221918124,-2998.5265566966823,-2998.526763525797,-2998.5268861723257,-2998.527196074291
];

<MultiDataGraph datasets={[ { data: dataset1_nomh, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5_nomh, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10_nomh, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15_nomh, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_nomh, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad_nomh = [0.012548499447967446,0.012548499747995129,0.006447894635096536,0.011827982970191728,0.014667928353228122,0.011085796598994628,0.00991642620434231,0.010773445093426565,0.011989567564966962,0.013435945535597496,0.014008115378979462,0.014367577532485283,0.015028836046843436,0.016454341702259713,0.017895753095467582,0.019271841762101404,0.020484743108924425,0.02175400536804643,0.0199990000805025,0.019244070536025847,0.016937199248836375,0.014878318109697876,0.016247186713883616,0.02204486040895772,0.020340640218461943,0.013250505257271249,0.011795763316328086,0.011757209923342452,0.012707404267905136,0.013447815922545708,0.012868957857466461,0.010773282283848988,0.010101274654563024,0.010047732737274915,0.010233597101460956,0.010452657153582862,0.01033554061261897,0.009936135566581083,0.009872361067789064,0.010029722704372402,0.010097676620091912,0.009980507032784972,0.010128715073807646,0.01025053507334768,0.010281137884784379,0.01026505967728607,0.010098605259437154,0.010053986743664707,0.010096567478365657,0.010065538051520214,0.010017029534597759,0.010045874683964938,0.010132828199646112,0.010236749950508862,0.01032789786180515,0.010382938688614887,0.010384067525614328,0.01034783458801225,0.010242038652351286,0.010217400223347125,0.010007107364119854,0.010022852178003971,0.01004423614586817,0.010082593430885007,0.010151046812465208,0.010130062793961817,0.010174126303971395,0.010436010561451383,0.010384666245087324,0.010353733604399973,0.01031095512436487,0.010237534443696973,0.010225276440008181,0.010217009033281649,0.010238749467995559,0.010250036896358786,0.010211377323429874,0.010176358779389194,0.010171501431150025,0.010167941222894031,0.010068029539000808,0.009991135905083165,0.009961961332616294,0.009988002613433883,0.010098610457952356,0.010206005539047996,0.01022020498385496,0.01036103989498002,0.010365414513130793,0.01044780808347464,0.010592662858018012,0.010360063069704967,0.010224511296912412,0.010358402099227667,0.010190986813358924,0.010033125540563891,0.010153063837440439,0.01013446606932031,0.010120339737484016,0.010030677012676787,0.010078821697428972,0.01012614207873857,0.010017737836662561,0.010077365608778345,0.01000798610940792,0.00998671232158994,0.009988750460834455,0.010024048665789737,0.010050505145743191,0.010086301106969854,0.010126909833682848,0.010155937855945995,0.010163765280689472,0.0101210191943187,0.01017354292635784,0.010050337270619016,0.010114868500260131,0.010183700854354848,0.010287267886578655,0.010334036670549296,0.010315698844941166,0.010271246219548464,0.01002609563332114,0.009938445424746662,0.010087659485418442,0.010227907958503356,0.010208678703929844,0.010102329124548825,0.010116469063966533,0.010096353832200403,0.010058208481089645,0.010059574820163276,0.010072389016507075,0.010069994431133612,0.010095889877469438,0.010082179303545331,0.010032208603582532
];

export const dataset1_grad_itr5_nomh = [0.0046596120197846,0.010668399469668565,0.005955117930933609,0.008073316076971397,0.009975894640022777,0.00951969711937095,0.009201907066928349,0.009679429413593761,0.010643664017784209,0.012080185145925454,0.012955343299641691,0.01335832715937473,0.013753373403051727,0.014785056754715406,0.016217710111004598,0.017479233375900235,0.01845784067047438,0.019502735866405094,0.01698295799134309,0.015432396106061669,0.01436720827464944,0.012923671838377924,0.013390098804964183,0.01765946918882962,0.016109619320787156,0.010537536061532496,0.007510599532175122,0.0073533328442068,0.007405614843216921,0.007707581623513102,0.005666379671070454,0.004329821969923162,0.0045667039272589156,0.00673753635603575,0.007943748328446996,0.003047940015996039,0.003200604872111764,0.004255526783525918,0.0052326509462830365,0.007347841153599051,0.0052677523681983075,0.0030232245593987666,0.0027874446189934147,0.004907763061013751,0.00434838694209877,0.003436066202427329,0.002124340804060129,0.001979850625227121,0.003152865759695496,0.002400094417098857,0.0024572738141110852,0.002736226912254264,0.002439453342152754,0.002505268931781048,0.002450176179344446,0.002373668728666709,0.0021548811104934442,0.0018761957607542248,0.0019273507216333442,0.0022989656772884914,0.0027190395783077883,0.002775795117259843,0.002535102637589154,0.0026107880760206843,0.0027554797163548855,0.0026879161944429425,0.0028553005705181686,0.003870526850640929,0.002367007149188218,0.0020221543355334643,0.0018536347266612785,0.0018473413279521264,0.0019527937877716398,0.0021287084643299608,0.0024108386534259195,0.002398746823444664,0.0023896631006643273,0.0023705725221195586,0.002257908702863271,0.0022668277680151904,0.002320615485922315,0.0024515842503883105,0.004453546048653664,0.004752863664843168,0.005497518015965269,0.0036319013342685706,0.0029651656440958254,0.005304499201999758,0.005420072750428497,0.004842893536568751,0.005674676777984732,0.002572006574759071,0.002859140063906781,0.002878911620645182,0.0026245700398728573,0.003045595679154617,0.004779391057988469,0.0034039670004025226,0.002538762575510415,0.004241461633496294,0.00520414960614592,0.0025129244428883863,0.002442729207870269,0.0037429450619813477,0.002399566840752937,0.0023267653055217548,0.002192030391448283,0.0022571578480152336,0.0027138736621980576,0.0027306685113987015,0.003167550511393909,0.003729778471252383,0.004491295113838176,0.0047209676190541235,0.003958832850537106,0.0034823941201597743,0.00313478492111041,0.0027295709643302564,0.0038357026255100833,0.005677638055065616,0.0037366817017486275,0.002974005304235153,0.005199037239478855,0.00482329684314167,0.005661523224208156,0.004219922367493818,0.002732925258258151,0.003174481267916259,0.00439438017242935,0.0038163124246829933,0.0025067248874520048,0.0023232367179448696,0.003303895921929157,0.0025717970169462736,0.0026283268244525174,0.004718315407931739,0.0017576828674795383
];

export const dataset1_grad_itr10_nomh = [0.003068144788437646,0.008368710479882881,0.0056756981273035694,0.006980555743604899,0.008585892722748638,0.008843712723291906,0.00900357624974779,0.009444356646103439,0.009844431572247087,0.010976391087044892,0.011802790849690017,0.01296833082927193,0.013421924650475698,0.014363588611897246,0.015602156160455528,0.016648203636728934,0.017277242268040238,0.01820639209995409,0.015289767102324901,0.013389323097714274,0.012220120591696507,0.011934057540832852,0.012315319507049593,0.014187570660838856,0.00939261111327693,0.008016031848006413,0.006928481847810354,0.007001697176561088,0.0063143448513454156,0.006215953025179334,0.004247678180519385,0.003614006191610871,0.0034841849820011037,0.0039859893526169145,0.004483022388906559,0.00250018202793641,0.0022003521575029846,0.0022832464779871837,0.002847947390382098,0.00499198450628417,0.002639729700611138,0.00214883861562876,0.0016842090498185255,0.0036039477275256722,0.003213627577542456,0.0026489827123079867,0.0014368584196871228,0.001381549663625836,0.0022956787405260743,0.0018272244562281153,0.0017853308042692687,0.001920489588712577,0.0016421994634371639,0.0016660566660868011,0.001795603140806698,0.0018303800786246779,0.0017089946376357672,0.0013741107213326824,0.0014903612535881526,0.0018567274880513611,0.002251003787727668,0.002189025736416162,0.0019788789265267723,0.002033754582401125,0.0022582537445029697,0.0022499802133072646,0.002487871902378669,0.003460995188996621,0.0019323405782249964,0.0015692772261847454,0.0014032847677841703,0.0013487406984226192,0.0013054470149379447,0.0014325641507737066,0.0016244802489102088,0.0017060954507621348,0.0017794897092388011,0.0017953452817329068,0.001713419626553042,0.0018049925703310901,0.0018603586811598472,0.0016866248973071614,0.003331591045633433,0.003645886741693719,0.004309219069486121,0.002705836605583914,0.0017116751302907812,0.0036225600187618718,0.0028084317912313176,0.003416284686992459,0.004052219679086643,0.001580456106746173,0.002053534726840558,0.0022956191558785935,0.002042246007019154,0.00228377650658011,0.0038527789200999887,0.002653956704435345,0.0015878286191183446,0.003003832606067108,0.0039565780747742646,0.0017343935822688443,0.0014923271810080364,0.002140858158673471,0.0013517059797804813,0.0015291495249517822,0.0016890734680058978,0.0018377800827715951,0.0019878455530252764,0.0021691514338304896,0.002311083316351529,0.002156549913241214,0.002557138491114525,0.002058473860171262,0.002578917371090008,0.001655435534475907,0.0015538400738000246,0.0017799327288551075,0.0022812664143573766,0.00347247410842051,0.0022869770073107904,0.0015326131535426755,0.002504098390016504,0.00304879264456741,0.004305542263361015,0.002892415949606357,0.0020934898583466416,0.0020278489619440627,0.0035889771118327507,0.00280131600220588,0.0015998603113588224,0.0013670318536191995,0.001689966530668014,0.0013874084465696698,0.0013858207868961904,0.0025519354067404473,0.0008981147060149163
];

export const dataset1_grad_itr15_nomh = [0.002496023220252813,0.005820032326035837,0.005190562569632,0.005720511919894243,0.0081994972130738,0.008472865127200203,0.00874017757161307,0.009342060711562503,0.009564235548565983,0.010293334289894289,0.011219891708017326,0.012662196805907057,0.01323348775778299,0.014160047786069658,0.015288763624632449,0.016143415845939108,0.0165467688418536,0.01745807269265459,0.014690667567234687,0.012772382409868556,0.011502548376343319,0.010608286848525,0.011017083024498242,0.012330464928340943,0.0075968278141878565,0.0068350456303028755,0.006448110455755155,0.006231789083455491,0.006123190646060483,0.004902367078451643,0.0035730104023771127,0.003489866600763776,0.0030128552509593996,0.0036466784432300876,0.002726400629145328,0.0016327648065303443,0.0018855436709286097,0.002050926247174438,0.001830435572905981,0.0034366724906976687,0.0019028614493573608,0.001911995678995297,0.0013148696627194412,0.002623086889570041,0.0025673881194706563,0.0021226043074007027,0.0011399244560334845,0.001112017046418699,0.0011662688805313456,0.0012782991136213952,0.0015352124863865211,0.0014419577195102348,0.0013514214652120503,0.0013362812074184207,0.001459105998187781,0.0014817630249729116,0.0014844001167577127,0.0011958948444475389,0.0013819362470743012,0.0017476817652532246,0.001982944166638851,0.0019554050861726163,0.0017791426865697573,0.0016874848578736668,0.001901014849535064,0.001896911460547129,0.002110409020951202,0.0029168286647736066,0.0016703013575438228,0.0013314152091339758,0.0011720013871439044,0.0011187644692883946,0.0010630658963596577,0.0011705486371383208,0.0013140703373494054,0.0014432549514409132,0.0015206197990854492,0.0015582103176383446,0.001490439215805888,0.0015947625170819855,0.001519523953740481,0.0013459368141891755,0.0024248683254796555,0.002936890718332679,0.0035801083967330685,0.0021971022995214843,0.0016423941175507393,0.002824529090845671,0.0017379986752548628,0.0028084816693671323,0.0032597364748933,0.0012429592633446682,0.0015994030742546446,0.0018709554766484422,0.0018037689494773718,0.0017637123079412465,0.003099840110450315,0.002168001638164117,0.0012923951219811535,0.0022661227477988218,0.003125767917589577,0.0013173580248235324,0.0011710354734072212,0.0016740470303758528,0.0010578082704228466,0.0013016425094050591,0.001409060944980032,0.0015823543478452298,0.0016802348588938567,0.0017928540918789044,0.0019188979092026348,0.0016934717412456762,0.0019871754660039983,0.0018245482108603798,0.0016704306853569941,0.0014303034550667316,0.0013150588063490607,0.0014552544452011817,0.00163960294358235,0.0029831202893181954,0.001802456809894609,0.0012225696367401202,0.0017069376237120884,0.0016389042883870177,0.0027384230906087204,0.0024678770165261947,0.0020268141806253793,0.001220022860662636,0.002840186929642958,0.002241639694412277,0.0013156851231755726,0.001057986481109112,0.0012708786091571945,0.0010836317880365022,0.0009986722410629384,0.00166630764257252,0.0005512550083990937
];

export const dataset2_grad_nomh = [0.002155748062589685,0.00471737052159946,0.004542247256999281,0.004307840333812318,0.006945629867752967,0.008087326548678095,0.007688121696421084,0.009288627934263032,0.008804385715809307,0.009504678369333464,0.009996708141725664,0.01189048929706489,0.012761324798461031,0.012350160479597005,0.011121797425892628,0.012184443924197711,0.012694461321818108,0.012370609706112937,0.011723124479177826,0.010828503633009159,0.01054869935146981,0.009854817964586217,0.010306371372262799,0.01077159227465944,0.006983252585395553,0.005982857203985969,0.005338269973034395,0.0052690363315907865,0.005767935636567943,0.003176186241426302,0.00401424383759287,0.002973067953595275,0.002657182802422083,0.0032461959445378866,0.0025388789036998047,0.0015436354704108036,0.0015634282737659988,0.0015916013996953356,0.001595164409808123,0.002393627755752591,0.0013470839352920138,0.0012044241827905407,0.0010677027038701423,0.002097642489850677,0.0018749702156094837,0.001231356716134049,0.0009537673540697042,0.0008823001373113498,0.0009164552965019828,0.000906226413285373,0.0013285405072866671,0.0012116587844293542,0.001232421562315939,0.0011552765611802956,0.0012917356962959107,0.0013204268976565535,0.001269034480915536,0.0011662539964631415,0.0014004325036359442,0.001670549625321467,0.0016986983656212395,0.0017390028687639225,0.0016757589869270913,0.0013998154827773088,0.0015241965031677928,0.0016621763696902181,0.0018928299574336722,0.0024055093514375623,0.0014815208383262156,0.0010895119765706046,0.0010327512459999124,0.0009647363094249445,0.0009607355160963304,0.0010543280711615554,0.0011743973178346971,0.0013466177337875833,0.0014459561571076272,0.0014593741257341985,0.0013864533434686536,0.0014640015374942307,0.0013082355651206224,0.0012126310810583144,0.001737623391565345,0.0025162124933300264,0.002843772996904853,0.0017797233615957431,0.0015235860573302486,0.0021223469621786117,0.001289225302004427,0.0021386801516656514,0.0025561443743133405,0.0011124563396685844,0.0014169532830658786,0.0016899051366257797,0.0015268841212432742,0.0013309281956743332,0.0023635618329242896,0.0018639134767447201,0.0011694370231992008,0.00210456588663343,0.0024930353574675332,0.001100350004700092,0.0010667880602042126,0.0013735375917857402,0.0008963665575720368,0.001277036197417775,0.001271987053793271,0.001349929101093163,0.0014799710633985903,0.0014739306366232518,0.0015720261847921597,0.0015043014089348738,0.0015338022115555267,0.001636420377173676,0.001218557803548482,0.001351180302030165,0.0012379594507829351,0.0012159618482774819,0.0014095699634308347,0.0023253280573236937,0.0014326141469260599,0.0011544602904939624,0.0016592045096883634,0.0012594212638923417,0.0014976506272825474,0.001791072100217517,0.0019454552895473418,0.0010819688992595427,0.002304300767141783,0.001728954276372431,0.0011844423092904582,0.0009960306623856999,0.0011711579770830533,0.0008964050215826534,0.0008604147661377043,0.0014976308129848997,0.00034466460176369113
];

<MultiDataGraph datasets={[ { data: dataset1_grad_nomh, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5_nomh, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10_nomh, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15_nomh, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad_nomh, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

緩和後の経路のエネルギー極大値を示すノードの分子構造
`sn2_Br_beta_methyl_diketone_traj_11.xyz`
```
22
-1 1
C      -0.104230152921      0.150644294366     -0.245805933863
C       1.328840106539     -0.404637275282      0.172942209285
C      -0.827841743557      0.567965653753      1.036837164805
C       1.820160287741     -1.805571461643      0.762206363449
H       1.879076054623     -1.665195976342      1.843382642270
C       0.111666222868      2.085206136596     -1.708991137387
Br      0.683937371720      3.493035789875     -3.684019256772
H       1.229921053055     -2.707103102485      0.591174225332
H       2.868152243632     -1.995475937583      0.476810925612
C      -1.365604431399     -0.299943242256      2.228543097324
H      -2.358589650531     -0.705566640594      2.006572296790
H      -0.760582987407     -1.133619662201      2.579964173568
H      -1.532374803954      0.359071344106      3.091434624051
O       2.257176111139      0.377808129539      0.110750859026
O      -1.079924664047      1.747699791790      1.150708944283
H       0.655615986599      1.287574262440     -2.163361091489
H       0.596997121850      2.891327982067     -1.158230107212
H      -0.901247023231      2.362752994981     -2.004481539128
C      -0.947547124500     -1.011540483455     -1.014016943372
H      -1.579719868790     -1.905610543240     -0.747942811510
H      -1.652208305661     -0.323734961214     -1.491067645398
H      -0.321671803767     -1.365087093218     -1.833411059664

```

