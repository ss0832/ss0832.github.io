---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(Co錯体触媒が関わる酸化的環化反応(配位子:Tris(3,5-ditrifluoromethylphenyl)arsine), NNP使用）
published: 2025-09-14
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-09-14

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(3,5-ditrifluoromethylphenyl)arsine)の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

酸化的環化について
- https://www.sciencedirect.com/topics/chemistry/oxidative-cyclization

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.15.3
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.15.3.zip
unzip v1.15.3.zip
cd MultiOptPy-v1.15.3
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.15.3`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.15.3`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3.xyz`とした。
初期構造は以下のものを使用した。

```
71
OptimizedStructure
Co     3.057905516279     -0.335779804937     -0.243592976252
C      4.307994026864      0.338105201042     -1.724887138049
C      3.480176346962      1.463176141235     -1.516613676331
C      3.524381077628     -0.620134418954     -2.404621991029
H      5.332452431173      0.230776539061     -1.405756704283
C      2.294074366864      1.295514211779     -2.316972970427
H      3.789310601832      2.384127613650     -1.045240872588
C      2.323102004980      0.032819422974     -2.858142753357
H      3.850952851944     -1.601039778398     -2.709750986185
H      1.513062481593      2.033323262511     -2.421147076279
H      1.554151512115     -0.431678620530     -3.456408113646
As     0.610865267605     -0.232374667135     -0.122771947804
C      2.867890402339      0.304124948239      1.717892150905
H      2.105941081460      0.157625282984      2.456956789790
C      3.964915078437      0.662028196696      1.282123656932
H      4.924659934430      1.135051551815      1.274901990251
C      3.221994214573     -2.270084271339      0.432244803532
H      2.526495984421     -2.998616450988      0.789896090577
C      4.343225413633     -1.861953580470      0.119758260032
H      5.401447009305     -1.859375776154     -0.036638188278
C     -0.744909978817     -0.610109340044     -1.497852180208
C     -1.379081080569     -1.837242839690     -1.625380160328
C     -1.045721958343      0.392514591899     -2.417489562591
C     -2.295987430689     -2.053933922532     -2.647484236505
H     -1.185530248161     -2.645116714933     -0.933866688045
C     -1.961599121762      0.169618553972     -3.430420526638
H     -0.570365194409      1.361652952379     -2.346914728388
C     -2.597713132252     -1.056730324394     -3.555681603254
H     -3.310710980904     -1.229797428527     -4.348946957224
C     -0.072109530442      1.537244111237      0.352199608602
C     -1.438205310332      1.776182913344      0.476199382701
C      0.823515129479      2.577819371586      0.553601093495
C     -1.894708257911      3.041048342737      0.805859080365
H     -2.154079062664      0.978548723364      0.319783229494
C      0.355122574090      3.844946298553      0.873797297291
H      1.885695704357      2.399407983394      0.458696453178
C     -1.001759210956      4.084881244533      1.003490953059
H     -1.363938071146      5.073441052714      1.255000541984
C     -0.142331352997     -1.257123170222      1.371394360265
C     -0.650581359495     -0.657037673918      2.514085306111
C     -0.059695805176     -2.649296931801      1.334149998376
C     -1.084178928055     -1.431229429317      3.584897910419
H     -0.711180824890      0.421110410126      2.594268705791
C     -0.509050669719     -3.413242418289      2.396226438026
H      0.371098342636     -3.151223723316      0.476472158057
C     -1.028215086771     -2.809959589132      3.534272634139
H     -1.368378064782     -3.407205549839      4.368101462525
C     -2.309083936833      1.293825190232     -4.369512856273
C     -2.993197226937     -3.386180802734     -2.716413740672
C     -0.468150068590     -4.915727859312      2.309423214463
C     -1.628367567892     -0.719656283654      4.794749327299
C     -3.370298119600      3.315202122123      0.924929021498
C      1.320706488276      4.974689278797      1.112166647763
F     -1.893309378915     -1.558970234616      5.803810630025
F     -0.757847591211      0.199802803853      5.249649274391
F     -2.766333788167     -0.065328433209      4.503079302731
F     -0.216571413705     -5.476404817464      3.501630029278
F      0.476381355377     -5.340433806546      1.454130882640
F     -1.642183046995     -5.410363604109      1.879350677409
F     -3.587538691159     -3.587032775720     -3.900438924187
F     -3.944725769060     -3.485470470066     -1.769664497242
F     -2.136087715564     -4.401494952516     -2.514718681960
F     -2.705463422516      0.841204019086     -5.568339692687
F     -3.312606360155      2.044072911137     -3.877791260009
F     -1.266421032444      2.115063511608     -4.569357315726
F     -3.821751216111      4.026438628956     -0.122941758028
F     -4.089380919930      2.185239684672      0.979597349131
F     -3.649338465286      4.026814390515      2.029822395419
F      0.934281504615      6.095346400505      0.479284535395
F      1.409155814689      5.276503159647      2.420203748053
F      2.557731874358      4.678059441852      0.687663373086

```

<MoleculeViewer 
  xyzData={`71
OptimizedStructure
Co     3.057905516279     -0.335779804937     -0.243592976252
C      4.307994026864      0.338105201042     -1.724887138049
C      3.480176346962      1.463176141235     -1.516613676331
C      3.524381077628     -0.620134418954     -2.404621991029
H      5.332452431173      0.230776539061     -1.405756704283
C      2.294074366864      1.295514211779     -2.316972970427
H      3.789310601832      2.384127613650     -1.045240872588
C      2.323102004980      0.032819422974     -2.858142753357
H      3.850952851944     -1.601039778398     -2.709750986185
H      1.513062481593      2.033323262511     -2.421147076279
H      1.554151512115     -0.431678620530     -3.456408113646
As     0.610865267605     -0.232374667135     -0.122771947804
C      2.867890402339      0.304124948239      1.717892150905
H      2.105941081460      0.157625282984      2.456956789790
C      3.964915078437      0.662028196696      1.282123656932
H      4.924659934430      1.135051551815      1.274901990251
C      3.221994214573     -2.270084271339      0.432244803532
H      2.526495984421     -2.998616450988      0.789896090577
C      4.343225413633     -1.861953580470      0.119758260032
H      5.401447009305     -1.859375776154     -0.036638188278
C     -0.744909978817     -0.610109340044     -1.497852180208
C     -1.379081080569     -1.837242839690     -1.625380160328
C     -1.045721958343      0.392514591899     -2.417489562591
C     -2.295987430689     -2.053933922532     -2.647484236505
H     -1.185530248161     -2.645116714933     -0.933866688045
C     -1.961599121762      0.169618553972     -3.430420526638
H     -0.570365194409      1.361652952379     -2.346914728388
C     -2.597713132252     -1.056730324394     -3.555681603254
H     -3.310710980904     -1.229797428527     -4.348946957224
C     -0.072109530442      1.537244111237      0.352199608602
C     -1.438205310332      1.776182913344      0.476199382701
C      0.823515129479      2.577819371586      0.553601093495
C     -1.894708257911      3.041048342737      0.805859080365
H     -2.154079062664      0.978548723364      0.319783229494
C      0.355122574090      3.844946298553      0.873797297291
H      1.885695704357      2.399407983394      0.458696453178
C     -1.001759210956      4.084881244533      1.003490953059
H     -1.363938071146      5.073441052714      1.255000541984
C     -0.142331352997     -1.257123170222      1.371394360265
C     -0.650581359495     -0.657037673918      2.514085306111
C     -0.059695805176     -2.649296931801      1.334149998376
C     -1.084178928055     -1.431229429317      3.584897910419
H     -0.711180824890      0.421110410126      2.594268705791
C     -0.509050669719     -3.413242418289      2.396226438026
H      0.371098342636     -3.151223723316      0.476472158057
C     -1.028215086771     -2.809959589132      3.534272634139
H     -1.368378064782     -3.407205549839      4.368101462525
C     -2.309083936833      1.293825190232     -4.369512856273
C     -2.993197226937     -3.386180802734     -2.716413740672
C     -0.468150068590     -4.915727859312      2.309423214463
C     -1.628367567892     -0.719656283654      4.794749327299
C     -3.370298119600      3.315202122123      0.924929021498
C      1.320706488276      4.974689278797      1.112166647763
F     -1.893309378915     -1.558970234616      5.803810630025
F     -0.757847591211      0.199802803853      5.249649274391
F     -2.766333788167     -0.065328433209      4.503079302731
F     -0.216571413705     -5.476404817464      3.501630029278
F      0.476381355377     -5.340433806546      1.454130882640
F     -1.642183046995     -5.410363604109      1.879350677409
F     -3.587538691159     -3.587032775720     -3.900438924187
F     -3.944725769060     -3.485470470066     -1.769664497242
F     -2.136087715564     -4.401494952516     -2.514718681960
F     -2.705463422516      0.841204019086     -5.568339692687
F     -3.312606360155      2.044072911137     -3.877791260009
F     -1.266421032444      2.115063511608     -4.569357315726
F     -3.821751216111      4.026438628956     -0.122941758028
F     -4.089380919930      2.185239684672      0.979597349131
F     -3.649338465286      4.026814390515      2.029822395419
F      0.934281504615      6.095346400505      0.479284535395
F      1.409155814689      5.276503159647      2.420203748053
F      2.557731874358      4.678059441852      0.687663373086
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3.xyz`として保存し、以下を実行する。
```
python optmain.py .\co_cat_oxidative_cyclization_As_mmdiCF3Ph_3.xyz -os uma-s-1p1 -opt rsirfo_fsb -ma 100 1 13 100 1 17 200 15 19
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）今回はUMAモデルのNNPを使用し、ラジカル反応を扱うためスピンだ重度を2とした。
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。


これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.15.3`ディレクトリに置く。

`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj.xyz`は次のNEB計算に使用する。

※`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）



```
python .\nebmain.py co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj.xyz -os uma-s-1p1 -ns 15 -modelhess -spng -nd 0.3 -aneb 3 5
```

- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `-aneb A B`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.15.3`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-6684.378092490488,-6684.352517175849,-6684.353610436736,-6684.3402840169965,-6684.329097340217,-6684.331340935821,-6684.30184118198,-6684.3375507114515,-6684.346389668371,-6684.363929015639,-6684.386990917567,-6684.414981075587,-6684.427518279197,-6684.44540103324,-6684.453100620733,-6684.454974927446,-6684.4560557905015,-6684.456290446832,-6684.4563829355275,-6684.4565872237445,-6684.456733632052,-6684.45692115034,-6684.456979485859,-6684.457128680393,-6684.457202559199,-6684.457332267672,-6684.457432098687,-6684.457449516983,-6684.457576964933];

export const dataset1_itr5 = [-6684.378042487363,-6684.37066878321,-6684.363385885502,-6684.3498740634295,-6684.335398255238,-6684.341375109358,-6684.337461035268,-6684.346550735032,-6684.354046884194,-6684.380793097302,-6684.407514909024,-6684.4295342804135,-6684.443590476787,-6684.454334743759,-6684.459112175636,-6684.459862511641,-6684.4610213715105,-6684.461538435536,-6684.462292328799,-6684.462053011234,-6684.462469543308,-6684.462636226231,-6684.462610028693,-6684.462716553661,-6684.462746220838,-6684.462886145475,-6684.463031695134,-6684.463590832929,-6684.463830588581];

export const dataset1_itr10 = [-6684.378060299936,-6684.375534901196,-6684.371346309339,-6684.360182487501,-6684.355196947298,-6684.349761834584,-6684.345042913459,-6684.34159294319,-6684.338973973684,-6684.3399546508745,-6684.343569214397,-6684.347434275436,-6684.350887119549,-6684.352980565591,-6684.353590100788,-6684.352680047426,-6684.351877307585,-6684.352484345693,-6684.352130223336,-6684.352141622331,-6684.358691795087,-6684.4005911015665,-6684.4258065374,-6684.440812188582,-6684.451821900561,-6684.458291675793,-6684.461552857324,-6684.461573570025,-6684.462275173355,-6684.46264917605,-6684.46320338976,-6684.463115790103,-6684.463188074276,-6684.4631802413005,-6684.463121572837,-6684.463317081812,-6684.463327718538,-6684.463381129971,-6684.463422099764,-6684.463705313537,-6684.463535686677,-6684.46360863674,-6684.463622024646,-6684.463572135423,-6684.463805424926,-6684.46379070524,-6684.463838772025,-6684.46387949649,-6684.464015933963,-6684.46410980701,-6684.46427657755,-6684.464412804741,-6684.464851907001];


export const dataset2 = [-6684.37800131605,-6684.376929424994,-6684.375219365446,-6684.368371338088,-6684.364379122616,-6684.358393590014,-6684.351864252625,-6684.345534638596,-6684.344455746927,-6684.343610197333,-6684.343013857283,-6684.342651919474,-6684.342585689647,-6684.342792163913,-6684.343232913375,-6684.343891404672,-6684.349005120047,-6684.351514423511,-6684.3547724508235,-6684.356791571211,-6684.3586226738935,-6684.3594376100455,-6684.357450627639,-6684.357119566124,-6684.356907970635,-6684.356705785231,-6684.356595948334,-6684.3564459827685,-6684.357120345918,-6684.3565876509865,-6684.356106010587,-6684.355497588128,-6684.355293045821,-6684.355769928608,-6684.355912595663,-6684.357883386414,-6684.359695239602,-6684.36119804071,-6684.362462488042,-6684.419878166246,-6684.438800743458,-6684.44923493323,-6684.456916892145,-6684.460480423041,-6684.462473223229,-6684.46252458442,-6684.462889124458,-6684.463177472598,-6684.4633922923995,-6684.463387613642,-6684.4633713694175,-6684.4633540387385,-6684.463331100561,-6684.463414196694,-6684.463451188668,-6684.463490861727,-6684.463533601387,-6684.463524103685,-6684.463529903943,-6684.463452467879,-6684.463440481849,-6684.463417263296,-6684.463548408691,-6684.4636171005595,-6684.463686388226,-6684.463753450415,-6684.463753029853,-6684.463680675585,-6684.463656002587,-6684.463639215136,-6684.463679729321,-6684.463696481725,-6684.463717667559,-6684.463738625588,-6684.463790547529,-6684.463989491098,-6684.463985302997,-6684.463959298218,-6684.463933661431,-6684.463890658919,-6684.463940916134,-6684.463963679077,-6684.463990963067,-6684.464020174634,-6684.464037172367,-6684.464026991252,-6684.463958597281,-6684.463952726929,-6684.463936745556,-6684.464063825513,-6684.4641138374,-6684.4641639894735,-6684.464215858844,-6684.464184088854,-6684.464158802537,-6684.464137073476,-6684.464095910925,-6684.464144240561,-6684.464162061896,-6684.464185315495,-6684.464206623993,-6684.464224024766,-6684.464405479945,-6684.4644819872665,-6684.464646059198,-6684.4646834191635,-6684.465071458129];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [6.707066469130733e-05,0.011791050263418265,0.005545515512669623,0.005386136703506648,0.0046845727895594115,0.007414336187084736,0.021524794433391985,0.006561429619867553,0.0061198117650120044,0.007460233705750792,0.008137071736304227,0.006288693757829558,0.00836965914320761,0.005799165617984062,0.005864684387659663,0.00558341667383345,0.005586360972737566,0.00547621499947979,0.005511066518306224,0.005496734872810342,0.005506319231851075,0.005535240279326393,0.005523450366240885,0.00554145827458865,0.005518611343486682,0.0055212552102761,0.005524030431984059,0.005523196662173649,0.005525714122485308];

export const dataset1_grad_itr5 = [0.0004002737964454429,0.0036425592841112906,0.0039296797473849015,0.004529775728045162,0.003363733909861864,0.0040376144244816045,0.008669600740256885,0.004256657962348271,0.003206720814754719,0.0070943567900081115,0.006107621871473548,0.003955911786519485,0.003373837827752332,0.002639039345392339,0.0023788341338131297,0.002523355235272762,0.0021239900923909617,0.001972174672326599,0.0014580698935726284,0.0018661148467573568,0.001815949209090869,0.001843440141507088,0.0020237851617376404,0.0020320327214695525,0.0020818958329355576,0.0020017039120336076,0.001946923984133591,0.001245928423142569,0.001368035943873836];

export const dataset1_grad_itr10 = [0.0004696236839124445,0.001762322886597445,0.0024990169075575506,0.0036765607758483974,0.0038730550178903123,0.0037298319671004595,0.003370263901534585,0.0027499644265222864,0.00228170096004669,0.00272998260212357,0.003377932941573135,0.003327268096296676,0.002726182307574272,0.0022759109605998947,0.0028647872293758895,0.004049143602963753,0.0038635818008478555,0.0033397922051332436,0.003105446738342774,0.003069075818631783,0.0028349802593253723,0.007420397647492709,0.004933779231996348,0.003012528296967821,0.0022530701161033156,0.0015631658422309298,0.0010728149038091114,0.0016902030929158238,0.0013202904349305907,0.0012929452809671538,0.0009849702187785818,0.0010231143889328721,0.0010297244894817389,0.001082179747186029,0.0011453663436210234,0.0011042301262412246,0.0011723779144024436,0.0011793499996961337,0.0011964308387806915,0.001119835973261553,0.0013285497519712642,0.0013039527865419918,0.0013399783461929267,0.0013790810968511659,0.0010824864666709156,0.0011901636356468665,0.001173447760278914,0.0011636333317524606,0.0011261207574643423,0.0010799792746628205,0.0010037799429350254,0.0007196892144076493,0.000504391726605913];


export const dataset2_grad = [0.0005177493480567767,0.0010783461326416429,0.0015448596457557976,0.0026915794436611204,0.0030997585879728546,0.0033418370065613342,0.003007026837684231,0.0024260635573148804,0.0022422787508849743,0.0020931690224663692,0.0020121347947664675,0.0020403542543497226,0.002127732861167295,0.0022867998819066106,0.0024959498301744746,0.0027288112448477226,0.0031758677282741838,0.0030089356814290116,0.0023902093239184124,0.0022319091031702564,0.003010915341786532,0.00357852166107333,0.0033422837418157635,0.003296485738697493,0.00325019300778013,0.003234806163414199,0.0031028720705804642,0.002981063941788307,0.002904539060959463,0.0027406064229129135,0.00258352798417501,0.002606158202508273,0.0025922163499583215,0.0025779590602882803,0.0025762259646974774,0.002324708976653519,0.002430613936964528,0.0026476575397654,0.0029536343684719913,0.006896518954413604,0.004050201276998174,0.002352877629380917,0.001636385090083495,0.001039024492464405,0.0006603296335094318,0.0011537339650381018,0.0010145169818264257,0.0009867016221463438,0.0009085562998590421,0.0008312751580919646,0.0008226106164777022,0.0008146623686181544,0.0008178115094190842,0.0008414147311429864,0.0008508094552008049,0.0008571373300789715,0.0008251598019152907,0.0008599783668409436,0.000887714821883941,0.0009451877082904195,0.0009429279397999627,0.0009524595177796996,0.0008790003661892877,0.0008500153681146876,0.0008167323781886252,0.0007645707264739332,0.0007604659016779201,0.0008323929738641841,0.000878833057100544,0.0009161747749678012,0.0009278563416882565,0.0009338794200728874,0.0009278547434745545,0.0009197266907543687,0.0009571030392770198,0.000845671749246927,0.0007554460205958519,0.0007700362984726812,0.0007812254645381753,0.0008307361692774965,0.0008558540286318091,0.0008677949063626865,0.0008671560237448265,0.0008429383559800417,0.000844484250252795,0.0008935318115638876,0.000956150795090904,0.0009329173255946379,0.0009164583095981904,0.0007339527337842183,0.0007009801946299349,0.0006670511382300664,0.0006262990707424686,0.0006964889896272937,0.0007568070516600287,0.0008043171150634665,0.0008429983921537745,0.0007832866599994586,0.0007817264848398777,0.0007674436698882825,0.0007609299256433983,0.0008869753296931373,0.0007569291438255375,0.0007296204996368706,0.0006111552431344135,0.00051985161250527,0.00020999109321038757];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、緩和後に得られた経路の12番(グラフ上では13番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj_12.xyz`
```
71
0 1
Co      2.925602410970     -0.363453231044     -0.215546949903
C       4.250727341903      0.346771498784     -1.766192158394
C       3.448179797181      1.481629473587     -1.568461286971
C       3.482053650536     -0.607306009729     -2.460087639909
H       5.249483212458      0.205862300272     -1.384039466591
C       2.261397925286      1.315017007675     -2.372893924357
H       3.768021903794      2.388259914434     -1.075084469837
C       2.283763426819      0.053427794591     -2.909823845212
H       3.813604258543     -1.595538457654     -2.740416138912
H       1.478004102849      2.051183619364     -2.456634553731
H       1.514023016867     -0.414280016636     -3.502001504967
As      0.566942268343     -0.231862325382     -0.132408714192
C       2.898166810811      0.177184095250      1.586072763294
H       2.205356885018      0.416923425371      2.384219675779
C       4.142946155493      0.114251773052      1.239413538151
H       5.063466601828      0.663435956383      1.361935774097
C       3.217104869865     -2.062120865298      0.462058588217
H       2.718199240879     -3.007543729696      0.599300443432
C       4.371790415079     -1.479780812360      0.473035005995
H       5.426942632666     -1.641894601151      0.327360782163
C      -0.756873983837     -0.609302973475     -1.506446924175
C      -1.384596633156     -1.837987340879     -1.629223751235
C      -1.049673558165      0.394891429591     -2.423621384775
C      -2.299022873608     -2.054815032901     -2.651508364324
H      -1.186407464163     -2.641137132637     -0.933384958922
C      -1.964307480083      0.170879284445     -3.435667114779
H      -0.569164995322      1.361081755056     -2.350619989551
C      -2.599422446530     -1.056269596743     -3.558948671724
H      -3.311536574699     -1.230963236704     -4.352558824347
C      -0.079901814907      1.539803807326      0.355135816411
C      -1.444454307284      1.781109627287      0.479147823927
C       0.821466705900      2.575271416165      0.558569321057
C      -1.898864877190      3.046141477103      0.806971855941
H      -2.156411296036      0.980431189733      0.321316502028
C       0.354328431638      3.844055129053      0.875469149641
H       1.884767408234      2.397946228692      0.457630111076
C      -1.002673981337      4.087221900669      1.002568280999
H      -1.362836519638      5.077324305253      1.250730912341
C      -0.157893207549     -1.260413915738      1.370348026634
C      -0.659612126971     -0.659460756171      2.514582803672
C      -0.060329589069     -2.651018865567      1.334196568747
C      -1.085914138526     -1.434063398895      3.587664532939
H      -0.716651652739      0.418750348542      2.592975132098
C      -0.506150749998     -3.415080643763      2.397464340989
H       0.377698690185     -3.149961516936      0.478158895707
C      -1.026338331011     -2.812671425902      3.535371908881
H      -1.362495799120     -3.410646098727      4.370422425579
C      -2.311236853905      1.295669206149     -4.373159478859
C      -2.995695703214     -3.386314990874     -2.716146525633
C      -0.463749350835     -4.916756400645      2.309611124397
C      -1.628471497007     -0.722526910378      4.797072916440
C      -3.374044270377      3.319414988974      0.922710029839
C       1.318731546856      4.975886082453      1.110799206626
F      -1.894729271122     -1.561740482808      5.805389598093
F      -0.756398448057      0.195748150280      5.251788375261
F      -2.765381230450     -0.066018691806      4.505363219018
F      -0.212322851154     -5.478152433345      3.501383589145
F       0.481438285711     -5.339348912013      1.453946583474
F      -1.637018242089     -5.411980486722      1.877743572027
F      -3.589720333111     -3.589430080128     -3.899414573554
F      -3.946355011524     -3.483560677230     -1.768450454415
F      -2.137602522596     -4.400282905716     -2.510849065000
F      -2.707792240611      0.842959041888     -5.571451146005
F      -3.314325025834      2.045625830209     -3.879610523860
F      -1.269498902162      2.116843853686     -4.571946478182
F      -3.823471687093      4.026533189224     -0.128460332043
F      -4.091681522890      2.188677956979      0.979888966096
F      -3.653932563219      4.033604380208      2.025463428414
F       0.925580819736      6.095499352913      0.481003855790
F       1.410712429743      5.274956466273      2.419394467799
F       2.554460682998      4.683411698739      0.681379302148

```


<MoleculeViewer 
  xyzData={`71
0 1
Co      2.925602410970     -0.363453231044     -0.215546949903
C       4.250727341903      0.346771498784     -1.766192158394
C       3.448179797181      1.481629473587     -1.568461286971
C       3.482053650536     -0.607306009729     -2.460087639909
H       5.249483212458      0.205862300272     -1.384039466591
C       2.261397925286      1.315017007675     -2.372893924357
H       3.768021903794      2.388259914434     -1.075084469837
C       2.283763426819      0.053427794591     -2.909823845212
H       3.813604258543     -1.595538457654     -2.740416138912
H       1.478004102849      2.051183619364     -2.456634553731
H       1.514023016867     -0.414280016636     -3.502001504967
As      0.566942268343     -0.231862325382     -0.132408714192
C       2.898166810811      0.177184095250      1.586072763294
H       2.205356885018      0.416923425371      2.384219675779
C       4.142946155493      0.114251773052      1.239413538151
H       5.063466601828      0.663435956383      1.361935774097
C       3.217104869865     -2.062120865298      0.462058588217
H       2.718199240879     -3.007543729696      0.599300443432
C       4.371790415079     -1.479780812360      0.473035005995
H       5.426942632666     -1.641894601151      0.327360782163
C      -0.756873983837     -0.609302973475     -1.506446924175
C      -1.384596633156     -1.837987340879     -1.629223751235
C      -1.049673558165      0.394891429591     -2.423621384775
C      -2.299022873608     -2.054815032901     -2.651508364324
H      -1.186407464163     -2.641137132637     -0.933384958922
C      -1.964307480083      0.170879284445     -3.435667114779
H      -0.569164995322      1.361081755056     -2.350619989551
C      -2.599422446530     -1.056269596743     -3.558948671724
H      -3.311536574699     -1.230963236704     -4.352558824347
C      -0.079901814907      1.539803807326      0.355135816411
C      -1.444454307284      1.781109627287      0.479147823927
C       0.821466705900      2.575271416165      0.558569321057
C      -1.898864877190      3.046141477103      0.806971855941
H      -2.156411296036      0.980431189733      0.321316502028
C       0.354328431638      3.844055129053      0.875469149641
H       1.884767408234      2.397946228692      0.457630111076
C      -1.002673981337      4.087221900669      1.002568280999
H      -1.362836519638      5.077324305253      1.250730912341
C      -0.157893207549     -1.260413915738      1.370348026634
C      -0.659612126971     -0.659460756171      2.514582803672
C      -0.060329589069     -2.651018865567      1.334196568747
C      -1.085914138526     -1.434063398895      3.587664532939
H      -0.716651652739      0.418750348542      2.592975132098
C      -0.506150749998     -3.415080643763      2.397464340989
H       0.377698690185     -3.149961516936      0.478158895707
C      -1.026338331011     -2.812671425902      3.535371908881
H      -1.362495799120     -3.410646098727      4.370422425579
C      -2.311236853905      1.295669206149     -4.373159478859
C      -2.995695703214     -3.386314990874     -2.716146525633
C      -0.463749350835     -4.916756400645      2.309611124397
C      -1.628471497007     -0.722526910378      4.797072916440
C      -3.374044270377      3.319414988974      0.922710029839
C       1.318731546856      4.975886082453      1.110799206626
F      -1.894729271122     -1.561740482808      5.805389598093
F      -0.756398448057      0.195748150280      5.251788375261
F      -2.765381230450     -0.066018691806      4.505363219018
F      -0.212322851154     -5.478152433345      3.501383589145
F       0.481438285711     -5.339348912013      1.453946583474
F      -1.637018242089     -5.411980486722      1.877743572027
F      -3.589720333111     -3.589430080128     -3.899414573554
F      -3.946355011524     -3.483560677230     -1.768450454415
F      -2.137602522596     -4.400282905716     -2.510849065000
F      -2.707792240611      0.842959041888     -5.571451146005
F      -3.314325025834      2.045625830209     -3.879610523860
F      -1.269498902162      2.116843853686     -4.571946478182
F      -3.823471687093      4.026533189224     -0.128460332043
F      -4.091681522890      2.188677956979      0.979888966096
F      -3.653932563219      4.033604380208      2.025463428414
F       0.925580819736      6.095499352913      0.481003855790
F       1.410712429743      5.274956466273      2.419394467799
F       2.554460682998      4.683411698739      0.681379302148
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj_12.xyz`を`MultiOptPy-v1.15.3`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py .\co_cat_oxidative_cyclization_As_mmdiCF3Ph_3_traj_12.xyz -fc 5 -order 1 -opt rsirfo_bofill -freq -tcc -os uma-s-1p1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
71
OptimizedStructure
Co     2.789749035601     -0.675224832421     -0.468734943678
C      4.008612906774     -0.229085199581     -2.103116972346
C      3.471657327981      1.023218217615     -1.739341505579
C      2.974354069941     -0.945504284756     -2.732414138444
H      4.990861907333     -0.599729756255     -1.857886183416
C      2.217904471799      1.187071324098     -2.465079417534
H      4.029112959874      1.820746578413     -1.270646526999
C      1.920654994936     -0.000673668523     -3.061831450382
H      3.043252461450     -1.954343429066     -3.108036355215
H      1.612920580543      2.082531244930     -2.470708096234
H      1.032424796572     -0.234894987890     -3.628335396848
As     0.564956207944     -0.147614416970     -0.084858995331
C      3.257199554132      0.092973817887      1.281119375974
H      2.949136764685      0.884642574081      1.943139479619
C      4.241149651534     -0.656648458140      1.011715800597
H      5.268377417921     -0.892523372452      1.219591667922
C      2.461811040524     -2.527917143034      0.018066641110
H      1.676738241208     -3.259174393556     -0.056318991633
C      3.715886911128     -2.399648265789      0.126382124116
H      4.669754453128     -2.892391175646      0.150481713818
C     -0.805437011462     -0.416647207448     -1.437175133087
C     -1.055386448922     -1.725004730954     -1.850405572378
C     -1.462310068522      0.629800521952     -2.058004518177
C     -1.963633004957     -1.970402879897     -2.860977415844
H     -0.540461105388     -2.555699109157     -1.383158493351
C     -2.374302998469      0.371714065291     -3.077757147506
H     -1.274424401339      1.654967638683     -1.762400864222
C     -2.632240811400     -0.921344286825     -3.484851134111
H     -3.344955973040     -1.117486560870     -4.274200225353
C      0.132255401623      1.662169203906      0.503896461112
C     -1.131113188550      2.000124313033      0.987961290455
C      1.118198738585      2.631712349531      0.450293013200
C     -1.391720649527      3.292784470998      1.399559844779
H     -1.919045154385      1.260882266279      1.046499777616
C      0.847240160678      3.930282527098      0.871576620242
H      2.103232057361      2.378838210179      0.077468232733
C     -0.403137973089      4.270543120292      1.345235629129
H     -0.612602987272      5.280545513189      1.670484905118
C     -0.258751908546     -1.158104916096      1.371826367423
C     -1.622786856486     -1.403009579762      1.435930607454
C      0.565041191018     -1.642213859202      2.385051113203
C     -2.158251904706     -2.110583186550      2.505004754504
H     -2.286636483863     -1.057097774657      0.652097713467
C      0.020156343771     -2.343603697068      3.447393582184
H      1.635473558871     -1.476798298441      2.336699982224
C     -1.345157317371     -2.584679616889      3.517481346285
H     -1.765126210617     -3.132751638506      4.348654600927
C     -3.056712525935      1.542414932598     -3.732553977050
C     -2.248241431490     -3.374396967191     -3.322434744609
C      0.930387641701     -2.899918559682      4.508961248295
C     -3.643818443964     -2.346198485472      2.522737436350
C     -2.751376910901      3.678958233118      1.917245058971
C      1.957488498457      4.942725778591      0.801574169907
F     -4.037378588751     -3.053418072353      1.447614938319
F     -4.042440894772     -3.014873179754      3.612208957604
F     -4.321820691979     -1.184228928070      2.490229943415
F      2.004749996485     -2.121091086264      4.703052923447
F      1.384054938111     -4.121824427146      4.172510424451
F      0.302615566340     -3.025586868659      5.689476302458
F     -1.884321895090     -3.548995521899     -4.605023803977
F     -3.559878654055     -3.656993501802     -3.246951915947
F     -1.595993707479     -4.289874879644     -2.592295073779
F     -4.016484012392      1.160960325286     -4.584827796564
F     -3.622733745775      2.349825116766     -2.818064142842
F     -2.179060275607      2.292377682391     -4.422807807123
F     -3.307622676024      4.638141722280      1.156975914760
F     -3.598498364692      2.641632215647      1.940844839277
F     -2.676051468120      4.167915815692      3.167794548975
F      1.555073680277      6.168054376900      1.162203722564
F      2.979221507201      4.599731071407      1.607496273318
F      2.458211709447      5.029915976212     -0.443340607760

```

<MoleculeViewer 
  xyzData={`71
OptimizedStructure
Co     2.789749035601     -0.675224832421     -0.468734943678
C      4.008612906774     -0.229085199581     -2.103116972346
C      3.471657327981      1.023218217615     -1.739341505579
C      2.974354069941     -0.945504284756     -2.732414138444
H      4.990861907333     -0.599729756255     -1.857886183416
C      2.217904471799      1.187071324098     -2.465079417534
H      4.029112959874      1.820746578413     -1.270646526999
C      1.920654994936     -0.000673668523     -3.061831450382
H      3.043252461450     -1.954343429066     -3.108036355215
H      1.612920580543      2.082531244930     -2.470708096234
H      1.032424796572     -0.234894987890     -3.628335396848
As     0.564956207944     -0.147614416970     -0.084858995331
C      3.257199554132      0.092973817887      1.281119375974
H      2.949136764685      0.884642574081      1.943139479619
C      4.241149651534     -0.656648458140      1.011715800597
H      5.268377417921     -0.892523372452      1.219591667922
C      2.461811040524     -2.527917143034      0.018066641110
H      1.676738241208     -3.259174393556     -0.056318991633
C      3.715886911128     -2.399648265789      0.126382124116
H      4.669754453128     -2.892391175646      0.150481713818
C     -0.805437011462     -0.416647207448     -1.437175133087
C     -1.055386448922     -1.725004730954     -1.850405572378
C     -1.462310068522      0.629800521952     -2.058004518177
C     -1.963633004957     -1.970402879897     -2.860977415844
H     -0.540461105388     -2.555699109157     -1.383158493351
C     -2.374302998469      0.371714065291     -3.077757147506
H     -1.274424401339      1.654967638683     -1.762400864222
C     -2.632240811400     -0.921344286825     -3.484851134111
H     -3.344955973040     -1.117486560870     -4.274200225353
C      0.132255401623      1.662169203906      0.503896461112
C     -1.131113188550      2.000124313033      0.987961290455
C      1.118198738585      2.631712349531      0.450293013200
C     -1.391720649527      3.292784470998      1.399559844779
H     -1.919045154385      1.260882266279      1.046499777616
C      0.847240160678      3.930282527098      0.871576620242
H      2.103232057361      2.378838210179      0.077468232733
C     -0.403137973089      4.270543120292      1.345235629129
H     -0.612602987272      5.280545513189      1.670484905118
C     -0.258751908546     -1.158104916096      1.371826367423
C     -1.622786856486     -1.403009579762      1.435930607454
C      0.565041191018     -1.642213859202      2.385051113203
C     -2.158251904706     -2.110583186550      2.505004754504
H     -2.286636483863     -1.057097774657      0.652097713467
C      0.020156343771     -2.343603697068      3.447393582184
H      1.635473558871     -1.476798298441      2.336699982224
C     -1.345157317371     -2.584679616889      3.517481346285
H     -1.765126210617     -3.132751638506      4.348654600927
C     -3.056712525935      1.542414932598     -3.732553977050
C     -2.248241431490     -3.374396967191     -3.322434744609
C      0.930387641701     -2.899918559682      4.508961248295
C     -3.643818443964     -2.346198485472      2.522737436350
C     -2.751376910901      3.678958233118      1.917245058971
C      1.957488498457      4.942725778591      0.801574169907
F     -4.037378588751     -3.053418072353      1.447614938319
F     -4.042440894772     -3.014873179754      3.612208957604
F     -4.321820691979     -1.184228928070      2.490229943415
F      2.004749996485     -2.121091086264      4.703052923447
F      1.384054938111     -4.121824427146      4.172510424451
F      0.302615566340     -3.025586868659      5.689476302458
F     -1.884321895090     -3.548995521899     -4.605023803977
F     -3.559878654055     -3.656993501802     -3.246951915947
F     -1.595993707479     -4.289874879644     -2.592295073779
F     -4.016484012392      1.160960325286     -4.584827796564
F     -3.622733745775      2.349825116766     -2.818064142842
F     -2.179060275607      2.292377682391     -4.422807807123
F     -3.307622676024      4.638141722280      1.156975914760
F     -3.598498364692      2.641632215647      1.940844839277
F     -2.676051468120      4.167915815692      3.167794548975
F      1.555073680277      6.168054376900      1.162203722564
F      2.979221507201      4.599731071407      1.607496273318
F      2.458211709447      5.029915976212     -0.443340607760
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -436.1612              6.3345              7.4458
Reduced mass [au]                   5.5598             18.8305             16.0609
Force const [Dyne/A]               -0.6232              0.0004              0.0005
Char temp [K]                       0.0000              9.1139             10.7129
Normal mode                   x         y         z            x         y         z            x         y         z     
      Co                 0.02351   -0.00454    0.00384   -0.00003    0.00104   -0.00024   -0.00106   -0.00738    0.00435
       C                 0.00594   -0.00575    0.00483   -0.00009    0.00124   -0.00022    0.00032   -0.01893    0.00236
       C                -0.00000   -0.00766    0.01022   -0.00060    0.00111   -0.00054    0.00272   -0.01579   -0.00487
       C                 0.00360   -0.00382    0.00680    0.00024    0.00070   -0.00015   -0.00075   -0.02018    0.00550
       H                 0.00857   -0.00200   -0.00198    0.00003    0.00167   -0.00005   -0.00060   -0.01965    0.00498
       C                 0.00171   -0.00344    0.00600   -0.00059    0.00049   -0.00071    0.00353   -0.01715   -0.00659
       H                 0.00035   -0.00943    0.01325   -0.00095    0.00143   -0.00067    0.00414   -0.01449   -0.00876
       C                 0.00147   -0.00312    0.00665   -0.00009    0.00023   -0.00045    0.00154   -0.01972   -0.00044
       H                -0.00207   -0.00692    0.01394    0.00066    0.00065    0.00008   -0.00251   -0.02235    0.01097
       H                 0.00107   -0.00394    0.00815   -0.00090    0.00027   -0.00097    0.00513   -0.01608   -0.01192
       H                 0.00013   -0.00445    0.00949    0.00005   -0.00026   -0.00048    0.00144   -0.02074    0.00014
      As                 0.00048   -0.00049    0.00018   -0.00021    0.00048   -0.00070   -0.00017   -0.00183    0.00105
       C                -0.01326    0.04782    0.04952   -0.00040    0.00136   -0.00026   -0.00145    0.00249    0.00008
       H                -0.20698   -0.03560    0.05387   -0.00073    0.00125   -0.00028   -0.00094    0.00739   -0.00556
       C                 0.02422    0.16966    0.00990   -0.00012    0.00169   -0.00017   -0.00221   -0.00040    0.00542
       H                 0.00931    0.04668   -0.08087   -0.00005    0.00207   -0.00010   -0.00264   -0.00035    0.00757
       C                -0.04076   -0.05787   -0.00131    0.00050    0.00100   -0.00004   -0.00364   -0.00399    0.01502
       H                -0.15841    0.06051    0.11592    0.00081    0.00067   -0.00003   -0.00480   -0.00316    0.01921
       C                -0.06067   -0.11694   -0.11906    0.00046    0.00142    0.00000   -0.00355   -0.00500    0.01518
       H                 0.00591    0.02417   -0.09192    0.00061    0.00172    0.00012   -0.00418   -0.00603    0.01888
       C                -0.00132    0.00021    0.00114   -0.00007   -0.00158   -0.00044    0.00084    0.00116   -0.00047
       C                -0.00055    0.00035   -0.00005   -0.00057   -0.00223    0.00188    0.00914    0.00246   -0.00999
       C                -0.00061    0.00007    0.00022    0.00070   -0.00244   -0.00267   -0.00679    0.00128    0.00819
       C                -0.00029    0.00012   -0.00010   -0.00025   -0.00365    0.00194    0.00989    0.00392   -0.01086
       H                 0.00010   -0.00022   -0.00191   -0.00122   -0.00163    0.00365    0.01586    0.00259   -0.01708
       C                -0.00019   -0.00005   -0.00019    0.00095   -0.00387   -0.00253   -0.00616    0.00269    0.00706
       H                -0.00070    0.00030   -0.00032    0.00122   -0.00197   -0.00460   -0.01321    0.00042    0.01535
       C                -0.00029    0.00006   -0.00024    0.00048   -0.00448   -0.00026    0.00212    0.00419   -0.00241
       H                -0.00003    0.00007   -0.00045    0.00077   -0.00558   -0.00025    0.00286    0.00536   -0.00331
       C                -0.00086   -0.00069    0.00049   -0.00108    0.00087   -0.00250    0.00358   -0.00081    0.00056
       C                -0.00049    0.00015    0.00052   -0.00222    0.00153   -0.00579    0.00852   -0.00179    0.01422
       C                -0.00082   -0.00029   -0.00009   -0.00083    0.00064   -0.00109    0.00110    0.00090   -0.01384
       C                -0.00016    0.00022    0.00016   -0.00307    0.00201   -0.00803    0.01083   -0.00101    0.01322
       H                -0.00067    0.00032    0.00056   -0.00295    0.00214   -0.00845    0.01094   -0.00345    0.02638
       C                -0.00006   -0.00004   -0.00012   -0.00160    0.00112   -0.00289    0.00325    0.00190   -0.01544
       H                -0.00079   -0.00028   -0.00022   -0.00023    0.00035    0.00070   -0.00219    0.00121   -0.02282
       C                -0.00005    0.00012   -0.00002   -0.00264    0.00176   -0.00626    0.00811    0.00094   -0.00198
       H                 0.00010    0.00018   -0.00010   -0.00384    0.00256   -0.00947    0.00999    0.00149   -0.00251
       C                -0.00166    0.00155    0.00012    0.00020    0.00145    0.00024   -0.00411    0.00076    0.00043
       C                -0.00136   -0.00005    0.00073    0.00002    0.00263    0.00137   -0.00335   -0.00446   -0.00593
       C                -0.00129    0.00024   -0.00029    0.00053    0.00112   -0.00022   -0.00729    0.00787    0.00660
       C                -0.00037   -0.00030    0.00039    0.00024    0.00352    0.00205   -0.00607   -0.00308   -0.00622
       H                -0.00178    0.00003    0.00110   -0.00032    0.00302    0.00183   -0.00062   -0.00918   -0.01033
       C                -0.00026   -0.00005    0.00016    0.00077    0.00183    0.00040   -0.01004    0.00983    0.00631
       H                -0.00127   -0.00408   -0.00027    0.00061    0.00039   -0.00099   -0.00770    0.01189    0.01147
       C                -0.00010   -0.00013    0.00045    0.00065    0.00299    0.00152   -0.00953    0.00421   -0.00021
       H                 0.00011   -0.00036    0.00040    0.00080    0.00373    0.00208   -0.01165    0.00556   -0.00035
       C                -0.00006    0.00002   -0.00012    0.00124   -0.00460   -0.00409   -0.01839    0.00378    0.02185
       C                 0.00003   -0.00003   -0.00008   -0.00066   -0.00436    0.00435    0.02326    0.00568   -0.02442
       C                 0.00005   -0.00042    0.00004    0.00122    0.00159   -0.00011   -0.01453    0.01733    0.01409
       C                -0.00044   -0.00024    0.00019    0.00026    0.00350    0.00259   -0.00514   -0.00944   -0.01341
       C                -0.00020    0.00017    0.00008    0.00003    0.00013    0.00147    0.01670   -0.00246    0.02972
       C                 0.00017   -0.00001   -0.00006   -0.00173    0.00125   -0.00302   -0.00064    0.00475   -0.03625
       F                 0.00011   -0.00003    0.00001    0.00209   -0.01019    0.01089    0.00385   -0.01536   -0.01281
       F                -0.00022   -0.00010    0.00011   -0.00139    0.01710    0.01033   -0.00820   -0.00695   -0.01300
       F                 0.00001   -0.00004    0.00003    0.00010    0.00296   -0.01321   -0.01001   -0.01252   -0.02164
       F                -0.00000    0.00012   -0.00009    0.00113    0.00175   -0.00019   -0.01105    0.01401    0.00749
       F                -0.00007    0.00009   -0.00004    0.00138    0.00183   -0.00078   -0.02026    0.01113    0.02883
       F                 0.00002    0.00011   -0.00005    0.00169    0.00098    0.00006   -0.01759    0.03374    0.01430
       F                 0.00001    0.00002   -0.00000    0.00002   -0.00688    0.00488    0.06000    0.01096   -0.01483
       F                 0.00001    0.00002    0.00001   -0.00085   -0.00357    0.00407    0.02137    0.00472   -0.06292
       F                 0.00001    0.00009    0.00003   -0.00155   -0.00333    0.00641    0.00330    0.00311   -0.00979
       F                -0.00001    0.00005   -0.00004    0.00753   -0.00560   -0.01068    0.01623    0.00401   -0.01707
       F                 0.00003   -0.00004    0.00001   -0.00685   -0.00841   -0.00563   -0.06641   -0.03873    0.02994
       F                 0.00004    0.00001   -0.00000    0.00306   -0.00022    0.00302   -0.01827    0.04808    0.07028
       F                -0.00001    0.00005    0.00001    0.04922    0.09318    0.08346    0.00622   -0.00333    0.03631
       F                 0.00005    0.00002   -0.00000   -0.03673    0.02758   -0.11382    0.01826   -0.00345    0.04055
       F                -0.00003    0.00005    0.00004   -0.00720   -0.12316    0.05053    0.03157   -0.00198    0.02867
       F                -0.00008   -0.00014   -0.00004   -0.00116    0.00068   -0.00045    0.00975   -0.00174   -0.00267
       F                -0.00011   -0.00008   -0.00001   -0.00048   -0.00010   -0.00521    0.02732   -0.00711   -0.07691
       F                -0.00001   -0.00016   -0.00005   -0.00368    0.00329   -0.00368   -0.04323    0.02610   -0.05199
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、Co錯体触媒が関わる酸化的環化反応(配位子 Tris(3,5-ditrifluoromethylphenyl)arsine)のある1つの遷移状態構造を算出する手順を説明した。




## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.

