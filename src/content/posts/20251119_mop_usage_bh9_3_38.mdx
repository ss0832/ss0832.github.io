---
title:  【計算化学】自作pythonライブラリで遷移状態構造を求めてみる(BH9データセットの3. Halogen atom transfer, No. 38の化学反応, NNP(UMA)使用)
published: 2025-11-19
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-11-19

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作ライブラリ(MultiOptPy)で、BH9データセットの3. Halogen atom transfer, No. 38の素過程の遷移状態構造を算出してみる。計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)とした。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonライブラリである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

BH9のデータセットについて:

- _J. Chem. Theory Comput._ 2022, 18, 1, 151–166 

https://doi.org/10.1021/acs.jctc.1c00694


この文献のSupporting Informationから、データセットの詳細を確認できる。

有機金属錯体が関わる反応を除いたさまざまなカテゴリの反応がまとめられたデータセットである。DFTの汎関数の電子エネルギーの精度の比較などのベンチマークに主に使われる。

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)



## 使用した自作ライブラリMultiOptPyのバージョン
```
v1.19.6b
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード(Unixコマンド)
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.19.6b.zip
unzip v1.19.6b.zip
cd MultiOptPy-v1.19.6b
```
https://github.com/ss0832/MultiOptPy/releases/tag/v1.19.6b にアクセスしてzipファイルをダウンロードする。Unixコマンドの場合とはディレクトリ名が異なるので都度読み替えていただけると良い。

移動先のディレクトリで`requirements.txt`を参照することで、本ソースコードで必要なモジュールを把握することが出来る。導入方法は各自の状況に合わせて適宜LLMとの対話などで調べると良い。

次に述べる環境構築手順を使用する場合は、環境構築が終わった後、`pip install -r requirements.txt`で本自作モジュールが動作させるために最低限必要なモジュールを導入することが可能である。

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install ase==3.26.0 fairchem-core==2.7.1 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作ライブラリへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.19.6b`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.19.6b`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作ライブラリでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照すると良い。`omol`以外のモデルを使用したい場合は、現バージョンでは、`multioptpy/Calculator/ase_tools/firechem.py`内の、`self.task_name`を編集することで対応可能である。


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`bh9_3_38.xyz`とした。
初期構造は以下のものを使用した。

```
41
OptimizedStructure
O     -3.480666347469     -0.661295950001     -1.694584541931
C     -2.642974221560     -0.934785160459     -0.914568921628
C     -2.628324307650     -2.060779803780      0.115006239997
C     -1.221487523121     -2.626429148587      0.264153248369
Cl    -2.324862499529      2.130048302751      0.965314776611
C     -0.994043625720      2.113351316211     -0.274866730369
H     -3.314514054810     -2.831915569697     -0.256505783394
C     -3.147130637620     -1.486865317966      1.432905433818
H     -0.563462021355     -1.827025393782      0.615195657516
C     -0.682061512374     -3.217672144297     -1.030125618382
H     -1.241276995239     -3.389228011998      1.046948400366
C      0.057400803710      1.092130956801      0.063713172332
C     -0.490832099068      3.519181837826     -0.419500086230
C      0.533673923831      0.907976709211      1.360916390495
C      0.625540980928      0.350071982316     -0.957954881621
C      0.773643667515      3.894236320162     -0.286861392677
C      1.542964347792      0.003321783129      1.622081754895
C      2.110381842872     -0.734416860710      0.583090203454
C      1.652293981385     -0.557163125544     -0.715860666962
H      0.261669658408      0.474295313796     -1.971694505976
H      1.910152576542     -0.152623184501      2.627804394803
O      3.092550536786     -1.605286292170      0.939396419215
H      2.065397679456     -1.121445709874     -1.539075721489
H      0.098082567130      1.474108737473      2.174361364524
H     -1.317398323096     -4.029422368278     -1.390428786994
H      0.324293240709     -3.615542784104     -0.892670488775
H     -0.634075044464     -2.456897185757     -1.813042036891
C      3.688777028023     -2.371177305666     -0.089537170255
H      4.172206185092     -1.731123401285     -0.832372909893
H      4.437963342850     -2.993161169299      0.391892549110
H      2.953811578669     -3.009950855825     -0.586855798759
H     -4.145806819091     -1.064901678821      1.323700667376
H     -2.481462256809     -0.702502621301      1.793553270522
H     -3.184745094403     -2.280767671384      2.179834893229
C      1.255524854605      5.300245842953     -0.454339301934
H      1.995604727626      5.364571874064     -1.254881083642
H      1.743135218309      5.652439080578      0.457119194109
H      0.435555573458      5.978378981944     -0.689293001499
H      1.523173904310      3.146805528267     -0.044899931209
H     -1.252569499491      4.254835491315     -0.660711059251
H     -1.506105337137      1.806378656289     -1.186357610978
```

<MoleculeViewer 
  xyzData={`41
OptimizedStructure
O     -3.480666347469     -0.661295950001     -1.694584541931
C     -2.642974221560     -0.934785160459     -0.914568921628
C     -2.628324307650     -2.060779803780      0.115006239997
C     -1.221487523121     -2.626429148587      0.264153248369
Cl    -2.324862499529      2.130048302751      0.965314776611
C     -0.994043625720      2.113351316211     -0.274866730369
H     -3.314514054810     -2.831915569697     -0.256505783394
C     -3.147130637620     -1.486865317966      1.432905433818
H     -0.563462021355     -1.827025393782      0.615195657516
C     -0.682061512374     -3.217672144297     -1.030125618382
H     -1.241276995239     -3.389228011998      1.046948400366
C      0.057400803710      1.092130956801      0.063713172332
C     -0.490832099068      3.519181837826     -0.419500086230
C      0.533673923831      0.907976709211      1.360916390495
C      0.625540980928      0.350071982316     -0.957954881621
C      0.773643667515      3.894236320162     -0.286861392677
C      1.542964347792      0.003321783129      1.622081754895
C      2.110381842872     -0.734416860710      0.583090203454
C      1.652293981385     -0.557163125544     -0.715860666962
H      0.261669658408      0.474295313796     -1.971694505976
H      1.910152576542     -0.152623184501      2.627804394803
O      3.092550536786     -1.605286292170      0.939396419215
H      2.065397679456     -1.121445709874     -1.539075721489
H      0.098082567130      1.474108737473      2.174361364524
H     -1.317398323096     -4.029422368278     -1.390428786994
H      0.324293240709     -3.615542784104     -0.892670488775
H     -0.634075044464     -2.456897185757     -1.813042036891
C      3.688777028023     -2.371177305666     -0.089537170255
H      4.172206185092     -1.731123401285     -0.832372909893
H      4.437963342850     -2.993161169299      0.391892549110
H      2.953811578669     -3.009950855825     -0.586855798759
H     -4.145806819091     -1.064901678821      1.323700667376
H     -2.481462256809     -0.702502621301      1.793553270522
H     -3.184745094403     -2.280767671384      2.179834893229
C      1.255524854605      5.300245842953     -0.454339301934
H      1.995604727626      5.364571874064     -1.254881083642
H      1.743135218309      5.652439080578      0.457119194109
H      0.435555573458      5.978378981944     -0.689293001499
H      1.523173904310      3.146805528267     -0.044899931209
H     -1.252569499491      4.254835491315     -0.660711059251
H     -1.506105337137      1.806378656289     -1.186357610978`}
  caption="初期経路を求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化

　`run_autots.py`を適切に使用することで、自動的に遷移状態構造が得られる。以下にその手順を説明していく。

初期構造をカレントディレクトリに`bh9_3_38.xyz`として保存する。その後、同じディレクトリ内で、`config_bh9_3_38.json`を作成し、以下のように記述する。

`config_bh9_3_38.json`
```json
{
  "work_dir": "bh9_3_38",
  "top_n_candidates": 3,
  "multioptpy_version": "v1.19.6b",
  
  "step1_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_fsb"],
    "use_model_hessian": "fischerd3",
    "spin_multiplicity": 2,
    "electronic_charge": 0,
	"manual_AFIR": ["600", "2", "5"]
  },
  
  "step2_settings": {
    "othersoft": "uma-s-1p1",
    "NSTEP": 15,
    "ANEB": [3, 5],
    "QSM": true,
    "use_model_hessian": "fischerd3",
    "save_pict": true,
    "node_distance_bernstein": 0.50,
    "align_distances": 9999,
    "spin_multiplicity": 2,
    "electronic_charge": 0
  },
  
  "step3_settings": {
    "othersoft": "uma-s-1p1",
    "opt_method": ["rsirfo_block_bofill"],
    "calc_exact_hess": 5,
    "tight_convergence_criteria": true,
    "max_trust_radius": 0.2,
    "frequency_analysis": true,
	"NSTEP": 500,
	"detect_negative_eigenvalues": true,
    "spin_multiplicity": 2,
    "electronic_charge": 0
  },

  "step4_settings": {
    "othersoft": "uma-s-1p1",
	"opt_method": ["rsirfo_block_bofill"],
    "spin_multiplicity": 2,
    "electronic_charge": 0,
	"calc_exact_hess": 10,
    "tight_convergence_criteria": true,
    "frequency_analysis": true,
    
    "intrinsic_reaction_coordinates": ["0.5", "200", "lqa"],

    "step4b_opt_method": ["rsirfo_block_fsb"]
  }
}
```
その後、以下のコマンドを実行する。
```
python run_autots.py bh9_3_38.xyz -cfg config_bh9_3_38.json
```

これにより、これまでの似た内容の記事で行ってきたコマンドの操作をまとめ、遷移状態構造を求める処理を自動的に行う。

具体的な処理の流れは、
```
Step1. バイアスポテンシャルによるNEB法のための初期経路の作成

Step2. NEB法による経路の緩和

Step3. NEB法により得られた経路のエネルギー極大値を示す構造のうち、エネルギー値が上位の最大で3個
(`run_autots.py`にて、`--top_n X`で最大値を変更可能)の構造を初期構造とした遷移状態構造の算出

(Step4.得られた遷移状態構造に対するIRC計算とIRC経路の末端に存在する構造に対する構造最適化。
こちらは`--run_step4`をコマンドで追記しなければ行わない。)
```
となっている。

`run_autots.py`のオプションの説明：

- `-cfg YYY.json`は、workflowを実行するためのオプションが記されたJSONファイルの読み込み先を指定する。


これらの一連の結果は、`(jsonファイルの"work_dir"にて指定した名前)`のディレクトリの中に存在するファイルを開いて確認できる。

以下にすべてのstepで共通のオプションに関する説明を載せる。

- `"opt_method": ["rsirfo_block_fsb"]`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。(以前のHessian更新法とは細かな点で異なる方法を使用している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"spin_multiplicity": Z`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- ` "electronic_charge": 0`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `"othersoft": "uma-s-1p1"`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。
- `"use_model_hessian": "fischerd3"`は、計算コストが非常に低い数式を使用して、近似したHessianを生成する機能を呼び出すオプションである。デフォルトではこの機能は使用されない。


※オプションの説明は`MultiOptPy-v1.19.6b/OPTION_README.md`にて示されている。


#### Step 1


Step1では、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化を行っている。


以下のJSON内で記述したバイアスポテンシャルで、次の経路緩和アルゴリズムの初期経路として用いるトラジェクトリーを生成する。
- `"manual_AFIR": ["yyy", "a", "b]`：yyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。


Step1が正常終了していれば作成された`work_dir`ディレクトリ中に、`bh9_3_38_step1_traj.xyz`が存在する。必要に応じて確認し、目的に沿った初期経路が得られているか確認する。もし想定とは異なる場合は、プロセスをkillして再度設定を見直してやり直す。


`bh9_3_38_step1_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`bh9_3_38_step1_traj.xyz`はStep2のNEB計算に使用している。

※`bh9_3_38_step1_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。


#### Step 2

Step2では、NEB法を用いることで、先ほど得られた`bh9_3_38_step1_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）

Step2固有のオプションについて以下に示す。


- `"NSTEP": n`はn回分NEB法による経路の緩和を行うことを示す。
- `"align_distances": X`は線形補間で、各ノード間の距離を全て等しくするための処理である。X回の反復計算ごとに本処理を行う。Xを`"NSTEP": n`よりも大きな数値を指定することで、初期経路に対してのみ処理を行うことが出来る。
- `"node_distance_bernstein": N`はノード間の距離をN Åとして初期経路を作成することを示す。経路作成時に元のノードをベルンシュタイン多項式を用いてがたついた経路を滑らかにする。

→プログラムの仕様上`"align_distances": X`の処理を行った後に、`"node_distance_bernstein": N`の処理を行うようになっている。

- `"save_pict": true`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `"ANEB": [A, B]`これを指定すると、(B+1)回の緩和ごとに、エネルギー極大値を示すノードと前後のノードの間に線形補間でA個の新規ノードを内挿するようにできる。デフォルトではこのような操作は行われない。このオプションを使用するとノードの数が徐々に増えるため、計算コストが使用しない場合と比べて増加する。一方で、エネルギー極大値を示すノード周辺にノードを増加させるため、緩和している経路中のノードが遷移状態構造付近に存在する可能性が高くすることが出来る。


`MultiOptPy-v1.19.6b/"work_dir"`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

経路の緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-1233.470493757268,-1233.470493757268,-1233.457805996677,-1233.426651069052,-1233.3946949454964,-1233.370247607862,-1233.3640799673333,-1233.39367695872,-1233.4284326926352,-1233.451495172153,-1233.4635675118627,-1233.4703189785175,-1233.47359357862,-1233.4749632191385,-1233.4757901281785,-1233.4764169458647,-1233.476935516906,-1233.4773995593953,-1233.4777185297387,-1233.4779026484807,-1233.47810225794,-1233.478354976553,-1233.4786067576622,-1233.478777111745,-1233.4788630773412,-1233.4789188675804,-1233.4789609983015,-1233.4789920717344,-1233.4790856556442,-1233.479365938622,-1233.4796389888015,-1233.479779250764,-1233.4798607610267,-1233.4799434497402,-1233.4800264232097,-1233.4801221186935,-1233.480660346649,-1233.4813448909142,-1233.4817039767836,-1233.4817406139075,-1233.4819508162839,-1233.4820105317729,-1233.4820636496881];

export const dataset1_itr5 = [-1233.4704938010768,-1233.4704938448854,-1233.4616801918078,-1233.4385978257912,-1233.4166485448598,-1233.3815202984267,-1233.3852897472188,-1233.4233098296156,-1233.4507990032785,-1233.4679988843545,-1233.4802319555904,-1233.487208013553,-1233.4903515602584,-1233.491178421109,-1233.4918735188635,-1233.4929146825746,-1233.4936130309263,-1233.4940036326955,-1233.4940677684713,-1233.4938464255704,-1233.4930927119224,-1233.4921252517834,-1233.4914402212428,-1233.4915491031122,-1233.4915577991173,-1233.4919720487633,-1233.493726254227,-1233.4944019009677,-1233.4950242238926,-1233.4948093208545,-1233.4946847817948,-1233.4949339475313,-1233.4954140152026,-1233.4963456574387,-1233.4971672568777,-1233.4974387211862,-1233.4976090270798,-1233.4979722090525,-1233.498351205926,-1233.4976358247943,-1233.4973887881554,-1233.497545114728,-1233.4982678250367];

export const dataset1_itr10 = [-1233.4704937791726,-1233.4704929949987,-1233.4661172397023,-1233.4496767411056,-1233.430818698328,-1233.4227462170463,-1233.410763849776,-1233.393416319514,-1233.4012034343784,-1233.404073909,-1233.4034440466169,-1233.4028465434487,-1233.400065966244,-1233.4319773616057,-1233.4547472195932,-1233.4708978696065,-1233.482013633421,-1233.4883688185232,-1233.4911609721478,-1233.4922558189048,-1233.4929866250409,-1233.4936966220969,-1233.4942100149628,-1233.4946101231958,-1233.4948548949305,-1233.4949514315394,-1233.4947832416008,-1233.4948014221657,-1233.4948956675853,-1233.4950216085197,-1233.4949167219936,-1233.494921707411,-1233.4950124831905,-1233.4946506724268,-1233.4948627541917,-1233.495050123531,-1233.4949439884601,-1233.4950856128696,-1233.4960121032157,-1233.496206990109,-1233.4963067378874,-1233.4965551325927,-1233.4965145526958,-1233.4962690405957,-1233.4966482871782,-1233.4965696945678,-1233.4966766795255,-1233.4966413610402,-1233.4967658475296,-1233.4969032225058,-1233.4970064224012,-1233.4974218943069,-1233.4977674520837,-1233.498101220969,-1233.498402751113,-1233.498716481949,-1233.4989730294328,-1233.4988742761093,-1233.4988524900975,-1233.4988097372946,-1233.4989436557732,-1233.4989078334893,-1233.4988672141646,-1233.4989613281584,-1233.498987560742,-1233.4990107267245,-1233.498958949352];

export const dataset2 = [-1233.47049376603,-1233.4704935645104,-1233.468232449852,-1233.4566764031367,-1233.4426282861623,-1233.4356765501811,-1233.419917427941,-1233.4161710673711,-1233.4113996405565,-1233.4073537223246,-1233.400775003892,-1233.3976673517548,-1233.4011481150815,-1233.4058629444835,-1233.4121184584722,-1233.4225090189955,-1233.42317416071,-1233.4185798717385,-1233.4153765044036,-1233.4144838474317,-1233.4134603090117,-1233.4129379540036,-1233.4226211684381,-1233.429730144401,-1233.4348809785208,-1233.437564998855,-1233.4574965722252,-1233.472087807289,-1233.482781234392,-1233.4887027144534,-1233.4913049008892,-1233.4925042661803,-1233.4933071812554,-1233.4939438909214,-1233.4943936430486,-1233.494764662378,-1233.495017249565,-1233.4951975876256,-1233.49522152902,-1233.495215132966,-1233.4952211084576,-1233.4952218356802,-1233.4952762547107,-1233.4953065877785,-1233.4953053041868,-1233.4953548078934,-1233.4955419581897,-1233.495592964531,-1233.495587497219,-1233.495585227934,-1233.49559448907,-1233.4955080766263,-1233.4955066353236,-1233.495509509167,-1233.4955075903508,-1233.4955585572645,-1233.4956043503835,-1233.4956165028864,-1233.4956085034378,-1233.4956018576747,-1233.495591291043,-1233.495686268066,-1233.4956975268735,-1233.4957518407634,-1233.4957931347403,-1233.4957444809204,-1233.495778480767,-1233.4958186488632,-1233.495800411347,-1233.4958148068497,-1233.495873427124,-1233.495883560051,-1233.4958533102194,-1233.4958382400646,-1233.4962453970998,-1233.4964305760095,-1233.496574443419,-1233.4968133228983,-1233.4968275125007,-1233.4967616944753,-1233.4967425851682,-1233.4966994862773,-1233.4966634099035,-1233.496753002851,-1233.4968292254166,-1233.4968909298157,-1233.4969372311143,-1233.4969935295333,-1233.496982818333,-1233.4969525071697,-1233.4969426589987,-1233.4969072704196,-1233.4968820235292,-1233.4969641865398,-1233.4970176987324,-1233.4970718943391,-1233.4971079794745,-1233.497219511764,-1233.4973846657672,-1233.4977079337334,-1233.497907473099,-1233.498270177558,-1233.498516736683,-1233.4988962066896,-1233.499109331099,-1233.4991146669852,-1233.4991177642523,-1233.4991279234644,-1233.4991257856052,-1233.4991131643505,-1233.4991049327164,-1233.4991189777504,-1233.4991308104504,-1233.499124147164,-1233.4991163317115,-1233.4991082052181,-1233.4990987863712,-1233.4991052700425,-1233.499110259841,-1233.499112993497,-1233.4991122837978,-1233.499094098852,-1233.4990638314973,-1233.4990278777875,-1233.4989722584016,-1233.4989863034357,-1233.4989908157204,-1233.4989973125344,-1233.4990335247148,-1233.4990799618201,-1233.4991224517714,-1233.4991530958803,-1233.498700737142];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(81, 143, 18, 1)"}, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [1.015756876091353e-05,1.0157260482161122e-05,0.005201740338605927,0.00908834095186291,0.012468138663962191,0.008881456802458115,0.015302412886297242,0.017827792115680762,0.014827112898062421,0.012844416693257175,0.013216039672791455,0.013336747890812774,0.013225796050216045,0.013130235939656655,0.013112999119409026,0.013140315006940136,0.013164998918738477,0.013145152238294319,0.013140195121839206,0.01316560213963119,0.013165880374138439,0.013149216937715336,0.01312836618443199,0.013116066977163476,0.01311708025016343,0.013125189581691668,0.013140951976892974,0.013169673142566361,0.013195298751319934,0.013161132199257165,0.013119459160203878,0.0131304021690302,0.013182651128898461,0.01324447889646552,0.013318995929606621,0.013398445396018532,0.013328786195992075,0.01320559555843611,0.013172992121357103,0.013211548622601876,0.013149247980204316,0.013137767583158528,0.013128264955063678];

export const dataset1_grad_itr5 = [8.604155438936991e-06,4.141057091747103e-06,0.003428817113053632,0.00703160178847978,0.009951980222860684,0.006060430578919699,0.009429111480717465,0.006835670322390075,0.004170931196635573,0.0031309848374901565,0.002581741932691927,0.0022194996707510053,0.001960893466658615,0.0026999272986023373,0.002596803558354254,0.0017510559555404977,0.0014541876664265878,0.0014373077920041772,0.0018104787077230077,0.0025177826323356804,0.0037570471271531755,0.004866699939163922,0.005560640393399006,0.005581104473289679,0.005610060066849388,0.005197424161892588,0.0034376627230101203,0.002817404944019898,0.002487175673329399,0.0031849375153115266,0.0031257272024247627,0.003142012170732246,0.0028672515733990382,0.002105641868563149,0.0014892291279670956,0.0017116390396104894,0.0018951361020993131,0.0017880184056168803,0.0015932081776870227,0.0028794925840096553,0.003052966134819709,0.002898158183420277,0.003349227198913868];

export const dataset1_grad_itr10 = [2.8643531150787198e-06,2.5777498005828898e-05,0.0021729263189560906,0.004937450715375158,0.007417218194060013,0.008383627794599459,0.009185249999569628,0.006856165892806404,0.00858707999369852,0.008801348471948803,0.008833563561286775,0.008733264984074177,0.00908854350577678,0.005314804630048278,0.0029796065304158697,0.001898257345839849,0.0012586900637150376,0.0008510329157717895,0.0005598455362531157,0.0008991005844972883,0.001061933400722561,0.0006729510442399166,0.0004880940092493541,0.00037459227294862267,0.0004970443037424109,0.0009367119557150839,0.0017873326146229176,0.002116839269738202,0.0020790258127730784,0.0021102232736806615,0.0021548221245991867,0.002173754711676754,0.002138245342052314,0.0029641450838548706,0.002463225235981286,0.0022548240100598083,0.0025116378318910037,0.0022547716192022546,0.000941053057719496,0.0006891351218847249,0.000900743572254835,0.0009737893656929306,0.0010572632872312175,0.002848489631970756,0.00099125431914201,0.0012211327444891981,0.0011125860766444313,0.002189616642577717,0.0010896685723101231,0.0009820996826407963,0.0010823433889027454,0.000720006734710592,0.00042198618270965194,0.0005983164824789874,0.0008864813864038287,0.0006640342574193204,0.0005089610918498015,0.0010878606194316283,0.001139392478220535,0.0012780566094042476,0.0008721597237065689,0.0006706482580641308,0.0009913536690707506,0.0006183387020997252,0.0005066951819779395,0.0005847124348149499,0.0011344745220943288];

export const dataset2_grad = [1.0838404999722034e-05,3.202447900844423e-06,0.001423324817358034,0.003583517289263157,0.005155643722367431,0.006002272437013196,0.00802961082019706,0.008404329240311379,0.008760507710009444,0.008860722079736576,0.007997413036305365,0.0038243046277713247,0.0074472504699725625,0.008131302374344217,0.007791702211982533,0.006677541571391847,0.0071390173190719625,0.007394373649263748,0.007836903210751837,0.007926461897609524,0.007960981331780904,0.007832803338290381,0.006621632033639353,0.00589543951314436,0.005085728851964695,0.004458946751668284,0.0023552420026764563,0.001582846002616085,0.000963299726964042,0.0005616825714553878,0.0002683158835535543,0.0003296648654124143,0.00038865924902083544,0.00033186868616256674,0.0002595843102396021,0.0001614020428510444,0.00020096244778155018,0.00037303662121659643,0.0005317034927845985,0.0007022028710249881,0.0008998631951231934,0.0009918282305420223,0.0009955201735946623,0.0010312363593192378,0.0011578097147429602,0.0010613566165687384,0.0007366477798900484,0.0006960943298763212,0.0006677069535780356,0.0007217545185502334,0.000759260280509769,0.0010064178157468064,0.001045566920634846,0.0010585457361417217,0.001094834365141804,0.0010157405711117647,0.0009166114116897076,0.0009081978119774971,0.000961808823202685,0.0010000269261180208,0.0010239760659333434,0.000843533700453683,0.0008725236783959072,0.0007741174012444673,0.0006996376198057974,0.0011294049138024388,0.0011547753823176437,0.0011282890463568736,0.001209828708653717,0.0011841068138516457,0.0011073113703486434,0.001095011860235709,0.001178782289122566,0.0011566985391533913,0.00035975432524583753,0.0002722465918739578,0.0003946102502964168,0.0002679021673604865,0.0007139330322814182,0.0006030280386050646,0.0006228230178825066,0.0006831762940748035,0.0007279300637494303,0.0007399457962819042,0.0005998909780565823,0.0004702334040966363,0.0003459629104772129,0.00047262825942308886,0.0005834220482060116,0.0006448639210946217,0.0006540312535098522,0.000708821411308538,0.0007306726554309203,0.0005827233556247712,0.00047246760710013944,0.00038103913120398123,0.000333235770579856,0.0003216079630952754,0.0005143445977929723,0.00030462782840570706,0.00020293104901182623,0.00025141827595656527,0.000520676505945649,0.0003403086976573616,0.00020181153136334307,0.0002567221850148952,0.00029163177897822696,0.00032702754653182525,0.0003658901595064048,0.0004034017122206787,0.0006032147622776075,0.0004277547318873492,0.0004027974090157866,0.0004116018985231898,0.0004044521464004223,0.0004005329982735685,0.0003901299867694378,0.00035223147751076866,0.00031421580528157353,0.0002789652508412431,0.0002468934158436212,0.00021752980022589683,0.00024516416481665216,0.00033066146661592537,0.0004343284898046849,0.0003839784003282588,0.00033775859487389284,0.00032150164991284915,0.00028686623489468545,0.0003247606005061981,0.0004312522663025423,0.00032952850479015184,0.0033536210579346816];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(81, 143, 18, 1)"},  { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、以下の構造がstep3の初期構造として用いられることとなった。"work_dir"内の`bh9_3_38_step3_TS_Opt_Inputs`内に保存された`bh9_3_38_ts_guess_X.xyz`にて確認が可能である。ts_guessの番号が小さい順にエネルギー値が高い構造を示すようになっている。

※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`bh9_3_38_ts_guess_1.xyz`
```
41
0 2
O      -3.195990739179     -0.311023695779     -1.676905303963
C      -2.616886709638     -0.467713503361     -0.661564204991
C      -2.571002711211     -1.737219890025      0.198946086548
C      -1.217231442841     -2.459047952285      0.274607691625
Cl     -2.659950162431      1.224251436670      0.510141424756
C      -0.914360118506      1.972947454513     -0.466980246075
H      -3.264792204425     -2.366739015193     -0.363812462627
C      -3.147873707787     -1.472814523802      1.581791431165
H      -0.462472837971     -1.768199522356      0.653278866127
C      -0.730186092264     -3.111252075531     -1.017898014108
H      -1.315384466890     -3.248273017139      1.029567992353
C       0.139339735930      1.044251239906     -0.049940185606
C      -0.621412468320      3.418058707187     -0.323347245113
C       0.566194774025      0.893665340240      1.277457599177
C       0.722625408182      0.266847793214     -1.032166936041
C       0.641721649841      3.846839182154     -0.207299313104
C       1.566237099029     -0.004406786161      1.586244473877
C       2.161039647458     -0.761996291520      0.573354790133
C       1.742295715643     -0.623327416666     -0.741870772260
H       0.365495256527      0.379488038242     -2.048790353963
H       1.902698716651     -0.148506734501      2.605674086319
O       3.132269196997     -1.629581925930      0.958366090446
H       2.167913890649     -1.201638881555     -1.544436952276
H       0.096211410175      1.468733166494      2.068984214974
H      -1.390688994814     -3.919816833787     -1.340945764548
H       0.259255255976     -3.552231451125     -0.867601326477
H      -0.651670170800     -2.395648744820     -1.837054829353
C       3.722141408009     -2.395477411637     -0.073392300535
H       4.198356004771     -1.750244418878     -0.816818305407
H       4.470635168594     -3.021287000846      0.400498023975
H       2.978243407943     -3.024536629429     -0.570686305643
H      -4.147452538908     -1.048588856952      1.497001389616
H      -2.514276930604     -0.766615858579      2.113471206582
H      -3.203870715342     -2.389171234819      2.169474788964
C       1.140666453247      5.241975444806     -0.404871420665
H       1.877705998330      5.259175686014     -1.214740081538
H       1.662057787182      5.598828433048      0.485231633854
H       0.349192727912      5.945381344203     -0.656355886773
H       1.419567249249      3.108814904619     -0.035492163888
H      -1.404541979372      4.138614000693     -0.550443964593
H      -1.251818971017      1.767487500671     -1.480677450944
```

<MoleculeViewer 
  xyzData={`41
0 2
O      -3.195990739179     -0.311023695779     -1.676905303963
C      -2.616886709638     -0.467713503361     -0.661564204991
C      -2.571002711211     -1.737219890025      0.198946086548
C      -1.217231442841     -2.459047952285      0.274607691625
Cl     -2.659950162431      1.224251436670      0.510141424756
C      -0.914360118506      1.972947454513     -0.466980246075
H      -3.264792204425     -2.366739015193     -0.363812462627
C      -3.147873707787     -1.472814523802      1.581791431165
H      -0.462472837971     -1.768199522356      0.653278866127
C      -0.730186092264     -3.111252075531     -1.017898014108
H      -1.315384466890     -3.248273017139      1.029567992353
C       0.139339735930      1.044251239906     -0.049940185606
C      -0.621412468320      3.418058707187     -0.323347245113
C       0.566194774025      0.893665340240      1.277457599177
C       0.722625408182      0.266847793214     -1.032166936041
C       0.641721649841      3.846839182154     -0.207299313104
C       1.566237099029     -0.004406786161      1.586244473877
C       2.161039647458     -0.761996291520      0.573354790133
C       1.742295715643     -0.623327416666     -0.741870772260
H       0.365495256527      0.379488038242     -2.048790353963
H       1.902698716651     -0.148506734501      2.605674086319
O       3.132269196997     -1.629581925930      0.958366090446
H       2.167913890649     -1.201638881555     -1.544436952276
H       0.096211410175      1.468733166494      2.068984214974
H      -1.390688994814     -3.919816833787     -1.340945764548
H       0.259255255976     -3.552231451125     -0.867601326477
H      -0.651670170800     -2.395648744820     -1.837054829353
C       3.722141408009     -2.395477411637     -0.073392300535
H       4.198356004771     -1.750244418878     -0.816818305407
H       4.470635168594     -3.021287000846      0.400498023975
H       2.978243407943     -3.024536629429     -0.570686305643
H      -4.147452538908     -1.048588856952      1.497001389616
H      -2.514276930604     -0.766615858579      2.113471206582
H      -3.203870715342     -2.389171234819      2.169474788964
C       1.140666453247      5.241975444806     -0.404871420665
H       1.877705998330      5.259175686014     -1.214740081538
H       1.662057787182      5.598828433048      0.485231633854
H       0.349192727912      5.945381344203     -0.656355886773
H       1.419567249249      3.108814904619     -0.035492163888
H      -1.404541979372      4.138614000693     -0.550443964593
H      -1.251818971017      1.767487500671     -1.480677450944`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.1)"
  backgroundColor="#333333"
/>

`bh9_3_38_ts_guess_2.xyz`
```
41
0 2
O      -3.073526960656     -0.331723089972     -1.731186529553
C      -2.681091301915     -0.430365764283     -0.607897440101
C      -2.561839037633     -1.689328998192      0.236000881406
C      -1.223360715926     -2.442577656324      0.287151513045
Cl     -2.663172990427      0.997728245825      0.305844936885
C      -0.833370593532      2.010335037695     -0.508908404003
H      -3.273781758426     -2.278242423166     -0.336057361903
C      -3.146425640086     -1.455411350338      1.625805635743
H      -0.444566770016     -1.785491547683      0.678795928746
C      -0.752366968923     -3.088521586164     -1.016003394643
H      -1.345102256489     -3.241744566293      1.024540708809
C       0.162246869973      1.059245643428     -0.066733997672
C      -0.631505441511      3.421752107678     -0.347418955632
C       0.571184083932      0.894078019317      1.264978146179
C       0.734037539777      0.260301655461     -1.043026744149
C       0.620461735841      3.846749719551     -0.199131068455
C       1.568838648413     -0.002975278294      1.578535742930
C       2.167691365641     -0.758726414317      0.567157325742
C       1.751892099669     -0.626635804921     -0.749959430852
H       0.368261488583      0.369962531323     -2.057259020656
H       1.901325141726     -0.147121445001      2.599627659445
O       3.134188164187     -1.632627579706      0.956446709470
H       2.179265693940     -1.205376573132     -1.552291532865
H       0.095545701006      1.471989263170      2.054217189118
H      -1.408037963159     -3.903881475018     -1.332783072913
H       0.240283897464     -3.524431226467     -0.872253958795
H      -0.684571095075     -2.374192452026     -1.836952499123
C       3.720869755634     -2.395781713177     -0.077407373658
H       4.197081954519     -1.749192122652     -0.819721154336
H       4.468039652640     -3.023848509841      0.394975817883
H       2.975953272319     -3.022017735099     -0.577246826147
H      -4.157178634417     -1.054042412330      1.543366673283
H      -2.540221128945     -0.751702236329      2.193450284000
H      -3.187117640225     -2.385424671125      2.189872229369
C       1.126898954452      5.231596098033     -0.375138991712
H       1.874759519471      5.242745844352     -1.174354508694
H       1.634668815383      5.568114853395      0.529118106039
H       0.344020731649      5.941028892054     -0.637297687458
H       1.389910657240      3.096630740095     -0.032771109664
H      -1.430243227536      4.122128961443     -0.563856490621
H      -1.189945618565      1.766997019032     -1.514227934489
```

<MoleculeViewer 
  xyzData={`41
0 2
O      -3.073526960656     -0.331723089972     -1.731186529553
C      -2.681091301915     -0.430365764283     -0.607897440101
C      -2.561839037633     -1.689328998192      0.236000881406
C      -1.223360715926     -2.442577656324      0.287151513045
Cl     -2.663172990427      0.997728245825      0.305844936885
C      -0.833370593532      2.010335037695     -0.508908404003
H      -3.273781758426     -2.278242423166     -0.336057361903
C      -3.146425640086     -1.455411350338      1.625805635743
H      -0.444566770016     -1.785491547683      0.678795928746
C      -0.752366968923     -3.088521586164     -1.016003394643
H      -1.345102256489     -3.241744566293      1.024540708809
C       0.162246869973      1.059245643428     -0.066733997672
C      -0.631505441511      3.421752107678     -0.347418955632
C       0.571184083932      0.894078019317      1.264978146179
C       0.734037539777      0.260301655461     -1.043026744149
C       0.620461735841      3.846749719551     -0.199131068455
C       1.568838648413     -0.002975278294      1.578535742930
C       2.167691365641     -0.758726414317      0.567157325742
C       1.751892099669     -0.626635804921     -0.749959430852
H       0.368261488583      0.369962531323     -2.057259020656
H       1.901325141726     -0.147121445001      2.599627659445
O       3.134188164187     -1.632627579706      0.956446709470
H       2.179265693940     -1.205376573132     -1.552291532865
H       0.095545701006      1.471989263170      2.054217189118
H      -1.408037963159     -3.903881475018     -1.332783072913
H       0.240283897464     -3.524431226467     -0.872253958795
H      -0.684571095075     -2.374192452026     -1.836952499123
C       3.720869755634     -2.395781713177     -0.077407373658
H       4.197081954519     -1.749192122652     -0.819721154336
H       4.468039652640     -3.023848509841      0.394975817883
H       2.975953272319     -3.022017735099     -0.577246826147
H      -4.157178634417     -1.054042412330      1.543366673283
H      -2.540221128945     -0.751702236329      2.193450284000
H      -3.187117640225     -2.385424671125      2.189872229369
C       1.126898954452      5.231596098033     -0.375138991712
H       1.874759519471      5.242745844352     -1.174354508694
H       1.634668815383      5.568114853395      0.529118106039
H       0.344020731649      5.941028892054     -0.637297687458
H       1.389910657240      3.096630740095     -0.032771109664
H      -1.430243227536      4.122128961443     -0.563856490621
H      -1.189945618565      1.766997019032     -1.514227934489`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.2)"
  backgroundColor="#333333"
/>

`bh9_3_38_ts_guess_3.xyz`
```
41
0 2
O      -2.664045628600     -0.442810881837     -1.537619008993
C      -2.705262230214     -0.532038703898     -0.356210574001
C      -2.737323553407     -1.835844017627      0.415991683434
C      -1.304098828362     -2.407595544867      0.429874999504
Cl     -2.676167014489      0.944069378534      0.640928167384
C      -0.133045708095      2.242406729864     -1.236002983790
H      -3.358569892491     -2.491564611086     -0.200537956094
C      -3.319476588839     -1.752357137193      1.818410188203
H      -0.602538772792     -1.620047699674      0.723733849173
C      -0.884302219656     -3.029587311221     -0.893369786654
H      -1.268506047109     -3.162706849517      1.218423468308
C       0.695922356283      1.204419324639     -0.666866195242
C      -0.186269783244      3.599362870766     -0.886571255248
C       1.176832337000      1.220162256296      0.655502891145
C       1.014889279035      0.086480297411     -1.443532863008
C       0.671181981373      4.299918715739     -0.089507560301
C       1.960186773748      0.198548310392      1.146465824130
C       2.301176594284     -0.882431745711      0.333362272244
C       1.818519777797     -0.939297530381     -0.968841004096
H       0.632860539744      0.029505097047     -2.456260563376
H       2.317728123031      0.209016663544      2.167793135410
O       3.088644460494     -1.834091066937      0.904702509531
H       2.049767162048     -1.772615407330     -1.615862402675
H       0.894083355798      2.029085848192      1.314865181793
H      -1.560340564426     -3.841677251989     -1.168326510004
H       0.122723322881     -3.440656945438     -0.821108247833
H      -0.892802410134     -2.297167794181     -1.699775019654
C       3.454202900414     -2.942119636701      0.106040016185
H       4.012736665493     -2.627433167206     -0.779253461255
H       4.087814860264     -3.567891934808      0.727978204051
H       2.576739943756     -3.514816304885     -0.206537349420
H      -4.298568862234     -1.275414848893      1.827523278853
H      -2.663173608836     -1.193745585533      2.484225791246
H      -3.426295456224     -2.761942422949      2.216477100136
C       0.530853527202      5.759257914607      0.182369550145
H       1.397052948903      6.315970533093     -0.185205035308
H       0.466265269326      5.961036764662      1.254942503899
H      -0.360948233313      6.167357475262     -0.293188297565
H       1.537046054315      3.806057012119      0.333735141396
H      -0.984332369195      4.170015160958     -1.355402814262
H      -0.781160461528      1.923184046737     -2.043366867392
```

<MoleculeViewer 
  xyzData={`41
0 2
O      -2.664045628600     -0.442810881837     -1.537619008993
C      -2.705262230214     -0.532038703898     -0.356210574001
C      -2.737323553407     -1.835844017627      0.415991683434
C      -1.304098828362     -2.407595544867      0.429874999504
Cl     -2.676167014489      0.944069378534      0.640928167384
C      -0.133045708095      2.242406729864     -1.236002983790
H      -3.358569892491     -2.491564611086     -0.200537956094
C      -3.319476588839     -1.752357137193      1.818410188203
H      -0.602538772792     -1.620047699674      0.723733849173
C      -0.884302219656     -3.029587311221     -0.893369786654
H      -1.268506047109     -3.162706849517      1.218423468308
C       0.695922356283      1.204419324639     -0.666866195242
C      -0.186269783244      3.599362870766     -0.886571255248
C       1.176832337000      1.220162256296      0.655502891145
C       1.014889279035      0.086480297411     -1.443532863008
C       0.671181981373      4.299918715739     -0.089507560301
C       1.960186773748      0.198548310392      1.146465824130
C       2.301176594284     -0.882431745711      0.333362272244
C       1.818519777797     -0.939297530381     -0.968841004096
H       0.632860539744      0.029505097047     -2.456260563376
H       2.317728123031      0.209016663544      2.167793135410
O       3.088644460494     -1.834091066937      0.904702509531
H       2.049767162048     -1.772615407330     -1.615862402675
H       0.894083355798      2.029085848192      1.314865181793
H      -1.560340564426     -3.841677251989     -1.168326510004
H       0.122723322881     -3.440656945438     -0.821108247833
H      -0.892802410134     -2.297167794181     -1.699775019654
C       3.454202900414     -2.942119636701      0.106040016185
H       4.012736665493     -2.627433167206     -0.779253461255
H       4.087814860264     -3.567891934808      0.727978204051
H       2.576739943756     -3.514816304885     -0.206537349420
H      -4.298568862234     -1.275414848893      1.827523278853
H      -2.663173608836     -1.193745585533      2.484225791246
H      -3.426295456224     -2.761942422949      2.216477100136
C       0.530853527202      5.759257914607      0.182369550145
H       1.397052948903      6.315970533093     -0.185205035308
H       0.466265269326      5.961036764662      1.254942503899
H      -0.360948233313      6.167357475262     -0.293188297565
H       1.537046054315      3.806057012119      0.333735141396
H      -0.984332369195      4.170015160958     -1.355402814262
H      -0.781160461528      1.923184046737     -2.043366867392`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造 (No.3)"
  backgroundColor="#333333"
/>


#### Step 3

step3のオプションで、追加での説明を要するものを以下に示す。

- `"opt_method": ["rsirfo_block_bofill"]`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なHessianを計算するようにしているので、初期Hessianは正確なHessianを使用するようになっている。(Bofill法によるHessianの更新法を細かい点で変更している。具体的には、複数の座標変位や勾配変位を用いてHessianの更新を行う。)
- `"saddle_order": 1`は一次の鞍点を求めることを指定する。（step3のデフォルトでは一次の鞍点を指定する。それ以外の値の指定は、プログラムの使用目的上想定していないので、行わないことを勧める。）
- `"calc_exact_hess": 5`は5回の反復回数当たり1回正確なHessianを計算することを指定する。
- `"frequency_analysis": true`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `"tight_convergence_criteria": true`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）
- `"max_trust_radius": D`は一回の反復計算ごとの計算されるステップ幅の最大値をDÅ以下にすることを示す。デフォルトでは、`"saddle_order": 1`を指定すると0.1Åが指定される。
- `"detect_negative_eigenvalues": true`は、初めの計算時(ITR. 0)に、任意の次数の鞍点(遷移状態構造等)を求める際に、正確なへシアンから算出した固有値に１つも負の固有値がない場合、計算を打ち切るオプションである。

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`MultiOptPy-v1.19.6b/"work_dir"`ディレクトリ内に生成された新規ディレクトリ内の`bh9_3_38_ts_final_X.xyz`として保存されている。)

`bh9_3_38_ts_final_1.xyz`
```
41
OptimizedStructure
O     -2.398676918088     -0.641187125167     -1.885490208814
C     -2.220804829510     -0.637442964025     -0.732366098339
C     -2.449803705505     -1.703297527038      0.325487967901
C     -1.218746911546     -2.628887019575      0.319440594526
Cl    -2.569172899347      1.559923249310      0.116620567583
C     -0.605457553066      2.074257360681     -0.951974295714
H     -3.322379348538     -2.258819613460     -0.045358803282
C     -2.711331044387     -1.160362895610      1.717793898868
H     -0.351399139704     -2.040842486116      0.630249006862
C     -0.942491679346     -3.333083121021     -1.001616243178
H     -1.390095887189     -3.371178362206      1.103207679675
C      0.348629538613      1.095163761052     -0.465584842066
C     -0.531430683999      3.492012348188     -0.639771447193
C      0.790838344339      1.068093036261      0.868546178048
C      0.813319468573      0.097660470134     -1.321741054516
C      0.505377302379      4.112266765353     -0.072348903556
C      1.674072081149      0.107362305727      1.303830653486
C      2.154540461841     -0.862843118906      0.418873235010
C      1.720428148271     -0.867254621573     -0.900992059616
H      0.470636384781      0.083726176631     -2.350180949124
H      2.005360565703      0.074124420701      2.333439145384
O      3.020755691267     -1.767081856278      0.945765420699
H      2.064818049902     -1.612545524449     -1.602757222307
H      0.399788640787      1.797092184778      1.567316563389
H     -1.815369697724     -3.895814302964     -1.338618558393
H     -0.115566852493     -4.036051464806     -0.890147150969
H     -0.677181507241     -2.627736484942     -1.789110048790
C      3.504565804124     -2.783345561575      0.087667042522
H      4.063149966229     -2.360963722385     -0.751372566088
H      4.167685273260     -3.397166568584      0.690328201066
H      2.686970476347     -3.400027780380     -0.295177553767
H     -3.591470469688     -0.522650244465      1.746304191559
H     -1.859115907015     -0.573911829184      2.061777102967
H     -2.857119622474     -1.998526197712      2.400961103567
C      0.554604976973      5.579556066662      0.206174117459
H      1.393123722868      6.049376497759     -0.313158635756
H      0.700881495840      5.765036038069      1.273135190628
H     -0.365798878448      6.073449694149     -0.103942853845
H      1.386484257045      3.535262328331      0.190272908768
H     -1.395003319833      4.079388854364     -0.938012863660
H     -1.037613795152      1.837268834270     -1.917468410996
```

<MoleculeViewer 
  xyzData={`41
OptimizedStructure
O     -2.398676918088     -0.641187125167     -1.885490208814
C     -2.220804829510     -0.637442964025     -0.732366098339
C     -2.449803705505     -1.703297527038      0.325487967901
C     -1.218746911546     -2.628887019575      0.319440594526
Cl    -2.569172899347      1.559923249310      0.116620567583
C     -0.605457553066      2.074257360681     -0.951974295714
H     -3.322379348538     -2.258819613460     -0.045358803282
C     -2.711331044387     -1.160362895610      1.717793898868
H     -0.351399139704     -2.040842486116      0.630249006862
C     -0.942491679346     -3.333083121021     -1.001616243178
H     -1.390095887189     -3.371178362206      1.103207679675
C      0.348629538613      1.095163761052     -0.465584842066
C     -0.531430683999      3.492012348188     -0.639771447193
C      0.790838344339      1.068093036261      0.868546178048
C      0.813319468573      0.097660470134     -1.321741054516
C      0.505377302379      4.112266765353     -0.072348903556
C      1.674072081149      0.107362305727      1.303830653486
C      2.154540461841     -0.862843118906      0.418873235010
C      1.720428148271     -0.867254621573     -0.900992059616
H      0.470636384781      0.083726176631     -2.350180949124
H      2.005360565703      0.074124420701      2.333439145384
O      3.020755691267     -1.767081856278      0.945765420699
H      2.064818049902     -1.612545524449     -1.602757222307
H      0.399788640787      1.797092184778      1.567316563389
H     -1.815369697724     -3.895814302964     -1.338618558393
H     -0.115566852493     -4.036051464806     -0.890147150969
H     -0.677181507241     -2.627736484942     -1.789110048790
C      3.504565804124     -2.783345561575      0.087667042522
H      4.063149966229     -2.360963722385     -0.751372566088
H      4.167685273260     -3.397166568584      0.690328201066
H      2.686970476347     -3.400027780380     -0.295177553767
H     -3.591470469688     -0.522650244465      1.746304191559
H     -1.859115907015     -0.573911829184      2.061777102967
H     -2.857119622474     -1.998526197712      2.400961103567
C      0.554604976973      5.579556066662      0.206174117459
H      1.393123722868      6.049376497759     -0.313158635756
H      0.700881495840      5.765036038069      1.273135190628
H     -0.365798878448      6.073449694149     -0.103942853845
H      1.386484257045      3.535262328331      0.190272908768
H     -1.395003319833      4.079388854364     -0.938012863660
H     -1.037613795152      1.837268834270     -1.917468410996`}
  caption="遷移状態構造 (No.1)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                    -1450.5433             22.6098             24.2548
Reduced mass [au]                   9.5841              5.2079              3.3329
Force const [Dyne/A]              -11.8813              0.0016              0.0012
Char temp [K]                       0.0000             32.5304             34.8972
Normal mode                   x         y         z            x         y         z            x         y         z     
       O                -0.05267   -0.02139   -0.04010   -0.03601    0.06222   -0.00188   -0.00054   -0.00190    0.00590
       C                 0.16321   -0.05886    0.02693   -0.03286    0.02091   -0.00201    0.02555   -0.00583    0.00196
       C                -0.04894   -0.02129   -0.02669   -0.03405   -0.01481   -0.03910    0.03827   -0.00769    0.00356
       C                -0.01035   -0.00138    0.00301   -0.02105    0.00283   -0.05172    0.00004   -0.05847   -0.06473
      Cl                 0.03748    0.05598   -0.01169    0.01372   -0.00537    0.07598    0.00951   -0.00802    0.00899
       C                -0.12959   -0.04678    0.06778   -0.01496   -0.02865    0.01427    0.00786    0.01476   -0.00037
       H                -0.04990   -0.11516    0.08520   -0.02147   -0.01489   -0.06850   -0.00208    0.03038    0.04142
       C                -0.00003   -0.00533   -0.00492   -0.06186   -0.06119   -0.02619    0.13180   -0.01137    0.02251
       H                -0.02066    0.01375    0.00202   -0.03109    0.00777   -0.03242    0.03220   -0.10467   -0.06748
       C                 0.00414   -0.00271    0.00124   -0.00383    0.03970   -0.06779   -0.06136   -0.02629   -0.09482
       H                 0.02418   -0.02008    0.00069   -0.01529   -0.01895   -0.07111   -0.01026   -0.07739   -0.08488
       C                 0.00919   -0.01817    0.01808   -0.00300   -0.01794    0.01633    0.01001    0.02155    0.00295
       C                -0.00542    0.02139    0.01444   -0.00336   -0.02174   -0.02249   -0.00934    0.01598   -0.00249
       C                 0.00052    0.00209   -0.00305    0.00959    0.00162    0.01218    0.02332    0.03870   -0.00074
       C                -0.00316    0.01231   -0.00084   -0.00178   -0.02241    0.02301   -0.01393   -0.00146    0.01606
       C                -0.00352   -0.00601   -0.01101    0.00876   -0.01338   -0.05319   -0.01047    0.03165   -0.01794
       C                 0.00168    0.00217    0.00321    0.02124    0.01377    0.01536    0.01129    0.03196    0.00772
       C                 0.00358   -0.00306    0.00183    0.02226    0.00848    0.02179   -0.01382    0.00740    0.02056
       C                 0.00541    0.00486   -0.00241    0.01121   -0.00959    0.02562   -0.02497   -0.00829    0.02432
       H                -0.04312   -0.01871    0.01589   -0.00942   -0.03541    0.02563   -0.02464   -0.01446    0.01984
       H                -0.01166   -0.00193    0.00367    0.03105    0.02852    0.01266    0.01948    0.04379    0.00546
       O                -0.00873    0.00971   -0.00423    0.03713    0.02371    0.02386   -0.02741    0.00015    0.02985
       H                -0.01255   -0.00014   -0.00005    0.01264   -0.01346    0.03040   -0.04420   -0.02683    0.03453
       H                -0.01867   -0.02316    0.01393    0.00982    0.00695    0.00680    0.03976    0.05523   -0.00893
       H                -0.00013    0.00634   -0.00281    0.00833    0.02953   -0.08233   -0.09827    0.03539   -0.10204
       H                 0.00278   -0.01341   -0.00036    0.01093    0.05464   -0.08350   -0.09960   -0.07734   -0.13318
       H                -0.01789    0.00152   -0.00175   -0.01722    0.06386   -0.05072   -0.03445   -0.01296   -0.07376
       C                 0.00067   -0.00368   -0.00331    0.04397    0.02221    0.02975   -0.06916   -0.03612    0.04919
       H                 0.00296    0.00082    0.00350    0.03099    0.02180    0.02087   -0.06586   -0.07459    0.03206
       H                -0.00301    0.00542    0.00556    0.05763    0.03727    0.03007   -0.08122   -0.04195    0.05650
       H                -0.00026   -0.00016    0.00511    0.04949    0.00684    0.04266   -0.09344   -0.01967    0.07433
       H                -0.00642   -0.00615    0.00916   -0.06517   -0.06570   -0.02181    0.14745    0.00732    0.07848
       H                 0.00617   -0.00207   -0.01120   -0.07099   -0.06878    0.00894    0.16532   -0.03183   -0.02484
       H                -0.00011    0.01661    0.02639   -0.07153   -0.08423   -0.05655    0.15486   -0.01212    0.02656
       C                -0.00079   -0.00097   -0.00594    0.02219   -0.00645   -0.09248   -0.02681    0.03318   -0.02319
       H                 0.00565   -0.02094   -0.00195    0.01715   -0.02538   -0.11781   -0.04046    0.04291   -0.03639
       H                 0.00570   -0.04380   -0.00454    0.03983    0.02096   -0.09965   -0.01445    0.03840   -0.02582
       H                 0.00247    0.00012   -0.00032    0.02057   -0.00879   -0.09144   -0.03794    0.01942   -0.01198
       H                -0.01821   -0.01787    0.01869    0.00879   -0.01234   -0.05091    0.00097    0.04433   -0.02830
       H                -0.01198   -0.00933    0.01201   -0.00446   -0.02439   -0.02453   -0.02096    0.00320    0.00616
       H                -0.00170   -0.01553   -0.00237   -0.03745   -0.05152    0.02978    0.00378    0.00743    0.00328
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_3_38_ts_final_2.xyz`
```
41
OptimizedStructure
O     -2.385582631449     -0.589325256825     -1.813743060298
C     -2.690595526196     -0.421832399292     -0.682722769372
C     -2.622943894584     -1.465690600505      0.418939199479
C     -1.218376769089     -2.102978973245      0.433084312982
Cl    -3.313472773645      1.195568986281     -0.196779727776
C     -0.106506624984      2.053786276644     -1.250034748110
H     -3.338824720517     -2.228912540480      0.089708827806
C     -3.015199549707     -0.980430359446      1.806987998794
H     -0.468552686452     -1.308932060209      0.476451147066
C     -0.922492041270     -3.049996940226     -0.721800952718
H     -1.137839858038     -2.651235228385      1.374737994575
C      0.745332808299      1.025731175869     -0.706776679435
C     -0.313481074665      3.364830521891     -0.787969761346
C      1.189825760246      0.984898885563      0.629466224272
C      1.126083300676     -0.039969439594     -1.532601164367
C      0.403497560981      4.068866707011      0.132595403127
C      1.990273481225     -0.039011669887      1.088257450163
C      2.382663930415     -1.068066460588      0.232102195613
C      1.941248322777     -1.067871996932     -1.087245807389
H      0.773981838352     -0.055264353948     -2.557394882110
H      2.316966549691     -0.073608985244      2.119446675252
O      3.171817184966     -2.031358156671      0.779063296029
H      2.211406332349     -1.861746502131     -1.768186298821
H      0.864198900852      1.745874161666      1.324483749029
H     -1.667539755022     -3.847672172089     -0.771206066078
H      0.055056065193     -3.514544336096     -0.583166492750
H     -0.918628938313     -2.531249320245     -1.678049952208
C      3.587773456554     -3.089436843610     -0.062774881075
H      4.173575999871     -2.717733217037     -0.907491703168
H      4.208903954123     -3.736800881511      0.549780593735
H      2.733445110587     -3.658630591122     -0.439031739712
H     -4.013471610677     -0.548687635387      1.826755792546
H     -2.311945763140     -0.229637220748      2.169356154445
H     -2.992896481884     -1.826554891755      2.494249150393
C      0.077625339598      5.471476502449      0.524331909230
H      0.910638799996      6.147826096411      0.312893035853
H     -0.120778570127      5.549602530811      1.597281305996
H     -0.801270994046      5.835663538790     -0.008333772993
H      1.287139812863      3.631417174153      0.580917094352
H     -1.131647288387      3.896421303671     -1.269031318383
H     -0.659406957426      1.765215171999     -2.136547732627
```

<MoleculeViewer 
  xyzData={`41
OptimizedStructure
O     -2.385582631449     -0.589325256825     -1.813743060298
C     -2.690595526196     -0.421832399292     -0.682722769372
C     -2.622943894584     -1.465690600505      0.418939199479
C     -1.218376769089     -2.102978973245      0.433084312982
Cl    -3.313472773645      1.195568986281     -0.196779727776
C     -0.106506624984      2.053786276644     -1.250034748110
H     -3.338824720517     -2.228912540480      0.089708827806
C     -3.015199549707     -0.980430359446      1.806987998794
H     -0.468552686452     -1.308932060209      0.476451147066
C     -0.922492041270     -3.049996940226     -0.721800952718
H     -1.137839858038     -2.651235228385      1.374737994575
C      0.745332808299      1.025731175869     -0.706776679435
C     -0.313481074665      3.364830521891     -0.787969761346
C      1.189825760246      0.984898885563      0.629466224272
C      1.126083300676     -0.039969439594     -1.532601164367
C      0.403497560981      4.068866707011      0.132595403127
C      1.990273481225     -0.039011669887      1.088257450163
C      2.382663930415     -1.068066460588      0.232102195613
C      1.941248322777     -1.067871996932     -1.087245807389
H      0.773981838352     -0.055264353948     -2.557394882110
H      2.316966549691     -0.073608985244      2.119446675252
O      3.171817184966     -2.031358156671      0.779063296029
H      2.211406332349     -1.861746502131     -1.768186298821
H      0.864198900852      1.745874161666      1.324483749029
H     -1.667539755022     -3.847672172089     -0.771206066078
H      0.055056065193     -3.514544336096     -0.583166492750
H     -0.918628938313     -2.531249320245     -1.678049952208
C      3.587773456554     -3.089436843610     -0.062774881075
H      4.173575999871     -2.717733217037     -0.907491703168
H      4.208903954123     -3.736800881511      0.549780593735
H      2.733445110587     -3.658630591122     -0.439031739712
H     -4.013471610677     -0.548687635387      1.826755792546
H     -2.311945763140     -0.229637220748      2.169356154445
H     -2.992896481884     -1.826554891755      2.494249150393
C      0.077625339598      5.471476502449      0.524331909230
H      0.910638799996      6.147826096411      0.312893035853
H     -0.120778570127      5.549602530811      1.597281305996
H     -0.801270994046      5.835663538790     -0.008333772993
H      1.287139812863      3.631417174153      0.580917094352
H     -1.131647288387      3.896421303671     -1.269031318383
H     -0.659406957426      1.765215171999     -2.136547732627`}
  caption="遷移状態構造 (No.2)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -30.0458             11.1892             25.8342
Reduced mass [au]                   6.3409              4.2908              4.9675
Force const [Dyne/A]               -0.0034              0.0003              0.0020
Char temp [K]                       0.0000             16.0988             37.1696
Normal mode                   x         y         z            x         y         z            x         y         z     
       O                -0.09240   -0.02184   -0.01574    0.00523   -0.05989   -0.00744    0.05512   -0.00976    0.00783
       C                -0.03357   -0.02061    0.00024   -0.00979   -0.03146   -0.01559    0.02801   -0.02855    0.00328
       C                -0.03538   -0.04080   -0.01977   -0.02652   -0.00556    0.00949    0.01739   -0.04132   -0.00793
       C                -0.01169    0.00935    0.00386   -0.00838    0.03417    0.07415    0.01148   -0.05341   -0.01126
      Cl                 0.08784    0.00799    0.05647   -0.00415   -0.01626   -0.06015   -0.00806   -0.04418    0.00890
       C                 0.01818    0.01284   -0.02550   -0.00005    0.01987    0.02854   -0.02445    0.03867    0.01388
       H                 0.00487   -0.06008   -0.06016    0.00886   -0.03287   -0.00319    0.01018   -0.03106   -0.01658
       C                -0.09428   -0.08639   -0.02137   -0.09540    0.01204   -0.01649    0.01981   -0.05213   -0.00326
       H                -0.03866    0.03412    0.02603   -0.02972    0.05542    0.06051    0.01712   -0.05939   -0.00098
       C                 0.03668    0.03382   -0.00347    0.04252   -0.00346    0.11818    0.00835   -0.04430   -0.01960
       H                -0.01087    0.00171   -0.00063   -0.01743    0.07384    0.09796    0.00476   -0.06364   -0.01667
       C                 0.00692    0.00977   -0.01414    0.00376    0.01429    0.01062   -0.03349    0.02784    0.01089
       C                 0.01593    0.01336   -0.02784    0.00916    0.01852    0.03753    0.02191    0.04967    0.00102
       C                -0.00765    0.00959   -0.00920    0.03183    0.00974    0.00126   -0.03528    0.02297    0.01079
       C                 0.01299    0.00802   -0.00897   -0.02171    0.01195    0.00156   -0.03921    0.02823    0.00866
       C                 0.00463    0.01063   -0.01713    0.02376    0.01410    0.02925    0.06408    0.03760   -0.02156
       C                -0.01443    0.00841   -0.00010    0.03344    0.00303   -0.01663   -0.03950    0.01869    0.00914
       C                -0.00697    0.00725    0.00465    0.00752    0.00090   -0.02590   -0.04249    0.02000    0.00635
       C                 0.00667    0.00702    0.00026   -0.02010    0.00563   -0.01664   -0.04208    0.02464    0.00631
       H                 0.02524    0.00863   -0.01328   -0.04402    0.01519    0.00919   -0.03980    0.03174    0.00886
       H                -0.02530    0.00858    0.00336    0.05517   -0.00031   -0.02363   -0.04053    0.01457    0.00933
       O                -0.01361    0.00651    0.01317    0.01185   -0.00576   -0.04372   -0.04689    0.01513    0.00454
       H                 0.01256    0.00618    0.00358   -0.04075    0.00400   -0.02292   -0.04479    0.02522    0.00456
       H                -0.01388    0.01040   -0.01309    0.05249    0.01122    0.00917   -0.03231    0.02436    0.01105
       H                 0.06695    0.00669   -0.01978    0.06864   -0.02908    0.13835    0.00213   -0.03784   -0.03055
       H                 0.05334    0.07018   -0.00074    0.05515    0.03384    0.15327    0.00366   -0.05444   -0.01983
       H                 0.02520    0.04549    0.00241    0.04175   -0.04153    0.09729    0.01683   -0.03488   -0.01435
       C                -0.00082    0.00908    0.01624   -0.00409   -0.00168   -0.05681   -0.04755    0.01775    0.00103
       H                 0.00769    0.01227    0.02354   -0.01919    0.00263   -0.06539   -0.04543    0.02003    0.00349
       H                -0.00591    0.00994    0.02231    0.00655   -0.00528   -0.07140   -0.04985    0.01404   -0.00054
       H                 0.00540    0.00685    0.00548   -0.01091    0.00056   -0.04460   -0.04790    0.02086   -0.00283
       H                -0.09931   -0.09560   -0.04894   -0.10455   -0.00630   -0.06798    0.02121   -0.04943    0.00162
       H                -0.11639   -0.09100    0.03015   -0.12581    0.03179    0.00118    0.02264   -0.05738    0.00233
       H                -0.11468   -0.10726   -0.04624   -0.10971    0.02454   -0.00059    0.01813   -0.05805   -0.01053
       C                 0.00233    0.01093   -0.02004    0.03125    0.01305    0.03947    0.12265    0.05478   -0.03474
       H                 0.00674    0.00937   -0.00768    0.02886    0.01287    0.02956    0.14293    0.02146   -0.06156
       H                -0.01239    0.01003   -0.02270    0.04734    0.00919    0.04272    0.14753    0.07755   -0.03179
       H                 0.01051    0.01353   -0.03178    0.02371    0.01610    0.05399    0.12507    0.07928   -0.02200
       H                -0.00282    0.00816   -0.00494    0.03025    0.01176    0.01409    0.05696    0.01133   -0.03291
       H                 0.02403    0.01600   -0.03874    0.00276    0.02170    0.05181    0.03030    0.07007    0.00934
       H                 0.02845    0.01482   -0.03263   -0.01315    0.02606    0.03463   -0.04638    0.04109    0.02685
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

`bh9_3_38_ts_final_3.xyz`
```
41
OptimizedStructure
O     -4.312838757822     -1.533656745983     -0.804193882433
C     -3.210500785922     -1.336645542787     -0.427437254750
C     -2.458653313355     -2.096270282423      0.640976282312
C     -1.187582947109     -2.736286449596      0.078537572127
Cl    -2.251690951913      0.007191136723     -1.149719164543
C      0.496448618960      2.683159682800     -1.478428163354
H     -3.156469776797     -2.881621958477      0.943972581324
C     -2.152053245016     -1.188385659873      1.831470062526
H     -0.488362496970     -1.942684128498     -0.191813903783
C     -1.445407977124     -3.643241253827     -1.117067406862
H     -0.723379696930     -3.300483520212      0.892020793578
C      0.980633003976      1.516217351788     -0.785881494979
C      0.298201686115      3.988510505354     -0.994637978248
C      0.948927106824      1.351468281484      0.612363309235
C      1.458385342971      0.436091984705     -1.538126578976
C      0.728819428492      4.542622883144      0.173723661915
C      1.390361678024      0.190597205006      1.208233089676
C      1.878385513433     -0.861065713894      0.433397184081
C      1.910489562546     -0.735010474357     -0.951796213002
H      1.475898422812      0.520463374799     -2.618463013436
H      1.345768568026      0.061964324328      2.282087539671
O      2.264658148963     -1.973783387849      1.114106487789
H      2.270426568310     -1.537427642691     -1.579260411943
H      0.523488653059      2.126526229177      1.233526403437
H     -2.157226480910     -4.433419263627     -0.870464475804
H     -0.523321555203     -4.117514478448     -1.455188481998
H     -1.851536763012     -3.081260011162     -1.960763137972
C      2.703834532585     -3.082384898267      0.352931258635
H      3.593237091216     -2.836304212164     -0.232786821800
H      2.948655969811     -3.862827120430      1.067957763877
H      1.916878607594     -3.438623204004     -0.317975990270
H     -3.056920391009     -0.728411890574      2.229835320508
H     -1.455327459541     -0.401201581497      1.543388328984
H     -1.690995930062     -1.779702514920      2.623225376129
C      0.455015848595      5.958165025563      0.557687297170
H      1.383300080046      6.516270002540      0.708191493741
H     -0.097400160004      6.014941945330      1.500107991258
H     -0.130344243759      6.468858074382     -0.207333139992
H      1.343206137985      3.965139681583      0.853216860636
H     -0.229657970346      4.654439724457     -1.673786572398
H      0.264650332460      2.525584522398     -2.525832572069
```

<MoleculeViewer 
  xyzData={`41
OptimizedStructure
O     -4.312838757822     -1.533656745983     -0.804193882433
C     -3.210500785922     -1.336645542787     -0.427437254750
C     -2.458653313355     -2.096270282423      0.640976282312
C     -1.187582947109     -2.736286449596      0.078537572127
Cl    -2.251690951913      0.007191136723     -1.149719164543
C      0.496448618960      2.683159682800     -1.478428163354
H     -3.156469776797     -2.881621958477      0.943972581324
C     -2.152053245016     -1.188385659873      1.831470062526
H     -0.488362496970     -1.942684128498     -0.191813903783
C     -1.445407977124     -3.643241253827     -1.117067406862
H     -0.723379696930     -3.300483520212      0.892020793578
C      0.980633003976      1.516217351788     -0.785881494979
C      0.298201686115      3.988510505354     -0.994637978248
C      0.948927106824      1.351468281484      0.612363309235
C      1.458385342971      0.436091984705     -1.538126578976
C      0.728819428492      4.542622883144      0.173723661915
C      1.390361678024      0.190597205006      1.208233089676
C      1.878385513433     -0.861065713894      0.433397184081
C      1.910489562546     -0.735010474357     -0.951796213002
H      1.475898422812      0.520463374799     -2.618463013436
H      1.345768568026      0.061964324328      2.282087539671
O      2.264658148963     -1.973783387849      1.114106487789
H      2.270426568310     -1.537427642691     -1.579260411943
H      0.523488653059      2.126526229177      1.233526403437
H     -2.157226480910     -4.433419263627     -0.870464475804
H     -0.523321555203     -4.117514478448     -1.455188481998
H     -1.851536763012     -3.081260011162     -1.960763137972
C      2.703834532585     -3.082384898267      0.352931258635
H      3.593237091216     -2.836304212164     -0.232786821800
H      2.948655969811     -3.862827120430      1.067957763877
H      1.916878607594     -3.438623204004     -0.317975990270
H     -3.056920391009     -0.728411890574      2.229835320508
H     -1.455327459541     -0.401201581497      1.543388328984
H     -1.690995930062     -1.779702514920      2.623225376129
C      0.455015848595      5.958165025563      0.557687297170
H      1.383300080046      6.516270002540      0.708191493741
H     -0.097400160004      6.014941945330      1.500107991258
H     -0.130344243759      6.468858074382     -0.207333139992
H      1.343206137985      3.965139681583      0.853216860636
H     -0.229657970346      4.654439724457     -1.673786572398
H      0.264650332460      2.525584522398     -2.525832572069`}
  caption="遷移状態構造 (No.3)"
  backgroundColor="#333333"
/>


停留点に収束した構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                      -12.4118              8.9904             21.1191
Reduced mass [au]                   5.8715              4.8265              5.2727
Force const [Dyne/A]               -0.0005              0.0002              0.0014
Char temp [K]                       0.0000             12.9352             30.3857
Normal mode                   x         y         z            x         y         z            x         y         z     
       O                -0.01689    0.00198   -0.00448   -0.00098    0.03131    0.01550   -0.02613   -0.07342    0.01463
       C                -0.02044    0.02842   -0.00810    0.00126    0.01438    0.01800   -0.02564   -0.04186   -0.00365
       C                -0.00167    0.05273   -0.00408    0.00839   -0.03670   -0.02326    0.01609   -0.02314   -0.01987
       C                 0.00999    0.07503   -0.00298    0.00690   -0.00649   -0.06080    0.02277    0.01381   -0.04658
      Cl                -0.05093    0.04399   -0.02066   -0.00480    0.04996    0.07702   -0.07835   -0.01008   -0.01645
       C                -0.02632   -0.05110    0.00983    0.01557   -0.01936   -0.02687   -0.03248    0.00204    0.01685
       H                 0.01535    0.04084    0.00433    0.01146   -0.05277   -0.05787    0.04363   -0.04308   -0.00814
       C                -0.01662    0.06847   -0.01222    0.01329   -0.09437    0.01949    0.01526   -0.01789   -0.02370
       H                -0.00803    0.08728   -0.01311    0.00445    0.00807   -0.02423   -0.00472    0.03409   -0.05771
       C                 0.02535    0.05825    0.00647    0.00428    0.05274   -0.10511    0.02587    0.00991   -0.04427
       H                 0.02568    0.09274    0.00044    0.01092   -0.04635   -0.09065    0.05421    0.02471   -0.05683
       C                -0.00135   -0.04176    0.00853    0.00953   -0.01274   -0.01162   -0.02438    0.00394    0.01658
       C                -0.03911   -0.05261    0.00810    0.00197   -0.01696   -0.03874    0.01505    0.01150    0.00890
       C                 0.01206   -0.03902    0.00901   -0.01065   -0.00341   -0.01095   -0.00390    0.01583    0.01802
       C                 0.01122   -0.03533    0.00735    0.02371   -0.01646    0.00267   -0.03374   -0.00075    0.01819
       C                -0.03382   -0.04376    0.00212   -0.01882   -0.00695   -0.03590    0.07399    0.01151   -0.01231
       C                 0.03601   -0.03032    0.00850   -0.01654    0.00172    0.00329    0.00781    0.02188    0.02168
       C                 0.04812   -0.02370    0.00729   -0.00256   -0.00233    0.01754    0.00111    0.01777    0.02326
       C                 0.03614   -0.02606    0.00676    0.01811   -0.01137    0.01720   -0.01929    0.00643    0.02179
       H                 0.00153   -0.03755    0.00702    0.03972   -0.02352    0.00238   -0.04996   -0.00969    0.01723
       H                 0.04504   -0.02902    0.00902   -0.03190    0.00884    0.00351    0.02306    0.03050    0.02331
       O                 0.07053   -0.01617    0.00666   -0.01067    0.00282    0.03058    0.01522    0.02464    0.02665
       H                 0.04504   -0.02140    0.00592    0.02972   -0.01456    0.02794   -0.02521    0.00255    0.02332
       H                 0.00362   -0.04456    0.01028   -0.02231   -0.00063   -0.02246    0.00403    0.02156    0.01672
       H                 0.04499    0.04375    0.01673    0.00777    0.03816   -0.14176    0.05441   -0.01220   -0.03276
       H                 0.03503    0.07713    0.00639    0.00445    0.07292   -0.13297    0.03345    0.03883   -0.06425
       H                 0.00834    0.04113    0.00323   -0.00099    0.09400   -0.07508   -0.00767    0.00045   -0.03443
       C                 0.07524   -0.01354    0.00549    0.00437   -0.00073    0.04445    0.01815    0.02371    0.02972
       H                 0.06681   -0.00570   -0.00400    0.01293   -0.00192    0.05695    0.00901    0.02889    0.01800
       H                 0.09081   -0.00878    0.00532   -0.00471    0.00444    0.05321    0.03430    0.03144    0.03262
       H                 0.07240   -0.02394    0.01434    0.01594   -0.00718    0.03428    0.01447    0.01042    0.04110
       H                -0.02438    0.05514   -0.01447    0.01478   -0.11530    0.04700    0.01101   -0.04237   -0.00509
       H                -0.03134    0.07867   -0.01989    0.01028   -0.07913    0.05376   -0.01045    0.00079   -0.03489
       H                -0.00442    0.08350   -0.00809    0.01890   -0.13209   -0.01196    0.04602   -0.00785   -0.03411
       C                -0.04808   -0.04630    0.00119   -0.03182   -0.00570   -0.04979    0.12906    0.02302   -0.01586
       H                -0.05368   -0.03387   -0.01034   -0.03694   -0.00014   -0.03882    0.15095   -0.00187   -0.05845
       H                -0.03863   -0.05083    0.00701   -0.04706   -0.00208   -0.05894    0.16823    0.04845    0.00557
       H                -0.06293   -0.05597    0.00610   -0.02221   -0.01374   -0.06251    0.11330    0.03194    0.00215
       H                -0.01895   -0.03400   -0.00299   -0.02663    0.00068   -0.02236    0.08300   -0.00006   -0.03009
       H                -0.05533   -0.06158    0.01193    0.00929   -0.02411   -0.05144    0.00682    0.01779    0.02153
       H                -0.03574   -0.05788    0.01292    0.03259   -0.02739   -0.02942   -0.07181   -0.00679    0.02691
       
(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。


次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、求められた遷移状態構造の中に、想定される反応系と生成系をつなぐ方向に振動している構造が存在することを確認できた。


## 終わりに
　
　自作ライブラリで、UMAモデルのニューラルネットワークポテンシャル(NNP, `uma-s-1p1`)を用いて、BH9データセットの3. Halogen atom transfer, No. 38の反応のある1つの遷移状態構造を算出する手順を説明した。



## 参考
- https://github.com/ss0832/MultiOptPy (自作ライブラリMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- arXiv preprint arXiv:2505.08762 (2025). (プレプリント)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.
- _J. Phys. Chem. A_ 2019, 123, 3761−3781 http://dx.doi.org/10.1021/acs.jpca.9b01546 (MOBH35のデータセットについて)

