---
title:  【計算化学】自作pythonモジュールで遷移状態構造を求めてみる(SN2反応（基質-fluoromethane, 求核剤-3-methyl-2,4-pentanedione）, NNP使用）
published: 2025-08-19
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-08-19

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作モジュール(MultiOptPy)で、SN2反応（基質-fluoromethane, 求核剤-3-methyl-2,4-pentanedione）の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonモジュールである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

SN2反応について：
- https://en.wikipedia.org/wiki/SN2_reaction

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)



## 使用した自作モジュールMultiOptPyのバージョン
```
v1.12c
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.12c.zip
unzip v1.12c.zip
cd MultiOptPy-v1.12c
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作モジュールへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.12c`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.12c`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作モジュールでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`sn2_F_beta_methyl_diketone.xyz`とした。
初期構造は以下のものを使用した。

```
22
OptimizedStructure
C     -0.138626821531     -0.407816462800      0.078435775876
C      1.345171928429     -0.547793173107      0.214044962652
C     -0.846563145142      0.424050451543      1.096540648468
C      1.889156494450     -1.831194209991      0.798019537469
H      1.934737329746     -1.701040559110      1.884092362677
C      0.186970951119      2.533453875193     -2.129538718637
C     -0.925806334469     -0.970801962523     -1.051311290858
F      0.472406437989      3.347336312785     -3.223742498931
H      1.247895072006     -2.685863969758      0.588170577732
H      2.900483140226     -2.008622785677      0.438839060908
C     -1.400424039376     -0.306049223873      2.299251731480
H     -2.379394160564     -0.717156014870      2.030660916530
H     -0.759238397293     -1.142806071334      2.583274400590
H     -1.523680683629      0.383790702393      3.130663515751
O      2.074991931022      0.372402279656     -0.067607285958
O     -0.980478035329      1.612797174958      0.935523541520
H      0.627887230365      1.550422351067     -2.299495478574
H      0.614324360055      2.975898924826     -1.232090274627
H     -0.896025724593      2.459518872596     -2.026842035128
H     -1.557690470705     -1.806331112702     -0.728697803734
H     -1.598298596765     -0.211629117792     -1.459584724175
H     -0.287798466012     -1.322566281483     -1.858606921030

```

<MoleculeViewer 
  xyzData={`22
OptimizedStructure
C     -0.138626821531     -0.407816462800      0.078435775876
C      1.345171928429     -0.547793173107      0.214044962652
C     -0.846563145142      0.424050451543      1.096540648468
C      1.889156494450     -1.831194209991      0.798019537469
H      1.934737329746     -1.701040559110      1.884092362677
C      0.186970951119      2.533453875193     -2.129538718637
C     -0.925806334469     -0.970801962523     -1.051311290858
F      0.472406437989      3.347336312785     -3.223742498931
H      1.247895072006     -2.685863969758      0.588170577732
H      2.900483140226     -2.008622785677      0.438839060908
C     -1.400424039376     -0.306049223873      2.299251731480
H     -2.379394160564     -0.717156014870      2.030660916530
H     -0.759238397293     -1.142806071334      2.583274400590
H     -1.523680683629      0.383790702393      3.130663515751
O      2.074991931022      0.372402279656     -0.067607285958
O     -0.980478035329      1.612797174958      0.935523541520
H      0.627887230365      1.550422351067     -2.299495478574
H      0.614324360055      2.975898924826     -1.232090274627
H     -0.896025724593      2.459518872596     -2.026842035128
H     -1.557690470705     -1.806331112702     -0.728697803734
H     -1.598298596765     -0.211629117792     -1.459584724175
H     -0.287798466012     -1.322566281483     -1.858606921030
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`sn2_F_beta_methyl_diketone.xyz`として保存し、以下を実行する。
```
python .\optmain.py sn2_F_beta_methyl_diketone.xyz -opt rsirfo_fsb -os uma-s-1p1 -ma 300 1 6 -elec -1   
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。

これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`sn2_F_beta_methyl_diketone_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.12c`ディレクトリに置く。

`sn2_F_beta_methyl_diketone_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`sn2_F_beta_methyl_diketone_traj.xyz`は次のNEB計算に使用する。

※`sn2_F_beta_methyl_diketone_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`sn2_F_beta_methyl_diketone_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `sn2_F_beta_methyl_diketone_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`sn2_F_beta_methyl_diketone_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py sn2_F_beta_methyl_diketone_traj.xyz -os uma-s-1p1 -ns 20 -modelhess -spng -nd 0.12 -elec -1
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.12c`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-524.2021020322433,-524.2021020322433,-524.2086135826612,-524.2031172043178,-524.2003063668774,-524.200521973591,-524.1968226453756,-524.191281821438,-524.1830269337828,-524.1810418658115,-524.184853462848,-524.1866439330627,-524.1894206901582,-524.1912726019202,-524.194866589643,-524.196089103393,-524.1954817728629,-524.1963591285895,-524.1979318865402,-524.1966472303053,-524.1935325096521,-524.1911460279517,-524.19084068427,-524.1906133877818,-524.1904120303598,-524.1917659030715,-524.1958836925811,-524.1996841699023,-524.2063909030584,-524.1943399632974,-524.2079331205352,-524.2326460454191,-524.2461881392276,-524.25248069776,-524.2570490925691,-524.260785461495,-524.2637200193219,-524.2654019449932,-524.2679515085506,-524.269405414892,-524.2705116869295,-524.2708911919826,-524.2718048288882,-524.2722414252959,-524.272896920085,-524.2730867646096,-524.2733829763907,-524.2737289722535,-524.2740614049768,-524.274417949948,-524.274733179038,-524.2750871130172,-524.2754171494106,-524.275778285522,-524.2761466807168,-524.2765717992739,-524.2769749040145,-524.2774780938598,-524.277916630988,-524.2784689258817,-524.2789471316881,-524.2794549477205,-524.2799197086707,-524.2804264207266,-524.2796842594039,-524.2808056892134,-524.2816803364739,-524.282093306909,-524.2825689017235,-524.2832717229323,-524.2837811204548,-524.2841691594214,-524.2848730232747,-524.2855758357219,-524.2861959287895,-524.2874532966537,-524.2881908493127,-524.2889740943311,-524.2896948332534,-524.29044109506,-524.2916243650752,-524.2924412025204,-524.2932303354132,-524.2941111859701,-524.295055506412,-524.2956940166109,-524.2963362330164,-524.2968967726869,-524.2973735415715,-524.2979521479044,-524.2985982720362,-524.2992063790736,-524.2998165889232,-524.3003685946803,-524.3008338331441,-524.3013862244168,-524.3019045588916,-524.302539415454,-524.3030905625628,-524.3037196013445,-524.3042177838679,-524.304884962408,-524.3054039890585,-524.306218986543,-524.3071239581094,-524.3076979032083,-524.3085589960912,-524.3093761664816,-524.3101376123456,-524.3110032350365,-524.311855794006,-524.3127845886837,-524.3135461659734,-524.3144184738552,-524.3150257660528,-524.3158274544876,-524.3165397208286,-524.3169810135171,-524.3172860790141,-524.3177609203209,-524.3182474322359,-524.3185917239446,-524.3190957592956,-524.3192757512684,-524.3195123001308
];

export const dataset1_itr5 = [-524.2232464305463,-524.2112180845178,-524.2139982660759,-524.2129147687555,-524.2127827362366,-524.2125024527112,-524.210060066253,-524.2064827368151,-524.2000341140142,-524.1975551239047,-524.2005395977867,-524.2015226181895,-524.2047512170819,-524.20608315319,-524.2108883766888,-524.2093908369576,-524.208778883218,-524.2093864835132,-524.2109718465643,-524.209039615928,-524.2064522958688,-524.2036459641419,-524.2015945464182,-524.2017233590057,-524.2061577233504,-524.2134643538142,-524.2217627628393,-524.223950745628,-524.2338291730563,-524.224203086392,-524.225968185957,-524.2464575072952,-524.2566953863945,-524.2620509383291,-524.2647053840318,-524.2680417060566,-524.2707294287642,-524.2719619965856,-524.2735708977183,-524.274798081464,-524.2756565984017,-524.2761813508349,-524.2765810428864,-524.2763401569736,-524.2772954602291,-524.2779071026197,-524.2784199259739,-524.2788466829722,-524.2792515970076,-524.2796487262566,-524.2800312190556,-524.2803831553631,-524.2807631510725,-524.2811464981392,-524.2815711435634,-524.2820211103527,-524.2824728119622,-524.2829603051897,-524.2834412008435,-524.283957712881,-524.2844664007043,-524.2849949513424,-524.2855026841384,-524.2859764389921,-524.2859003960416,-524.2871380062317,-524.2874737990738,-524.2881031094688,-524.2885888853996,-524.2895387870559,-524.2893014671623,-524.29011617551,-524.2915691136815,-524.2914138910855,-524.292619056634,-524.2937467247867,-524.2945373208864,-524.2950957577445,-524.2946323329564,-524.2965881586939,-524.2974708579733,-524.2980600046529,-524.2987258076033,-524.2993514731236,-524.2997407913009,-524.3003558901893,-524.3007933101984,-524.302000955313,-524.3025667257291,-524.3031175837011,-524.3039370671851,-524.3047966618141,-524.304504581183,-524.3057948843451,-524.306106047998,-524.306569227458,-524.3070962973657,-524.3080697067114,-524.3087135790817,-524.3096130044806,-524.3100095773606,-524.3111687351277,-524.3117415850119,-524.3123578579705,-524.3130010644502,-524.3129178806995,-524.3139996724968,-524.3155099385892,-524.3163964842628,-524.3166849024957,-524.3178326963147,-524.3181884220652,-524.319032087891,-524.3193338151734,-524.3204117518148,-524.3211615621174,-524.3211617461135,-524.3212750176037,-524.3218377827504,-524.322980617437,-524.3231760300334,-524.3229192416024,-524.323789350293,-524.3239972658611,-524.3239377212255
];

export const dataset1_itr10 = [-524.2391250795956,-524.217627132829,-524.2197177844307,-524.2215663842634,-524.2200435768669,-524.2201993207851,-524.2182336654952,-524.2165981030022,-524.2123070403886,-524.2119280258547,-524.2128460418395,-524.2136103396427,-524.2193730776357,-524.2167057177082,-524.2207245627794,-524.2196220626615,-524.2197883633547,-524.2217913052308,-524.221854999635,-524.2196773425309,-524.2179438267688,-524.215746333135,-524.2121744317867,-524.2104838167501,-524.2275285000777,-524.2371743663205,-524.247231946787,-524.2433747055807,-524.2528089818098,-524.2522234099112,-524.2485403735628,-524.2578739645097,-524.2641225151231,-524.2681622585344,-524.2694804896727,-524.2711090126728,-524.2736296669417,-524.2739636942977,-524.2755156705487,-524.2760853924995,-524.2765407959348,-524.2771833803325,-524.2774263822002,-524.2775533175896,-524.2782574180094,-524.2787268796212,-524.279264415401,-524.2797290624488,-524.2801643139328,-524.280597256704,-524.2810298621491,-524.2814477347655,-524.2818793107087,-524.2823118635835,-524.2827673765403,-524.283238086697,-524.2837213042061,-524.2842281871154,-524.2847485630706,-524.2852978088865,-524.2858630097909,-524.2864678048988,-524.2870309993698,-524.2877745099971,-524.2873595900797,-524.2889547134109,-524.28936423611,-524.2901548760184,-524.2908005708259,-524.2916528494204,-524.2912172430869,-524.2929750890446,-524.2938058138128,-524.292936116923,-524.2948439196842,-524.2956741450345,-524.2963390455279,-524.2965779250073,-524.2953462903089,-524.2980674083046,-524.2985667473748,-524.2991460809303,-524.2996894388717,-524.3001942803008,-524.3004772312217,-524.3013335139213,-524.3020485489651,-524.3028778893819,-524.3035270976384,-524.304158502084,-524.3049671210376,-524.3057510932786,-524.305068923439,-524.3073280272832,-524.3079510555264,-524.3086846654123,-524.3094214733253,-524.3102055419452,-524.3107453864377,-524.3116317305917,-524.312275664294,-524.3132289392117,-524.3138575661927,-524.3140978913556,-524.314760180857,-524.3142782776056,-524.3162202685904,-524.3173910093489,-524.3182162843284,-524.3185585958888,-524.3196841261823,-524.3197680722025,-524.3204765184342,-524.3210777913316,-524.3217001712077,-524.3223004452692,-524.3227509377615,-524.3223546803035,-524.3231079777698,-524.3236421446691,-524.3237004801874,-524.3233064920145,-524.3240883263962,-524.3242130319284,-524.3242963295813
];

export const dataset1_itr15 = [-524.2509618101371,-524.222632484919,-524.224763823201,-524.2266855231421,-524.2256589783576,-524.2260536806108,-524.2240058327395,-524.2227647923368,-524.2197755000575,-524.2207711466435,-524.2200119142085,-524.2252406972262,-524.227326323435,-524.2243956065262,-524.2273759640435,-524.226468207346,-524.2265609150841,-524.2285171361941,-524.2291052511815,-524.2271239102259,-524.2263755488925,-524.2249930636954,-524.2229362503962,-524.2246251230147,-524.2501431414929,-524.2547397840808,-524.26075957938,-524.2562337928055,-524.2613093333755,-524.2631986532926,-524.262020057654,-524.2650496538361,-524.26858400383,-524.2712838264703,-524.2727502357832,-524.272963005343,-524.275172062254,-524.2753716366665,-524.2766478728904,-524.2767618234138,-524.2770125093082,-524.2777516872659,-524.2779288579654,-524.2782681642565,-524.2788887479803,-524.2793447691167,-524.2798809994006,-524.280357404674,-524.2808181001869,-524.2812793082604,-524.2817432762752,-524.282195867199,-524.2826535136342,-524.283119216469,-524.2835941892014,-524.2840849855966,-524.2845937084668,-524.2851215406439,-524.2856834383806,-524.2862743461656,-524.2869009579514,-524.2875697486476,-524.2881884047935,-524.2890250700065,-524.2881685682639,-524.2902752532618,-524.2907001002058,-524.2916002265422,-524.2922692888516,-524.2931644648173,-524.2921227315948,-524.2944917687146,-524.2952188160738,-524.293445935008,-524.2961895881424,-524.2968378764185,-524.2973699317437,-524.2975589920945,-524.2956401495687,-524.2989144736769,-524.2992555060264,-524.2997469157418,-524.3002343301138,-524.3006919809299,-524.3010041258951,-524.3018942551113,-524.3025746550838,-524.3034299915179,-524.304157783623,-524.3048717146904,-524.3057027636421,-524.3065157722166,-524.3053628966012,-524.3081515411575,-524.308875968763,-524.3096871636618,-524.3104328559568,-524.3112674709278,-524.3119795970812,-524.3128889495067,-524.3138091664625,-524.3147237846805,-524.3152751946408,-524.3149020505948,-524.3162150816534,-524.3147305136799,-524.3177534553371,-524.3187042594504,-524.3194366865044,-524.3195490993463,-524.3209119057249,-524.3209732815594,-524.3214077225845,-524.322164989109,-524.322472884641,-524.3230484681812,-524.3233988317603,-524.322617601937,-524.3236216685341,-524.3238990645258,-524.3239932354708,-524.3234067435917,-524.3241672256668,-524.324291615777,-524.3241179322413
];

export const dataset2 = [-524.2602024217327,-524.2272621843737,-524.2294532074786,-524.2312045872885,-524.2308554700637,-524.2313701749969,-524.2294973972033,-524.2276201399815,-524.2260644345243,-524.2273433737382,-524.2273251614122,-524.2329430786112,-524.2327599061348,-524.2309248650607,-524.2326397063161,-524.2317553488816,-524.2318592300006,-524.2337171238257,-524.2353911201423,-524.2327816702424,-524.2325867461117,-524.232055448675,-524.2310788610162,-524.243474315362,-524.2633025103169,-524.2645664012801,-524.2673531314011,-524.2648410460923,-524.2674504697071,-524.2684171719577,-524.2679436098618,-524.2691684454671,-524.2716684045582,-524.273696707227,-524.2742339363466,-524.2746053368107,-524.2760876048333,-524.2761200845218,-524.2773007347834,-524.2773786483606,-524.27751512088,-524.2783828639068,-524.2784742354829,-524.2788731214563,-524.2794483107192,-524.2799041303361,-524.2804352174915,-524.2809197930669,-524.2813995409357,-524.2818832271967,-524.2823723676271,-524.2828514014159,-524.2833309170991,-524.2838207058967,-524.2843102318428,-524.2848218460799,-524.2853553120417,-524.2859113569508,-524.2865217157497,-524.28716104955,-524.2878501148617,-524.2885741306665,-524.2892527082016,-524.290161815299,-524.2888788982651,-524.2914668994794,-524.2917615472938,-524.2928363034316,-524.2933383673961,-524.294374160174,-524.2926179964661,-524.2955441123777,-524.296180808901,-524.293562316908,-524.2971221328354,-524.2975052126695,-524.297996745049,-524.2981873649857,-524.2958232607131,-524.2993529363305,-524.2997296726808,-524.3001548613316,-524.3006290805563,-524.3010741057367,-524.3013954680293,-524.3023747126792,-524.3029863769741,-524.3038975080283,-524.3046726835045,-524.3054349880168,-524.3062869249043,-524.3071411398384,-524.3055010075619,-524.3088229428457,-524.3095915820802,-524.3104457181588,-524.3112397400904,-524.3120803217913,-524.3129021358923,-524.3139113018092,-524.3150400126063,-524.3159401564661,-524.3164488004809,-524.3152397534915,-524.3175817607113,-524.3148700966093,-524.3190154844353,-524.3197528092896,-524.3204241934544,-524.320506632459,-524.3217411322393,-524.3218816439107,-524.3221121033791,-524.3229509940685,-524.3230170574221,-524.3235666186599,-524.3237555651085,-524.3227115187923,-524.3238466869757,-524.3240048359854,-524.3241336770485,-524.3234480638538,-524.3242297755714,-524.3243211427667,-524.324412571294
];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.01309886876740248,0.013098869138177949,0.007201779153869897,0.013516783694361156,0.013077327411541106,0.011490600054954319,0.011915667422244487,0.012726636752458524,0.01420259867529318,0.013842018806530021,0.013150806652475354,0.013411985054035222,0.012912341374939146,0.012550377352048935,0.011556659490407958,0.011122908292527548,0.011074078238282171,0.010720555568387913,0.010142981795782123,0.010089785579359566,0.010299120359599493,0.010238173442285873,0.009645759874211637,0.00991028881024222,0.011152981593647738,0.013221616461359638,0.01564447076174856,0.017105664671433842,0.017633394239439687,0.029400959601929743,0.024890397382060194,0.012997967425214828,0.011494764732470065,0.012824547306070968,0.012588568893450542,0.01095138028815412,0.010455331792450203,0.01083907126866656,0.010422103334732079,0.010153210136676234,0.010041526599061908,0.010177828053407424,0.009968684123728321,0.010242855793491724,0.01000457492887712,0.010071152016376355,0.010114660273453868,0.010134102566437571,0.010149953089038908,0.010150115930162787,0.010158900312033273,0.010151686447321544,0.01015738660687225,0.010163923974242955,0.010180216141107305,0.010190839873270326,0.010223139968817506,0.010227556805300434,0.010267244858012592,0.0102616685233281,0.01029122119986667,0.010305649193817552,0.010337182896139507,0.010419402237857965,0.01186533979588683,0.010863407557440858,0.010381009569705332,0.010355015241893382,0.010303535661479199,0.01033935336893188,0.01041685351375471,0.010548685675861737,0.010624146675542692,0.01057597119592267,0.010507162936986284,0.010466842435480633,0.010473111012688796,0.010441078037427103,0.010538047661848337,0.01049389203825553,0.010279973112181774,0.010101308651302156,0.010181242660375083,0.010241241139523101,0.010066449717811399,0.010038270069799828,0.010102826935701824,0.010140962444534635,0.010159424385157973,0.010206264248099353,0.010297726864795683,0.010402226479764498,0.01042215502206908,0.010440856546697271,0.01048433634075871,0.01046706581046621,0.010472869115488274,0.010490828890160418,0.01050185922076441,0.010424105468211105,0.010385055673948918,0.010353954369239674,0.010326592034962657,0.010262948120662614,0.010265214861976858,0.01023484465834326,0.010305046900855402,0.010356253107617026,0.010445567160077766,0.010474722353537596,0.010417147879173689,0.010273263344369685,0.010129059479194876,0.010049183358812976,0.010225538784318273,0.010144402942775526,0.010005938880246524,0.009963755091617465,0.010136464405426517,0.01021413969622447,0.010075373181738654,0.010103495248263997,0.009997157872731036,0.010108657137687299,0.010032305270431573
];

export const dataset1_grad_itr5 = [0.006858789883234834,0.0064852441046618975,0.0059771189038649265,0.008568975413273948,0.0068339307357307075,0.006898093308682898,0.007593887403262056,0.008601880877499642,0.010410834684640208,0.011618903577383021,0.011110637406959747,0.010556632600474522,0.009849599142840537,0.009472381252957482,0.008018374199008759,0.0083515345042006,0.008481391955634394,0.008476326766871262,0.008056198012238815,0.008050118966358405,0.008477608697227782,0.008348601604891889,0.0070792373470398625,0.006048965314303406,0.009032726923457609,0.011525612735205212,0.012442069668209346,0.013051558245791234,0.012697523648729054,0.022445664564706227,0.02074847323635387,0.01017547992347886,0.008275601532147688,0.008803807336105137,0.0074397551164656454,0.0037710776032961334,0.0037043825782601355,0.00320715854216203,0.0037321893276143206,0.0024128594976753352,0.0018502465735789832,0.0019523142682161155,0.002254859737397215,0.004438759531685621,0.002913793462724511,0.0019711301233417636,0.001545646043664084,0.0015629057895177832,0.0016161948619606626,0.0017084432175862435,0.0018028197947275216,0.0020307961922053455,0.0020877284087526373,0.0021646428983081536,0.0021234319215614776,0.002082072715580564,0.002089103685275281,0.0021105749568380364,0.0021617863501326496,0.002235398014147317,0.002323841774316835,0.002405396334993903,0.0025187487172591123,0.0029938721766832556,0.0034627621760887654,0.0026903992954075456,0.0029484273270114466,0.0024758170462499717,0.0025710893264987854,0.002049836861857647,0.004175415158638724,0.004247336995878253,0.002568771251175951,0.003922645165911429,0.003087192850675284,0.0022695056142399547,0.002036057506417595,0.002100937777720637,0.004120672788109842,0.002185268183022854,0.001933831218090217,0.0019258793637938832,0.0017062841217600256,0.0018574872478344282,0.0023987013516000326,0.002727283567348604,0.003619003231650091,0.0017942445081201284,0.0021315741595463937,0.0026167137188522786,0.002322908192939975,0.0018954978097847095,0.003663278681724574,0.0033926237492305426,0.00424780646665352,0.004604985528008069,0.004735237038026623,0.004043823762916414,0.003977428678508281,0.003188674173061053,0.003739145475309326,0.0024025982960743865,0.002529447389712828,0.0022866361352262706,0.0023972868455200505,0.003959758483667602,0.0032882428385519443,0.0019449117985605453,0.0021210286553005353,0.003732591116898809,0.0028687294364281826,0.00335489007505468,0.0022815214581451294,0.0036185238467533482,0.0018411541391490872,0.0015187019613867433,0.0036390754193310923,0.004381694333135699,0.003781491744017977,0.0012540007340843945,0.0012264775929890777,0.002741877031773031,0.0011822779340136562,0.001112784819394779,0.0015840322656433432
];

export const dataset1_grad_itr10 = [0.00530123911249543,0.004571692574025419,0.005062285453692486,0.0051784771059247975,0.004757501364387255,0.005043517493464224,0.00582539482413583,0.006446603874065163,0.0077083080287623775,0.00891948524882489,0.009060218648052483,0.008505080082213573,0.007145754570255844,0.007797863558268391,0.006555921661162344,0.007090927558823708,0.007091131826532419,0.006650692991464519,0.0066581276439684305,0.006679983649282863,0.007108385453923217,0.007603148957287578,0.007412097919987608,0.005490168863186862,0.010570938497055005,0.010476555828230774,0.008691659659330978,0.010926008930383627,0.008573760891398793,0.009656762604533771,0.012085307956463932,0.007536947486942713,0.006188181734324934,0.0063466698536055995,0.004428488113418937,0.002515099700067805,0.002228071629764455,0.0019266270958422844,0.002258261427804974,0.001489082568149684,0.0011154504880749587,0.0011282080714030839,0.0009603690779227575,0.002438181019842075,0.0014853790358173749,0.0013199079893045302,0.000926805836035581,0.0008994987644560172,0.0009903009130747735,0.0010991717693193325,0.001172548661020273,0.0013439607511320315,0.0013563544230901922,0.0014236016993438244,0.0013942428778319302,0.0013904088158862098,0.001390741126542587,0.001424135097570985,0.001435275880869258,0.0015203285279484363,0.0015863609043218294,0.001600119366502348,0.001799114088842328,0.0013832069602698566,0.0015487491770363442,0.001560910847503968,0.0021061590581368367,0.0014363631287414263,0.0014583641947007444,0.0012468630476959312,0.0023285497370164093,0.0018512437129765504,0.001509130940503397,0.002380328678765792,0.0020110343681419,0.0016538186532737383,0.0013855109412822361,0.0012666277710469288,0.0026181119782328947,0.0013966381338776186,0.0012517707138126296,0.0013558686843133392,0.0011729780270682913,0.0011415517723013739,0.0015297392083546385,0.0012201785977011082,0.0014735646149915962,0.0010994380378451863,0.0014170592636611442,0.0018699033503162734,0.0017684120736279339,0.0012357251533594204,0.0023381255443225657,0.001543676055970513,0.002134731991576357,0.001988280939844696,0.0017072187629570224,0.001615832007615231,0.0023149243901417547,0.0016224880980652303,0.002325840429819804,0.0020488736600742406,0.001934091644728599,0.001891277785158372,0.0014919366486870215,0.002209711350477093,0.0018148248490756599,0.0011967954316574097,0.0013569427974973523,0.0020522006618249387,0.0013168424465002456,0.0019100969619607036,0.0012540726512484338,0.0017655504425273354,0.0009574400144684642,0.0009638909142775161,0.0012531705584988753,0.0024951655834145165,0.0011168127693536633,0.0005914805992396084,0.0005442767946098446,0.00133185050647184,0.0004783981954932462,0.00031583211388067344,0.0008486338324793688
];

export const dataset1_grad_itr15 = [0.004365275450498063,0.004045304844584192,0.004509494078666181,0.0043134688604770785,0.003975545773323098,0.004310028334025506,0.0052238502431722665,0.005896056798158778,0.006568682417578676,0.007234641805671747,0.007679297359167554,0.006180731436172275,0.005743899087464727,0.006838399741175644,0.005776479995043273,0.006281941628264768,0.006242579780672992,0.005818117555132941,0.005895977667993479,0.005953786430247012,0.006108158814368454,0.0065805340198973675,0.006844154235612811,0.009297910696504187,0.009055984212101683,0.006861513617654501,0.00565244771776221,0.009051262154516244,0.00697104232600716,0.005212813400453819,0.005945793555528005,0.004981646377289654,0.004580727501859434,0.004928201448387172,0.0022375213913098002,0.0020227591842480845,0.0014961682237845959,0.0014148980236055606,0.0015348917063768043,0.0011634874725170684,0.0009393095901938868,0.0009165023509652876,0.0006765197065211334,0.0018444875451251615,0.001022435242865327,0.0010909790729966146,0.0006977316684577695,0.000730790286969221,0.0008379283855347498,0.0009520473920701917,0.0010200255166427812,0.0011551532962664594,0.0011699252428379787,0.0012004306862499943,0.001184832303150382,0.0011863358104836183,0.0011733694607496245,0.0012246311687272974,0.001204706651887542,0.0013090074458945123,0.001345636853191397,0.0013255553130634202,0.0015398588286914103,0.0009235321533481012,0.0010730464094937818,0.0012676186180284165,0.0017828180068879354,0.001306982583691679,0.0011300643422588338,0.001043556818115288,0.0014179530482619053,0.001394745179035618,0.0011732554296069574,0.0015890809316573419,0.0015871663280091711,0.0013104172831256025,0.001091540285811643,0.0009567836862979594,0.0020126295835133337,0.0010803153979227387,0.0009975263187978786,0.0011682601120017032,0.00105558132298661,0.000996391625561864,0.0011029199411780287,0.0008934379382078462,0.0010605013231941667,0.0008930347112631635,0.0011176931915931679,0.0014471231722431308,0.001400987067555617,0.0009299336093770127,0.0015736533556040008,0.0011244632393055778,0.0015190998050965904,0.0013294004412776701,0.001283326906684142,0.001344198929214475,0.0016555368060829686,0.0012935920118357807,0.0018313624213483588,0.002001360422571467,0.0015332986571136608,0.001536632381543556,0.0011352673258648168,0.0015376327333326664,0.001391261455614417,0.0011204361979542442,0.0011490808343166243,0.001577349016681389,0.001137808414309166,0.001453408690681242,0.0010574668386022004,0.001279648114987362,0.0008339679024498965,0.0007578880020647884,0.0005973152041218704,0.0013210602554191721,0.0005541614883689801,0.00036431076927240686,0.00034760049248569875,0.000871479369840752,0.00026341484020077507,0.00021629243639837272,0.0008169961659958252
];

export const dataset2_grad = [0.003900373815132507,0.0036780082258003077,0.004071100087000705,0.003540229722815067,0.003422548736556518,0.004021278062694017,0.0048861837031101965,0.0055298377372441365,0.005880498023204018,0.006262587032556756,0.006912632413384006,0.004596774629251197,0.005012757018608001,0.0060342938388471675,0.005176640807756164,0.005776126778324604,0.005767741511201535,0.005318702288879804,0.005113744356757822,0.0054904410128689745,0.0054436031129387035,0.005829320936785801,0.005894894981157929,0.010097993117125123,0.005354351964179618,0.004678103710045334,0.003456926423044233,0.007075509227912943,0.005577356841688045,0.00382000247628493,0.004223635632877537,0.0038733188769923465,0.003095207799971711,0.003477967425608178,0.0018701502710917622,0.001596438474948773,0.0012097081208223865,0.0011633005531905352,0.0012881131913482302,0.0008075132275829032,0.000662807810813252,0.000764760747350133,0.0005588405006216189,0.001498931538756474,0.0008371945076454827,0.000966985083990663,0.0006212225253477705,0.0006871752412111462,0.0007938819070528572,0.0008994535987385875,0.0009599075830740066,0.0010727281466808933,0.0010942966025381526,0.0010912950666382988,0.0011029273548622493,0.00109245502163034,0.0010770171552964066,0.0011382158093672335,0.0010969342926545975,0.0012209527641673153,0.0012159433727404376,0.0012078644795101802,0.0014054626009126624,0.0008127739972585653,0.0009124000943045335,0.001126684406475583,0.0015657919177225373,0.0012522225344794727,0.0009898459261890962,0.00091358735164592,0.001080791900090699,0.0011638716260769244,0.0009437244881672376,0.0013575437327318755,0.0012589362174346746,0.0010976796283301228,0.0009770003506456432,0.0008506255985707708,0.0015996143135609726,0.0009046739519187388,0.0008445826859348219,0.0010521379379215073,0.000982940047386138,0.0009193661301619909,0.0009140401410919929,0.0007685227308072185,0.0008661217743304357,0.000834121267585744,0.0009685522972801337,0.0011880953908566037,0.0012513071330732392,0.0008495352545914326,0.0013954984363654195,0.0009689480649871343,0.001347587855685998,0.0011628091771728444,0.0012047031433396695,0.0013854062753518512,0.0014158025044432334,0.0011778831451201349,0.0016098869178945091,0.0020252275596322603,0.0010756027830485157,0.0011296903668188893,0.0010944401952461833,0.0013517606613639313,0.0013240952385663125,0.0011481972669490305,0.0011020961757057808,0.0013742230085565241,0.0010565185430306615,0.0012874882929372856,0.0010118758511314723,0.0009397836487693093,0.0007949590291345578,0.000572904919106783,0.0004071498631652614,0.0009705738911859774,0.0003436221992077634,0.0003202374335353348,0.00025416796000440764,0.0007659110271457455,0.0002835376645358545,0.0001980462133692306,0.0004790995530470196
];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、ITR. 5の経路の23番(グラフ上では24番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`sn2_F_beta_methyl_diketone_traj_23_itr5.xyz`
```
22
-1 1
C      -0.051717734748      0.258500426158     -0.329462744061
C       1.302663055293     -0.231442348192      0.149949042509
C      -0.786426202537      0.738092574993      0.920368063004
C       1.679103557266     -1.677517974480      0.581358119760
H       1.756794298789     -1.608857878528      1.675301885770
C       0.151857486478      1.834611427149     -1.620948947298
C      -0.868886355422     -0.823886401066     -1.054104278626
F       0.375815929309      3.054031687444     -2.900603480061
H       1.061322120630     -2.550711919409      0.360836590776
H       2.698118437436     -1.892096452415      0.242347564092
C      -1.288497444355     -0.232995265035      2.028566731961
H      -2.260564997159     -0.674545011178      1.775947773331
H      -0.622266646593     -1.058471217750      2.299161427257
H      -1.438041490897      0.404154727270      2.905506286103
O       2.219554171886      0.549579703069      0.359629816750
O      -1.055016624510      1.894956201217      1.154918619091
H       0.708774224593      1.101397559500     -2.188242237298
H       0.632035283442      2.420272566165     -0.850169447560
H      -0.930890268845      1.875076805411     -1.676641492618
H      -1.254465190450     -1.594563338204     -0.389193700889
H      -1.720448594807     -0.437607812736     -1.614097444492
H      -0.308817014798     -1.347978059383     -1.830428147501

```


<MoleculeViewer 
  xyzData={`22
-1 1
C      -0.051717734748      0.258500426158     -0.329462744061
C       1.302663055293     -0.231442348192      0.149949042509
C      -0.786426202537      0.738092574993      0.920368063004
C       1.679103557266     -1.677517974480      0.581358119760
H       1.756794298789     -1.608857878528      1.675301885770
C       0.151857486478      1.834611427149     -1.620948947298
C      -0.868886355422     -0.823886401066     -1.054104278626
F       0.375815929309      3.054031687444     -2.900603480061
H       1.061322120630     -2.550711919409      0.360836590776
H       2.698118437436     -1.892096452415      0.242347564092
C      -1.288497444355     -0.232995265035      2.028566731961
H      -2.260564997159     -0.674545011178      1.775947773331
H      -0.622266646593     -1.058471217750      2.299161427257
H      -1.438041490897      0.404154727270      2.905506286103
O       2.219554171886      0.549579703069      0.359629816750
O      -1.055016624510      1.894956201217      1.154918619091
H       0.708774224593      1.101397559500     -2.188242237298
H       0.632035283442      2.420272566165     -0.850169447560
H      -0.930890268845      1.875076805411     -1.676641492618
H      -1.254465190450     -1.594563338204     -0.389193700889
H      -1.720448594807     -0.437607812736     -1.614097444492
H      -0.308817014798     -1.347978059383     -1.830428147501
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`sn2_F_beta_methyl_diketone_traj_23_itr5.xyz`を`MultiOptPy-v1.12c`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py sn2_F_beta_methyl_diketone_traj_23_itr5.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1 -elec -1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
22
OptimizedStructure
C      0.123635267757     -0.050898257949      0.313405243069
C      1.580447863601     -0.189377795757      0.381668792029
C     -0.547685014919      0.743520165143      1.345517168269
C      2.198186791170     -1.392456099859     -0.331906556330
H      1.779952859199     -2.337498901715      0.020087503537
C      0.004921403513      1.255511183939     -1.218214179271
C     -0.650819804757     -1.230870348138     -0.247360021962
F     -0.170703285586      2.409133816024     -2.714028588291
H      2.015903010330     -1.334816981179     -1.408030551488
H      3.270591349678     -1.369763741453     -0.152572677285
C     -2.056689530350      0.545858246315      1.494863379634
H     -2.574752405970      0.795876482563      0.565734094522
H     -2.308820921794     -0.487296740595      1.742208271403
H     -2.400547300538      1.209314888203      2.284892138520
O      2.339443503506      0.612461824196      0.902163294087
O     -0.013615409479      1.583792538995      2.051794163187
H      0.492273460168      0.576629173987     -1.896516698367
H      0.573585924121      2.014946538196     -0.709903911302
H     -1.070549891211      1.264942033812     -1.186452776921
H     -0.727255463824     -2.078286034926      0.445372259836
H     -1.665796022457     -0.939527966728     -0.518478277362
H     -0.191706382159     -1.601194023074     -1.164242069513

```

<MoleculeViewer 
  xyzData={`22
OptimizedStructure
C      0.123635267757     -0.050898257949      0.313405243069
C      1.580447863601     -0.189377795757      0.381668792029
C     -0.547685014919      0.743520165143      1.345517168269
C      2.198186791170     -1.392456099859     -0.331906556330
H      1.779952859199     -2.337498901715      0.020087503537
C      0.004921403513      1.255511183939     -1.218214179271
C     -0.650819804757     -1.230870348138     -0.247360021962
F     -0.170703285586      2.409133816024     -2.714028588291
H      2.015903010330     -1.334816981179     -1.408030551488
H      3.270591349678     -1.369763741453     -0.152572677285
C     -2.056689530350      0.545858246315      1.494863379634
H     -2.574752405970      0.795876482563      0.565734094522
H     -2.308820921794     -0.487296740595      1.742208271403
H     -2.400547300538      1.209314888203      2.284892138520
O      2.339443503506      0.612461824196      0.902163294087
O     -0.013615409479      1.583792538995      2.051794163187
H      0.492273460168      0.576629173987     -1.896516698367
H      0.573585924121      2.014946538196     -0.709903911302
H     -1.070549891211      1.264942033812     -1.186452776921
H     -0.727255463824     -2.078286034926      0.445372259836
H     -1.665796022457     -0.939527966728     -0.518478277362
H     -0.191706382159     -1.601194023074     -1.164242069513
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -654.2947             41.4171             67.1046
Reduced mass [au]                  10.4418              5.5059              4.3335
Force const [Dyne/A]               -2.6337              0.0056              0.0115
Char temp [K]                       0.0000             59.5900             96.5486
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                 0.01128   -0.06666    0.09128    0.00353    0.00026   -0.00496    0.00428    0.00593    0.02229
       C                -0.01574   -0.00445    0.00922    0.00476    0.01206   -0.01309    0.00490    0.01073    0.00737
       C                 0.01004   -0.01581   -0.00238    0.00522   -0.01642    0.00906    0.00124    0.00201    0.02411
       C                -0.00197    0.00054   -0.00177    0.00731   -0.04996    0.09467    0.01035    0.08408   -0.11208
       H                 0.00682   -0.00623   -0.00708   -0.02479   -0.01864    0.14016    0.05994    0.04481   -0.15810
       C                -0.01920    0.15138   -0.18991   -0.00779    0.00509   -0.00200   -0.00101   -0.01506   -0.00440
       C                -0.00040   -0.00344    0.00181    0.00574   -0.00093   -0.00540    0.00228    0.00867    0.01783
       F                 0.00847   -0.04286    0.05989   -0.02305    0.00938    0.00558   -0.01489   -0.06979   -0.03919
       H                 0.00571   -0.00496   -0.00525    0.04807   -0.11577    0.08399   -0.04392    0.15374   -0.09904
       H                -0.00223    0.00772    0.00133    0.00172   -0.05782    0.12953    0.01800    0.10633   -0.16091
       C                 0.00065   -0.00126   -0.00234   -0.01392    0.06472   -0.07727   -0.01898    0.08717   -0.06152
       H                -0.00912    0.00020    0.00077    0.04672    0.07363   -0.10813    0.04390    0.09269   -0.09473
       H                -0.01143    0.00166    0.00031   -0.07462    0.08005   -0.07388   -0.08504    0.10540   -0.05165
       H                 0.00608    0.00340   -0.00319   -0.02476    0.08942   -0.10278   -0.02820    0.11950   -0.09270
       O                 0.00462    0.00476   -0.00424    0.00243    0.07496   -0.10681    0.00353   -0.03072    0.07416
       O                -0.00162    0.00933   -0.00093    0.02285   -0.10077    0.09651    0.01386   -0.06176    0.09082
       H                 0.00589   -0.05511    0.04018   -0.01024    0.00510   -0.00418    0.00985   -0.02769    0.01691
       H                 0.00985   -0.02296    0.03899    0.00033    0.00112   -0.00538   -0.01098    0.00611   -0.02468
       H                -0.01017   -0.04763    0.05473   -0.00716    0.00356    0.00432   -0.00055   -0.02825   -0.00309
       H                -0.03353   -0.03610   -0.03907   -0.01081    0.00655    0.00197    0.01136    0.00569    0.01519
       H                 0.00306    0.01432   -0.00333    0.01180    0.00181   -0.02514   -0.00090    0.00588    0.02787
       H                 0.00457    0.01198   -0.00510    0.01935   -0.01271    0.00591   -0.00531    0.01397    0.01218

(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作モジュールで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、SN2反応（基質-fluoromethane, 求核剤-3-methyl-2,4-pentanedione）のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作モジュールMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.


### 個人的な技術的補足

`-modelhess`を使わない場合のアルゴリズムを用いた`nebmain.py`による経路緩和の結果

#### コマンド
```
python .\nebmain.py sn2_F_beta_methyl_diketone_traj.xyz -os uma-s-1p1 -ns 20 -spng -nd 0.12 -elec -1
```

#### 結果

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1_nomh = [-524.2021020322433,-524.2021020322433,-524.2086135826612,-524.2031172043178,-524.2003063668774,-524.200521973591,-524.1968226453756,-524.191281821438,-524.1830269337828,-524.1810418658115,-524.184853462848,-524.1866439330627,-524.1894206901582,-524.1912726019202,-524.194866589643,-524.196089103393,-524.1954817728629,-524.1963591285895,-524.1979318865402,-524.1966472303053,-524.1935325096521,-524.1911460279517,-524.19084068427,-524.1906133877818,-524.1904120303598,-524.1917659030715,-524.1958836925811,-524.1996841699023,-524.2063909030584,-524.1943399632974,-524.2079331205352,-524.2326460454191,-524.2461881392276,-524.25248069776,-524.2570490925691,-524.260785461495,-524.2637200193219,-524.2654019449932,-524.2679515085506,-524.269405414892,-524.2705116869295,-524.2708911919826,-524.2718048288882,-524.2722414252959,-524.272896920085,-524.2730867646096,-524.2733829763907,-524.2737289722535,-524.2740614049768,-524.274417949948,-524.274733179038,-524.2750871130172,-524.2754171494106,-524.275778285522,-524.2761466807168,-524.2765717992739,-524.2769749040145,-524.2774780938598,-524.277916630988,-524.2784689258817,-524.2789471316881,-524.2794549477205,-524.2799197086707,-524.2804264207266,-524.2796842594039,-524.2808056892134,-524.2816803364739,-524.282093306909,-524.2825689017235,-524.2832717229323,-524.2837811204548,-524.2841691594214,-524.2848730232747,-524.2855758357219,-524.2861959287895,-524.2874532966537,-524.2881908493127,-524.2889740943311,-524.2896948332534,-524.29044109506,-524.2916243650752,-524.2924412025204,-524.2932303354132,-524.2941111859701,-524.295055506412,-524.2956940166109,-524.2963362330164,-524.2968967726869,-524.2973735415715,-524.2979521479044,-524.2985982720362,-524.2992063790736,-524.2998165889232,-524.3003685946803,-524.3008338331441,-524.3013862244168,-524.3019045588916,-524.302539415454,-524.3030905625628,-524.3037196013445,-524.3042177838679,-524.304884962408,-524.3054039890585,-524.306218986543,-524.3071239581094,-524.3076979032083,-524.3085589960912,-524.3093761664816,-524.3101376123456,-524.3110032350365,-524.311855794006,-524.3127845886837,-524.3135461659734,-524.3144184738552,-524.3150257660528,-524.3158274544876,-524.3165397208286,-524.3169810135171,-524.3172860790141,-524.3177609203209,-524.3182474322359,-524.3185917239446,-524.3190957592956,-524.3192757512684,-524.3195123001308
];

export const dataset1_itr5_nomh = [-524.2105755318813,-524.2031659079702,-524.2091453807478,-524.2056052633529,-524.2028921683528,-524.2020565523557,-524.1985080374017,-524.193925175901,-524.1856903755795,-524.1846181296739,-524.1887768177879,-524.1899125795776,-524.1941031318695,-524.1956723062776,-524.2012568824016,-524.1994650908103,-524.1988088326565,-524.1999275835707,-524.2017433811741,-524.1991134228304,-524.1962482523339,-524.1938133544751,-524.193574135479,-524.1939613628915,-524.1944283109855,-524.196753736654,-524.2022680832275,-524.2072439088755,-524.2181971302264,-524.2058158315311,-524.216353326339,-524.235688462185,-524.2481604435662,-524.2552380104129,-524.2601460094114,-524.2650293660781,-524.2679046377402,-524.2700237687586,-524.2712899114834,-524.2731298021685,-524.2742071079662,-524.2747743722551,-524.2749958509626,-524.2745440135465,-524.2758515641505,-524.2768327582827,-524.2774026773722,-524.2777970904885,-524.2781480498645,-524.2784976818402,-524.2788131869244,-524.2790578578994,-524.2793874255408,-524.2797276299079,-524.2801468868757,-524.280600301401,-524.2810364115334,-524.2815233221066,-524.2819823528932,-524.2824884910566,-524.282962096961,-524.2834469397689,-524.2838968452261,-524.2841926145404,-524.2843085758781,-524.28517976226,-524.2855539664738,-524.2861824707907,-524.2865118412935,-524.287487029268,-524.2870034700519,-524.2873883635617,-524.2892321269261,-524.2891186451546,-524.2897482446863,-524.2914685642058,-524.2924177736865,-524.2932658992266,-524.2929488389375,-524.2945655599035,-524.2957621302066,-524.2964575477638,-524.2973034390658,-524.2980298468196,-524.298321357939,-524.2986702495496,-524.2988935244092,-524.3006270653611,-524.3012697286143,-524.3017347830821,-524.3026458352808,-524.3034663789327,-524.3032838460617,-524.3036241687121,-524.3034912096415,-524.3037471832328,-524.3043742506278,-524.3055930231243,-524.3061880839635,-524.3073174956982,-524.3075504785414,-524.3089878997104,-524.3096111207113,-524.3104699092622,-524.3112246261268,-524.310686814353,-524.3121298079745,-524.3133964106895,-524.3142906141046,-524.3143837424051,-524.315421243718,-524.316026380533,-524.3172251500272,-524.3173964065671,-524.3188866871808,-524.3197937265127,-524.3191894308227,-524.3190955490144,-524.3198905434965,-524.3217640879404,-524.3222113210737,-524.3221254912843,-524.3229113735797,-524.3230990408175,-524.3235123836256
];

export const dataset1_itr10_nomh = [-524.2135816921106,-524.2046147407292,-524.2096292330408,-524.2067023375031,-524.203652760497,-524.2030169992871,-524.1992660946712,-524.1968929012114,-524.1875340316128,-524.1875682045035,-524.1981468246252,-524.1924511274651,-524.2023768572184,-524.1974054058581,-524.2042357564505,-524.2016979516663,-524.2019363678698,-524.2050567305218,-524.2050955766938,-524.2012571348487,-524.1984617580072,-524.1958810783035,-524.1959010834961,-524.1966040667968,-524.1971800698043,-524.2004627832574,-524.208055259021,-524.2121768828773,-524.2277971923978,-524.2228503746078,-524.2281191461065,-524.2416136418819,-524.2502824571899,-524.2568174108411,-524.2622909130232,-524.2659626467554,-524.2687231793395,-524.2709945714932,-524.2719497038952,-524.2736802746249,-524.2747150116157,-524.2752406402208,-524.2755200995971,-524.2753895280946,-524.2765255593072,-524.2771440007909,-524.2778073679838,-524.2782562789861,-524.2786178926111,-524.2789451427782,-524.2792779785404,-524.2795493201851,-524.2798987331179,-524.2802197405608,-524.2806151130853,-524.2810459136165,-524.2814940930153,-524.2819903260565,-524.2824749980108,-524.2829845576251,-524.2834869545349,-524.2840044654082,-524.2844619234664,-524.2851106761136,-524.2856110841134,-524.2861309956975,-524.2863238498722,-524.2869872871588,-524.2874080073334,-524.2882535919753,-524.2882934227454,-524.289091571446,-524.2901704981615,-524.2902611468959,-524.2912389809093,-524.292212854626,-524.2929676152992,-524.293941427684,-524.2937969732394,-524.2951593064852,-524.2963435753361,-524.2970535110601,-524.2978065106279,-524.298478070027,-524.2988615003298,-524.2997291557394,-524.2999993408372,-524.3012558938616,-524.3016903786953,-524.3021295160012,-524.3030906326566,-524.3040292930286,-524.3042947818457,-524.3047236767031,-524.3053332206623,-524.3059848821998,-524.3068022541098,-524.3071983100483,-524.3070755583792,-524.3082533435589,-524.3084594279278,-524.3095464329474,-524.3102633868074,-524.3110006941383,-524.311925572328,-524.31171225078,-524.3127769484656,-524.3140365242828,-524.3149981578795,-524.3154757153187,-524.3165873933361,-524.3168969974032,-524.3178933799735,-524.318275609921,-524.3194534038623,-524.3202070167505,-524.3197736797019,-524.319861042792,-524.321426937032,-524.3222839119073,-524.3225685012694,-524.3228025968508,-524.3233163314237,-524.3236102607773,-524.3238462926984
];

export const dataset1_itr15_nomh = [-524.2162933030946,-524.2069265145459,-524.2106747563525,-524.210464087004,-524.2047526140283,-524.2051023662038,-524.2004210051956,-524.2001125532945,-524.1884386724245,-524.1883195108693,-524.2036225194273,-524.1959933487675,-524.207143544491,-524.1988319811154,-524.2059385147493,-524.2031680436389,-524.2034448985945,-524.2070191294646,-524.2072017428338,-524.2029783420397,-524.2004121164327,-524.197585934486,-524.1977208320867,-524.1989499839334,-524.1996931988526,-524.2057927030598,-524.2140651251032,-524.2159399605314,-524.2399899224937,-524.2407193683731,-524.2425583434587,-524.2506632633582,-524.2530753774646,-524.2581147146159,-524.2637120373968,-524.2665471453437,-524.2693961318519,-524.2713615954792,-524.2723577020554,-524.2738898855853,-524.274925932453,-524.2754410557582,-524.2760325111506,-524.2756396225731,-524.2766632803715,-524.2772527643773,-524.2780309451226,-524.2785096634896,-524.2788781200164,-524.2792116172884,-524.2795423984279,-524.2798363321623,-524.280186275179,-524.2805470170131,-524.2809268812968,-524.2813717662896,-524.28180954991,-524.2823057698087,-524.2828044429883,-524.283292829911,-524.2838373443992,-524.2843733424975,-524.2848375996489,-524.2855563496611,-524.28611662648,-524.2866161057376,-524.2868264921101,-524.2875527421529,-524.2880671163313,-524.2888003669867,-524.2889058755949,-524.2899500445751,-524.2907232837115,-524.2909514038013,-524.2918712352414,-524.2926496700766,-524.2933741852993,-524.2943001587038,-524.2944004102811,-524.2955631077823,-524.2966350601704,-524.2974346545545,-524.2981562696485,-524.2987510676363,-524.299272512521,-524.3000688212609,-524.3003883260693,-524.3015712456157,-524.3020600092923,-524.3024990677427,-524.3034663964561,-524.3043549660865,-524.3046417809251,-524.3054724355995,-524.306139728042,-524.3067216638277,-524.3072822297833,-524.30795622494,-524.3078859033914,-524.3088709307751,-524.3091101431999,-524.3100290283745,-524.3108524896785,-524.3114423723424,-524.312405565525,-524.3124080713764,-524.3132328732231,-524.3144085293053,-524.3154200346008,-524.3161432443276,-524.3170620594085,-524.3172642886215,-524.3182095378056,-524.3185347640158,-524.319690259385,-524.3204175520722,-524.3201940406461,-524.3202158222771,-524.321751830297,-524.3224940529517,-524.3227736831815,-524.3230524284777,-524.323485555245,-524.3237888421135,-524.3240042226652
];

export const dataset2_nomh = [-524.2195622069851,-524.2092481341721,-524.2120068992508,-524.2163644071743,-524.2096388721114,-524.2124562094589,-524.2036826751927,-524.2038173137751,-524.189128736572,-524.1889804729705,-524.2068079375616,-524.1992923710635,-524.2138555617846,-524.2034942615661,-524.2112468258277,-524.2047273956135,-524.2050347276576,-524.2085643388626,-524.2115774893686,-524.2054609104896,-524.2026623797035,-524.1993014766789,-524.1994870925794,-524.2051938273138,-524.2035879473309,-524.2119775680308,-524.2226504541075,-524.2266280725573,-524.2461671089139,-524.2509604914986,-524.2546148376014,-524.2589502977567,-524.261946082469,-524.2624501090584,-524.264517221757,-524.2670016068943,-524.2697727280147,-524.2716504342745,-524.2726574754748,-524.2741274245219,-524.2752311775654,-524.2755763410648,-524.2764396024728,-524.276497513048,-524.2772030854362,-524.2774590590275,-524.2781836969142,-524.2786700511183,-524.2790690071855,-524.2794220211844,-524.2797739706344,-524.2801042917837,-524.2804397779657,-524.2808522358403,-524.281215601809,-524.2817045188156,-524.2821177915299,-524.2826043647771,-524.2831187871448,-524.2835647761141,-524.2841902664001,-524.2846591585002,-524.2851975222624,-524.2858914941361,-524.2864581494856,-524.2870533855593,-524.2872496743275,-524.2880589591718,-524.288684440696,-524.2893810060382,-524.2896407559299,-524.2906570626469,-524.2913275706399,-524.2916994529984,-524.29243829363,-524.2931882090732,-524.293989117715,-524.2948062705821,-524.2950242621257,-524.2959829693086,-524.2969058147798,-524.297803680593,-524.298469588684,-524.2990306715809,-524.2995730219247,-524.3002921574525,-524.3006748430095,-524.3017344150899,-524.3024043360477,-524.3029920195205,-524.3038506854074,-524.3046103614043,-524.3048781983617,-524.3059195197836,-524.3065010437687,-524.3070773632932,-524.3076883266506,-524.3085140046692,-524.308419623443,-524.30946010374,-524.3098407741016,-524.310532021081,-524.3113840543474,-524.3119330723587,-524.3128607192514,-524.3128695948717,-524.3138976510525,-524.3148447489591,-524.3158331671277,-524.3165737162943,-524.3174833315713,-524.3175850989259,-524.3185257394463,-524.3187970810909,-524.3198336974702,-524.3205998921853,-524.3205054321037,-524.3205066061739,-524.3219707505828,-524.3225984838684,-524.3228958565771,-524.3231471776961,-524.3235489287513,-524.3238957876433,-524.3241162237063
];

<MultiDataGraph datasets={[ { data: dataset1_nomh, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5_nomh, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10_nomh, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15_nomh, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_nomh, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad_nomh = [0.013098869194288603,0.013098869330322548,0.007201779082676138,0.013516783139827118,0.013077327373116433,0.011490600559192167,0.011915666467964393,0.012726636214404986,0.01420259801521781,0.013842018456178086,0.013150805115980211,0.013411984660869354,0.012912342024626077,0.01255037763978795,0.01155665937232162,0.011122908651999277,0.011074078404822088,0.01072055586790959,0.010142981837907308,0.010089785415448348,0.010299119982713833,0.010238173759530638,0.009645759442112992,0.009910289752285535,0.011152981462511903,0.013221616413073048,0.015644471791571114,0.017105665365328093,0.0176333943612845,0.029400959618838988,0.02489039766989856,0.012997967420211077,0.01149476448413555,0.012824547036863936,0.012588568679028059,0.01095138026994826,0.010455331331999378,0.010839071910465166,0.01042210334188414,0.010153210888536322,0.01004152678697992,0.010177828042702798,0.009968683629035054,0.010242856241717307,0.010004574950049173,0.01007115077498289,0.010114660456088987,0.010134103571708146,0.010149953451900404,0.010150115928949427,0.010158900187564825,0.010151685727848506,0.010157385927375988,0.010163923484016752,0.010180216143914917,0.010190839311587778,0.010223140368752789,0.010227557470652446,0.010267243820017407,0.010261668535910885,0.010291220781607036,0.010305649478675625,0.01033718279298431,0.010419403150679664,0.01186534001279459,0.010863406991072135,0.01038100956152015,0.010355016910496746,0.010303535679028955,0.010339353021403505,0.010416853348322194,0.01054868526207724,0.010624146946316273,0.010575970642734288,0.010507162647745276,0.010466842728941533,0.010473111377863985,0.010441077786165768,0.010538048443773254,0.010493891499451978,0.010279972938056624,0.01010130906127564,0.01018124340708878,0.010241240703532035,0.010066449391282387,0.010038269848237087,0.010102827112791004,0.010140962701863656,0.010159425159654532,0.010206264227252326,0.010297728071757491,0.010402226840054513,0.010422154915182037,0.01044085624059606,0.010484336768115091,0.010467066235307911,0.010472868412496165,0.010490828760031561,0.010501859544497276,0.010424105514874316,0.010385055774201072,0.01035395536460768,0.010326591947695262,0.010262948346369925,0.010265215321287937,0.010234844146470782,0.010305047523579197,0.010356253451319746,0.010445567105951223,0.010474721725982907,0.010417147074037377,0.010273263125362251,0.010129059298911938,0.010049183695192622,0.010225538063293649,0.010144402527462354,0.010005939414999344,0.00996375408502107,0.010136464932745733,0.010214139256006347,0.010075373889516836,0.010103495244024315,0.009997157771962188,0.010108656614946662,0.010032305396213283
];

export const dataset1_grad_itr5_nomh = [0.004835352370708147,0.011201651666426808,0.006941933382203434,0.010245350127014543,0.011202582983474969,0.010985780306094373,0.0113634821746512,0.012055103148882067,0.013879189502435434,0.013518031495844485,0.012708510920657936,0.012258867361467276,0.01133486688880728,0.010983432469767141,0.009569777370846229,0.009851474352990743,0.009879776921653002,0.009685536974354278,0.009199016682278087,0.009339398398261114,0.009237230869791538,0.008772998807137392,0.008109635465052938,0.008216097983288309,0.009360180668867766,0.011378377732442858,0.013722963253695795,0.014926786873687233,0.01512140715892801,0.027047999876659748,0.02276949015567924,0.011965785527696855,0.010193615320605427,0.010924746827736012,0.00892248704778116,0.004488603998806463,0.004845636163233036,0.003991927819597609,0.005001122716446783,0.0032585813848869543,0.003216610841002786,0.002912084113524341,0.004252249835498335,0.006460981371193691,0.0047634336390715536,0.002902742916063112,0.0022520969745333194,0.002234848031609732,0.002309386843094758,0.0024077414723302566,0.0025365112662018205,0.0028805047922278743,0.002905968932679473,0.0029527345813945742,0.0028237578232254658,0.002709592767785633,0.002700974191163494,0.0026968801640244967,0.0027564089737777578,0.002822833136652423,0.0029197237037686522,0.0030313570853285985,0.003156843282431357,0.0038908911933396902,0.004505571798705367,0.0037069741368496796,0.0038184489734371867,0.00316316017917078,0.0034149358532052265,0.0028498061211773024,0.0054980962969105335,0.005687294387669448,0.00365097719517573,0.005204833536755439,0.005015894541364388,0.003393572874392411,0.002851858651254662,0.00289001938176402,0.00539833028959784,0.0032836050816853713,0.002920407729418497,0.002744709916470858,0.0024713897235264905,0.0028956962546758122,0.004059020946588484,0.0049211177391864135,0.005829632428536142,0.003248664524295212,0.0029364909240730793,0.003527695175252473,0.0030281257230785515,0.0027677696585691474,0.004975454443043702,0.005451163761190839,0.00666549846571459,0.007150149190545912,0.006916451350544677,0.005875764127332347,0.005761916651155132,0.004559312624295033,0.00506550744126486,0.0032218448419692736,0.0031294438513454334,0.00276707037668478,0.002959840604253575,0.0054047092100058414,0.004234522989893973,0.00319890939162345,0.0031582272191560067,0.00538312458688902,0.004910587174654887,0.005060587283087761,0.003599407896986156,0.005076505209819933,0.002994718260714233,0.002343252398239417,0.005488584664615422,0.006401001345847551,0.005860565903835267,0.0025898663008768253,0.002090860254879778,0.0036017175846784362,0.002417590941850356,0.002703317893929605,0.0017069007484263917
];

export const dataset1_grad_itr10_nomh = [0.0031913352559642403,0.008862601977059462,0.00647338241635102,0.009773403397604857,0.010776731133549437,0.011107450860308168,0.011419730202244842,0.011944340375938908,0.01351044278603087,0.013064439373225342,0.010421380013255889,0.011528196947641423,0.00960587686686307,0.010560339582111658,0.00883267706856175,0.009344854064306154,0.00927816529441516,0.008731310161503166,0.008611069646269013,0.008974464041003683,0.008746306889080374,0.008335002764067964,0.007473622305496165,0.007364773786896035,0.008378926173985656,0.010410500801393162,0.01273750756104246,0.013907901164232399,0.013172063029410703,0.019333896432239275,0.017899598219245975,0.01032782698808053,0.0091688212349435,0.009763122762777741,0.006059680805167475,0.0034948185908604554,0.003971732386801683,0.0026857946970770875,0.004083587082195301,0.002429834734505643,0.002367184027251353,0.0019097774049547105,0.003188962349427192,0.004967350923343603,0.0031607367153396165,0.0022759451021196696,0.0017185242840121265,0.0015413112835780435,0.0015797662587712352,0.0017456052106752172,0.001820535627912244,0.0021319629966951793,0.0020634704228141626,0.0022177403140580393,0.0021724880733308884,0.0021317328593236443,0.00211887711888363,0.0020861313520725835,0.002088886475350572,0.0021640311383212926,0.0022137156738411285,0.002293586424929411,0.0024676611663768016,0.0022125707420743465,0.0023669638501067113,0.0022605281919712964,0.0029521212365444835,0.0021509341527813797,0.0023287519038797722,0.0018970510644869074,0.0036894849137522273,0.003109538121378891,0.0024476730132739124,0.00390808753827133,0.002849236630453922,0.0024049617122586884,0.002345219753026697,0.002160015611698606,0.004506632521919261,0.002692902091716979,0.0021051337971752858,0.0020925183905417034,0.0019270101675478086,0.002140476327353467,0.002992743768904805,0.002569139092091546,0.0038849752703600257,0.002159102752045502,0.002396280295317636,0.003167983612751958,0.0026877511480938184,0.0019870603366071785,0.0031886737352712145,0.0036657193430523274,0.00349684015568541,0.0032075244915864922,0.002091642765572516,0.0029097043901499453,0.004576734242327702,0.0030953634740949415,0.0038596433291732905,0.0029448930498717292,0.0027106765251700116,0.0024661757099075613,0.002019746263023029,0.0037694365389469957,0.0032213692683207592,0.002209700387278556,0.0023286509432824598,0.0037762977631742847,0.0027675331160085517,0.0035449294384223735,0.0023815837792599665,0.003392448747085338,0.0018035535188692844,0.0014951292916156207,0.004529118363106887,0.005115877962440297,0.002316971515552789,0.0014663063413651162,0.0014307108792759621,0.001984677001378096,0.0014287507884965865,0.00130705559202072,0.000863825748598614
];

export const dataset1_grad_itr15_nomh = [0.0025772991684101703,0.0061955491193408235,0.005669546394711519,0.007643532818812114,0.010015345344069265,0.011040450646564327,0.010908665403971056,0.011288223509587943,0.013111330347534785,0.012888437204254512,0.008965552538334264,0.011026058319450825,0.00843276227431442,0.010483743790941004,0.008737428681742673,0.009252878647393579,0.00920612275057075,0.008527502258177883,0.008343942876566411,0.008910151049813055,0.008584901934808745,0.008218070936686979,0.00724357443778803,0.006753352346808321,0.007831296922441704,0.009341274167201286,0.0119714982591527,0.013622397242272379,0.009913620170776074,0.014570201538849619,0.013252409035217452,0.008420413930173707,0.007821069154867822,0.008369266875399812,0.003979488221597293,0.003152180308519098,0.002853719360334785,0.002284216514017208,0.003374858270954539,0.002251697996705722,0.0022664945513850734,0.0016122129264140531,0.0021069745684585395,0.004630604788698602,0.0029246701813533675,0.0022066145510433654,0.0014153646626042988,0.0012121438898266546,0.0012810493759739577,0.0014302496711279663,0.0015639346862365458,0.0018228280299825953,0.0017257238833783574,0.001891893700364306,0.0018675769169459353,0.001811439608878978,0.0018755637493251226,0.001869705665866457,0.0018293672493114009,0.0019562347005719423,0.0019288623097360113,0.0019164854707352254,0.002128793240019187,0.0016210872941406901,0.0017831316264981937,0.001799040154668934,0.0024803086723668407,0.0017624633809960103,0.001786626800594903,0.0015834264907388564,0.0031718546817081543,0.002262424508277289,0.0021301694298175777,0.003343416485060511,0.0025879760133126683,0.002337486885700051,0.002288368937755296,0.0020858660936686237,0.00405212195177631,0.002533881674524838,0.001949321223305147,0.0018709269679817184,0.0016876623764259804,0.0018569203511987066,0.0024552647154093945,0.0020085911042923787,0.0033213408292313245,0.001715786243799196,0.00208318031702071,0.0028990574583637476,0.002454716685624023,0.0017660952579101007,0.002853201846635683,0.002340216922196923,0.0020198235233821523,0.001732115645073771,0.0017208367637317416,0.0017545962827712324,0.0033768914740770505,0.0026099769244511046,0.0033297865869417955,0.002736990802950615,0.0024836196830855107,0.002417542905736216,0.0017068780844048293,0.0029362183621604965,0.002768413596330839,0.0018711724216407494,0.0021016677078575345,0.002714670813305641,0.00212353374250594,0.003036792165458828,0.002028964194782804,0.003266991544463249,0.001469122487572899,0.0012118321032045579,0.003842811868759342,0.004612968421966683,0.0017263736306204651,0.0010034829804634008,0.0010938244134050127,0.0014479389020264385,0.0010275248172530677,0.0007912767143092997,0.0005330150115173399
];

export const dataset2_grad_nomh = [0.002194156594532623,0.005092877475372078,0.005095657751083204,0.004711964721600476,0.007592860787430107,0.007728180780582123,0.009834632215303337,0.009768207478640677,0.01274150044112981,0.012644903710942831,0.008191366302142856,0.010757595147850041,0.007165654804323105,0.010303937253960564,0.007759089040844304,0.009082587700196203,0.009034773828829633,0.008610474018389365,0.007782488243880836,0.008741864814700392,0.008594176578814476,0.008079569571101047,0.006822016322822686,0.004147387896535763,0.0063809199683299385,0.0072502071260847414,0.011647581340074379,0.013337392575938769,0.009376413738326485,0.010891200639476682,0.00805410770585756,0.006555946305560497,0.005278727455934005,0.004992501709690971,0.0037571272889429454,0.0031848470302798665,0.002543390821903436,0.0020666617404757528,0.0030835074710458973,0.0018325713660167367,0.0014327159271438905,0.001525072389767342,0.0011213988682789895,0.0028542708098674503,0.0013260125015636802,0.0018274743424370526,0.001184177863310828,0.0010658141717901728,0.0011298193293041705,0.0013326006968263097,0.0014026596720271033,0.0016099579079095507,0.0016486319522145026,0.0016492757431614722,0.0017277105215936092,0.0016136724598314635,0.0017264109076596094,0.0017237131563112775,0.0016570655472678737,0.0018566463226246243,0.0017144687990296133,0.0017334580462309514,0.0020385595799712387,0.0014972931123326488,0.0015893474573154488,0.001462002125041805,0.002135475016724692,0.0015907780185042528,0.001531171986839623,0.0015115768739006302,0.0023790371663992087,0.0019268893892357925,0.0018618863159164728,0.0027140775206622248,0.002614686023103568,0.0022916473275674688,0.0020260896345260355,0.0016421688764843541,0.003587692859641442,0.0024481003169040255,0.0018881029913211246,0.0017146532827032326,0.0016017596857838014,0.0017007036167245044,0.0023925682650338103,0.001710240069359243,0.002875812853785692,0.0015634823352871218,0.0019112397754047336,0.002316841472817762,0.0021458769719599185,0.0017259522890814933,0.0027565131486679754,0.0017448963835184905,0.0016189362989488235,0.0015732974309481858,0.0016025212680831863,0.0014116241175296054,0.0027640461609158254,0.0020228752415136124,0.00237166891379359,0.002361001284588769,0.0022715631613471747,0.0021776194845759328,0.0015750275329457569,0.002827822651047886,0.0017098158348014076,0.0016574755353558,0.0018258930093097703,0.002245419891186181,0.002109994325403481,0.002819207624988578,0.0017010820356647513,0.0030216025534721344,0.001443573804413724,0.001019360808266897,0.0034442639372076816,0.004262012808967196,0.001273526422686772,0.0008671089699737339,0.000979852279689309,0.0013635148263169171,0.000934762836689491,0.0006149080313437367,0.000332815659141951
];

<MultiDataGraph datasets={[ { data: dataset1_grad_nomh, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5_nomh, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10_nomh, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15_nomh, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad_nomh, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

緩和後の経路のエネルギー極大値を示すノードの分子構造
`sn2_F_beta_methyl_diketone_traj_21.xyz`
```
22
-1 1
C      -0.051457383763      0.252115770113     -0.323294614281
C       1.304365707064     -0.253935353644      0.126418558879
C      -0.796985275987      0.728421759570      0.917900494163
C       1.698148197932     -1.699714839833      0.599933829801
H       1.788863874215     -1.606680012988      1.690544513765
C       0.164808330585      1.962949007599     -1.718092070021
C      -0.879025350988     -0.850405195697     -1.053550635934
F       0.390554201889      3.036326786837     -2.890795396664
H       1.110905500134     -2.603497437261      0.423485329654
H       2.729844968246     -1.914695021080      0.296568555172
C      -1.291772608184     -0.238662345839      2.043252965152
H      -2.271279547008     -0.673656213229      1.819942573691
H      -0.651370946759     -1.067626977037      2.363914549257
H      -1.443034114723      0.401491743987      2.910771562807
O       2.249637666161      0.512623734099      0.287248019870
O      -1.099555204395      1.884883845675      1.129604711660
H       0.691004389507      1.160310925489     -2.165479038757
H       0.625268923869      2.469985469873     -0.889136603981
H      -0.913214676617      1.925990228258     -1.700778718566
H      -1.307175816472     -1.639290627950     -0.420011459704
H      -1.718533403634     -0.405969359405     -1.600825650462
H      -0.329997431072     -1.380965887537     -1.847621475502

```

