---
title:  【計算化学】自作pythonモジュールで遷移状態構造を求めてみる(SN2反応（基質-iodomethane, 求核剤-3-methyl-2,4-pentanedione）, NNP使用）
published: 2025-08-19
description: ""
tags: [MultiOptPy, python]
category: Computational Chemistry
draft: false
---
最終更新：2025-08-19

import MoleculeViewer from '../../components/MoleculeViewer.astro';
import MultiDataGraph from '../../components/MultiDataGraph.astro';

## 概要

本記事では、自作モジュール(MultiOptPy)で、SN2反応（基質-iodomethane, 求核剤-3-methyl-2,4-pentanedione）の遷移状態構造を算出してみる。使用する計算レベルは、Meta社のFAIR Chemistryが開発したニューラルネットワークポテンシャル(NNP)であるUMA(Meta’s Universal Model for Atoms)を使用する。

MultiOptPyは電子状態計算ソフトウェアを用いた分子構造最適化手法の勉強を目的として作成したpythonモジュールである。

MultiOptPyのレポジトリ:https://github.com/ss0832/MultiOptPy

SN2反応について：
- https://en.wikipedia.org/wiki/SN2_reaction

今回使用したニューラルネットワークポテンシャルについて：
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)



## 使用した自作モジュールMultiOptPyのバージョン
```
v1.12c
```
## 環境
```
Windows 11
```
※Windows 11環境下でAnaconda PowerShell Promptを使用した。

## Source codeのダウンロード
```
wget https://github.com/ss0832/MultiOptPy/archive/refs/tags/v1.12c.zip
unzip v1.12c.zip
cd MultiOptPy-v1.12c
```

### 環境構築手順

今回は、Windows 11のPower Shellを使用した。初めに、NNPを使用できる環境が整ったAnaconda PowerShell Promptを用意する手順を説明する。

1, https://repo.anaconda.com/archive/ より、`Anaconda3-2025.06-1-Windows-x86_64.exe`でAnacondaをインストールする。

2, 検索機能を使い、スタートから`Anaconda PowerShell Prompt`を開く。

3, 以下のコマンドを実行し、仮想環境を作成する。
```
conda create -n (任意の仮想環境名) python=3.12.7
```

4, 先ほど作成した仮想環境を`conda activate (仮想環境名)`で起動させる。

5, 以下のコマンドを実行し、必要なライブラリを導入する。
```
pip install fairchem-core==2.2.0 ase==3.25.0 torch==2.6.0
```
- fairchem-coreは、FAIR Chemistryが管理しているNNPを動作させるために必要なライブラリである。
- aseはNNPに電子エネルギーを算出したい分子構造を渡すために必要なインターフェイスの役割を果たすために必要なライブラリである。
- torchはPyTorchライブラリを指す。これはニューラルネットワークなどの機械学習を行ったり、学習結果を扱ったりするために必須なライブラリである。

これで、`Anaconda PowerShell Prompt`から仮想環境を立ち上げることで、NNPを使用する準備が整えることが出来る。

次に、NNPを使用するために必要なModelの情報が保存されている`.pt`ファイルのダウンロードおよびNNPの自作モジュールへの導入方法について説明する。


1, 以下のサイトにアクセスして、`uma-s-1p1.pt`をダウンロードする。（使用許諾が下りていれば可能である。）
```
https://huggingface.co/facebook/UMA
```

2, ダウンロード後、`MultiOptPy-v1.12c`ディレクトリ内に存在する`software_path.conf`に対して、`uma-s-1p1.pt`の絶対パスを用いて以下を追記する。
```
uma-s-1p1::(uma-s-1p1.ptの絶対パス)
```

これで、`MultiOptPy-v1.12c`がNNP`uma-s-1p1`を使用できるようになる。


### 使用するNNPに関する具体的な説明

今回使用するNNPについて具体的に説明する。

- UMAのModel Checkpointは`uma-s-1p1`を使用した。
- 小分子系のトレーニングセットである`Omol25`(`omol`)を使用して学習したニューラルネットワークポテンシャルを使用する。

※自作モジュールでの具体的な使用の仕方に関しては、`ase_calculation_tools.py` を参照


## 手順

### 1. 初期構造の準備

モデル反応系として、以下の構造を用意した。今回はファイルの名前を`sn2_I_beta_methyl_diketone.xyz`とした。
初期構造は以下のものを使用した。

```
22
OptimizedStructure
C     -0.331837279705     -0.631215354746      0.277492284969
C      1.068215211565     -0.737713323997      0.689703872708
C     -1.291895909318      0.297398349869      0.937281017588
C      1.957352535007     -1.726516104192     -0.028267055046
H      1.564321880854     -2.741322945571      0.042837822646
C      0.276948473721      2.206577603876     -1.618001828198
I      0.704424081589      2.802639966425     -3.613567278175
H      2.018975120585     -1.471731291425     -1.087305063777
H      2.951065255168     -1.681709338977      0.408371073247
C     -1.239127383923      0.578856280472      2.413289870680
H     -1.764951994971     -0.239860983433      2.914232517014
H     -0.226475506038      0.616240677064      2.796729670686
H     -1.772775123374      1.505170100772      2.613052568106
O      1.529898300976     -0.012925373019      1.560564468488
O     -2.183422413325      0.754388415338      0.245042799260
H      0.814337794452      1.283709997004     -1.432753481573
H      0.621202263988      2.989330556357     -0.951523001639
H     -0.792207743194      2.055174873079     -1.525341279932
C     -0.855211428838     -1.337493926407     -0.921070638648
H     -1.828072063720     -1.781285265182     -0.702338994559
H     -1.036502815684     -0.620626513799     -1.728199840570
H     -0.184261255814     -2.107086399509     -1.290229503275

```

<MoleculeViewer 
  xyzData={`22
OptimizedStructure
C     -0.331837279705     -0.631215354746      0.277492284969
C      1.068215211565     -0.737713323997      0.689703872708
C     -1.291895909318      0.297398349869      0.937281017588
C      1.957352535007     -1.726516104192     -0.028267055046
H      1.564321880854     -2.741322945571      0.042837822646
C      0.276948473721      2.206577603876     -1.618001828198
I      0.704424081589      2.802639966425     -3.613567278175
H      2.018975120585     -1.471731291425     -1.087305063777
H      2.951065255168     -1.681709338977      0.408371073247
C     -1.239127383923      0.578856280472      2.413289870680
H     -1.764951994971     -0.239860983433      2.914232517014
H     -0.226475506038      0.616240677064      2.796729670686
H     -1.772775123374      1.505170100772      2.613052568106
O      1.529898300976     -0.012925373019      1.560564468488
O     -2.183422413325      0.754388415338      0.245042799260
H      0.814337794452      1.283709997004     -1.432753481573
H      0.621202263988      2.989330556357     -0.951523001639
H     -0.792207743194      2.055174873079     -1.525341279932
C     -0.855211428838     -1.337493926407     -0.921070638648
H     -1.828072063720     -1.781285265182     -0.702338994559
H     -1.036502815684     -0.620626513799     -1.728199840570
H     -0.184261255814     -2.107086399509     -1.290229503275
`}
  caption="初期パスを求めるための初期構造"
  backgroundColor="#333333"
/>


### 2. 遷移状態構造最適化のための初期構造の算出


#### a. 初期構造をカレントディレクトリに`sn2_I_beta_methyl_diketone.xyz`として保存し、以下を実行する。
```
python .\optmain.py sn2_I_beta_methyl_diketone.xyz -opt rsirfo_fsb -os uma-s-1p1 -ma 300 1 6 -elec -1   
```
- `-opt rsirfo_fsb`は準ニュートン法であるRS-I-RFO法を構造最適化に使用することを示す。初期のへシアンに関しては、特にオプションで指定しない限り、単位行列が使われる。
- `-spin`はスピン多重度の指定である。PySCFを使用するときは目的とするスピン多重度に1を引いた値を指定する。（デフォルトでは1が指定される。）
- `-elec M`は形式電荷をMとすることを示す。（デフォルトでは0が指定される。）
- `-ma yyy a b `はyyykJ/molの活性化障壁を超えうるペア同士を近づける力を原子のラベル番号aとbのペアに構造最適化時に加えることを示す。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。

これを実行すると、`omol`のデータセットを使用した`uma-s-1p1`モデルのNNPで得たエネルギーに対して、指定した人工力ポテンシャルを加えた上で初期構造を構造最適化することができる。

結果は`yyyy_mm_dd`（今日の年月日）ディレクトリの中に存在するディレクトリを開いて確認できる。

正常終了していれば、このディレクトリ中に、`sn2_I_beta_methyl_diketone_traj.xyz`が存在するので、これをコピーして、`MultiOptPy-v1.12c`ディレクトリに置く。

`sn2_I_beta_methyl_diketone_traj.xyz`は構造最適化の過程をAvogadro（公式ページ:https://avogadro.cc/ ）等で可視化して確認できるようにしている。この`sn2_I_beta_methyl_diketone_traj.xyz`は次のNEB計算に使用する。

※`sn2_I_beta_methyl_diketone_traj.xyz`をアニメーションとして表示したい場合は、[https://github.com/ss0832/molecule_movie] を使うと良い。

（この人工力ポテンシャルを加えて行った構造最適化の結果は`sn2_I_beta_methyl_diketone_optimized.xyz`で確認できる。構造を可視化して、生成系になっているか確認する。反応系のままであれば、`-ma`の設定を見直してb.をやり直す。今回の場合以下の構造が得られた。生成系の安定構造に近いものが得られていると判断できるため、次のNEB計算を行うことが可能である。）



#### b. `sn2_I_beta_methyl_diketone_traj.xyz`を初期パスとして、NEB法で経路の緩和を行う。

NEB法を用いることで、先ほど得られた`sn2_I_beta_methyl_diketone_traj.xyz`全体のエネルギーを下げることができる。これにより、パスのエネルギー極大値を持つ構造を遷移状態構造に近づける。（この時点ではまだ正確な遷移状態構造は求められていない。）


```
python .\nebmain.py sn2_I_beta_methyl_diketone_traj.xyz -os uma-s-1p1 -ns 20 -modelhess -spng -nd 0.12 -elec -1
```
- `-nd N`はノード間の距離をN Åとして初期パスを作成することを示す。
- `-ns n`はn回分NEB法による経路の緩和を行うことを示す。
- `-fc M`はM回あたりの経路緩和回数に対して1回だけ正確なHessianを計算し、経路緩和に使用する。これを使用すると、Hessianを使用しない場合の経路緩和アルゴリズムとは別のものを使用して、経路緩和を行う。
- `-spng`は緩和中のパスのエネルギープロファイルや各ノードの勾配のRMS値をmatplotlibで可視化するオプションである。
- `-os uma-s-1p1`は今回使用するNNPを指定している。これを使用する際にASEライブラリが必要である。



#### c. 初期構造の決定及び遷移状態構造の計算

`MultiOptPy-v1.12c`と同じディレクトリ内に、NEBという名前を含むディレクトリが生成されている。
そのディレクトリ内の`energy_plot.csv`を確認し、緩和後のパスのエネルギー極大値を示す構造を確認する。

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1 = [-722.1306917894029,-722.1306917894029,-722.1369007195275,-722.1310828511622,-722.1255091105453,-722.119268725853,-722.11047906674,-722.1030815569992,-722.098635703578,-722.0957911066905,-722.0957110070647,-722.0968457459238,-722.0974961282506,-722.0984633693467,-722.097724441098,-722.0954038387551,-722.0914069445257,-722.0868143848984,-722.0831214784747,-722.0804216777389,-722.0788596561782,-722.0777329080059,-722.0769622097677,-722.0681829420523,-722.0887762474597,-722.1123100467579,-722.1235079867257,-722.1339575357892,-722.1486981011935,-722.1558766293166,-722.1629107468036,-722.1646354734673,-722.1667949916249,-722.1705276412014,-722.1745617464471,-722.1774545678304,-722.1784852087181,-722.1793203932008,-722.1803370679099,-722.1810588932851,-722.1815294325884,-722.18189444576,-722.1823157792548,-722.1827171710796,-722.1831112381082,-722.1835384069072,-722.1839604939099,-722.1843847362952,-722.1847063789628,-722.1853986773483,-722.1860550702136,-722.1866985658299,-722.1869994782728,-722.187191447514,-722.1877450303804,-722.1882133091602,-722.1886335211552,-722.1889817118283,-722.1892824665603,-722.1896569073405,-722.1898520833705,-722.1901886209587,-722.1905575769034,-722.190774639705,-722.1909715680786,-722.1912434266645,-722.1915274289917,-722.1919399481982,-722.1922567894443,-722.1925836716192,-722.1929400632604,-722.1932527689756,-722.1934893353615,-722.1936645872448,-722.1938442024637,-722.1940658914524,-722.1941464291641,-722.1946859056645,-722.1947181663102,-722.1951929813317,-722.1955561019722,-722.1959245322139,-722.1964241779442,-722.1967723335705,-722.1974586739879,-722.1979457378911,-722.1983077720787,-722.198865858468,-722.1991824719095,-722.1994398911842,-722.1999294959857,-722.20047251222,-722.2009424907733,-722.201761203226,-722.2020560350367,-722.2024234138721,-722.2026496239073,-722.202624530347,-722.2033341769342,-722.2038210480797,-722.2039218779304,-722.2043154893496,-722.2046474007506,-722.2048074422914,-722.2049410059205,-722.2050419934822,-722.205175504541,-722.2053791268672,-722.2055768613188,-722.2056994728005,-722.2057885269022,-722.2058818567223,-722.2060208526165,-722.2061499652929,-722.206369218524,-722.2065231794326,-722.2067204407515,-722.206897269744,-722.2069941217748,-722.2069493318724
];

export const dataset1_itr5 = [-722.1426000681336,-722.1388093108434,-722.1397702084558,-722.1374815951453,-722.1343702302302,-722.1311224103189,-722.124701131197,-722.1186647105379,-722.1148050160506,-722.1125925333077,-722.1123127891757,-722.1130442261556,-722.1127914944,-722.1126169697393,-722.1104753868185,-722.1074923022164,-722.103337635731,-722.0995690455874,-722.0990905681676,-722.1023805494659,-722.1073450264987,-722.1131332101635,-722.1119039411288,-722.1016741096674,-722.107725425247,-722.1313603698179,-722.1417660401977,-722.1497195948476,-722.1615481419445,-722.1644964250028,-722.1710300205876,-722.1740205176031,-722.1767122575585,-722.179946277764,-722.1815359863534,-722.1833289317534,-722.1843960389114,-722.1848837336584,-722.1857531063647,-722.1864024723321,-722.186878549041,-722.1873337728612,-722.1869220071623,-722.1880593132048,-722.1885259798286,-722.1891456085252,-722.1895837294718,-722.1900857759128,-722.190656391559,-722.1908615033772,-722.1915732878236,-722.1917376927,-722.1926905645788,-722.192455890724,-722.1930954435674,-722.1936807088059,-722.1936319761304,-722.1931121784487,-722.1944521780753,-722.194802401467,-722.1950366372358,-722.1948718818907,-722.195762440431,-722.1959930838955,-722.1963717653472,-722.1966802128675,-722.1968497345872,-722.1971037543153,-722.1975792877978,-722.197789341225,-722.1975457128943,-722.1984220248813,-722.1989008177228,-722.1992197442578,-722.199533168434,-722.1998331696581,-722.200105308619,-722.2004183648029,-722.2004787505633,-722.2006252464881,-722.2013258159355,-722.2018873018715,-722.2023623797446,-722.2028356351803,-722.2032726171036,-722.2038013867846,-722.2042146945457,-722.2043915585851,-722.2050408018886,-722.2054751552964,-722.2055876557555,-722.2061983474996,-722.2062704213919,-722.2070355647008,-722.2075082243398,-722.2078764793471,-722.2080536412849,-722.207674188802,-722.2073408580027,-722.2085769787008,-722.2086836438556,-722.2091822381798,-722.209287186038,-722.2096922753077,-722.2092609885011,-722.2090060225074,-722.2097755641989,-722.2100356996061,-722.2096996351507,-722.2105173487678,-722.2106051587054,-722.2103249239171,-722.2109939862266,-722.2111001081549,-722.2111367321362,-722.2111988176699,-722.2115618857401,-722.211225190441,-722.2116319093903,-722.2115997363619
];

export const dataset1_itr10 = [-722.144756449596,-722.1411519576686,-722.1415379639166,-722.1406940440012,-722.1402161273314,-722.1381254061836,-722.1345888263324,-722.1303482336787,-722.1273509638552,-722.1261324454485,-722.1260471413622,-722.1278053815972,-722.1254585028621,-722.1239868671844,-722.1217435256708,-722.1187990714834,-722.1141899784942,-722.1094691035069,-722.1136713636444,-722.12539555868,-722.1344111124064,-722.1421424260793,-722.1334439238803,-722.1237819393622,-722.12658762546,-722.1480915099334,-722.1552951491402,-722.1599633749641,-722.1691075419488,-722.1718025938336,-722.175731260565,-722.1777276530569,-722.1806804571615,-722.1830158229992,-722.1840605877762,-722.1851421167221,-722.1860402804336,-722.1864655917485,-722.1867797343855,-722.1870443733158,-722.1877496215205,-722.1882723631395,-722.1881594946883,-722.1894066025808,-722.189889723711,-722.1905197613286,-722.1909191905285,-722.1914755420977,-722.1917543574876,-722.1919206023249,-722.192770716775,-722.1930266816045,-722.1936286116307,-722.1931486797658,-722.1940009145517,-722.1944442224353,-722.1946162675299,-722.1941647586782,-722.1952356859452,-722.1955223868814,-722.1958464302597,-722.1953483616386,-722.1964960065084,-722.1967977075058,-722.1970806584267,-722.1973440006227,-722.1975700003767,-722.197727325785,-722.1982128125791,-722.1985603373615,-722.1980014098473,-722.1992297501398,-722.1996424095339,-722.1999995196359,-722.2003668984713,-722.2007088332778,-722.2010173508918,-722.201393035836,-722.201629812503,-722.2018034171834,-722.202559343165,-722.2030563078097,-722.2035589850944,-722.2040571413328,-722.2045086677078,-722.2049945400175,-722.2054415102994,-722.2057694438804,-722.206290520773,-722.2067042841435,-722.2069642267929,-722.2074830081154,-722.2076844925824,-722.2082760487345,-722.2085124048391,-722.2087260330472,-722.209024772584,-722.2090419455512,-722.2082318020587,-722.2094549904609,-722.2091784180707,-722.2097377661474,-722.2099118439606,-722.2100463363319,-722.2100098174913,-722.20971202422,-722.210414065636,-722.210599551206,-722.2102149994032,-722.2109280805839,-722.2110934492493,-722.21077490823,-722.2114578315773,-722.2116014361352,-722.2116744562929,-722.2113998290041,-722.2118628507533,-722.2114927032148,-722.2119226582403,-722.2118751872522
];

export const dataset1_itr15 = [-722.1459259461905,-722.14224325593,-722.1426732109554,-722.1425299568662,-722.1421972569105,-722.1407036117972,-722.1390770689453,-722.1365782269734,-722.1339785639124,-722.1335390761378,-722.1330173421164,-722.1345571965304,-722.1325828660445,-722.1314611032897,-722.1296895101964,-722.1273053065427,-722.1232786487572,-722.1157414158995,-722.1286962730828,-722.1471124405178,-722.1544253909183,-722.1581030169058,-722.14882950944,-722.1401626896134,-722.1411816686543,-722.1599484800435,-722.1638952309609,-722.1656676564174,-722.1745470267609,-722.1768684789904,-722.1782694952211,-722.1794879522956,-722.1831814194693,-722.1847229561332,-722.1853208207223,-722.1861465075026,-722.1868662300656,-722.186983531946,-722.1872296486044,-722.1873930546451,-722.1884435320623,-722.1889294919891,-722.188647820279,-722.1901898125523,-722.1907301827479,-722.1913144491506,-722.191776314353,-722.1922335183214,-722.1923826077148,-722.1926088002265,-722.193503949907,-722.1936751013063,-722.1942734039814,-722.1935234184444,-722.1946225934903,-722.1950015728404,-722.1951031912457,-722.1945138079997,-722.1957929136862,-722.1959687964132,-722.1963562571063,-722.1955057045703,-722.1969778834746,-722.1972449055922,-722.1975418051682,-722.1977862746237,-722.1979866726376,-722.1980963693469,-722.1986665118602,-722.1990396208593,-722.1981576488025,-722.1997898342008,-722.2002030718683,-722.2005885874601,-722.2009990739481,-722.2013611081356,-722.201707458848,-722.202142863662,-722.2023569825262,-722.2024516791744,-722.203412103654,-722.2039212996569,-722.2044532761267,-722.2049557080834,-722.2053896409287,-722.2058781067069,-722.2063192241611,-722.206689073801,-722.2071217975293,-722.2075008469733,-722.2078020222675,-722.2082015390847,-722.2084541394145,-722.2088734752376,-722.209104434124,-722.2091002810697,-722.2094978352619,-722.2095710131306,-722.2084124686837,-722.2098272057648,-722.2092480737288,-722.2100634216819,-722.210180425664,-722.2102267751521,-722.2102152272079,-722.2098247875306,-722.2107066719701,-722.2108190497652,-722.2103763727252,-722.2111665044539,-722.2113189233002,-722.2109012697268,-722.2116700579105,-722.2117847137522,-722.2118160807026,-722.2114436375941,-722.2119396734967,-722.2115511438739,-722.2119676409004,-722.2117492813646
];

export const dataset2 = [-722.1462673728173,-722.1427277614116,-722.1433189670951,-722.1432541303818,-722.1431120854097,-722.1417953393827,-722.14113625667,-722.1400508638066,-722.1374426493089,-722.1378422099347,-722.137253247251,-722.1382694575891,-722.1367328712959,-722.1361495862056,-722.1349071220237,-722.1331771208057,-722.1303824219023,-722.1208153355517,-722.1464242250928,-722.1610677719939,-722.1667814109619,-722.167282090575,-722.1606808720506,-722.1507100369731,-722.1530232882345,-722.1685607231288,-722.1691352465011,-722.1703638671686,-722.1786949292,-722.180365368259,-722.1806336695875,-722.1812120831626,-722.1848741308155,-722.1857711204568,-722.1860108936315,-722.1869536369643,-722.1874428036798,-722.1875454734914,-722.1875708824736,-722.18765450431,-722.1891280149954,-722.1894663925444,-722.1889799945317,-722.1908909077027,-722.1914543562635,-722.1919658127897,-722.1925065159306,-722.1928138945212,-722.1929920202481,-722.1931487498596,-722.1940989056058,-722.194230103571,-722.1948423023307,-722.1937654346189,-722.1951830630669,-722.1954875502906,-722.195591061227,-722.1946637560415,-722.1962604389583,-722.1963599895982,-722.196815038184,-722.1955701908148,-722.1974095557968,-722.197614264576,-722.1979562169058,-722.198193676987,-722.198370243128,-722.1984845660244,-722.1990939259874,-722.1994738340796,-722.1982045064703,-722.2002985395476,-722.2007248672218,-722.2011327777647,-722.2015766639217,-722.2019617063806,-722.2023497979176,-722.2028356877506,-722.2029067277601,-722.2029894734249,-722.2041654011203,-722.2046773307793,-722.2052160362484,-722.2057076562451,-722.2060765596195,-722.206607081644,-722.2070292737874,-722.2073924119513,-722.2077605968649,-722.2080975725389,-722.2084121707852,-722.208723369485,-722.2089978215395,-722.209296876498,-722.2094900022861,-722.2091278454344,-722.2098623227305,-722.2098787947604,-722.2084731348191,-722.210146903331,-722.209284978085,-722.2103166178085,-722.2103677862416,-722.2103969101922,-722.2103931426534,-722.2098648811522,-722.2109456040199,-722.2109907093441,-722.210424071518,-722.2113802027558,-722.2114854309889,-722.2109388224501,-722.2118102103516,-722.2118842819154,-722.2118790424081,-722.211465979975,-722.2119742121889,-722.2115793741293,-722.2119880206565,-722.2118622724798
];

<MultiDataGraph datasets={[ { data: dataset1, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad = [0.015155444460330585,0.015155444838949395,0.0065046263341441,0.010780579401160046,0.010932006864903976,0.011157549167408447,0.012254680849940702,0.012866111341702098,0.012874620165887812,0.01281399469783841,0.012597041112195437,0.01214822579528643,0.011756072628912989,0.01102810846902309,0.010445336115299925,0.010088138235719751,0.009899038703961175,0.010275429795455872,0.011398692182854109,0.013567448274135216,0.016106578484251864,0.018724072617786778,0.020673916490628386,0.02464829218106796,0.020713187858541714,0.017102790415658566,0.01919362407953142,0.018468214409346585,0.01220824873576268,0.01208258192151037,0.00879433710031308,0.0099752069309901,0.012969901929016318,0.012961881740706277,0.010519491611127902,0.009587751387790866,0.01043463042904373,0.010712000405004174,0.010119825802132113,0.010157808954121975,0.009989355664187911,0.01004140792629769,0.010051948750306194,0.010118635024898603,0.010234594566078031,0.010321648372159181,0.010351451171783647,0.010301924482666222,0.010263325762289104,0.010095438582621881,0.010057270549448744,0.01006121793062613,0.010099224480437692,0.010171994265845497,0.010155408029470929,0.01013555225086988,0.010070524689573167,0.010061894385314412,0.010059304169816624,0.010002511987485104,0.01012391525483087,0.010072074555422743,0.010009993326633724,0.010049031889217235,0.010151756806732087,0.010162716297834815,0.010092220424459968,0.01002718170057718,0.01021450053896888,0.010104327691564644,0.009907481353378248,0.009891547159520299,0.009998530196359275,0.010176093561554135,0.010328357761535078,0.010431927548744717,0.010625621890868811,0.010315034107112674,0.010320024657087635,0.00999600174659575,0.010114955558356791,0.010363430544780285,0.010426040785633707,0.01057339707207694,0.010369282141445607,0.010262420906581863,0.010237856622758687,0.01002835765894219,0.01015516898837903,0.010331491023566274,0.010366821727969391,0.010277368957141585,0.01023990132353418,0.010019038568195736,0.010030448251587007,0.010141665633186924,0.01036413447486847,0.010606152824100733,0.010085387468042956,0.010020757825252751,0.010091192019685537,0.01007590211892223,0.009978322616448605,0.010107373343663233,0.01002338312111791,0.010068700153698068,0.010058058799349671,0.009956048582854277,0.009977275257881618,0.010065937986688516,0.010032806365299667,0.01002485944199212,0.010079328328936717,0.010127907409370905,0.010095391118432754,0.01005771527658488,0.010074497605099942,0.010022732726235717,0.00999950335937371,0.010080639023385154
];

export const dataset1_grad_itr5 = [0.002962931410823916,0.00516339497489372,0.0036470380080105753,0.005581018536739472,0.007112263354851076,0.007566219791377872,0.009351441689296568,0.010535961208783962,0.011106535294840085,0.0112581262243722,0.010945728393459232,0.01045990927804238,0.009860972351860018,0.009094343910063349,0.008663146769597816,0.008264931833311317,0.007738265831815609,0.007256626049275689,0.007757665651321342,0.009957089986952754,0.012321428510772671,0.013341369235847483,0.014524877099196675,0.018311472001054308,0.016504394247742284,0.01274720036899399,0.013242030024518205,0.01262904693861492,0.006189269345430608,0.008860376763400317,0.0053752506779982554,0.004709732203558937,0.005037579434992351,0.0034878238868855803,0.0032839337072825448,0.0025630059191371958,0.003315319012185653,0.003944791532672707,0.002655117363282727,0.0017120126849844482,0.0016729256670958252,0.0016376989621639862,0.004170308347824494,0.0030275509032853653,0.003284558896579615,0.0029764700238610353,0.0030968739050919567,0.002958102775508351,0.0022117602657763216,0.0025656216342330412,0.00265254393368681,0.00389971770972678,0.002154828468530984,0.0026773909154847383,0.0018372794461600135,0.001411088821682865,0.0030824058681676405,0.004765180243083049,0.0020136407435450846,0.001875555911288214,0.002074495481973587,0.0029231322548972285,0.0018174570990200992,0.002117073698265879,0.0017189848890247926,0.001547742024123139,0.0016906823208862611,0.0018272985860463395,0.001392068858606517,0.0018616947159844637,0.002950025698760997,0.0019257613889624274,0.0013572861766046355,0.001318243579740845,0.0014148216142702173,0.0013597888887036046,0.001323817586718221,0.001578897475205664,0.002010834717064856,0.0023097259983635254,0.001875631674366898,0.0016308275946699698,0.0019069065119257423,0.0019431357091937852,0.0021305664017654143,0.0016039039705043369,0.0015510804277252574,0.0027024531712563655,0.0018357815666526524,0.0016670599597893914,0.0029500416971602428,0.002354682486563273,0.003166072793523599,0.002611670288476252,0.0018108056820877758,0.0021075317979815794,0.002715227428039037,0.00377822446831651,0.00414217320755078,0.0028573296484706323,0.0025301167748793623,0.0016735780625438113,0.00237224422876064,0.001042417557488429,0.002919628488855145,0.003932577120276701,0.0026464221480553417,0.00227716940101432,0.0035219450705088976,0.0012976779846467085,0.0018200535243229332,0.003227015580800997,0.0013930380227526423,0.0016192257719133136,0.001897154490000943,0.0015763639097510836,0.0010606307693745317,0.0025470899839362335,0.0016072185968517782,0.0015882317174991424
];

export const dataset1_grad_itr10 = [0.0014562689475826473,0.0023791566923215997,0.00249837576743024,0.003933316789187726,0.003234058948971375,0.004498011979500342,0.005768830531472978,0.007038093140770796,0.0077860581564408796,0.007859140665739386,0.00755709976354576,0.006512302254478401,0.0068299403120894685,0.006824549237406731,0.006871744590694118,0.006904682147256431,0.006635783496821322,0.005139916847190419,0.006727122817387238,0.009985416552927466,0.010352997735011806,0.008818410959525022,0.011322805862503216,0.0142998350890608,0.01320205619357485,0.009276961087164824,0.0095221416673896,0.008802379574370599,0.0045049360493105255,0.00673130229269847,0.004440239844635136,0.0037035752136825514,0.00353778666251371,0.0017850452979433847,0.0017700851379100927,0.0013100418811564166,0.0012679556677623902,0.0014518665353818769,0.0011440871518709013,0.0009114465414249848,0.0008252713191644281,0.0007593322257986606,0.0019139863379284978,0.0012090999894077948,0.0017184137367917728,0.00133504396513056,0.0018872040002423554,0.0015598234411961637,0.0012040392122143891,0.0018212242650253025,0.001394164570432787,0.002354284479711866,0.0009843376547634685,0.0016827381485164448,0.0009253079748255264,0.0008108050884623827,0.0014084335631275088,0.0024077256683866363,0.0011707149116945447,0.0008922667489062693,0.0007639025655934507,0.0016223057711973708,0.0008994092922215114,0.0008107100895476321,0.0007862157532698949,0.0007505120384266018,0.0007269258756651233,0.0007439236295585419,0.0006887734125356501,0.0007252067325208753,0.0019198351922657497,0.0010796097444133125,0.00079718709860541,0.0007774485476695044,0.0008983395198652815,0.0007638798843079379,0.0007527734068102392,0.0010431659230611065,0.001260568025756073,0.0010409832341452198,0.0010578229114455817,0.0009990345346259782,0.0012604822875440134,0.0012831341947550853,0.0013504678759620136,0.0011232774052263943,0.0010277576165506604,0.001707120159776797,0.0011626071785873777,0.001048947470801626,0.001966402863480119,0.0011507131493745685,0.0018284027225512834,0.0009867700459168266,0.001013635341068975,0.000993271055509568,0.0010028621273022666,0.0015895502318499426,0.002049039638809039,0.0007999513455323481,0.001426248587028345,0.0006619168265224859,0.0008759826643625915,0.00037103144702318737,0.0007899285019454908,0.0014051467536225668,0.0010026958224319973,0.0007925159675337663,0.0017583247127062045,0.0004589726526320791,0.000430642161599434,0.0014800930615288211,0.0004101371249969692,0.0003671296251900674,0.000360718629023372,0.0008125924170821577,0.0002557053734966908,0.0013039232001953423,0.00030202482960694376,0.0012915991867451964
];

export const dataset1_grad_itr15 = [0.0009904245184552787,0.001169839641422704,0.0014966038887728205,0.001892313780423542,0.0020853712468332573,0.0031320630449748546,0.003864508163073527,0.0047483783211372714,0.00556805485977309,0.005413309687980587,0.005309413452044388,0.004435791527969692,0.004898987517844738,0.005033917253608966,0.00527085846088435,0.005527460623101182,0.005926639424745226,0.004136521118309943,0.008582253807981829,0.008756272570347168,0.0070701067001237745,0.0060932756499325344,0.008896377120939242,0.0113788430175103,0.01068407855876358,0.007006696489164455,0.007474362036556258,0.007088677709755484,0.0035210815315631235,0.0050858074062687,0.0038264765183836542,0.003389705948925589,0.002430738702034573,0.0012120061925922508,0.001322434776317494,0.0009567070735891018,0.0008709184096242836,0.001054160529974805,0.000817062122600493,0.0007151179427680453,0.0007424307345499085,0.0007040823435684716,0.0012143637747466633,0.0009132965404663653,0.0012851904062579876,0.0010780677753555092,0.001462858245611772,0.0012677770342336978,0.0009530583216208899,0.001459941673889551,0.0010518992736151414,0.0018216123309603713,0.0006652585893734335,0.001255033192400235,0.0007463915195437376,0.0007328588000312662,0.0007232213480628203,0.0013782409326981208,0.0007922097763063359,0.0006659666088084621,0.0005704104084631656,0.0011469017240550517,0.0006623249380251584,0.0006194306513440408,0.0005848545811327073,0.0005513112456464404,0.00061885040088729,0.0005268102688955587,0.0005130207769638975,0.0004266800052936909,0.0013501704992805962,0.000730095307890224,0.0006293005034107005,0.0006507897050301888,0.0007278563162122771,0.0006108126610773205,0.0006378936744896522,0.0008665436941364279,0.00100519175431841,0.0007687809470490959,0.0008340373512281414,0.0007937706801389791,0.0009194332713983324,0.0009684591020718581,0.0009573623786209333,0.000877916578126817,0.0008399585445331863,0.001172728178361207,0.0009598974383546781,0.0008630738968406196,0.0014161323521074836,0.0008441801121471079,0.001227460711719957,0.0007195532196616144,0.0007013404606798386,0.000682377257371565,0.0006102245192385914,0.0007129040421877316,0.001317025730325865,0.0004339347665106031,0.0011246904790122839,0.0004207516585236803,0.0005514021070638347,0.00030767171672696383,0.0004219027365639629,0.000827467519478548,0.0005654099158370035,0.0003727884564660098,0.0009240888948542078,0.0003522644202375045,0.00033189131033751194,0.0007622927572953809,0.00030582732113468785,0.00025225762205045,0.00023349283753681943,0.0006075074325393748,0.00015490513089442865,0.0010524076775512196,0.0001402745187480195,0.0016676386532255597
];

export const dataset2_grad = [0.0013386633242197658,0.0010010359619206676,0.0011356934948750417,0.001192491244538061,0.0015033197281464025,0.0024754553547653617,0.002822381946151695,0.003361476665461286,0.004303494128343312,0.0038597823420297582,0.003856738302181756,0.0032824643632474453,0.003718402257412206,0.0037975351813257265,0.004057817214492918,0.004326706526203433,0.004764193055574446,0.004255681264035409,0.009281747413594138,0.006753220747240805,0.004978581346263603,0.00462629197596325,0.006865078604901953,0.00914503657721962,0.008426417283134363,0.005300337546018797,0.006423484765012113,0.005849468840075402,0.002745271992657607,0.0037226634147490196,0.002928976652927362,0.002772648790491163,0.0015929235934624504,0.0009374413317015473,0.0010515826373118653,0.0007933469572728177,0.0007850959130443822,0.0009103402992824382,0.0007401437268980849,0.0006535740738204527,0.0008389244112687931,0.0007539501189810063,0.0009171335540575468,0.000925617730687703,0.0011434354968664253,0.0010113832416855182,0.0012402553787937026,0.0009820528165400025,0.0008831456580660427,0.0012675617217539836,0.0009364743090800519,0.0012419356981422027,0.0006863897311235117,0.0010232844673635467,0.0007370767893828142,0.0007496547802181954,0.00070263229434452,0.001004225364515161,0.0007121366768357372,0.0005985951688639164,0.0005720864212721728,0.0008963231393742031,0.0005933253065244393,0.0005632234165101909,0.0005264319987152657,0.0005271493458784667,0.0005966038698362115,0.0004607280899685783,0.00047878469730356813,0.00039642570438467683,0.0011282694720048318,0.000582676913766194,0.0005700519744046194,0.0005916754769394816,0.0006284823925489523,0.0005638396848455302,0.0005880398047455804,0.0007499663543830877,0.0007970920727239653,0.000681553473344106,0.0007101133495282702,0.0006714560389363252,0.0007135615474177735,0.0008136349645770686,0.000704543789905804,0.000712699333752604,0.0007210643758023331,0.0008764092150189026,0.0008331412501525415,0.0007501867482325796,0.0009525744687668658,0.0006907749384227299,0.0008068079450242439,0.0005941980374717439,0.0005404722022855432,0.0005190369596066665,0.0005051425314536453,0.0004969361159754351,0.0011729795780198878,0.00042737074324045,0.0009851745732662608,0.0003786438807300496,0.0004438790639081656,0.000326830297635781,0.00036520239769418804,0.0006356874220087605,0.0004300635389267646,0.00037009652609562544,0.0006841971149083898,0.0003806257482283022,0.0003359096166189625,0.0005713224862484201,0.00023926707345075238,0.00018963585632502126,0.00018618728409626757,0.0005701220305248132,0.00011492482597146573,0.0009511881133823249,9.271450988196019e-05,0.0015508264127060281
];

<MultiDataGraph datasets={[ { data: dataset1_grad, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

経路緩和の結果、経路のエネルギー極大値を示す構造の中から目視で、ITR. 5の経路の17番(グラフ上では18番)の構造を遷移状態構造を求める初期構造として採用した。


※こちら[https://ss0832.github.io/molecule_viewer/] を使うことでも可視化は可能である。


`sn2_I_beta_methyl_diketone_traj_17_itr5.xyz`
```
22
-1 1
C      -0.198295176571     -0.072669526362     -0.009315684189
C       1.048846453929     -0.523044462357      0.612624045349
C      -1.259020905584      0.456607002704      0.819690980722
C       1.896916897442     -1.633409709338     -0.055765878370
H       1.462656441415     -2.631716965631      0.091469101561
C       0.185296271510      1.686803194927     -1.264763356279
I       0.617788620625      2.716017910308     -3.435757381030
H       2.031860184956     -1.504476468192     -1.138523252518
H       2.874115538774     -1.637698511638      0.447768261792
C      -1.156067414027      0.636787415636      2.318895710882
H      -1.704156456281     -0.223556583092      2.718013138638
H      -0.156757328325      0.632126829999      2.734949474539
H      -1.721836998018      1.525977775478      2.595021696216
O       1.567652981385     -0.046734067794      1.627015911031
O      -2.371087594466      0.693660432629      0.327844271826
H       0.881658163225      0.909497161567     -1.441500671276
H       0.525671892714      2.497632220278     -0.635750846334
H      -0.883109406570      1.566088467536     -1.353881313847
C      -0.775640174167     -1.032099581492     -1.068483473089
H      -1.643111803246     -1.476580231825     -0.585092803789
H      -1.118854913315     -0.671685415729     -2.043128815681
H      -0.104525275406     -1.867526887609     -1.261329116153

```


<MoleculeViewer 
  xyzData={`22
-1 1
C      -0.198295176571     -0.072669526362     -0.009315684189
C       1.048846453929     -0.523044462357      0.612624045349
C      -1.259020905584      0.456607002704      0.819690980722
C       1.896916897442     -1.633409709338     -0.055765878370
H       1.462656441415     -2.631716965631      0.091469101561
C       0.185296271510      1.686803194927     -1.264763356279
I       0.617788620625      2.716017910308     -3.435757381030
H       2.031860184956     -1.504476468192     -1.138523252518
H       2.874115538774     -1.637698511638      0.447768261792
C      -1.156067414027      0.636787415636      2.318895710882
H      -1.704156456281     -0.223556583092      2.718013138638
H      -0.156757328325      0.632126829999      2.734949474539
H      -1.721836998018      1.525977775478      2.595021696216
O       1.567652981385     -0.046734067794      1.627015911031
O      -2.371087594466      0.693660432629      0.327844271826
H       0.881658163225      0.909497161567     -1.441500671276
H       0.525671892714      2.497632220278     -0.635750846334
H      -0.883109406570      1.566088467536     -1.353881313847
C      -0.775640174167     -1.032099581492     -1.068483473089
H      -1.643111803246     -1.476580231825     -0.585092803789
H      -1.118854913315     -0.671685415729     -2.043128815681
H      -0.104525275406     -1.867526887609     -1.261329116153
`}
  caption="NEB法により緩和した経路から得られた遷移状態構造を求めるための初期構造"
  backgroundColor="#333333"
/>


構造が壊れていないので、これを遷移状態を求めるための初期構造とする。

`sn2_I_beta_methyl_diketone_traj_17_itr5.xyz`を`MultiOptPy-v1.12c`と同じディレクトリ内にコピーする。

そして、以下を実行する。

```
python .\optmain.py sn2_I_beta_methyl_diketone_traj_17_itr5.xyz -freq -tcc -opt rsirfo_bofill -fc 5 -order 1 -os uma-s-1p1 -elec -1
```
- `-opt rsirfo_bofill`は遷移状態構造の最適化向けのoptimizerを指定することを意味する。準ニュートン法であるRS-I-RFO法を使用する。今回は`-fc`で正確なへシアンを計算するようにしているので、初期へシアンは正確なへシアンを使用するようになっている。
- `-order 1`は一次の鞍点を求めることを指定する。（デフォルトだと極小値を求めるようになっている。）
- `-fc 5`は5回の反復回数当たり1回正確なへシアンを計算することを指定する。
- `-freq`は収束条件を満たした後に基準振動解析を行うことを示す。（自前で実装しているため、あくまで目安として使用することを推奨する。各振動モードを`vibration_animation`内のxyzファイルで可視化できる。）UMAモデルから算出されるHessianは数値微分により求めているため、原子数Zが多いとZの二乗オーダーで計算コストが急増する。
- `-tcc`は収束条件を厳しくすることを示す。（Gaussianのtightと同等）

実行して得られた正確な遷移状態構造と思われる構造を以下に示す。

(実行して得られた正確な遷移状態構造は計算開始時に、`yyyy_mm_dd`ディレクトリ内に生成された新規ディレクトリ内の`YYY_optimized.xyz`として保存されている。)

```
22
OptimizedStructure
C     -0.374568497051     -0.424080510323      0.085692051994
C      0.929585925753     -0.645927643573      0.647628413142
C     -1.421598315793      0.269675998930      0.810770800715
C      1.820325559938     -1.669992726188     -0.049385821392
H      1.318536831429     -2.631394152298     -0.172785348738
C      0.288967715970      1.441805721481     -1.110377032846
I      0.979699261781      3.420623333131     -2.535634076261
H      2.096723481600     -1.319196162370     -1.047626253131
H      2.724205739041     -1.792378119151      0.543216903656
C     -1.109348451787      1.035179643961      2.078269336725
H     -0.655815297675      0.386506926418      2.826854551823
H     -0.375670494894      1.819455974137      1.888977304466
H     -2.040711869631      1.465531574351      2.443204420437
O      1.411550119192     -0.038543353264      1.611372454308
O     -2.585689857689      0.280131148514      0.395498030377
H      0.818230318803      0.743907890865     -1.732963161558
H      0.761326849189      1.816794811012     -0.219373688719
H     -0.763353853712      1.593837988676     -1.276070075669
C     -0.851142070955     -1.274372930040     -1.068148813258
H     -1.203041780481     -2.263171349415     -0.749515240263
H     -1.695374113599     -0.784059746747     -1.551651161157
H     -0.072837199427     -1.430334318106     -1.817953594649

```

<MoleculeViewer 
  xyzData={`22
OptimizedStructure
C     -0.374568497051     -0.424080510323      0.085692051994
C      0.929585925753     -0.645927643573      0.647628413142
C     -1.421598315793      0.269675998930      0.810770800715
C      1.820325559938     -1.669992726188     -0.049385821392
H      1.318536831429     -2.631394152298     -0.172785348738
C      0.288967715970      1.441805721481     -1.110377032846
I      0.979699261781      3.420623333131     -2.535634076261
H      2.096723481600     -1.319196162370     -1.047626253131
H      2.724205739041     -1.792378119151      0.543216903656
C     -1.109348451787      1.035179643961      2.078269336725
H     -0.655815297675      0.386506926418      2.826854551823
H     -0.375670494894      1.819455974137      1.888977304466
H     -2.040711869631      1.465531574351      2.443204420437
O      1.411550119192     -0.038543353264      1.611372454308
O     -2.585689857689      0.280131148514      0.395498030377
H      0.818230318803      0.743907890865     -1.732963161558
H      0.761326849189      1.816794811012     -0.219373688719
H     -0.763353853712      1.593837988676     -1.276070075669
C     -0.851142070955     -1.274372930040     -1.068148813258
H     -1.203041780481     -2.263171349415     -0.749515240263
H     -1.695374113599     -0.784059746747     -1.551651161157
H     -0.072837199427     -1.430334318106     -1.817953594649
`}
  caption="遷移状態構造"
  backgroundColor="#333333"
/>


停留点に収束した分子構造が得られた。`-freq`オプションにより生成された`normal_modes.txt`や`vibration_animation`ディレクトリ内の振動モードのアニメーションを確認した。

以下に`-freq`オプションで生成された`normal_modes.txt`の一部を示す。
```
Mode                                 0                   1                   2
Freq [cm^-1]                     -444.9434             48.7619             52.1000
Reduced mass [au]                  11.1374              7.0549              3.8821
Force const [Dyne/A]               -1.2991              0.0099              0.0062
Char temp [K]                       0.0000             70.1575             74.9603
Normal mode                   x         y         z            x         y         z            x         y         z     
       C                -0.02955   -0.08999    0.06979    0.02754    0.00395    0.00782    0.01378   -0.01947   -0.01445
       C                -0.01913   -0.00616    0.00359    0.00206   -0.05001    0.04674    0.00816   -0.02280   -0.00250
       C                 0.00764   -0.01924   -0.00010    0.02740    0.02610   -0.01419    0.02557    0.02837   -0.04342
       C                -0.00062    0.00264   -0.00252   -0.00280   -0.05184    0.04235   -0.03421   -0.11693    0.08221
       H                 0.01157   -0.00387   -0.00698   -0.02250   -0.03712    0.00680   -0.08224   -0.09893    0.13787
       C                 0.07150    0.20330   -0.13812    0.04535    0.00876    0.02150    0.01336   -0.03871   -0.03251
       I                -0.00368   -0.01022    0.00755   -0.01980    0.00715   -0.01470   -0.01409    0.00842    0.01911
       H                 0.00766    0.00239   -0.00157    0.02937   -0.03507    0.05724   -0.00022   -0.19697    0.06347
       H                -0.00270    0.00938    0.00318   -0.02079   -0.08823    0.06229   -0.04968   -0.12318    0.10461
       C                 0.00363   -0.00157   -0.00271    0.00554   -0.03875    0.03047    0.03942    0.08172   -0.07914
       H                 0.00482    0.00826    0.00543   -0.06285   -0.09106    0.02672    0.06432    0.12055   -0.06089
       H                 0.00143    0.00179   -0.00223    0.05467   -0.06896    0.09648    0.02229    0.08636   -0.12725
       H                -0.00074   -0.00175   -0.01085    0.00957   -0.00670    0.00292    0.04089    0.08526   -0.07972
       O                 0.00743    0.00848   -0.00099   -0.01686   -0.10346    0.08967    0.03392    0.04134   -0.05594
       O                -0.00432    0.01047   -0.00512    0.04748    0.10207   -0.06901    0.02588    0.02893   -0.04393
       H                -0.01410    0.00739    0.00611    0.08602    0.01585    0.04821    0.00438   -0.02995   -0.05139
       H                 0.01147   -0.00248   -0.01659    0.01250    0.04060    0.02569    0.02648   -0.05644   -0.03220
       H                 0.01752    0.01133    0.01412    0.04359   -0.03061   -0.00213    0.01302   -0.03076   -0.02219
       C                -0.00200   -0.00968    0.00338    0.04126    0.04068   -0.02543    0.00054   -0.05756    0.01953
       H                -0.01933   -0.02861   -0.06859    0.02841    0.03423   -0.05941   -0.02579   -0.03571    0.05834
       H                 0.00921    0.01931    0.00926    0.05443    0.06209   -0.02626    0.01562   -0.05754   -0.00687
       H                 0.01227    0.01843    0.00925    0.05282    0.05477   -0.01657    0.00277   -0.10699    0.03198

(...snip...)
```
その結果、虚振動が１つであることが確認できた。つまりこの構造は遷移状態構造である。

次に、`vibration_animation`内の虚振動を示す分子振動が示されたxyzファイル(`mode_1_XXXi_wave_number.xyz`)をAvogadroで確認すると、想定される反応系と生成系をつなぐ方向に振動していることを確認できた。


## 終わりに
　
　自作モジュールで、UMAモデルのニューラルネットワークポテンシャル(NNP)を用いて、SN2反応（基質-iodomethane, 求核剤-3-methyl-2,4-pentanedione）のある1つの遷移状態構造を算出する手順を説明した。


## 参考
- https://github.com/ss0832/MultiOptPy (自作モジュールMultiOptPyのレポジトリ)
- https://avogadro.cc/ (Avogadro、分子構造可視化ツール)
- https://ai.meta.com/blog/meta-fair-science-new-open-source-releases/ (UMAの公開に関する記事)
- https://github.com/facebookresearch/fairchem (FAIR Chemistryの提供するGitHubのレポジトリ)
- https://fair-chem.github.io/ (同上のレポジトリの内容に関して説明したサイト)
- https://huggingface.co/facebook/UMA (NNPの配布サイト, Hugging Faceへのアカウント登録と配布元の使用許諾が必要である。)
- _The Journal of Chemical Physics_ 2010, 132, 241102.
- _The Journal of Chemical Physics_ 1991, 94, 751–760.
- In _Classical and Quantum Dynamics in Condensed Phase Simulations_; WORLD SCIENTIFIC: LERICI, Villa Marigola, 1998; pp 385–404.
- _The Journal of Chemical Physics_, 2020, 153, 024109.
- _The Journal of Chemical Physics_, 2022, 144, 214108.


### 個人的な技術的補足

`-modelhess`を使わない場合のアルゴリズムを用いた`nebmain.py`による経路緩和の結果

#### コマンド
```
python .\nebmain.py sn2_I_beta_methyl_diketone_traj.xyz -os uma-s-1p1 -ns 20 -spng -nd 0.12 -elec -1
```

#### 結果

パスの緩和後の各ノードのエネルギー一覧(単位:hartree) (energy_plot.csvに保存されている。)

export const dataset1_nomh = [-722.1306917894029,-722.1306917894029,-722.1369007195275,-722.1310828511622,-722.1255091105453,-722.119268725853,-722.11047906674,-722.1030815569992,-722.098635703578,-722.0957911066905,-722.0957110070647,-722.0968457459238,-722.0974961282506,-722.0984633693467,-722.097724441098,-722.0954038387551,-722.0914069445257,-722.0868143848984,-722.0831214784747,-722.0804216777389,-722.0788596561782,-722.0777329080059,-722.0769622097677,-722.0681829420523,-722.0887762474597,-722.1123100467579,-722.1235079867257,-722.1339575357892,-722.1486981011935,-722.1558766293166,-722.1629107468036,-722.1646354734673,-722.1667949916249,-722.1705276412014,-722.1745617464471,-722.1774545678304,-722.1784852087181,-722.1793203932008,-722.1803370679099,-722.1810588932851,-722.1815294325884,-722.18189444576,-722.1823157792548,-722.1827171710796,-722.1831112381082,-722.1835384069072,-722.1839604939099,-722.1843847362952,-722.1847063789628,-722.1853986773483,-722.1860550702136,-722.1866985658299,-722.1869994782728,-722.187191447514,-722.1877450303804,-722.1882133091602,-722.1886335211552,-722.1889817118283,-722.1892824665603,-722.1896569073405,-722.1898520833705,-722.1901886209587,-722.1905575769034,-722.190774639705,-722.1909715680786,-722.1912434266645,-722.1915274289917,-722.1919399481982,-722.1922567894443,-722.1925836716192,-722.1929400632604,-722.1932527689756,-722.1934893353615,-722.1936645872448,-722.1938442024637,-722.1940658914524,-722.1941464291641,-722.1946859056645,-722.1947181663102,-722.1951929813317,-722.1955561019722,-722.1959245322139,-722.1964241779442,-722.1967723335705,-722.1974586739879,-722.1979457378911,-722.1983077720787,-722.198865858468,-722.1991824719095,-722.1994398911842,-722.1999294959857,-722.20047251222,-722.2009424907733,-722.201761203226,-722.2020560350367,-722.2024234138721,-722.2026496239073,-722.202624530347,-722.2033341769342,-722.2038210480797,-722.2039218779304,-722.2043154893496,-722.2046474007506,-722.2048074422914,-722.2049410059205,-722.2050419934822,-722.205175504541,-722.2053791268672,-722.2055768613188,-722.2056994728005,-722.2057885269022,-722.2058818567223,-722.2060208526165,-722.2061499652929,-722.206369218524,-722.2065231794326,-722.2067204407515,-722.206897269744,-722.2069941217748,-722.2069493318724];

export const dataset1_itr5_nomh = [-722.1389419282069,-722.1324763848856,-722.1375917124171,-722.1332334148439,-722.1270231091295,-722.1204769229558,-722.1118399805875,-722.104858573596,-722.1008865538838,-722.0987862211314,-722.0985591086393,-722.1003521854651,-722.100745586603,-722.101676703136,-722.0996628660636,-722.0969523234614,-722.0931398458723,-722.0893623713466,-722.0875848290468,-722.0880073628971,-722.0897214791203,-722.0926452293681,-722.092577036917,-722.083408924157,-722.0960755120566,-722.1154649661732,-722.1276920925835,-722.1380732038679,-722.1537088050504,-722.157461834383,-722.1657615995578,-722.1697894489369,-722.1728082988718,-722.1769351381408,-722.1787166933075,-722.1810503068016,-722.182274423946,-722.1825103244412,-722.1838968487904,-722.1852393893153,-722.1856749343167,-722.1858904901028,-722.1848497031457,-722.186194311436,-722.1865256620871,-722.1872655541248,-722.1876307775777,-722.1881278473629,-722.1890103801696,-722.1893526479214,-722.1897469252311,-722.1897817442984,-722.1908729286574,-722.1914182229385,-722.1916985979143,-722.1925145416643,-722.1917042579842,-722.1906008597903,-722.1928157520055,-722.1936359539503,-722.1938008670064,-722.1936102996401,-722.1944581360435,-722.194695087945,-722.1952040210964,-722.1955909560864,-722.1952191788685,-722.196092336637,-722.1965987113667,-722.1965367660205,-722.1963917420643,-722.1970760672865,-722.1977968763024,-722.1981228823056,-722.1983913413449,-722.1986167277786,-722.1988952803171,-722.1991474600844,-722.1991137800404,-722.1990843231445,-722.1997637242812,-722.2003794277281,-722.2008387695556,-722.2012759792835,-722.2017273129009,-722.2023043246012,-722.2026741742411,-722.2026019075911,-722.2034268233402,-722.203887216574,-722.2037821110049,-722.2045285042374,-722.2042687543458,-722.2052160888187,-722.2060711098309,-722.2063442125808,-722.2063775071092,-722.2066865854731,-722.2072691871494,-722.2071465756678,-722.2074002449273,-722.2079608021211,-722.2078517362555,-722.2086897595348,-722.2064494408139,-722.2066143188231,-722.2077719695749,-722.2084045831375,-722.2080173327256,-722.2094334191112,-722.2085848292,-722.2082387939096,-722.2098842795958,-722.2098280468897,-722.2098757632059,-722.2104114195972,-722.2103956660283,-722.2103216295112,-722.2104426463601,-722.2110368135042
];

export const dataset1_itr10_nomh = [-722.1399894704487,-722.1343271488628,-722.1379041990895,-722.1337654000753,-722.1274768522193,-722.1215779905327,-722.1127202879178,-722.1057967958822,-722.1020497683265,-722.1001492903615,-722.1003395510678,-722.1080433178994,-722.1036759957566,-722.1039463998973,-722.1011337832805,-722.0984777736112,-722.0953152490246,-722.0927252501385,-722.0928623797869,-722.0953583128685,-722.1004048959605,-722.1057056477299,-722.1029429904291,-722.0955714679438,-722.104832691481,-722.1202827369999,-722.1305543092859,-722.1414058372093,-722.1553168957242,-722.1589862681734,-722.1669876092333,-722.1715604024248,-722.1739382801181,-722.1779445931944,-722.179742024594,-722.1817343166019,-722.1834441658685,-722.1841936081788,-722.1851904638819,-722.1858087257505,-722.1862529974231,-722.1864207492758,-722.1861091650605,-722.1872444734313,-722.1874208292911,-722.1881477715096,-722.1882313758227,-722.1889344861684,-722.1898463006366,-722.1899092623421,-722.1906037511573,-722.1908928528042,-722.1918915659915,-722.1920772443192,-722.1923521344595,-722.1930513195555,-722.1920666251169,-722.1912489991172,-722.1931818691536,-722.1942061665575,-722.1944381067561,-722.1945066233909,-722.1950778698807,-722.1954741974324,-722.1957734801957,-722.196152144124,-722.1959130368399,-722.1966996288346,-722.1970699516073,-722.1970515870464,-722.1970783979034,-722.1976909997022,-722.1982223978986,-722.1985413594804,-722.1987565297509,-722.1990455087338,-722.1993011055711,-722.1995281041609,-722.1997028829114,-722.1998597527104,-722.2003381600364,-722.2008253641271,-722.201234518834,-722.2016659107812,-722.2021637165508,-722.2026894196305,-722.203127540577,-722.2032306835213,-722.2039617262238,-722.2044667166022,-722.2044813311477,-722.20528570943,-722.2051680395573,-722.2062170450058,-722.2065889273644,-722.2070264174673,-722.2074044330284,-722.207559638101,-722.2077798551211,-722.2078402934518,-722.208326831652,-722.2086897244878,-722.2086316868679,-722.2091687977044,-722.2067602715215,-722.2069552197469,-722.2089480900281,-722.2091903164837,-722.2086924055736,-722.2099347470914,-722.2089082417347,-722.2086572185141,-722.210281711124,-722.2106010582214,-722.2107372328426,-722.2108357846465,-722.2109890095708,-722.2111390978,-722.2111641387901,-722.2114296013219
];

export const dataset1_itr15_nomh = [-722.1405177231882,-722.1362294930738,-722.1383478223948,-722.1346411425505,-722.1280452599125,-722.1233875043415,-722.1140842771283,-722.1064888577014,-722.1027582145583,-722.101035993746,-722.1014414334844,-722.1134663043964,-722.1055822038851,-722.1050299440382,-722.1024554358696,-722.0999344793214,-722.0977547741657,-722.0957836154216,-722.0969873615717,-722.102740296845,-722.1112836553035,-722.1162379862668,-722.1116526988654,-722.1075712452955,-722.114893237789,-722.1277683896238,-722.1352528418923,-722.1447784590316,-722.1559947898454,-722.1600493975113,-722.1675341476783,-722.1720678811309,-722.174711659442,-722.1784070191467,-722.1801715941039,-722.1819499775286,-722.183733688078,-722.1845490360311,-722.1855559151395,-722.186096040007,-722.1864898266605,-722.1868310605295,-722.1869530236439,-722.1877608014728,-722.1879176887951,-722.1885609566068,-722.1886932059782,-722.1894726133642,-722.1902518630392,-722.1902415066885,-722.1910142025984,-722.1913370193362,-722.1923447045227,-722.1924637061765,-722.1927247528024,-722.1933418055538,-722.1927465169099,-722.1925368314749,-722.1936786059936,-722.1944819854399,-722.1946466005976,-722.1949058948799,-722.1953795007844,-722.1957603200952,-722.1960384345479,-722.1963951416108,-722.1962530440684,-722.196910418246,-722.1972542981539,-722.1973174175704,-722.1975532479719,-722.1979883899344,-722.1984558275893,-722.1987470320486,-722.198943189391,-722.1992917831031,-722.1995182559899,-722.1997127836528,-722.1999912660975,-722.2002765125885,-722.2007889153803,-722.2011540687394,-722.2015969560606,-722.2019546970063,-722.202455727088,-722.2029724756919,-722.2033541186044,-722.2036152528474,-722.204238859364,-722.2047652283342,-722.2048537041625,-722.2056342856187,-722.2055624044842,-722.2064715378667,-722.206834728601,-722.207270291126,-722.2077075008539,-722.2079518125984,-722.2080699205569,-722.2081200200605,-722.2086088187839,-722.208943025755,-722.2089867467279,-722.2093868943887,-722.2069719546282,-722.2070945135396,-722.2093178870978,-722.2094397801185,-722.2090000820626,-722.2102063778727,-722.2091469810266,-722.2090022724922,-722.2104809175444,-722.2107794467998,-722.2109293247478,-722.2109944768829,-722.2111254119966,-722.2113390226813,-722.2113913301376,-722.2116304198983
];

export const dataset2_nomh = [-722.1409388025933,-722.137625769215,-722.1394027332415,-722.1378073821056,-722.1302180345492,-722.1272870734075,-722.1205536843672,-722.109630844821,-722.1041858664117,-722.1022415097631,-722.1025547499431,-722.1158415710978,-722.1077658080053,-722.1063567485174,-722.1038135284439,-722.101873465037,-722.1013311672634,-722.0995625882011,-722.1005400892692,-722.1071806391457,-722.1187558236434,-722.1318798608395,-722.1238378128378,-722.1233615083243,-722.1282077284492,-722.1389819517348,-722.1457524641742,-722.1544562146422,-722.1597405995224,-722.1622961298098,-722.1687451572926,-722.1726112653575,-722.1754765048526,-722.1787444504301,-722.1807538628349,-722.1822687638761,-722.1838988639855,-722.1847539025212,-722.1857251214374,-722.186217705223,-722.1866320819139,-722.1869926266094,-722.187186383241,-722.1879863456173,-722.1882977370749,-722.1890038088811,-722.189234907955,-722.190026984785,-722.1906172792498,-722.1905755384253,-722.1912784034428,-722.1916368453259,-722.1925971821884,-722.1927218964823,-722.1929584453447,-722.1935593414883,-722.193392535901,-722.1934608597779,-722.1940459497822,-722.1946230490996,-722.1948141596924,-722.1951397100863,-722.1955455178169,-722.1959289130729,-722.1962171035012,-722.19653895645,-722.1964717891199,-722.1970422645784,-722.1973831129319,-722.1974937383833,-722.1978925893097,-722.1983093316645,-722.1986554195253,-722.1988853970992,-722.1991278338361,-722.1994869240864,-722.1996926842717,-722.1998700039205,-722.2002789483462,-722.2005583770564,-722.2010543253417,-722.2014364589104,-722.2019009526281,-722.2021786465182,-722.202722644065,-722.2032210456315,-722.2035189265198,-722.2039629178174,-722.2044649292117,-722.205009715313,-722.2051918363833,-722.2058986091271,-722.2058626510365,-722.2066639977642,-722.2070259092876,-722.2074930840911,-722.2078767947689,-722.2081778473993,-722.2083034203415,-722.2083973634818,-722.2088002798455,-722.2090626932994,-722.2091637684782,-722.2095490212184,-722.2071383746999,-722.2071961319448,-722.2096265273758,-722.2096865100972,-722.2093104922078,-722.2104104032379,-722.2094979053556,-722.2094905279891,-722.2106688388718,-722.2109118714056,-722.2110503415968,-722.2111139166225,-722.21123410987,-722.2114694320919,-722.2114674344201,-722.2117651400741
];

<MultiDataGraph datasets={[ { data: dataset1_nomh, label: "緩和前の経路のエネルギー", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_itr5_nomh, label: "ITR. 5の経路のエネルギー", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_itr10_nomh, label: "ITR. 10の経路のエネルギー", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_itr15_nomh, label: "ITR. 15の経路のエネルギー", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_nomh, label: "緩和後の経路のエネルギー", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="Electronic Energy [hartree]" height="500px" />

export const dataset1_grad_nomh = [0.01515544468251241,0.01515544453921617,0.0065046269254462954,0.01078058004406027,0.010932007211664412,0.011157549691169246,0.012254680198903885,0.01286611108199242,0.012874619847328772,0.012813994266101433,0.012597041232160978,0.012148225442175179,0.011756072916240501,0.011028108910243415,0.010445336080850047,0.010088137742777501,0.009899038757781023,0.0102754298967147,0.011398691821407203,0.013567448817299302,0.01610657948027579,0.018724072934416875,0.020673917032266627,0.024648291092434195,0.020713188413950364,0.01710278998194669,0.019193624717096448,0.01846821484908855,0.01220824829898795,0.012082582365494731,0.00879433735471234,0.009975207344865905,0.012969901810827356,0.012961881343911711,0.010519491723306433,0.009587751761741235,0.010434630441599285,0.010712000300785268,0.010119826162037594,0.01015780907490777,0.009989355016201814,0.010041407789318346,0.010051948945100676,0.01011863497988524,0.010234594749587034,0.010321648109146393,0.010351450583360764,0.010301924879799095,0.010263325846210333,0.010095439698480913,0.010057271029638387,0.010061217457596531,0.010099224980197292,0.010171994615198712,0.010155408199121967,0.010135552106074325,0.010070525079132068,0.010061895379459765,0.010059303908574064,0.010002512167662559,0.010123914928258662,0.010072074704154733,0.010009993113322312,0.010049031902765286,0.010151755976637495,0.010162716371232297,0.010092220230203562,0.010027181579472534,0.010214499779564212,0.010104327356541648,0.009907481500379352,0.00989154743566066,0.00999853051221772,0.01017609365561812,0.010328358252972559,0.010431927221579394,0.01062562212314212,0.010315034179472583,0.010320024760517434,0.009996001471433508,0.010114954809423503,0.010363429886705158,0.01042604094113084,0.010573396028197823,0.010369282086919071,0.010262421155176477,0.010237857396764761,0.010028357419052402,0.010155168191789172,0.01033149097810198,0.010366821867748396,0.010277369659389777,0.010239901407739732,0.0100190384505116,0.010030448524865879,0.010141666310634664,0.01036413439237479,0.010606152748003196,0.0100853878683827,0.010020757080975572,0.010091192140415536,0.010075901093409664,0.009978322944342569,0.01010737496348467,0.010023383015339277,0.010068701346947194,0.010058058228078308,0.009956049083786174,0.00997727516106047,0.010065936356460307,0.010032805957816943,0.010024859441741762,0.010079328947004569,0.010127906057807863,0.010095390802282144,0.010057716490442055,0.01007449723850035,0.0100227312868158,0.009999502840941967,0.010080638562516309
];

export const dataset1_grad_itr5_nomh = [0.0034675428191103413,0.012342348275211898,0.005136611118545288,0.007932416456176124,0.009666135373419772,0.010817053928450391,0.012220619996136993,0.012912471296802718,0.013075058000093887,0.012994894981205086,0.012667711866531765,0.012107963935529842,0.011511800583013234,0.010577142514859311,0.010003546042785931,0.009551146929839459,0.009271893422269679,0.009436491643197518,0.009936734483093717,0.01132742133457918,0.013428246948643368,0.015609517078224234,0.017308106783085614,0.02091391008867117,0.018357169455685503,0.015709424571744325,0.01674853055643313,0.015913366161796266,0.008059834258935472,0.010683220980003058,0.006404276713049616,0.005778630387717304,0.006258620111283352,0.004450261343049198,0.004482540710499904,0.0038100750328218472,0.0051713996317493,0.006432643614920055,0.004943224086726063,0.0031296341668009806,0.0029709202387150596,0.0033799726575428064,0.006428596111582794,0.0049344484108052615,0.0052141414192115165,0.004635237985064027,0.004727055763989651,0.004532911361560478,0.0036073140894608987,0.0036176321879736817,0.004382809873953321,0.0057140478439107745,0.004215695605411414,0.0034234412255140668,0.0035944232544805168,0.0025715895930050357,0.005463847617858091,0.007816091700111898,0.004329069616122236,0.0032426424716201596,0.0034997681869251298,0.004465498329051922,0.0034412792001236063,0.0036177915435393854,0.0029610125162721685,0.0025527407501153396,0.003922333807106052,0.0028008343855230426,0.0024072181170298563,0.0032705157839561174,0.004132427511240204,0.0033737363007612406,0.0023561645771991283,0.0022338886025576763,0.002322258002999055,0.00245653976260284,0.0023103974829119735,0.002443538985551331,0.0027794132015599242,0.003643921225037118,0.002846491410745487,0.002484049746080962,0.0027592227428048528,0.0028364864525620877,0.0030157690138416177,0.0024733357758581443,0.002472801257820751,0.003954224986642446,0.0028459262644501687,0.0025435150261442887,0.00414637386474688,0.0034638467648249014,0.0047838524044663076,0.00421942283863984,0.002813502164547691,0.0036926577440011175,0.004467458325837525,0.003838844706812653,0.0028691042806337588,0.00419703226529052,0.003967469144286519,0.0034764460392708975,0.004437751455771517,0.002788351569498959,0.007590070158718874,0.007527974422554661,0.005770821644527445,0.0048630969153563835,0.005942879364246472,0.003104163070553136,0.0054295878345590656,0.006350212827011352,0.0028525706392672247,0.003471418640273416,0.0036711662022713308,0.002521874641864326,0.0033262354384546384,0.0038776815238888446,0.0036930541852625556,0.0018030242167911784
];

export const dataset1_grad_itr10_nomh = [0.0015392195162923247,0.008715100930240317,0.004628927861299336,0.007585319818216207,0.009554687061477742,0.010882364163433503,0.012711647340505205,0.01355620243928385,0.013621065565052094,0.013216854129951496,0.012578477819887099,0.010971376280667888,0.010319537261977284,0.009708159966650072,0.009350838729724241,0.00910036735369848,0.008541644583552901,0.008462439440149419,0.008757692213171643,0.010149432370445275,0.012106172431904373,0.013982534625016292,0.015396417851642957,0.018135662031343404,0.016530223147441073,0.013671568292834476,0.01468004248948889,0.012910114926205368,0.00672560053395681,0.009995134058731819,0.00584826784617232,0.004539611953702115,0.005847013681366686,0.0030185998924361847,0.0030270566885516243,0.002511716746827255,0.0028755806153764555,0.0036277439819165733,0.0023272260449503004,0.0019639318088226724,0.0016920364307865495,0.0024222119128636172,0.004254940965969989,0.002848452846363825,0.0035276820895266668,0.002789573596578003,0.003629650047234408,0.003137965215553835,0.002250570818087477,0.0030367132180710073,0.0028610919809488105,0.0041089654754659964,0.002457306925501725,0.002605482664745569,0.0023913346536945683,0.0014471020079042088,0.004931953773098975,0.006790571697674818,0.0038937948732294322,0.00202964639563133,0.0021433841722575124,0.0027290734521114675,0.0023446420116849716,0.0019609161881391484,0.001885654492627517,0.0014667099544866007,0.0028215377434563215,0.001344705819985037,0.0012980644484174293,0.002249075535916378,0.0029081011499695873,0.0022682138748212257,0.0016140646644587087,0.0014764265050186353,0.0017943864688627082,0.001741853492372009,0.001622952496054287,0.0018784328218403037,0.0018436387844840436,0.0026473023031705818,0.0022175907353277477,0.0019053001258745868,0.0023001280849885876,0.00235481750840168,0.0022465449120854584,0.002034768883491101,0.0018487307907189532,0.0031332301833130335,0.0021395105243984833,0.0017058214311784909,0.0033503344418450874,0.002134531146099548,0.003430566392113099,0.0020640869105887564,0.0019783651201884136,0.0023243923773133197,0.0022113603517598447,0.002230032654307516,0.0018452868802502644,0.002881336588649855,0.0018585238571214742,0.0016084579836717103,0.002761094541903191,0.0016847467483193878,0.007079195165424757,0.006956894227635347,0.00312197085652886,0.0033905868393498224,0.004872360737212537,0.0020647187549819655,0.005114554902831362,0.0058733878116436905,0.0022443203513540055,0.0014556481602107047,0.0014054520489277505,0.0014732760941705905,0.0018141495885647962,0.0017892010456981389,0.0019097394420648027,0.0009748126905454038
];

export const dataset1_grad_itr15_nomh = [0.001001899189483583,0.0059554110435145295,0.0042421421575182415,0.007308042415423021,0.009178185069344409,0.01030379731507949,0.012793033969449091,0.013793030195836319,0.013813786823438133,0.01316107226122276,0.012382728433308671,0.009204762858756654,0.010147650483840514,0.00946926601838921,0.00887880308493337,0.008671749242303736,0.007847891380841096,0.007629643708291831,0.00809081114875674,0.009201938958057224,0.011683297614559052,0.01333643730771392,0.014403476903555769,0.015579823938397044,0.014520199378868478,0.01240013913928326,0.012776754437159884,0.009627810761920588,0.005844099832575105,0.00952094657812387,0.005984322930834139,0.004150956744438077,0.005356816098994314,0.0024982913334819215,0.002904740747262528,0.0022917345399039585,0.002237193156764277,0.0028744995629314766,0.0015625912829656343,0.0012206510547307645,0.0011686858051363073,0.0012991443912851537,0.0022636768107171133,0.001503440936223223,0.0025524545950263156,0.002159850358884809,0.0028455905263577953,0.0023672303555136447,0.001705106071280767,0.002666068579363397,0.00205328792274828,0.0035042148706236308,0.00167025526157081,0.002116803287257955,0.0018574157209123416,0.000956330059170402,0.003533278116157213,0.004380718317988642,0.002828950153780291,0.0014271649388424663,0.001779301544245681,0.0018899601388654911,0.0017038653783036715,0.0012171132840630488,0.0013338783626401232,0.001023520031386791,0.0023325358351494884,0.000934165097939125,0.0010013009657235331,0.0017432126205082904,0.002168755790644501,0.0017858074102697224,0.0012177761189595547,0.0011897975683185125,0.0016552555372431668,0.0013354166791209742,0.0013414363733099766,0.0017468709371809893,0.0016798516408578713,0.0021897593100129883,0.0017312661630815881,0.0016541196766496054,0.0018874435842746076,0.0020413182918354715,0.0017938373613865146,0.001871001863148169,0.0018491549762137294,0.0027400296469128867,0.0020200156623731416,0.0014988849227372829,0.003062525190646472,0.0017084553013943834,0.0030173740981937823,0.0016797075411420284,0.0017640254061258504,0.002006311432460363,0.0015835728546097435,0.0016076965540868268,0.0013518469891524788,0.002313587706021697,0.001252441094510706,0.0009278331718155229,0.002022595859515339,0.0012619570063953456,0.006842605138068572,0.00683824555512069,0.0024999297594829463,0.002979303949852151,0.00426129859706714,0.0013464510307166155,0.0048583765373545725,0.005442291884469413,0.0020624592320178433,0.0012813956160231685,0.001155769647299169,0.0012309549926895163,0.0016566010843990576,0.0012801233571796162,0.0012765888302228808,0.0005923762687933392
];

export const dataset2_grad_nomh = [0.0007150621713157975,0.00410987429995524,0.0031249079200217867,0.004692292976147912,0.008018738379500928,0.009110245246065381,0.011283991136326216,0.01299347561134562,0.013787017909160227,0.013115861752573123,0.012345012017443292,0.00915062381357703,0.009738931059896103,0.009233775560435933,0.008707978877337376,0.008326561551534807,0.007140839641885868,0.0069552623211507686,0.007609867581566835,0.008833553677138931,0.011107620915043786,0.01229238740710251,0.014055707585793943,0.01412104966842113,0.012912271827554368,0.010645087338371098,0.010626971110361072,0.006772671116897761,0.005116782765618141,0.0077110704003936345,0.0049393531944687576,0.003755416315335791,0.004060082260636279,0.0023544606343329066,0.002168729547608055,0.0018377428455721191,0.001932839909894084,0.0025740536088884602,0.0012889424661532728,0.0008963728273890554,0.0008656353667281388,0.0011019377481868203,0.0022191680679249297,0.0013335133187989405,0.0019478960063040519,0.0015160645153375093,0.001999308337827851,0.0013747533760547815,0.001226944721321224,0.002206475868643306,0.0017168978004947853,0.002969361348336443,0.001301983825010011,0.0017485571769201194,0.0015648307652572438,0.0007105724850093967,0.0023003647816721893,0.0027458930249103586,0.0020317856588252716,0.0010039347069037271,0.0014696862530162523,0.001434762787891415,0.0012137840996132455,0.0008871291126462395,0.0010726437297147954,0.0007796978365961378,0.0020003575386560433,0.0008203412908972309,0.0008769217839974072,0.0014820116924714622,0.001160171808522038,0.0009194585776865766,0.0009600475991482404,0.001047976432736964,0.0014181212011917293,0.0010378815338122744,0.0011184106294318448,0.0016371763251117725,0.0014011775553912386,0.0018812964833271625,0.0015732470628711753,0.0014669294208818555,0.0014569915467419015,0.0018261347995099924,0.0015304398155480173,0.0017545113502625126,0.0020073132600929955,0.0023168127434296786,0.0020293265244122807,0.001353304339003661,0.002612933869101281,0.0015496005571307907,0.002731731526847666,0.0016371262972061462,0.0016190004759664698,0.0018934534912130997,0.0014072286582916523,0.0013578213864852248,0.0009407386556317543,0.0017019883874032275,0.0009913766373978348,0.0007851571290981183,0.001755524223776918,0.0008732440552336806,0.006711701760983733,0.006798367675598515,0.002044144208262058,0.002375459634666759,0.003585149060212456,0.0006647855848790035,0.004257534656506494,0.004630885631897696,0.001629490328651069,0.0010704315357916115,0.0009594794300936766,0.0010484738476730221,0.0015766902547028922,0.0009854703953994712,0.0012900172700279803,0.0003580098197944316
];

<MultiDataGraph datasets={[ { data: dataset1_grad_nomh, label: "緩和前の経路の勾配のRMS値", color: "rgba(75, 192, 192, 1)" }, { data: dataset1_grad_itr5_nomh, label: "ITR. 5の経路の勾配のRMS値", color: "rgba(81, 43, 186, 1)" }, { data: dataset1_grad_itr10_nomh, label: "ITR. 10の経路の勾配のRMS値", color: "rgba(153, 212, 37, 1)" }, { data: dataset1_grad_itr15_nomh, label: "ITR. 15の経路の勾配のRMS値", color: "rgba(13, 226, 148, 1)" }, { data: dataset2_grad_nomh, label: "緩和後の経路の勾配のRMS値", color: "rgba(255, 99, 132, 1)" }, ]} title="NEB計算の結果の可視化" xLabel="# NODE" yLabel="RMS of gradient [hartree/Bohr]" height="500px" />

※`bias_force_rms.csv`にて、各Iterationごとのすべてのノードの勾配のRMS値を確認できる。

緩和後の経路のエネルギー極大値を示すノードの分子構造
`sn2_I_beta_methyl_diketone_traj_17.xyz`
```
22
-1 1
C      -0.178039885189     -0.039360380000     -0.020933349120
C       1.062453475711     -0.522748509516      0.609862725971
C      -1.257269333868      0.468953993833      0.815894426689
C       1.895010260534     -1.644666842214     -0.056434292695
H       1.462165713139     -2.640828136013      0.090812187723
C       0.173275704802      1.672551899434     -1.228831014028
I       0.616660804720      2.728778549671     -3.441930600628
H       2.036248218123     -1.524243056503     -1.135306135168
H       2.867891129224     -1.641305866529      0.433429692442
C      -1.159106001759      0.629156289396      2.316301944249
H      -1.696777742613     -0.239717850907      2.708378458683
H      -0.162009314037      0.630282394463      2.734442606783
H      -1.726877763061      1.513708335269      2.597950851810
O       1.565170515245     -0.043212324318      1.626441780324
O      -2.368022041555      0.673637768864      0.316100360986
H       0.887279550204      0.920043905022     -1.432684897647
H       0.511026613421      2.520091077201     -0.643708408096
H      -0.885207173646      1.552344576301     -1.391663601511
C      -0.771648897899     -1.034571322182     -1.045615587291
H      -1.662420276457     -1.459040973033     -0.583338776738
H      -1.098150447218     -0.642224033990     -2.014632071034
H      -0.111653107819     -1.877629494249     -1.254536301704

```

